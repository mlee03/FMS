Page 1           Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56                                 /tmp/ifortYZCRQH.i90

      1 # 1 "sat_vapor_pres_k.F90"
      2 !***********************************************************************
      3 !*                   GNU Lesser General Public License
      4 !*
      5 !* This file is part of the GFDL Flexible Modeling System (FMS).
      6 !*
      7 !* FMS is free software: you can redistribute it and/or modify it under
      8 !* the terms of the GNU Lesser General Public License as published by
      9 !* the Free Software Foundation, either version 3 of the License, or (at
     10 !* your option) any later version.
     11 !*
     12 !* FMS is distributed in the hope that it will be useful, but WITHOUT
     13 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
     14 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
     15 !* for more details.
     16 !*
     17 !* You should have received a copy of the GNU Lesser General Public
     18 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
     19 !***********************************************************************
     20 
     21  module sat_vapor_pres_k_mod
     22 
     23 ! This module is what I (pjp) think a kernel should be.
     24 ! There have been many proposals as to what a kernel should look like.
     25 ! If fact, so many different ideas have been expressed that the lack
     26 ! of agreement has greatly hampered progress.
     27 ! The only way to move forward is to limit the requirments for a kernel
     28 ! to only what is widely agreeded upon.
     29 ! I believe that there are only two things widely agreeded upon.
     30 
     31 ! 1) A kernel should be independent of the rest of FMS so that it can
     32 !    easily be ported into another programming system.
     33 !    This requires that a kernel does not access anything by use association.
     34 !    The one exception is this kernel, because it is not practical for physics
     35 !    modules to avoid using a module that computes the saturation vapor
     36 !    pressure of water vapor.
     37 
     38 ! 2) For the sake of thread safety, module globals should be written only at initialization.
     39 !    In this case, the module globals are the tables and a handful of scalars.
     40 
     41 ! 3) A kernel should not read from an external file.
     42 
     43 ! One of the things that was not widely agreeded upon is that a kernel should
     44 ! not be a fortran module. This complicates things greatly for questionable
     45 ! benefit and could be done as a second step anyway, if necessary.
     46 
     47  implicit none
     48  private
     49 
     50 ! Include variable "version" to be written to log file.
     51 # 1 "../include/file_version.h" 1 
     52 ! -*-f90-*-
     53 !***********************************************************************
     54 !*                   GNU Lesser General Public License
     55 !*
     56 !* This file is part of the GFDL Flexible Modeling System (FMS).
     57 !*

Page 2           Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56                                 ../include/file_version.h

     58 !* FMS is free software: you can redistribute it and/or modify it under
     59 !* the terms of the GNU Lesser General Public License as published by
     60 !* the Free Software Foundation, either version 3 of the License, or (at
     61 !* your option) any later version.
     62 !*
     63 !* FMS is distributed in the hope that it will be useful, but WITHOUT
     64 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
     65 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
     66 !* for more details.
     67 !*
     68 !* You should have received a copy of the GNU Lesser General Public
     69 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
     70 !***********************************************************************
     71 
     72 # 23
     73 
     74   character(len=*), parameter :: version = 'unknown'
     75 
     76 # 51 "sat_vapor_pres_k.F90" 2 
     77 
     78  public :: sat_vapor_pres_init_k
     79  public :: lookup_es_k
     80  public :: lookup_des_k
     81  public :: lookup_es_des_k
     82  public :: lookup_es2_k
     83  public :: lookup_des2_k
     84  public :: lookup_es2_des2_k
     85  public :: lookup_es3_k
     86  public :: lookup_des3_k
     87  public :: lookup_es3_des3_k
     88  public :: compute_qs_k
     89  public :: compute_mrs_k
     90 
     91  interface lookup_es_k
     92    module procedure lookup_es_k_0d
     93    module procedure lookup_es_k_1d
     94    module procedure lookup_es_k_2d
     95    module procedure lookup_es_k_3d
     96  end interface
     97 
     98  interface lookup_des_k
     99    module procedure lookup_des_k_0d
    100    module procedure lookup_des_k_1d
    101    module procedure lookup_des_k_2d
    102    module procedure lookup_des_k_3d
    103  end interface
    104 
    105  interface lookup_es_des_k
    106    module procedure lookup_es_des_k_0d
    107    module procedure lookup_es_des_k_1d
    108    module procedure lookup_es_des_k_2d
    109    module procedure lookup_es_des_k_3d
    110  end interface
    111 
    112  interface lookup_es2_k
    113    module procedure lookup_es2_k_0d
    114    module procedure lookup_es2_k_1d

Page 3           Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    115    module procedure lookup_es2_k_2d
    116    module procedure lookup_es2_k_3d
    117  end interface
    118 
    119  interface lookup_des2_k
    120    module procedure lookup_des2_k_0d
    121    module procedure lookup_des2_k_1d
    122    module procedure lookup_des2_k_2d
    123    module procedure lookup_des2_k_3d
    124  end interface
    125 
    126  interface lookup_es2_des2_k
    127    module procedure lookup_es2_des2_k_0d
    128    module procedure lookup_es2_des2_k_1d
    129    module procedure lookup_es2_des2_k_2d
    130    module procedure lookup_es2_des2_k_3d
    131  end interface
    132 
    133  interface lookup_es3_k
    134    module procedure lookup_es3_k_0d
    135    module procedure lookup_es3_k_1d
    136    module procedure lookup_es3_k_2d
    137    module procedure lookup_es3_k_3d
    138  end interface
    139 
    140  interface lookup_des3_k
    141    module procedure lookup_des3_k_0d
    142    module procedure lookup_des3_k_1d
    143    module procedure lookup_des3_k_2d
    144    module procedure lookup_des3_k_3d
    145  end interface
    146 
    147  interface lookup_es3_des3_k
    148    module procedure lookup_es3_des3_k_0d
    149    module procedure lookup_es3_des3_k_1d
    150    module procedure lookup_es3_des3_k_2d
    151    module procedure lookup_es3_des3_k_3d
    152  end interface
    153 
    154  interface compute_qs_k
    155    module procedure compute_qs_k_0d
    156    module procedure compute_qs_k_1d
    157    module procedure compute_qs_k_2d
    158    module procedure compute_qs_k_3d
    159  end interface
    160 
    161  interface compute_mrs_k
    162    module procedure compute_mrs_k_0d
    163    module procedure compute_mrs_k_1d
    164    module procedure compute_mrs_k_2d
    165    module procedure compute_mrs_k_3d
    166  end interface
    167 
    168  real :: dtres, tepsl, tminl, dtinvl
    169  integer :: table_siz
    170  real, dimension(:), allocatable :: TABLE   !  sat vapor pres (es)
    171  real, dimension(:), allocatable :: DTABLE  !  first derivative of es

Page 4           Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    172  real, dimension(:), allocatable :: D2TABLE ! second derivative of es
    173  real, dimension(:), allocatable :: TABLE2  !  sat vapor pres (es)
    174  real, dimension(:), allocatable :: DTABLE2 !  first derivative of es
    175  real, dimension(:), allocatable :: D2TABLE2 ! second derivative of es
    176  real, dimension(:), allocatable :: TABLE3  !  sat vapor pres (es)
    177  real, dimension(:), allocatable :: DTABLE3 !  first derivative of es
    178  real, dimension(:), allocatable :: D2TABLE3 ! second derivative of es
    179 
    180  logical  :: use_exact_qs
    181  logical  :: module_is_initialized = .false.
    182 
    183  contains
    184 
    185  subroutine sat_vapor_pres_init_k(table_size, tcmin, tcmax, TFREEZE, HLV, RVGAS, ES0, err_msg, &
    186                                   use_exact_qs_input, do_simple,  &
    187                                   construct_table_wrt_liq, &
    188                                   construct_table_wrt_liq_and_ice, &
    189                                   teps, tmin, dtinv)
    190 
    191 ! This routine has been generalized to return tables for any temperature range and resolution
    192 
    193  integer, intent(in) :: table_size
    194  real, intent(in) :: tcmin ! TABLE(1)          = sat vapor pressure at temperature tcmin (deg C)
    195  real, intent(in) :: tcmax ! TABLE(table_size) = sat vapor pressure at temperature tcmax (deg C)
    196  real, intent(in) :: TFREEZE, HLV, RVGAS, ES0
    197  logical, intent(in)  :: use_exact_qs_input, do_simple
    198  logical, intent(in)  :: construct_table_wrt_liq
    199  logical, intent(in)  :: construct_table_wrt_liq_and_ice
    200  character(len=*), intent(out) :: err_msg
    201  real, intent(out), optional :: teps, tmin, dtinv
    202 
    203 ! increment used to generate derivative table
    204   real, dimension(3) :: tem(3), es(3)
    205   real :: hdtinv, tinrc, tfact
    206   integer :: i
    207 
    208       err_msg = ''
    209 
    210       if (module_is_initialized) return
    211 
    212       if(allocated(TABLE) .or. allocated(DTABLE) .or. allocated(D2TABLE)) then
    213         err_msg = 'Attempt to allocate sat vapor pressure tables when already allocated'
    214         return
    215       else
    216         allocate(TABLE(table_size), DTABLE(table_size), D2TABLE(table_size))
    217       endif
    218 
    219    if (construct_table_wrt_liq) then
    220       if(allocated(TABLE2) .or. allocated(DTABLE2) .or. allocated(D2TABLE2)) then
    221         err_msg = 'Attempt to allocate sat vapor pressure table2s when already allocated'
    222         return
    223       else
    224         allocate(TABLE2(table_size), DTABLE2(table_size), D2TABLE2(table_size))
    225       endif
    226    endif
    227 
    228    if (construct_table_wrt_liq_and_ice) then

Page 5           Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    229       if(allocated(TABLE3) .or. allocated(DTABLE3) .or. allocated(D2TABLE3)) then
    230         err_msg = 'Attempt to allocate sat vapor pressure table2s when already allocated'
    231         return
    232       else
    233         allocate(TABLE3(table_size), DTABLE3(table_size), D2TABLE3(table_size))
    234       endif
    235    endif
    236 
    237       table_siz = table_size
    238       dtres = (tcmax - tcmin)/real(table_size-1)
    239       tminl = real(tcmin)+TFREEZE  ! minimum valid temp in table
    240       dtinvl = 1./dtres
    241       tepsl = .5*dtres
    242       tinrc = .1*dtres
    243       if(present(teps )) teps =tepsl
    244       if(present(tmin )) tmin =tminl
    245       if(present(dtinv)) dtinv=dtinvl
    246 
    247 ! To be able to compute tables for any temperature range and resolution,
    248 ! and at the same time exactly reproduce answers from memphis revision,
    249 ! it is necessary to compute ftact differently than it is in memphis.
    250       tfact = 5.0*dtinvl
    251 
    252       hdtinv = dtinvl*0.5
    253 
    254 ! compute es tables from tcmin to tcmax
    255 ! estimate es derivative with small +/- difference
    256 
    257       if (do_simple) then
    258 
    259         do i = 1, table_size
    260           tem(1) = tminl + dtres*real(i-1)
    261           TABLE(i) = ES0*610.78*exp(-hlv/rvgas*(1./tem(1) - 1./tfreeze))
    262           DTABLE(i) = hlv*TABLE(i)/rvgas/tem(1)**2.
    263         enddo
    264 
    265       else
    266 
    267         do i = 1, table_size
    268           tem(1) = tminl + dtres*real(i-1)
    269           tem(2) = tem(1)-tinrc
    270           tem(3) = tem(1)+tinrc
    271           es = compute_es_k (tem, TFREEZE)
    272           TABLE(i) = es(1)
    273           DTABLE(i) = (es(3)-es(2))*tfact
    274         enddo
    275 
    276       endif !if (do_simple)
    277 
    278 ! compute one-half second derivative using centered differences
    279 ! differencing des values in the table
    280 
    281       do i = 2, table_size-1
    282          D2TABLE(i) = 0.25*dtinvl*(DTABLE(i+1)-DTABLE(i-1))
    283       enddo
    284 ! one-sided derivatives at boundaries
    285 

Page 6           Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    286          D2TABLE(1) = 0.50*dtinvl*(DTABLE(2)-DTABLE(1))
    287 
    288          D2TABLE(table_size) = 0.50*dtinvl*&
    289               (DTABLE(table_size)-DTABLE(table_size-1))
    290 
    291    if (construct_table_wrt_liq) then
    292 ! compute es tables from tcmin to tcmax
    293 ! estimate es derivative with small +/- difference
    294 
    295       do i = 1, table_size
    296         tem(1) = tminl + dtres*real(i-1)
    297         tem(2) = tem(1)-tinrc
    298         tem(3) = tem(1)+tinrc
    299 !   pass in flag to force all values to be wrt liquid
    300         es = compute_es_liq_k (tem, TFREEZE)
    301         TABLE2(i) = es(1)
    302         DTABLE2(i) = (es(3)-es(2))*tfact
    303       enddo
    304 
    305 ! compute one-half second derivative using centered differences
    306 ! differencing des values in the table
    307 
    308      do i = 2, table_size-1
    309        D2TABLE2(i) = 0.25*dtinvl*(DTABLE2(i+1)-DTABLE2(i-1))
    310      enddo
    311 ! one-sided derivatives at boundaries
    312 
    313      D2TABLE2(1) = 0.50*dtinvl*(DTABLE2(2)-DTABLE2(1))
    314 
    315      D2TABLE2(table_size) = 0.50*dtinvl*&
    316           (DTABLE2(table_size)-DTABLE2(table_size-1))
    317    endif
    318 
    319 
    320    if (construct_table_wrt_liq_and_ice) then
    321 ! compute es tables from tcmin to tcmax
    322 ! estimate es derivative with small +/- difference
    323 
    324       do i = 1, table_size
    325         tem(1) = tminl + dtres*real(i-1)
    326         tem(2) = tem(1)-tinrc
    327         tem(3) = tem(1)+tinrc
    328 !   pass in flag to force all values to be wrt liquid
    329         es = compute_es_liq_ice_k (tem, TFREEZE)
    330         TABLE3(i) = es(1)
    331         DTABLE3(i) = (es(3)-es(2))*tfact
    332       enddo
    333 
    334 ! compute one-half second derivative using centered differences
    335 ! differencing des values in the table
    336 
    337      do i = 2, table_size-1
    338        D2TABLE3(i) = 0.25*dtinvl*(DTABLE3(i+1)-DTABLE3(i-1))
    339      enddo
    340 ! one-sided derivatives at boundaries
    341 
    342      D2TABLE3(1) = 0.50*dtinvl*(DTABLE3(2)-DTABLE3(1))

Page 7           Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    343 
    344      D2TABLE3(table_size) = 0.50*dtinvl*&
    345           (DTABLE3(table_size)-DTABLE3(table_size-1))
    346    endif
    347 
    348       use_exact_qs = use_exact_qs_input
    349       module_is_initialized = .true.
    350 
    351  end subroutine sat_vapor_pres_init_k


ENTRY POINTS

  Name                                                      
                                                            
 sat_vapor_pres_k_mod_mp_sat_vapor_pres_init_k_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALLOCATED                  Func   212                                  scalar                    212,220,229                       
 CONSTRUCT_TABLE_WRT_LIQ    Dummy  187      L(4)            4           scalar   ARG,IN           219,291                           
 CONSTRUCT_TABLE_WRT_LIQ_AN                                                                                                         
 D_ICE                      Dummy  188      L(4)            4           scalar   ARG,IN           228,320                           
 D2TABLE                    Local  212      R(8)            8     1     1        ALC              212,216,282,286,288,1175,1176,1204
                                                                                                  ,1205,1231,1232,1256,1257,1282,130
                                                                                                  9,1334,1358,1380,1401,1421,1440   
 D2TABLE2                   Local  220      R(8)            8     1     1        ALC              220,224,309,313,315,1465,1466,1494
                                                                                                  ,1495,1521,1522,1546,1547,1572,159
                                                                                                  9,1624,1648,1670,1691,1711,1730   
 D2TABLE3                   Local  229      R(8)            8     1     1        ALC              229,233,338,342,344,1757,1758,1786
                                                                                                  ,1787,1813,1814,1838,1839,1864,189
                                                                                                  1,1916,1940,1962,1983,2003,2022   
 DO_SIMPLE                  Dummy  186      L(4)            4           scalar   ARG,IN           257                               
 DTABLE                     Local  212      R(8)            8     1     1        ALC              212,216,262,273,282,286,289,1175,1
                                                                                                  176,1204,1205,1231,1232,1256,1257,
                                                                                                  1282,1309,1334,1357,1380,1401,1421
                                                                                                  ,1440                             
 DTABLE2                    Local  220      R(8)            8     1     1        ALC              220,224,302,309,313,316,1465,1466,
                                                                                                  1494,1495,1521,1522,1546,1547,1572
                                                                                                  ,1599,1624,1647,1670,1691,1711,173
                                                                                                  0                                 
 DTABLE3                    Local  229      R(8)            8     1     1        ALC              229,233,331,338,342,345,1757,1758,
                                                                                                  1786,1787,1813,1814,1838,1839,1864
                                                                                                  ,1891,1916,1939,1962,1983,2003,202
                                                                                                  2                                 
 DTINV                      Dummy  189      R(8)            8           scalar   ARG,OUT          245                               
 DTINVL                     Local  240      R(8)            8           scalar                    240,245,250,252,282,286,288,309,31
                                                                                                  3,315,338,342,344,1169,1198,1225,1
                                                                                                  250,1276,1304,1329,1352,1375,1396,
                                                                                                  1416,1435,1459,1488,1515,1540,1566
                                                                                                  ,1594,1619,1642,1665,1686,1706,172
                                                                                                  5,1751,1780,1807,1832,1858,1886,19
                                                                                                  11,1934,1957,1978,1998,2017       
 DTRES                      Local  238      R(8)            8           scalar                    238,240,241,242,260,268,296,325,11

Page 8           Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  73,1202,1229,1254,1280,1308,1333,1
                                                                                                  356,1379,1400,1420,1439,1463,1492,
                                                                                                  1519,1544,1570,1598,1623,1646,1669
                                                                                                  ,1690,1710,1729,1755,1784,1811,183
                                                                                                  6,1862,1890,1915,1938,1961,1982,20
                                                                                                  02,2021                           
 ERR_MSG                    Dummy  185      CHAR                        scalar   ARG,OUT          208,213,221,230                   
 ES                         Local  204      R(8)            8     1     3                         271,272,273,300,301,302,329,330,33
                                                                                                  1                                 
 ES0                        Dummy  185      R(8)            8           scalar   ARG,IN           261                               
 EXP                        Func   261                                  scalar                    261                               
 HDTINV                     Local  205      R(8)            8           scalar                    252                               
 HLV                        Dummy  185      R(8)            8           scalar   ARG,IN           261,262                           
 I                          Local  206      I(4)            4           scalar                    259,260,261,262,267,268,272,273,28
                                                                                                  1,282,295,296,301,302,308,309,324,
                                                                                                  325,330,331,337,338               
 MODULE_IS_INITIALIZED      Local  210      L(4)            4           scalar                    181,210,349                       
 PRESENT                    Func   243                                  scalar                    243,244,245                       
 REAL                       Func   238                                  scalar                    238,239,260,268,296,325           
 RVGAS                      Dummy  185      R(8)            8           scalar   ARG,IN           261,262                           
 SAT_VAPOR_PRES_INIT_K      Subr   185                                                                                              
 TABLE                      Local  212      R(8)            8     1     1        ALC              212,216,261,262,272,1174,1203,1230
                                                                                                  ,1255,1281,1357,1401,1440         
 TABLE2                     Local  220      R(8)            8     1     1        ALC              220,224,301,1464,1493,1520,1545,15
                                                                                                  71,1647,1691,1730                 
 TABLE3                     Local  229      R(8)            8     1     1        ALC              229,233,330,1756,1785,1812,1837,18
                                                                                                  63,1939,1983,2022                 
 TABLE_SIZ                  Local  237      I(4)            4           scalar                    237,1170,1199,1226,1251,1277,1305,
                                                                                                  1330,1353,1376,1397,1417,1436,1460
                                                                                                  ,1489,1516,1541,1567,1595,1620,164
                                                                                                  3,1666,1687,1707,1726,1752,1781,18
                                                                                                  08,1833,1859,1887,1912,1935,1958,1
                                                                                                  979,1999,2018                     
 TABLE_SIZE                 Dummy  185      I(4)            4           scalar   ARG,IN           216,224,233,237,238,259,267,281,28
                                                                                                  8,289,295,308,315,316,324,337,344,
                                                                                                  345                               
 TCMAX                      Dummy  185      R(8)            8           scalar   ARG,IN           238                               
 TCMIN                      Dummy  185      R(8)            8           scalar   ARG,IN           238,239                           
 TEM                        Local  204      R(8)            8     1     3        TGT              260,261,262,268,269,270,271,296,29
                                                                                                  7,298,300,325,326,327,329         
 TEPS                       Dummy  189      R(8)            8           scalar   ARG,OUT          243                               
 TEPSL                      Local  241      R(8)            8           scalar                    241,243,1169,1198,1225,1250,1276,1
                                                                                                  304,1329,1352,1375,1396,1416,1435,
                                                                                                  1459,1488,1515,1540,1566,1594,1619
                                                                                                  ,1642,1665,1686,1706,1725,1751,178
                                                                                                  0,1807,1832,1858,1886,1911,1934,19
                                                                                                  57,1978,1998,2017                 
 TFACT                      Local  205      R(8)            8           scalar                    250,273,302,331                   
 TFREEZE                    Dummy  185      R(8)            8           scalar   ARG,IN           239,261,271,300,329               
 TINRC                      Local  205      R(8)            8           scalar                    242,269,270,297,298,326,327       
 TMIN                       Dummy  189      R(8)            8           scalar   ARG,OUT          244                               
 TMINL                      Local  239      R(8)            8           scalar                    239,244,260,268,296,325,1168,1197,
                                                                                                  1224,1249,1275,1303,1328,1351,1374
                                                                                                  ,1395,1415,1434,1458,1487,1514,153
                                                                                                  9,1565,1593,1618,1641,1664,1685,17

Page 9           Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  05,1724,1750,1779,1806,1831,1857,1
                                                                                                  885,1910,1933,1956,1977,1997,2016 
 USE_EXACT_QS               Local  348      L(4)            4           scalar                    348,531,618,703,785,869,956,1041,1
                                                                                                  123                               
 USE_EXACT_QS_INPUT         Dummy  186      L(4)            4           scalar   ARG,IN           348                               

Page 10          Source Listing                  SAT_VAPOR_PRES_INIT_K
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    352 
    353 !#######################################################################
    354 
    355  function compute_es_k(tem, TFREEZE) result (es)
    356  real, intent(in) :: tem(:), TFREEZE
    357  real :: es(size(tem,1))
    358 
    359  real    :: x, esice, esh2o, TBASW, TBASI
    360  integer :: i
    361  real, parameter :: ESBASW = 101324.60
    362  real, parameter :: ESBASI =    610.71
    363 
    364    TBASW = TFREEZE+100.
    365    TBASI = TFREEZE
    366 
    367    do i = 1, size(tem)
    368 
    369 !  compute es over ice
    370 
    371      if (tem(i) < TBASI) then
    372          x = -9.09718*(TBASI/tem(i)-1.0) - 3.56654*log10(TBASI/tem(i)) &
    373              +0.876793*(1.0-tem(i)/TBASI) + log10(ESBASI)
    374          esice =10.**(x)
    375      else
    376          esice = 0.
    377      endif
    378 
    379 !  compute es over water greater than -20 c.
    380 !  values over 100 c may not be valid
    381 !  see smithsonian meteorological tables page 350.
    382 
    383      if (tem(i) > -20.+TBASI) then
    384          x = -7.90298*(TBASW/tem(i)-1.0) + 5.02808*log10(TBASW/tem(i)) &
    385              -1.3816e-07*(10.0**((1.0-tem(i)/TBASW)*11.344)-1.0)        &
    386              +8.1328e-03*(10.0**((TBASW/tem(i)-1.0)*(-3.49149))-1.0)    &
    387              +log10(ESBASW)
    388          esh2o = 10.**(x)
    389      else
    390          esh2o = 0.
    391      endif
    392 
    393 !  derive blended es over ice and supercooled water between -20c and 0c
    394 
    395      if (tem(i) <= -20.+TBASI) then
    396          es(i) = esice
    397      else if (tem(i) >= TBASI) then
    398          es(i) = esh2o
    399      else
    400          es(i) = 0.05*((TBASI-tem(i))*esice + (tem(i)-TBASI+20.)*esh2o)
    401      endif
    402 
    403    enddo
    404 
    405  end function compute_es_k

Page 11          Source Listing                  COMPUTE_ES_K
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_k_mod_mp_compute_es_k_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_ES_K               Func   355      R(8)            8     1     0                         271                               
 ES                         Local  357      R(8)            8     1     0                         396,398,400                       
 ESBASI                     Param  362      R(8)            8           scalar                    373                               
 ESBASW                     Param  361      R(8)            8           scalar                    387                               
 ESH2O                      Local  359      R(8)            8           scalar                    388,390,398,400                   
 ESICE                      Local  359      R(8)            8           scalar                    374,376,396,400                   
 I                          Local  360      I(4)            4           scalar                    367,371,372,373,383,384,385,386,39
                                                                                                  5,396,397,398,400                 
 LOG10                      Func   372                                  scalar                    372,373,384,387                   
 SIZE                       Func   357                                  scalar                    357,367                           
 TBASI                      Local  359      R(8)            8           scalar                    365,371,372,373,383,395,397,400   
 TBASW                      Local  359      R(8)            8           scalar                    364,384,385,386                   
 TEM                        Dummy  355      R(8)            8     1     1        ARG,IN           357,367,371,372,373,383,384,385,38
                                                                                                  6,395,397,400                     
 TFREEZE                    Dummy  355      R(8)            8           scalar   ARG,IN           364,365                           
 X                          Local  359      R(8)            8           scalar                    372,374,384,388                   

Page 12          Source Listing                  COMPUTE_ES_K
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    406 
    407 !#######################################################################
    408 
    409  function compute_es_liq_k(tem, TFREEZE) result (es)
    410  real, intent(in) :: tem(:), TFREEZE
    411  real :: es(size(tem,1))
    412 
    413  real    :: x, esh2o, TBASW
    414  integer :: i
    415  real, parameter :: ESBASW = 101324.60
    416 
    417    TBASW = TFREEZE+100.
    418 
    419    do i = 1, size(tem)
    420 
    421 
    422 !  compute es over water for all temps.
    423 !  values over 100 c may not be valid
    424 !  see smithsonian meteorological tables page 350.
    425 
    426          x = -7.90298*(TBASW/tem(i)-1.0) + 5.02808*log10(TBASW/tem(i)) &
    427              -1.3816e-07*(10.0**((1.0-tem(i)/TBASW)*11.344)-1.0)        &
    428              +8.1328e-03*(10.0**((TBASW/tem(i)-1.0)*(-3.49149))-1.0)    &
    429              +log10(ESBASW)
    430          esh2o = 10.**(x)
    431 
    432 
    433          es(i) = esh2o
    434 
    435    enddo
    436 
    437  end function compute_es_liq_k

Page 13          Source Listing                  COMPUTE_ES_LIQ_K
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_compute_es_liq_k_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_ES_LIQ_K           Func   409      R(8)            8     1     0                         300                               
 ES                         Local  411      R(8)            8     1     0                         433                               
 ESBASW                     Param  415      R(8)            8           scalar                    429                               
 ESH2O                      Local  413      R(8)            8           scalar                    430,433                           
 I                          Local  414      I(4)            4           scalar                    419,426,427,428,433               
 LOG10                      Func   426                                  scalar                    426,429                           
 SIZE                       Func   411                                  scalar                    411,419                           
 TBASW                      Local  413      R(8)            8           scalar                    417,426,427,428                   
 TEM                        Dummy  409      R(8)            8     1     1        ARG,IN           411,419,426,427,428               
 TFREEZE                    Dummy  409      R(8)            8           scalar   ARG,IN           417                               
 X                          Local  413      R(8)            8           scalar                    426,430                           

Page 14          Source Listing                  COMPUTE_ES_LIQ_K
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    438 
    439 !#######################################################################
    440 
    441  function compute_es_liq_ice_k(tem, TFREEZE) result (es)
    442  real, intent(in) :: tem(:), TFREEZE
    443  real :: es(size(tem,1))
    444 
    445  real    :: x, TBASW, TBASI
    446  integer :: i
    447  real, parameter :: ESBASW = 101324.60
    448  real, parameter :: ESBASI =    610.71
    449 
    450    TBASW = TFREEZE+100.
    451    TBASI = TFREEZE
    452 
    453    do i = 1, size(tem)
    454 
    455      if (tem(i) < TBASI) then
    456 
    457 !  compute es over ice
    458 
    459          x = -9.09718*(TBASI/tem(i)-1.0) - 3.56654*log10(TBASI/tem(i)) &
    460              +0.876793*(1.0-tem(i)/TBASI) + log10(ESBASI)
    461          es(i) =10.**(x)
    462      else
    463 
    464 !  compute es over water
    465 !  values over 100 c may not be valid
    466 !  see smithsonian meteorological tables page 350.
    467 
    468          x = -7.90298*(TBASW/tem(i)-1.0) + 5.02808*log10(TBASW/tem(i)) &
    469              -1.3816e-07*(10.0**((1.0-tem(i)/TBASW)*11.344)-1.0)        &
    470              +8.1328e-03*(10.0**((TBASW/tem(i)-1.0)*(-3.49149))-1.0)    &
    471              +log10(ESBASW)
    472          es(i) = 10.**(x)
    473      endif
    474 
    475    enddo
    476 
    477  end function compute_es_liq_ice_k

Page 15          Source Listing                  COMPUTE_ES_LIQ_ICE_K
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                     
                                                           
 sat_vapor_pres_k_mod_mp_compute_es_liq_ice_k_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_ES_LIQ_ICE_K       Func   441      R(8)            8     1     0                         329                               
 ES                         Local  443      R(8)            8     1     0                         461,472                           
 ESBASI                     Param  448      R(8)            8           scalar                    460                               
 ESBASW                     Param  447      R(8)            8           scalar                    471                               
 I                          Local  446      I(4)            4           scalar                    453,455,459,460,461,468,469,470,47
                                                                                                  2                                 
 LOG10                      Func   459                                  scalar                    459,460,468,471                   
 SIZE                       Func   443                                  scalar                    443,453                           
 TBASI                      Local  445      R(8)            8           scalar                    451,455,459,460                   
 TBASW                      Local  445      R(8)            8           scalar                    450,468,469,470                   
 TEM                        Dummy  441      R(8)            8     1     1        ARG,IN           443,453,455,459,460,468,469,470   
 TFREEZE                    Dummy  441      R(8)            8           scalar   ARG,IN           450,451                           
 X                          Local  445      R(8)            8           scalar                    459,461,468,472                   

Page 16          Source Listing                  COMPUTE_ES_LIQ_ICE_K
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    478 
    479 !#######################################################################
    480 
    481  subroutine compute_qs_k_3d (temp, press, eps, zvir, qs, nbad, q, hc, &
    482                           dqsdT, esat, es_over_liq, es_over_liq_and_ice)
    483 
    484  real, intent(in),  dimension(:,:,:)           :: temp, press
    485  real, intent(in)                              :: eps, zvir
    486  real, intent(out), dimension(:,:,:)           :: qs
    487  integer, intent(out)                          :: nbad
    488  real, intent(in),  dimension(:,:,:), optional :: q
    489  real, intent(in),                    optional :: hc
    490  real, intent(out), dimension(:,:,:), optional :: dqsdT, esat
    491  logical,intent(in),                  optional :: es_over_liq
    492  logical,intent(in),                  optional :: es_over_liq_and_ice
    493 
    494  real, dimension(size(temp,1), size(temp,2), size(temp,3)) ::   &
    495                                                   esloc, desat, denom
    496  integer :: i, j, k
    497  real    :: hc_loc
    498 
    499    if (present(hc)) then
    500      hc_loc = hc
    501    else
    502      hc_loc = 1.0
    503    endif
    504  if (present(es_over_liq)) then
    505    if (present (dqsdT)) then
    506      call lookup_es2_des2_k (temp, esloc, desat, nbad)
    507      desat = desat*hc_loc
    508    else
    509      call lookup_es2_k (temp, esloc, nbad)
    510    endif
    511  else if (present(es_over_liq_and_ice)) then
    512    if (present (dqsdT)) then
    513      call lookup_es3_des3_k (temp, esloc, desat, nbad)
    514      desat = desat*hc_loc
    515    else
    516      call lookup_es3_k (temp, esloc, nbad)
    517    endif
    518  else
    519    if (present (dqsdT)) then
    520      call lookup_es_des_k (temp, esloc, desat, nbad)
    521      desat = desat*hc_loc
    522    else
    523      call lookup_es_k (temp, esloc, nbad)
    524    endif
    525  endif
    526    esloc = esloc*hc_loc
    527    if (present (esat)) then
    528      esat = esloc
    529    endif
    530    if (nbad == 0) then
    531      if (present (q) .and. use_exact_qs) then
    532        qs = (1.0 + zvir*q)*eps*esloc/press
    533        if (present (dqsdT)) then
    534          dqsdT = (1.0 + zvir*q)*eps*desat/press

Page 17          Source Listing                  COMPUTE_QS_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    535        endif
    536      else  ! (present(q))
    537        denom = press - (1.0 - eps)*esloc
    538        do k=1,size(qs,3)
    539          do j=1,size(qs,2)
    540            do i=1,size(qs,1)
    541              if (denom(i,j,k) > 0.0) then
    542                qs(i,j,k) = eps*esloc(i,j,k)/denom(i,j,k)
    543              else
    544                qs(i,j,k) = eps
    545              endif
    546            end do
    547          end do
    548        end do
    549        if (present (dqsdT)) then
    550          dqsdT = eps*press*desat/denom**2
    551        endif
    552      endif ! (present(q))
    553    else ! (nbad = 0)
    554      qs = -999.
    555      if (present (dqsdT)) then
    556        dqsdT = -999.
    557      endif
    558      if (present (esat)) then
    559        esat = -999.
    560      endif
    561    endif ! (nbad = 0)
    562 
    563 
    564  end subroutine compute_qs_k_3d

Page 18          Source Listing                  COMPUTE_QS_K_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_compute_qs_k_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_QS_K_3D            Subr   481                                           PRIV                                               
 DENOM                      Local  495      R(8)            8     3     0                         537,541,542,550                   
 DESAT                      Local  495      R(8)            8     3     0        TGT              506,507,513,514,520,521,534,550   
 DQSDT                      Dummy  482      R(8)            8     3     1        ARG,OUT          505,512,519,533,534,549,550,555,55
                                                                                                  6                                 
 EPS                        Dummy  481      R(8)            8           scalar   ARG,IN           532,534,537,542,544,550           
 ESAT                       Dummy  482      R(8)            8     3     1        ARG,OUT          527,528,558,559                   
 ESLOC                      Local  495      R(8)            8     3     0        TGT              506,509,513,516,520,523,526,528,53
                                                                                                  2,537,542                         
 ES_OVER_LIQ                Dummy  482      L(4)            4           scalar   ARG,IN           504                               
 ES_OVER_LIQ_AND_ICE        Dummy  482      L(4)            4           scalar   ARG,IN           511                               
 HC                         Dummy  481      R(8)            8           scalar   ARG,IN           499,500                           
 HC_LOC                     Local  497      R(8)            8           scalar                    500,502,507,514,521,526           
 I                          Local  496      I(4)            4           scalar                    540,541,542,544                   
 J                          Local  496      I(4)            4           scalar                    539,541,542,544                   
 K                          Local  496      I(4)            4           scalar                    538,541,542,544                   
 LOOKUP_ES2_DES2_K          Local  506                                  scalar                    84,506,593,678,760,844,931,1016,10
                                                                                                  98                                
 LOOKUP_ES2_K               Local  509                                  scalar                    82,509,596,681,763,847,934,1019,11
                                                                                                  01                                
 LOOKUP_ES3_DES3_K          Local  513                                  scalar                    87,513,600,685,767,851,938,1023,11
                                                                                                  05                                
 LOOKUP_ES3_K               Local  516                                  scalar                    85,516,603,688,770,854,941,1026,11
                                                                                                  08                                
 LOOKUP_ES_DES_K            Local  520                                  scalar                    81,520,607,692,774,858,945,1030,11
                                                                                                  12                                
 LOOKUP_ES_K                Local  523                                  scalar                    79,523,610,695,777,861,948,1033,11
                                                                                                  15                                
 NBAD                       Dummy  481      I(4)            4           scalar   ARG,OUT          506,509,513,516,520,523,530       
 PRESENT                    Func   499                                  scalar                    499,504,505,511,512,519,527,531,53
                                                                                                  3,549,555,558                     
 PRESS                      Dummy  481      R(8)            8     3     1        ARG,IN           532,534,537,550                   
 Q                          Dummy  481      R(8)            8     3     1        ARG,IN           531,532,534                       
 QS                         Dummy  481      R(8)            8     3     1        ARG,OUT          532,538,539,540,542,544,554       
 SIZE                       Func   538                                  scalar                    538,539,540                       
 TEMP                       Dummy  481      R(8)            8     3     1        ARG,IN           506,509,513,516,520,523           
 ZVIR                       Dummy  481      R(8)            8           scalar   ARG,IN           532,534                           

Page 19          Source Listing                  COMPUTE_QS_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    565 
    566 !#######################################################################
    567 
    568  subroutine compute_qs_k_2d (temp, press, eps, zvir, qs, nbad, q, hc, &
    569                           dqsdT, esat, es_over_liq, es_over_liq_and_ice)
    570 
    571  real, intent(in),  dimension(:,:)           :: temp, press
    572  real, intent(in)                            :: eps, zvir
    573  real, intent(out), dimension(:,:)           :: qs
    574  integer, intent(out)                        :: nbad
    575  real, intent(in),  dimension(:,:), optional :: q
    576  real, intent(in),                  optional :: hc
    577  real, intent(out), dimension(:,:), optional :: dqsdT, esat
    578  logical,intent(in),                optional :: es_over_liq
    579  logical,intent(in),                  optional :: es_over_liq_and_ice
    580 
    581  real, dimension(size(temp,1), size(temp,2)) :: esloc, desat, denom
    582  integer :: i, j
    583  real    :: hc_loc
    584 
    585    if (present(hc)) then
    586      hc_loc = hc
    587    else
    588      hc_loc = 1.0
    589    endif
    590 
    591  if (present(es_over_liq)) then
    592    if (present (dqsdT)) then
    593      call lookup_es2_des2_k (temp, esloc, desat, nbad)
    594      desat = desat*hc_loc
    595    else
    596      call lookup_es2_k (temp, esloc, nbad)
    597    endif
    598  else if (present(es_over_liq_and_ice)) then
    599    if (present (dqsdT)) then
    600      call lookup_es3_des3_k (temp, esloc, desat, nbad)
    601      desat = desat*hc_loc
    602    else
    603      call lookup_es3_k (temp, esloc, nbad)
    604    endif
    605  else
    606    if (present (dqsdT)) then
    607      call lookup_es_des_k (temp, esloc, desat, nbad)
    608      desat = desat*hc_loc
    609    else
    610      call lookup_es_k (temp, esloc, nbad)
    611    endif
    612  endif
    613    esloc = esloc*hc_loc
    614    if (present (esat)) then
    615      esat = esloc
    616    endif
    617    if (nbad == 0) then
    618      if (present (q) .and. use_exact_qs) then
    619        qs = (1.0 + zvir*q)*eps*esloc/press
    620        if (present (dqsdT)) then
    621          dqsdT = (1.0 + zvir*q)*eps*desat/press

Page 20          Source Listing                  COMPUTE_QS_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    622        endif
    623      else  ! (present(q))
    624        denom = press - (1.0 - eps)*esloc
    625       do j=1,size(qs,2)
    626         do i=1,size(qs,1)
    627           if (denom(i,j) > 0.0) then
    628             qs(i,j) = eps*esloc(i,j)/denom(i,j)
    629           else
    630             qs(i,j) = eps
    631           endif
    632         end do
    633       end do
    634       if (present (dqsdT)) then
    635         dqsdT = eps*press*desat/denom**2
    636       endif
    637     endif ! (present(q))
    638    else ! (nbad = 0)
    639      qs = -999.
    640      if (present (dqsdT)) then
    641        dqsdT = -999.
    642      endif
    643      if (present (esat)) then
    644        esat = -999.
    645      endif
    646    endif ! (nbad = 0)
    647 
    648 
    649  end subroutine compute_qs_k_2d

Page 21          Source Listing                  COMPUTE_QS_K_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_compute_qs_k_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_QS_K_2D            Subr   568                                           PRIV                                               
 DENOM                      Local  581      R(8)            8     2     0                         624,627,628,635                   
 DESAT                      Local  581      R(8)            8     2     0        TGT              593,594,600,601,607,608,621,635   
 DQSDT                      Dummy  569      R(8)            8     2     1        ARG,OUT          592,599,606,620,621,634,635,640,64
                                                                                                  1                                 
 EPS                        Dummy  568      R(8)            8           scalar   ARG,IN           619,621,624,628,630,635           
 ESAT                       Dummy  569      R(8)            8     2     1        ARG,OUT          614,615,643,644                   
 ESLOC                      Local  581      R(8)            8     2     0        TGT              593,596,600,603,607,610,613,615,61
                                                                                                  9,624,628                         
 ES_OVER_LIQ                Dummy  569      L(4)            4           scalar   ARG,IN           591                               
 ES_OVER_LIQ_AND_ICE        Dummy  569      L(4)            4           scalar   ARG,IN           598                               
 HC                         Dummy  568      R(8)            8           scalar   ARG,IN           585,586                           
 HC_LOC                     Local  583      R(8)            8           scalar                    586,588,594,601,608,613           
 I                          Local  582      I(4)            4           scalar                    626,627,628,630                   
 J                          Local  582      I(4)            4           scalar                    625,627,628,630                   
 NBAD                       Dummy  568      I(4)            4           scalar   ARG,OUT          593,596,600,603,607,610,617       
 PRESENT                    Func   585                                  scalar                    585,591,592,598,599,606,614,618,62
                                                                                                  0,634,640,643                     
 PRESS                      Dummy  568      R(8)            8     2     1        ARG,IN           619,621,624,635                   
 Q                          Dummy  568      R(8)            8     2     1        ARG,IN           618,619,621                       
 QS                         Dummy  568      R(8)            8     2     1        ARG,OUT          619,625,626,628,630,639           
 SIZE                       Func   625                                  scalar                    625,626                           
 TEMP                       Dummy  568      R(8)            8     2     1        ARG,IN           593,596,600,603,607,610           
 ZVIR                       Dummy  568      R(8)            8           scalar   ARG,IN           619,621                           

Page 22          Source Listing                  COMPUTE_QS_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    650 
    651 !#######################################################################
    652 
    653  subroutine compute_qs_k_1d (temp, press, eps, zvir, qs, nbad, q, hc, &
    654                           dqsdT, esat, es_over_liq, es_over_liq_and_ice)
    655 
    656  real, intent(in),  dimension(:)           :: temp, press
    657  real, intent(in)                          :: eps, zvir
    658  real, intent(out), dimension(:)           :: qs
    659  integer, intent(out)                      :: nbad
    660  real, intent(in),  dimension(:), optional :: q
    661  real, intent(in),                optional :: hc
    662  real, intent(out), dimension(:), optional :: dqsdT, esat
    663  logical,intent(in),              optional :: es_over_liq
    664  logical,intent(in),                  optional :: es_over_liq_and_ice
    665 
    666  real, dimension(size(temp,1)) :: esloc, desat, denom
    667  integer :: i
    668  real    :: hc_loc
    669 
    670    if (present(hc)) then
    671      hc_loc = hc
    672    else
    673      hc_loc = 1.0
    674    endif
    675 
    676  if (present(es_over_liq)) then
    677    if (present (dqsdT)) then
    678      call lookup_es2_des2_k (temp, esloc, desat, nbad)
    679      desat = desat*hc_loc
    680    else
    681      call lookup_es2_k (temp, esloc, nbad)
    682    endif
    683  else if (present(es_over_liq_and_ice)) then
    684    if (present (dqsdT)) then
    685      call lookup_es3_des3_k (temp, esloc, desat, nbad)
    686      desat = desat*hc_loc
    687    else
    688      call lookup_es3_k (temp, esloc, nbad)
    689    endif
    690  else
    691    if (present (dqsdT)) then
    692      call lookup_es_des_k (temp, esloc, desat, nbad)
    693      desat = desat*hc_loc
    694    else
    695      call lookup_es_k (temp, esloc, nbad)
    696    endif
    697  endif
    698    esloc = esloc*hc_loc
    699    if (present (esat)) then
    700      esat = esloc
    701    endif
    702    if (nbad == 0) then
    703      if (present (q) .and. use_exact_qs) then
    704        qs = (1.0 + zvir*q)*eps*esloc/press
    705        if (present (dqsdT)) then
    706          dqsdT = (1.0 + zvir*q)*eps*desat/press

Page 23          Source Listing                  COMPUTE_QS_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    707        endif
    708      else  ! (present(q))
    709        denom = press - (1.0 - eps)*esloc
    710        do i=1,size(qs,1)
    711          if (denom(i) >  0.0) then
    712            qs(i) = eps*esloc(i)/denom(i)
    713          else
    714            qs(i) = eps
    715          endif
    716        end do
    717        if (present (dqsdT)) then
    718          dqsdT = eps*press*desat/denom**2
    719        endif
    720      endif ! (present(q))
    721    else ! (nbad = 0)
    722      qs = -999.
    723      if (present (dqsdT)) then
    724        dqsdT = -999.
    725      endif
    726      if (present (esat)) then
    727        esat = -999.
    728      endif
    729    endif ! (nbad = 0)
    730 
    731 
    732  end subroutine compute_qs_k_1d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_compute_qs_k_1d_             

Page 24          Source Listing                  COMPUTE_QS_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_QS_K_1D            Subr   653                                           PRIV                                               
 DENOM                      Local  666      R(8)            8     1     0                         709,711,712,718                   
 DESAT                      Local  666      R(8)            8     1     0        TGT              678,679,685,686,692,693,706,718   
 DQSDT                      Dummy  654      R(8)            8     1     1        ARG,OUT          677,684,691,705,706,717,718,723,72
                                                                                                  4                                 
 EPS                        Dummy  653      R(8)            8           scalar   ARG,IN           704,706,709,712,714,718           
 ESAT                       Dummy  654      R(8)            8     1     1        ARG,OUT          699,700,726,727                   
 ESLOC                      Local  666      R(8)            8     1     0        TGT              678,681,685,688,692,695,698,700,70
                                                                                                  4,709,712                         
 ES_OVER_LIQ                Dummy  654      L(4)            4           scalar   ARG,IN           676                               
 ES_OVER_LIQ_AND_ICE        Dummy  654      L(4)            4           scalar   ARG,IN           683                               
 HC                         Dummy  653      R(8)            8           scalar   ARG,IN           670,671                           
 HC_LOC                     Local  668      R(8)            8           scalar                    671,673,679,686,693,698           
 I                          Local  667      I(4)            4           scalar                    710,711,712,714                   
 NBAD                       Dummy  653      I(4)            4           scalar   ARG,OUT          678,681,685,688,692,695,702       
 PRESENT                    Func   670                                  scalar                    670,676,677,683,684,691,699,703,70
                                                                                                  5,717,723,726                     
 PRESS                      Dummy  653      R(8)            8     1     1        ARG,IN           704,706,709,718                   
 Q                          Dummy  653      R(8)            8     1     1        ARG,IN           703,704,706                       
 QS                         Dummy  653      R(8)            8     1     1        ARG,OUT          704,710,712,714,722               
 SIZE                       Func   710                                  scalar                    710                               
 TEMP                       Dummy  653      R(8)            8     1     1        ARG,IN           678,681,685,688,692,695           
 ZVIR                       Dummy  653      R(8)            8           scalar   ARG,IN           704,706                           

Page 25          Source Listing                  COMPUTE_QS_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    733 
    734 !#######################################################################
    735 
    736  subroutine compute_qs_k_0d (temp, press, eps, zvir, qs, nbad, q, hc, &
    737                           dqsdT, esat, es_over_liq, es_over_liq_and_ice)
    738 
    739  real, intent(in)                :: temp, press
    740  real, intent(in)                :: eps, zvir
    741  real, intent(out)               :: qs
    742  integer, intent(out)            :: nbad
    743  real, intent(in),      optional :: q
    744  real, intent(in),      optional :: hc
    745  real, intent(out),     optional :: dqsdT, esat
    746  logical,intent(in),    optional :: es_over_liq
    747  logical,intent(in),                  optional :: es_over_liq_and_ice
    748 
    749  real    :: esloc, desat, denom
    750  real    :: hc_loc
    751 
    752    if (present(hc)) then
    753      hc_loc = hc
    754    else
    755      hc_loc = 1.0
    756    endif
    757 
    758  if (present(es_over_liq)) then
    759    if (present (dqsdT)) then
    760      call lookup_es2_des2_k (temp, esloc, desat, nbad)
    761      desat = desat*hc_loc
    762    else
    763      call lookup_es2_k (temp, esloc, nbad)
    764    endif
    765  else if (present(es_over_liq_and_ice)) then
    766    if (present (dqsdT)) then
    767      call lookup_es3_des3_k (temp, esloc, desat, nbad)
    768      desat = desat*hc_loc
    769    else
    770      call lookup_es3_k (temp, esloc, nbad)
    771    endif
    772  else
    773    if (present (dqsdT)) then
    774      call lookup_es_des_k (temp, esloc, desat, nbad)
    775      desat = desat*hc_loc
    776    else
    777      call lookup_es_k (temp, esloc, nbad)
    778    endif
    779  endif
    780    esloc = esloc*hc_loc
    781    if (present (esat)) then
    782      esat = esloc
    783    endif
    784    if (nbad == 0) then
    785      if (present (q) .and. use_exact_qs) then
    786        qs = (1.0 + zvir*q)*eps*esloc/press
    787        if (present (dqsdT)) then
    788          dqsdT = (1.0 + zvir*q)*eps*desat/press
    789        endif

Page 26          Source Listing                  COMPUTE_QS_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    790      else  ! (present(q))
    791        denom = press - (1.0 - eps)*esloc
    792        if (denom > 0.0) then
    793          qs = eps*esloc/denom
    794        else
    795          qs = eps
    796        endif
    797        if (present (dqsdT)) then
    798          dqsdT = eps*press*desat/denom**2
    799        endif
    800      endif ! (present(q))
    801    else ! (nbad = 0)
    802      qs = -999.
    803      if (present (dqsdT)) then
    804        dqsdT = -999.
    805      endif
    806      if (present (esat)) then
    807        esat = -999.
    808      endif
    809    endif ! (nbad = 0)
    810 
    811 
    812  end subroutine compute_qs_k_0d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_compute_qs_k_0d_             

Page 27          Source Listing                  COMPUTE_QS_K_0D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_QS_K_0D            Subr   736                                           PRIV                                               
 DENOM                      Local  749      R(8)            8           scalar                    791,792,793,798                   
 DESAT                      Local  749      R(8)            8           scalar                    760,761,767,768,774,775,788,798   
 DQSDT                      Dummy  737      R(8)            8           scalar   ARG,OUT          759,766,773,787,788,797,798,803,80
                                                                                                  4                                 
 EPS                        Dummy  736      R(8)            8           scalar   ARG,IN           786,788,791,793,795,798           
 ESAT                       Dummy  737      R(8)            8           scalar   ARG,OUT          781,782,806,807                   
 ESLOC                      Local  749      R(8)            8           scalar                    760,763,767,770,774,777,780,782,78
                                                                                                  6,791,793                         
 ES_OVER_LIQ                Dummy  737      L(4)            4           scalar   ARG,IN           758                               
 ES_OVER_LIQ_AND_ICE        Dummy  737      L(4)            4           scalar   ARG,IN           765                               
 HC                         Dummy  736      R(8)            8           scalar   ARG,IN           752,753                           
 HC_LOC                     Local  750      R(8)            8           scalar                    753,755,761,768,775,780           
 NBAD                       Dummy  736      I(4)            4           scalar   ARG,OUT          760,763,767,770,774,777,784       
 PRESENT                    Func   752                                  scalar                    752,758,759,765,766,773,781,785,78
                                                                                                  7,797,803,806                     
 PRESS                      Dummy  736      R(8)            8           scalar   ARG,IN           786,788,791,798                   
 Q                          Dummy  736      R(8)            8           scalar   ARG,IN           785,786,788                       
 QS                         Dummy  736      R(8)            8           scalar   ARG,OUT          786,793,795,802                   
 TEMP                       Dummy  736      R(8)            8           scalar   ARG,IN           760,763,767,770,774,777           
 ZVIR                       Dummy  736      R(8)            8           scalar   ARG,IN           786,788                           

Page 28          Source Listing                  COMPUTE_QS_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    813 
    814 !#######################################################################
    815 
    816 !#######################################################################
    817 
    818  subroutine compute_mrs_k_3d (temp, press, eps, zvir, mrs, nbad,   &
    819                  mr, hc, dmrsdT, esat,es_over_liq, es_over_liq_and_ice)
    820 
    821  real, intent(in),  dimension(:,:,:)           :: temp, press
    822  real, intent(in)                              :: eps, zvir
    823  real, intent(out), dimension(:,:,:)           :: mrs
    824  integer, intent(out)                          :: nbad
    825  real, intent(in),  dimension(:,:,:), optional :: mr
    826  real, intent(in),                    optional :: hc
    827  real, intent(out), dimension(:,:,:), optional :: dmrsdT, esat
    828  logical,intent(in),                  optional :: es_over_liq
    829  logical,intent(in),                  optional :: es_over_liq_and_ice
    830 
    831  real, dimension(size(temp,1), size(temp,2), size(temp,3)) ::    &
    832                                                     esloc, desat, denom
    833  integer :: i, j, k
    834  real    :: hc_loc
    835 
    836    if (present(hc)) then
    837      hc_loc = hc
    838    else
    839      hc_loc = 1.0
    840    endif
    841 
    842  if (present (es_over_liq)) then
    843    if (present (dmrsdT)) then
    844      call lookup_es2_des2_k (temp, esloc, desat, nbad)
    845      desat = desat*hc_loc
    846    else
    847      call lookup_es2_k (temp, esloc, nbad)
    848    endif
    849  else if (present(es_over_liq_and_ice)) then
    850    if (present (dmrsdT)) then
    851      call lookup_es3_des3_k (temp, esloc, desat, nbad)
    852      desat = desat*hc_loc
    853    else
    854      call lookup_es3_k (temp, esloc, nbad)
    855    endif
    856  else
    857    if (present (dmrsdT)) then
    858      call lookup_es_des_k (temp, esloc, desat, nbad)
    859      desat = desat*hc_loc
    860    else
    861      call lookup_es_k (temp, esloc, nbad)
    862    endif
    863  endif
    864    esloc = esloc*hc_loc
    865    if (present (esat)) then
    866      esat = esloc
    867    endif
    868    if (nbad == 0) then
    869      if (present (mr) .and. use_exact_qs) then

Page 29          Source Listing                  COMPUTE_MRS_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    870        mrs = (eps + mr)*esloc/press
    871        if (present (dmrsdT)) then
    872          dmrsdT =  (eps + mr)*desat/press
    873        endif
    874      else ! (present (mr))
    875        denom = press - esloc
    876        do k=1,size(mrs,3)
    877          do j=1,size(mrs,2)
    878            do i=1,size(mrs,1)
    879              if (denom(i,j,k) > 0.0) then
    880                mrs(i,j,k) = eps*esloc(i,j,k)/denom(i,j,k)
    881              else
    882                mrs(i,j,k) = eps
    883              endif
    884            end do
    885          end do
    886        end do
    887        if (present (dmrsdT)) then
    888          dmrsdT = eps*press*desat/denom**2
    889        endif
    890      endif !(present (mr))
    891    else
    892      mrs = -999.
    893      if (present (dmrsdT)) then
    894        dmrsdT = -999.
    895      endif
    896      if (present (esat)) then
    897        esat = -999.
    898      endif
    899    endif
    900 
    901 
    902  end subroutine compute_mrs_k_3d

Page 30          Source Listing                  COMPUTE_MRS_K_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_compute_mrs_k_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS_K_3D           Subr   818                                           PRIV                                               
 DENOM                      Local  832      R(8)            8     3     0                         875,879,880,888                   
 DESAT                      Local  832      R(8)            8     3     0        TGT              844,845,851,852,858,859,872,888   
 DMRSDT                     Dummy  819      R(8)            8     3     1        ARG,OUT          843,850,857,871,872,887,888,893,89
                                                                                                  4                                 
 EPS                        Dummy  818      R(8)            8           scalar   ARG,IN           870,872,880,882,888               
 ESAT                       Dummy  819      R(8)            8     3     1        ARG,OUT          865,866,896,897                   
 ESLOC                      Local  832      R(8)            8     3     0        TGT              844,847,851,854,858,861,864,866,87
                                                                                                  0,875,880                         
 ES_OVER_LIQ                Dummy  819      L(4)            4           scalar   ARG,IN           842                               
 ES_OVER_LIQ_AND_ICE        Dummy  819      L(4)            4           scalar   ARG,IN           849                               
 HC                         Dummy  819      R(8)            8           scalar   ARG,IN           836,837                           
 HC_LOC                     Local  834      R(8)            8           scalar                    837,839,845,852,859,864           
 I                          Local  833      I(4)            4           scalar                    878,879,880,882                   
 J                          Local  833      I(4)            4           scalar                    877,879,880,882                   
 K                          Local  833      I(4)            4           scalar                    876,879,880,882                   
 MR                         Dummy  819      R(8)            8     3     1        ARG,IN           869,870,872                       
 MRS                        Dummy  818      R(8)            8     3     1        ARG,OUT          870,876,877,878,880,882,892       
 NBAD                       Dummy  818      I(4)            4           scalar   ARG,OUT          844,847,851,854,858,861,868       
 PRESENT                    Func   836                                  scalar                    836,842,843,849,850,857,865,869,87
                                                                                                  1,887,893,896                     
 PRESS                      Dummy  818      R(8)            8     3     1        ARG,IN           870,872,875,888                   
 SIZE                       Func   876                                  scalar                    876,877,878                       
 TEMP                       Dummy  818      R(8)            8     3     1        ARG,IN           844,847,851,854,858,861           
 ZVIR                       Dummy  818      R(8)            8           scalar   ARG,IN                                             

Page 31          Source Listing                  COMPUTE_MRS_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    903 
    904 !#######################################################################
    905 
    906  subroutine compute_mrs_k_2d (temp, press, eps, zvir, mrs, nbad,  &
    907                  mr, hc, dmrsdT, esat,es_over_liq, es_over_liq_and_ice)
    908 
    909  real, intent(in),  dimension(:,:)           :: temp, press
    910  real, intent(in)                            :: eps, zvir
    911  real, intent(out), dimension(:,:)           :: mrs
    912  integer, intent(out)                        :: nbad
    913  real, intent(in), dimension(:,:), optional  :: mr
    914  real, intent(in),                 optional :: hc
    915  real, intent(out), dimension(:,:), optional :: dmrsdT, esat
    916  logical,intent(in),               optional :: es_over_liq
    917  logical,intent(in),                  optional :: es_over_liq_and_ice
    918 
    919  real, dimension(size(temp,1), size(temp,2)) :: esloc, desat, denom
    920  integer :: i, j
    921  real    :: hc_loc
    922 
    923    if (present(hc)) then
    924      hc_loc = hc
    925    else
    926      hc_loc = 1.0
    927    endif
    928 
    929  if (present (es_over_liq)) then
    930    if (present (dmrsdT)) then
    931      call lookup_es2_des2_k (temp, esloc, desat, nbad)
    932      desat = desat*hc_loc
    933    else
    934      call lookup_es2_k (temp, esloc, nbad)
    935    endif
    936  else if (present(es_over_liq_and_ice)) then
    937    if (present (dmrsdT)) then
    938      call lookup_es3_des3_k (temp, esloc, desat, nbad)
    939      desat = desat*hc_loc
    940    else
    941      call lookup_es3_k (temp, esloc, nbad)
    942    endif
    943  else
    944    if (present (dmrsdT)) then
    945      call lookup_es_des_k (temp, esloc, desat, nbad)
    946      desat = desat*hc_loc
    947    else
    948      call lookup_es_k (temp, esloc, nbad)
    949    endif
    950  endif
    951    esloc = esloc*hc_loc
    952    if (present (esat)) then
    953      esat = esloc
    954    endif
    955    if (nbad == 0) then
    956      if (present (mr) .and. use_exact_qs) then
    957        mrs = (eps + mr)*esloc/press
    958        if (present (dmrsdT)) then
    959          dmrsdT = (eps + mr)*desat/press

Page 32          Source Listing                  COMPUTE_MRS_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    960        endif
    961      else ! (present (mr))
    962        denom = press - esloc
    963        do j=1,size(mrs,2)
    964          do i=1,size(mrs,1)
    965            if (denom(i,j) > 0.0) then
    966              mrs(i,j) = eps*esloc(i,j)/denom(i,j)
    967            else
    968              mrs(i,j) = eps
    969            endif
    970          end do
    971        end do
    972        if (present (dmrsdT)) then
    973          dmrsdT = eps*press*desat/denom**2
    974        endif
    975      endif !(present (mr))
    976    else
    977      mrs = -999.
    978      if (present (dmrsdT)) then
    979        dmrsdT = -999.
    980      endif
    981      if (present (esat)) then
    982        esat = -999.
    983      endif
    984    endif
    985 
    986 
    987  end subroutine compute_mrs_k_2d

Page 33          Source Listing                  COMPUTE_MRS_K_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_compute_mrs_k_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS_K_2D           Subr   906                                           PRIV                                               
 DENOM                      Local  919      R(8)            8     2     0                         962,965,966,973                   
 DESAT                      Local  919      R(8)            8     2     0        TGT              931,932,938,939,945,946,959,973   
 DMRSDT                     Dummy  907      R(8)            8     2     1        ARG,OUT          930,937,944,958,959,972,973,978,97
                                                                                                  9                                 
 EPS                        Dummy  906      R(8)            8           scalar   ARG,IN           957,959,966,968,973               
 ESAT                       Dummy  907      R(8)            8     2     1        ARG,OUT          952,953,981,982                   
 ESLOC                      Local  919      R(8)            8     2     0        TGT              931,934,938,941,945,948,951,953,95
                                                                                                  7,962,966                         
 ES_OVER_LIQ                Dummy  907      L(4)            4           scalar   ARG,IN           929                               
 ES_OVER_LIQ_AND_ICE        Dummy  907      L(4)            4           scalar   ARG,IN           936                               
 HC                         Dummy  907      R(8)            8           scalar   ARG,IN           923,924                           
 HC_LOC                     Local  921      R(8)            8           scalar                    924,926,932,939,946,951           
 I                          Local  920      I(4)            4           scalar                    964,965,966,968                   
 J                          Local  920      I(4)            4           scalar                    963,965,966,968                   
 MR                         Dummy  907      R(8)            8     2     1        ARG,IN           956,957,959                       
 MRS                        Dummy  906      R(8)            8     2     1        ARG,OUT          957,963,964,966,968,977           
 NBAD                       Dummy  906      I(4)            4           scalar   ARG,OUT          931,934,938,941,945,948,955       
 PRESENT                    Func   923                                  scalar                    923,929,930,936,937,944,952,956,95
                                                                                                  8,972,978,981                     
 PRESS                      Dummy  906      R(8)            8     2     1        ARG,IN           957,959,962,973                   
 SIZE                       Func   963                                  scalar                    963,964                           
 TEMP                       Dummy  906      R(8)            8     2     1        ARG,IN           931,934,938,941,945,948           
 ZVIR                       Dummy  906      R(8)            8           scalar   ARG,IN                                             

Page 34          Source Listing                  COMPUTE_MRS_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

    988 
    989 !#######################################################################
    990 
    991  subroutine compute_mrs_k_1d (temp, press, eps, zvir, mrs, nbad,  &
    992                  mr, hc, dmrsdT, esat,es_over_liq, es_over_liq_and_ice)
    993 
    994  real, intent(in),  dimension(:)           :: temp, press
    995  real, intent(in)                          :: eps, zvir
    996  real, intent(out), dimension(:)           :: mrs
    997  integer, intent(out)                      :: nbad
    998  real, intent(in),  dimension(:), optional :: mr
    999  real, intent(in),                optional :: hc
   1000  real, intent(out), dimension(:), optional :: dmrsdT, esat
   1001  logical,intent(in),              optional :: es_over_liq
   1002  logical,intent(in),                  optional :: es_over_liq_and_ice
   1003 
   1004  real, dimension(size(temp,1)) :: esloc, desat, denom
   1005  integer :: i
   1006  real    :: hc_loc
   1007 
   1008    if (present(hc)) then
   1009      hc_loc = hc
   1010    else
   1011      hc_loc = 1.0
   1012    endif
   1013 
   1014  if (present (es_over_liq)) then
   1015    if (present (dmrsdT)) then
   1016      call lookup_es2_des2_k (temp, esloc, desat, nbad)
   1017      desat = desat*hc_loc
   1018    else
   1019      call lookup_es2_k (temp, esloc, nbad)
   1020    endif
   1021  else if (present(es_over_liq_and_ice)) then
   1022    if (present (dmrsdT)) then
   1023      call lookup_es3_des3_k (temp, esloc, desat, nbad)
   1024      desat = desat*hc_loc
   1025    else
   1026      call lookup_es3_k (temp, esloc, nbad)
   1027    endif
   1028  else
   1029    if (present (dmrsdT)) then
   1030      call lookup_es_des_k (temp, esloc, desat, nbad)
   1031      desat = desat*hc_loc
   1032    else
   1033      call lookup_es_k (temp, esloc, nbad)
   1034    endif
   1035  endif
   1036    esloc = esloc*hc_loc
   1037    if (present (esat)) then
   1038      esat = esloc
   1039    endif
   1040    if (nbad == 0) then
   1041      if (present (mr) .and. use_exact_qs) then
   1042        mrs = (eps + mr)*esloc/press
   1043        if (present (dmrsdT)) then
   1044          dmrsdT =  (eps + mr)*desat/press

Page 35          Source Listing                  COMPUTE_MRS_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1045        endif
   1046      else ! (present (mr))
   1047        denom = press - esloc
   1048        do i=1,size(mrs,1)
   1049          if (denom(i) > 0.0) then
   1050            mrs(i) = eps*esloc(i)/denom(i)
   1051          else
   1052            mrs(i) = eps
   1053          endif
   1054        end do
   1055        if (present (dmrsdT)) then
   1056          dmrsdT = eps*press*desat/denom**2
   1057        endif
   1058      endif !(present (mr))
   1059    else
   1060      mrs = -999.
   1061      if (present (dmrsdT)) then
   1062        dmrsdT = -999.
   1063      endif
   1064      if (present (esat)) then
   1065        esat = -999.
   1066      endif
   1067    endif
   1068 
   1069 
   1070  end subroutine compute_mrs_k_1d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_compute_mrs_k_1d_             

Page 36          Source Listing                  COMPUTE_MRS_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS_K_1D           Subr   991                                           PRIV                                               
 DENOM                      Local  1004     R(8)            8     1     0                         1047,1049,1050,1056               
 DESAT                      Local  1004     R(8)            8     1     0        TGT              1016,1017,1023,1024,1030,1031,1044
                                                                                                  ,1056                             
 DMRSDT                     Dummy  992      R(8)            8     1     1        ARG,OUT          1015,1022,1029,1043,1044,1055,1056
                                                                                                  ,1061,1062                        
 EPS                        Dummy  991      R(8)            8           scalar   ARG,IN           1042,1044,1050,1052,1056          
 ESAT                       Dummy  992      R(8)            8     1     1        ARG,OUT          1037,1038,1064,1065               
 ESLOC                      Local  1004     R(8)            8     1     0        TGT              1016,1019,1023,1026,1030,1033,1036
                                                                                                  ,1038,1042,1047,1050              
 ES_OVER_LIQ                Dummy  992      L(4)            4           scalar   ARG,IN           1014                              
 ES_OVER_LIQ_AND_ICE        Dummy  992      L(4)            4           scalar   ARG,IN           1021                              
 HC                         Dummy  992      R(8)            8           scalar   ARG,IN           1008,1009                         
 HC_LOC                     Local  1006     R(8)            8           scalar                    1009,1011,1017,1024,1031,1036     
 I                          Local  1005     I(4)            4           scalar                    1048,1049,1050,1052               
 MR                         Dummy  992      R(8)            8     1     1        ARG,IN           1041,1042,1044                    
 MRS                        Dummy  991      R(8)            8     1     1        ARG,OUT          1042,1048,1050,1052,1060          
 NBAD                       Dummy  991      I(4)            4           scalar   ARG,OUT          1016,1019,1023,1026,1030,1033,1040
 PRESENT                    Func   1008                                 scalar                    1008,1014,1015,1021,1022,1029,1037
                                                                                                  ,1041,1043,1055,1061,1064         
 PRESS                      Dummy  991      R(8)            8     1     1        ARG,IN           1042,1044,1047,1056               
 SIZE                       Func   1048                                 scalar                    1048                              
 TEMP                       Dummy  991      R(8)            8     1     1        ARG,IN           1016,1019,1023,1026,1030,1033     
 ZVIR                       Dummy  991      R(8)            8           scalar   ARG,IN                                             

Page 37          Source Listing                  COMPUTE_MRS_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1071 
   1072 !#######################################################################
   1073 
   1074  subroutine compute_mrs_k_0d (temp, press, eps, zvir, mrs, nbad,   &
   1075                  mr, hc, dmrsdT, esat,es_over_liq, es_over_liq_and_ice)
   1076 
   1077  real, intent(in)                              :: temp, press
   1078  real, intent(in)                              :: eps, zvir
   1079  real, intent(out)                             :: mrs
   1080  integer, intent(out)                          :: nbad
   1081  real, intent(in),                    optional :: mr
   1082  real, intent(in),                    optional :: hc
   1083  real, intent(out),                   optional :: dmrsdT, esat
   1084  logical,intent(in),                  optional :: es_over_liq
   1085  logical,intent(in),                  optional :: es_over_liq_and_ice
   1086 
   1087  real    :: esloc, desat, denom
   1088  real    :: hc_loc
   1089 
   1090    if (present(hc)) then
   1091      hc_loc = hc
   1092    else
   1093      hc_loc = 1.0
   1094    endif
   1095 
   1096  if (present (es_over_liq)) then
   1097    if (present (dmrsdT)) then
   1098      call lookup_es2_des2_k (temp, esloc, desat, nbad)
   1099      desat = desat*hc_loc
   1100    else
   1101      call lookup_es2_k (temp, esloc, nbad)
   1102    endif
   1103  else if (present(es_over_liq_and_ice)) then
   1104    if (present (dmrsdT)) then
   1105      call lookup_es3_des3_k (temp, esloc, desat, nbad)
   1106      desat = desat*hc_loc
   1107    else
   1108      call lookup_es3_k (temp, esloc, nbad)
   1109    endif
   1110  else
   1111    if (present (dmrsdT)) then
   1112      call lookup_es_des_k (temp, esloc, desat, nbad)
   1113      desat = desat*hc_loc
   1114    else
   1115      call lookup_es_k (temp, esloc, nbad)
   1116    endif
   1117  endif
   1118    esloc = esloc*hc_loc
   1119    if (present (esat)) then
   1120      esat = esloc
   1121    endif
   1122    if (nbad == 0) then
   1123      if (present (mr) .and. use_exact_qs) then
   1124        mrs = (eps + mr)*esloc/press
   1125        if (present (dmrsdT)) then
   1126          dmrsdT = (eps + mr)*desat/press
   1127        endif

Page 38          Source Listing                  COMPUTE_MRS_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1128      else ! (present (mr))
   1129        denom = press - esloc
   1130        if (denom > 0.0) then
   1131          mrs = eps*esloc/denom
   1132        else
   1133          mrs = eps
   1134        endif
   1135        if (present (dmrsdT)) then
   1136          dmrsdT = eps*press*desat/denom**2
   1137        endif
   1138      endif !(present (mr))
   1139    else
   1140      mrs = -999.
   1141      if (present (dmrsdT)) then
   1142        dmrsdT = -999.
   1143      endif
   1144      if (present (esat)) then
   1145        esat = -999.
   1146      endif
   1147    endif
   1148 
   1149 
   1150  end subroutine compute_mrs_k_0d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_compute_mrs_k_0d_             

Page 39          Source Listing                  COMPUTE_MRS_K_0D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS_K_0D           Subr   1074                                          PRIV                                               
 DENOM                      Local  1087     R(8)            8           scalar                    1129,1130,1131,1136               
 DESAT                      Local  1087     R(8)            8           scalar                    1098,1099,1105,1106,1112,1113,1126
                                                                                                  ,1136                             
 DMRSDT                     Dummy  1075     R(8)            8           scalar   ARG,OUT          1097,1104,1111,1125,1126,1135,1136
                                                                                                  ,1141,1142                        
 EPS                        Dummy  1074     R(8)            8           scalar   ARG,IN           1124,1126,1131,1133,1136          
 ESAT                       Dummy  1075     R(8)            8           scalar   ARG,OUT          1119,1120,1144,1145               
 ESLOC                      Local  1087     R(8)            8           scalar                    1098,1101,1105,1108,1112,1115,1118
                                                                                                  ,1120,1124,1129,1131              
 ES_OVER_LIQ                Dummy  1075     L(4)            4           scalar   ARG,IN           1096                              
 ES_OVER_LIQ_AND_ICE        Dummy  1075     L(4)            4           scalar   ARG,IN           1103                              
 HC                         Dummy  1075     R(8)            8           scalar   ARG,IN           1090,1091                         
 HC_LOC                     Local  1088     R(8)            8           scalar                    1091,1093,1099,1106,1113,1118     
 MR                         Dummy  1075     R(8)            8           scalar   ARG,IN           1123,1124,1126                    
 MRS                        Dummy  1074     R(8)            8           scalar   ARG,OUT          1124,1131,1133,1140               
 NBAD                       Dummy  1074     I(4)            4           scalar   ARG,OUT          1098,1101,1105,1108,1112,1115,1122
 PRESENT                    Func   1090                                 scalar                    1090,1096,1097,1103,1104,1111,1119
                                                                                                  ,1123,1125,1135,1141,1144         
 PRESS                      Dummy  1074     R(8)            8           scalar   ARG,IN           1124,1126,1129,1136               
 TEMP                       Dummy  1074     R(8)            8           scalar   ARG,IN           1098,1101,1105,1108,1112,1115     
 ZVIR                       Dummy  1074     R(8)            8           scalar   ARG,IN                                             

Page 40          Source Listing                  COMPUTE_MRS_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1151 
   1152 
   1153 
   1154 !#######################################################################
   1155 
   1156  subroutine lookup_es_des_k_3d (temp, esat, desat, nbad)
   1157  real, intent(in),  dimension(:,:,:)  :: temp
   1158  real, intent(out), dimension(:,:,:)  :: esat, desat
   1159  integer, intent(out)                 :: nbad
   1160 
   1161  real    :: tmp, del
   1162  integer :: ind, i, j, k
   1163 
   1164    nbad = 0
   1165    do k = 1, size(temp,3)
   1166    do j = 1, size(temp,2)
   1167    do i = 1, size(temp,1)
   1168      tmp = temp(i,j,k)-tminl
   1169      ind = int(dtinvl*(tmp+tepsl))
   1170      if (ind < 0 .or. ind >= table_siz) then
   1171        nbad = nbad+1
   1172      else
   1173        del = tmp-dtres*real(ind)
   1174        esat(i,j,k) = TABLE(ind+1) +  &
   1175                      del*(DTABLE(ind+1) + del*D2TABLE(ind+1))
   1176        desat(i,j,k) = DTABLE(ind+1) + 2.*del*D2TABLE(ind+1)
   1177      endif
   1178    enddo
   1179    enddo
   1180    enddo
   1181 
   1182  end subroutine lookup_es_des_k_3d

Page 41          Source Listing                  LOOKUP_ES_DES_K_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                   
                                                         
 sat_vapor_pres_k_mod_mp_lookup_es_des_k_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1161     R(8)            8           scalar                    1173,1175,1176                    
 DESAT                      Dummy  1156     R(8)            8     3     1        ARG,OUT          1176                              
 ESAT                       Dummy  1156     R(8)            8     3     1        ARG,OUT          1174                              
 I                          Local  1162     I(4)            4           scalar                    1167,1168,1174,1176               
 IND                        Local  1162     I(4)            4           scalar                    1169,1170,1173,1174,1175,1176     
 INT                        Func   1169                                 scalar                    1169                              
 J                          Local  1162     I(4)            4           scalar                    1166,1168,1174,1176               
 K                          Local  1162     I(4)            4           scalar                    1165,1168,1174,1176               
 LOOKUP_ES_DES_K_3D         Subr   1156                                          PRIV             520,858                           
 NBAD                       Dummy  1156     I(4)            4           scalar   ARG,OUT          1164,1171                         
 REAL                       Func   1173                                 scalar                    1173                              
 SIZE                       Func   1165                                 scalar                    1165,1166,1167                    
 TEMP                       Dummy  1156     R(8)            8     3     1        ARG,IN           1165,1166,1167,1168               
 TMP                        Local  1161     R(8)            8           scalar                    1168,1169,1173                    

Page 42          Source Listing                  LOOKUP_ES_DES_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1183 
   1184 !#######################################################################
   1185 
   1186  subroutine lookup_es_des_k_2d (temp, esat, desat, nbad)
   1187  real, intent(in),  dimension(:,:)  :: temp
   1188  real, intent(out), dimension(:,:)  :: esat, desat
   1189  integer, intent(out)               :: nbad
   1190 
   1191  real    :: tmp, del
   1192  integer :: ind, i, j
   1193 
   1194    nbad = 0
   1195    do j = 1, size(temp,2)
   1196    do i = 1, size(temp,1)
   1197      tmp = temp(i,j)-tminl
   1198      ind = int(dtinvl*(tmp+tepsl))
   1199      if (ind < 0 .or. ind >= table_siz)  then
   1200        nbad = nbad+1
   1201      else
   1202        del = tmp-dtres*real(ind)
   1203        esat(i,j) = TABLE(ind+1) + &
   1204                    del*(DTABLE(ind+1) + del*D2TABLE(ind+1))
   1205        desat(i,j) = DTABLE(ind+1) + 2.*del*D2TABLE(ind+1)
   1206      endif
   1207    enddo
   1208    enddo
   1209 
   1210  end subroutine lookup_es_des_k_2d

Page 43          Source Listing                  LOOKUP_ES_DES_K_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                   
                                                         
 sat_vapor_pres_k_mod_mp_lookup_es_des_k_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1191     R(8)            8           scalar                    1202,1204,1205                    
 DESAT                      Dummy  1186     R(8)            8     2     1        ARG,OUT          1205                              
 ESAT                       Dummy  1186     R(8)            8     2     1        ARG,OUT          1203                              
 I                          Local  1192     I(4)            4           scalar                    1196,1197,1203,1205               
 IND                        Local  1192     I(4)            4           scalar                    1198,1199,1202,1203,1204,1205     
 INT                        Func   1198                                 scalar                    1198                              
 J                          Local  1192     I(4)            4           scalar                    1195,1197,1203,1205               
 LOOKUP_ES_DES_K_2D         Subr   1186                                          PRIV             607,945                           
 NBAD                       Dummy  1186     I(4)            4           scalar   ARG,OUT          1194,1200                         
 REAL                       Func   1202                                 scalar                    1202                              
 SIZE                       Func   1195                                 scalar                    1195,1196                         
 TEMP                       Dummy  1186     R(8)            8     2     1        ARG,IN           1195,1196,1197                    
 TMP                        Local  1191     R(8)            8           scalar                    1197,1198,1202                    

Page 44          Source Listing                  LOOKUP_ES_DES_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1211 
   1212 !#######################################################################
   1213 
   1214  subroutine lookup_es_des_k_1d (temp, esat, desat, nbad)
   1215  real, intent(in),  dimension(:)  :: temp
   1216  real, intent(out), dimension(:)  :: esat, desat
   1217  integer, intent(out)             :: nbad
   1218 
   1219  real    :: tmp, del
   1220  integer :: ind, i
   1221 
   1222    nbad = 0
   1223    do i = 1, size(temp,1)
   1224      tmp = temp(i)-tminl
   1225      ind = int(dtinvl*(tmp+tepsl))
   1226      if (ind < 0 .or. ind >= table_siz)  then
   1227        nbad = nbad+1
   1228      else
   1229        del = tmp-dtres*real(ind)
   1230        esat(i) = TABLE(ind+1) + &
   1231                    del*(DTABLE(ind+1) + del*D2TABLE(ind+1))
   1232        desat(i) = DTABLE(ind+1) + 2.*del*D2TABLE(ind+1)
   1233      endif
   1234    enddo
   1235 
   1236  end subroutine lookup_es_des_k_1d


ENTRY POINTS

  Name                                                   
                                                         
 sat_vapor_pres_k_mod_mp_lookup_es_des_k_1d_             

Page 45          Source Listing                  LOOKUP_ES_DES_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1219     R(8)            8           scalar                    1229,1231,1232                    
 DESAT                      Dummy  1214     R(8)            8     1     1        ARG,OUT          1232                              
 ESAT                       Dummy  1214     R(8)            8     1     1        ARG,OUT          1230                              
 I                          Local  1220     I(4)            4           scalar                    1223,1224,1230,1232               
 IND                        Local  1220     I(4)            4           scalar                    1225,1226,1229,1230,1231,1232     
 INT                        Func   1225                                 scalar                    1225                              
 LOOKUP_ES_DES_K_1D         Subr   1214                                          PRIV             692,1030                          
 NBAD                       Dummy  1214     I(4)            4           scalar   ARG,OUT          1222,1227                         
 REAL                       Func   1229                                 scalar                    1229                              
 SIZE                       Func   1223                                 scalar                    1223                              
 TEMP                       Dummy  1214     R(8)            8     1     1        ARG,IN           1223,1224                         
 TMP                        Local  1219     R(8)            8           scalar                    1224,1225,1229                    

Page 46          Source Listing                  LOOKUP_ES_DES_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1237 
   1238 !#######################################################################
   1239 
   1240  subroutine lookup_es_des_k_0d (temp, esat, desat, nbad)
   1241  real, intent(in)     :: temp
   1242  real, intent(out)    :: esat, desat
   1243  integer, intent(out) :: nbad
   1244 
   1245  real    :: tmp, del
   1246  integer :: ind
   1247 
   1248    nbad = 0
   1249    tmp = temp-tminl
   1250    ind = int(dtinvl*(tmp+tepsl))
   1251    if (ind < 0 .or. ind >= table_siz)  then
   1252      nbad = nbad+1
   1253    else
   1254      del = tmp-dtres*real(ind)
   1255      esat = TABLE(ind+1) + &
   1256             del*(DTABLE(ind+1) + del*D2TABLE(ind+1))
   1257      desat = DTABLE(ind+1) + 2.*del*D2TABLE(ind+1)
   1258    endif
   1259 
   1260  end subroutine lookup_es_des_k_0d


ENTRY POINTS

  Name                                                   
                                                         
 sat_vapor_pres_k_mod_mp_lookup_es_des_k_0d_             

Page 47          Source Listing                  LOOKUP_ES_DES_K_0D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1245     R(8)            8           scalar                    1254,1256,1257                    
 DESAT                      Dummy  1240     R(8)            8           scalar   ARG,OUT          1257                              
 ESAT                       Dummy  1240     R(8)            8           scalar   ARG,OUT          1255                              
 IND                        Local  1246     I(4)            4           scalar                    1250,1251,1254,1255,1256,1257     
 INT                        Func   1250                                 scalar                    1250                              
 LOOKUP_ES_DES_K_0D         Subr   1240                                          PRIV             774,1112                          
 NBAD                       Dummy  1240     I(4)            4           scalar   ARG,OUT          1248,1252                         
 REAL                       Func   1254                                 scalar                    1254                              
 TEMP                       Dummy  1240     R(8)            8           scalar   ARG,IN           1249                              
 TMP                        Local  1245     R(8)            8           scalar                    1249,1250,1254                    

Page 48          Source Listing                  LOOKUP_ES_DES_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1261 
   1262 !#######################################################################
   1263 
   1264  subroutine lookup_es_k_3d(temp, esat, nbad)
   1265  real, intent(in),  dimension(:,:,:)  :: temp
   1266  real, intent(out), dimension(:,:,:)  :: esat
   1267  integer, intent(out) :: nbad
   1268  real    :: tmp, del
   1269  integer :: ind, i, j, k
   1270 
   1271    nbad = 0
   1272    do k = 1, size(temp,3)
   1273    do j = 1, size(temp,2)
   1274    do i = 1, size(temp,1)
   1275      tmp = temp(i,j,k)-tminl
   1276      ind = int(dtinvl*(tmp+tepsl))
   1277      if (ind < 0 .or. ind >= table_siz)  then
   1278        nbad = nbad+1
   1279      else
   1280        del = tmp-dtres*real(ind)
   1281        esat(i,j,k) = TABLE(ind+1) + &
   1282                      del*(DTABLE(ind+1) + del*D2TABLE(ind+1))
   1283      endif
   1284    enddo
   1285    enddo
   1286    enddo
   1287 
   1288  end subroutine lookup_es_k_3d

Page 49          Source Listing                  LOOKUP_ES_K_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                               
                                                     
 sat_vapor_pres_k_mod_mp_lookup_es_k_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1268     R(8)            8           scalar                    1280,1282                         
 ESAT                       Dummy  1264     R(8)            8     3     1        ARG,OUT          1281                              
 I                          Local  1269     I(4)            4           scalar                    1274,1275,1281                    
 IND                        Local  1269     I(4)            4           scalar                    1276,1277,1280,1281,1282          
 INT                        Func   1276                                 scalar                    1276                              
 J                          Local  1269     I(4)            4           scalar                    1273,1275,1281                    
 K                          Local  1269     I(4)            4           scalar                    1272,1275,1281                    
 LOOKUP_ES_K_3D             Subr   1264                                          PRIV             523,861                           
 NBAD                       Dummy  1264     I(4)            4           scalar   ARG,OUT          1271,1278                         
 REAL                       Func   1280                                 scalar                    1280                              
 SIZE                       Func   1272                                 scalar                    1272,1273,1274                    
 TEMP                       Dummy  1264     R(8)            8     3     1        ARG,IN           1272,1273,1274,1275               
 TMP                        Local  1268     R(8)            8           scalar                    1275,1276,1280                    

Page 50          Source Listing                  LOOKUP_ES_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1289 
   1290 !#######################################################################
   1291 
   1292  subroutine lookup_des_k_3d(temp, desat, nbad)
   1293  real, intent(in),  dimension(:,:,:)  :: temp
   1294  real, intent(out), dimension(:,:,:)  :: desat
   1295  integer, intent(out) :: nbad
   1296  real    :: tmp, del
   1297  integer :: ind, i, j, k
   1298 
   1299    nbad = 0
   1300    do k = 1, size(temp,3)
   1301    do j = 1, size(temp,2)
   1302    do i = 1, size(temp,1)
   1303      tmp = temp(i,j,k)-tminl
   1304      ind = int(dtinvl*(tmp+tepsl))
   1305      if (ind < 0 .or. ind >= table_siz)  then
   1306        nbad = nbad+1
   1307      else
   1308        del = tmp-dtres*real(ind)
   1309        desat(i,j,k) = DTABLE(ind+1) + 2.*del*D2TABLE(ind+1)
   1310      endif
   1311    enddo
   1312    enddo
   1313    enddo
   1314 
   1315  end subroutine lookup_des_k_3d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_des_k_3d_             

Page 51          Source Listing                  LOOKUP_DES_K_3D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1296     R(8)            8           scalar                    1308,1309                         
 DESAT                      Dummy  1292     R(8)            8     3     1        ARG,OUT          1309                              
 I                          Local  1297     I(4)            4           scalar                    1302,1303,1309                    
 IND                        Local  1297     I(4)            4           scalar                    1304,1305,1308,1309               
 INT                        Func   1304                                 scalar                    1304                              
 J                          Local  1297     I(4)            4           scalar                    1301,1303,1309                    
 K                          Local  1297     I(4)            4           scalar                    1300,1303,1309                    
 LOOKUP_DES_K_3D            Subr   1292                                          PRIV                                               
 NBAD                       Dummy  1292     I(4)            4           scalar   ARG,OUT          1299,1306                         
 REAL                       Func   1308                                 scalar                    1308                              
 SIZE                       Func   1300                                 scalar                    1300,1301,1302                    
 TEMP                       Dummy  1292     R(8)            8     3     1        ARG,IN           1300,1301,1302,1303               
 TMP                        Local  1296     R(8)            8           scalar                    1303,1304,1308                    

Page 52          Source Listing                  LOOKUP_DES_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1316 
   1317 !#######################################################################
   1318  subroutine lookup_des_k_2d(temp, desat, nbad)
   1319  real, intent(in),  dimension(:,:)  :: temp
   1320  real, intent(out), dimension(:,:)  :: desat
   1321  integer, intent(out) :: nbad
   1322  real    :: tmp, del
   1323  integer :: ind, i, j
   1324 
   1325    nbad = 0
   1326    do j = 1, size(temp,2)
   1327    do i = 1, size(temp,1)
   1328      tmp = temp(i,j)-tminl
   1329      ind = int(dtinvl*(tmp+tepsl))
   1330      if (ind < 0 .or. ind >= table_siz)  then
   1331        nbad = nbad+1
   1332      else
   1333        del = tmp-dtres*real(ind)
   1334        desat(i,j) = DTABLE(ind+1) + 2.*del*D2TABLE(ind+1)
   1335      endif
   1336    enddo
   1337    enddo
   1338 
   1339  end subroutine lookup_des_k_2d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_des_k_2d_             

Page 53          Source Listing                  LOOKUP_DES_K_2D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1322     R(8)            8           scalar                    1333,1334                         
 DESAT                      Dummy  1318     R(8)            8     2     1        ARG,OUT          1334                              
 I                          Local  1323     I(4)            4           scalar                    1327,1328,1334                    
 IND                        Local  1323     I(4)            4           scalar                    1329,1330,1333,1334               
 INT                        Func   1329                                 scalar                    1329                              
 J                          Local  1323     I(4)            4           scalar                    1326,1328,1334                    
 LOOKUP_DES_K_2D            Subr   1318                                          PRIV                                               
 NBAD                       Dummy  1318     I(4)            4           scalar   ARG,OUT          1325,1331                         
 REAL                       Func   1333                                 scalar                    1333                              
 SIZE                       Func   1326                                 scalar                    1326,1327                         
 TEMP                       Dummy  1318     R(8)            8     2     1        ARG,IN           1326,1327,1328                    
 TMP                        Local  1322     R(8)            8           scalar                    1328,1329,1333                    

Page 54          Source Listing                  LOOKUP_DES_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1340 !#######################################################################
   1341  subroutine lookup_es_k_2d(temp, esat, nbad)
   1342  real, intent(in),  dimension(:,:)  :: temp
   1343  real, intent(out), dimension(:,:)  :: esat
   1344  integer, intent(out) :: nbad
   1345  real    :: tmp, del
   1346  integer :: ind, i, j
   1347 
   1348    nbad = 0
   1349    do j = 1, size(temp,2)
   1350    do i = 1, size(temp,1)
   1351      tmp = temp(i,j)-tminl
   1352      ind = int(dtinvl*(tmp+tepsl))
   1353      if (ind < 0 .or. ind >= table_siz)  then
   1354        nbad = nbad+1
   1355      else
   1356        del = tmp-dtres*real(ind)
   1357        esat(i,j) = TABLE(ind+1) + del*(DTABLE(ind+1) +   &
   1358                                                   del*D2TABLE(ind+1))
   1359      endif
   1360    enddo
   1361    enddo
   1362 
   1363  end subroutine lookup_es_k_2d


ENTRY POINTS

  Name                                               
                                                     
 sat_vapor_pres_k_mod_mp_lookup_es_k_2d_             

Page 55          Source Listing                  LOOKUP_ES_K_2D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1345     R(8)            8           scalar                    1356,1357,1358                    
 ESAT                       Dummy  1341     R(8)            8     2     1        ARG,OUT          1357                              
 I                          Local  1346     I(4)            4           scalar                    1350,1351,1357                    
 IND                        Local  1346     I(4)            4           scalar                    1352,1353,1356,1357,1358          
 INT                        Func   1352                                 scalar                    1352                              
 J                          Local  1346     I(4)            4           scalar                    1349,1351,1357                    
 LOOKUP_ES_K_2D             Subr   1341                                          PRIV             610,948                           
 NBAD                       Dummy  1341     I(4)            4           scalar   ARG,OUT          1348,1354                         
 REAL                       Func   1356                                 scalar                    1356                              
 SIZE                       Func   1349                                 scalar                    1349,1350                         
 TEMP                       Dummy  1341     R(8)            8     2     1        ARG,IN           1349,1350,1351                    
 TMP                        Local  1345     R(8)            8           scalar                    1351,1352,1356                    

Page 56          Source Listing                  LOOKUP_ES_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1364 !#######################################################################
   1365  subroutine lookup_des_k_1d(temp, desat, nbad)
   1366  real, intent(in),  dimension(:)  :: temp
   1367  real, intent(out), dimension(:)  :: desat
   1368  integer, intent(out) :: nbad
   1369  real    :: tmp, del
   1370  integer :: ind, i
   1371 
   1372    nbad = 0
   1373    do i = 1, size(temp,1)
   1374      tmp = temp(i)-tminl
   1375      ind = int(dtinvl*(tmp+tepsl))
   1376      if (ind < 0 .or. ind >= table_siz)  then
   1377        nbad = nbad+1
   1378      else
   1379        del = tmp-dtres*real(ind)
   1380        desat(i) = DTABLE(ind+1) + 2.*del*D2TABLE(ind+1)
   1381      endif
   1382    enddo
   1383 
   1384  end subroutine lookup_des_k_1d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_des_k_1d_             

Page 57          Source Listing                  LOOKUP_DES_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1369     R(8)            8           scalar                    1379,1380                         
 DESAT                      Dummy  1365     R(8)            8     1     1        ARG,OUT          1380                              
 I                          Local  1370     I(4)            4           scalar                    1373,1374,1380                    
 IND                        Local  1370     I(4)            4           scalar                    1375,1376,1379,1380               
 INT                        Func   1375                                 scalar                    1375                              
 LOOKUP_DES_K_1D            Subr   1365                                          PRIV                                               
 NBAD                       Dummy  1365     I(4)            4           scalar   ARG,OUT          1372,1377                         
 REAL                       Func   1379                                 scalar                    1379                              
 SIZE                       Func   1373                                 scalar                    1373                              
 TEMP                       Dummy  1365     R(8)            8     1     1        ARG,IN           1373,1374                         
 TMP                        Local  1369     R(8)            8           scalar                    1374,1375,1379                    

Page 58          Source Listing                  LOOKUP_DES_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1385 !#######################################################################
   1386  subroutine lookup_es_k_1d(temp, esat, nbad)
   1387  real, intent(in),  dimension(:)  :: temp
   1388  real, intent(out), dimension(:)  :: esat
   1389  integer, intent(out) :: nbad
   1390  real    :: tmp, del
   1391  integer :: ind, i
   1392 
   1393    nbad = 0
   1394    do i = 1, size(temp,1)
   1395      tmp = temp(i)-tminl
   1396      ind = int(dtinvl*(tmp+tepsl))
   1397      if (ind < 0 .or. ind >= table_siz)  then
   1398        nbad = nbad+1
   1399      else
   1400        del = tmp-dtres*real(ind)
   1401        esat(i) = TABLE(ind+1) + del*(DTABLE(ind+1) + del*D2TABLE(ind+1))
   1402      endif
   1403    enddo
   1404 
   1405  end subroutine lookup_es_k_1d


ENTRY POINTS

  Name                                               
                                                     
 sat_vapor_pres_k_mod_mp_lookup_es_k_1d_             

Page 59          Source Listing                  LOOKUP_ES_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1390     R(8)            8           scalar                    1400,1401                         
 ESAT                       Dummy  1386     R(8)            8     1     1        ARG,OUT          1401                              
 I                          Local  1391     I(4)            4           scalar                    1394,1395,1401                    
 IND                        Local  1391     I(4)            4           scalar                    1396,1397,1400,1401               
 INT                        Func   1396                                 scalar                    1396                              
 LOOKUP_ES_K_1D             Subr   1386                                          PRIV             695,1033                          
 NBAD                       Dummy  1386     I(4)            4           scalar   ARG,OUT          1393,1398                         
 REAL                       Func   1400                                 scalar                    1400                              
 SIZE                       Func   1394                                 scalar                    1394                              
 TEMP                       Dummy  1386     R(8)            8     1     1        ARG,IN           1394,1395                         
 TMP                        Local  1390     R(8)            8           scalar                    1395,1396,1400                    

Page 60          Source Listing                  LOOKUP_ES_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1406 !#######################################################################
   1407  subroutine lookup_des_k_0d(temp, desat, nbad)
   1408  real, intent(in)     :: temp
   1409  real, intent(out)    :: desat
   1410  integer, intent(out) :: nbad
   1411  real    :: tmp, del
   1412  integer :: ind
   1413 
   1414    nbad = 0
   1415    tmp = temp-tminl
   1416    ind = int(dtinvl*(tmp+tepsl))
   1417    if (ind < 0 .or. ind >= table_siz)  then
   1418      nbad = nbad+1
   1419    else
   1420      del = tmp-dtres*real(ind)
   1421      desat = DTABLE(ind+1) + 2.*del*D2TABLE(ind+1)
   1422    endif
   1423 
   1424  end subroutine lookup_des_k_0d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_des_k_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1411     R(8)            8           scalar                    1420,1421                         
 DESAT                      Dummy  1407     R(8)            8           scalar   ARG,OUT          1421                              
 IND                        Local  1412     I(4)            4           scalar                    1416,1417,1420,1421               
 INT                        Func   1416                                 scalar                    1416                              
 LOOKUP_DES_K_0D            Subr   1407                                          PRIV                                               
 NBAD                       Dummy  1407     I(4)            4           scalar   ARG,OUT          1414,1418                         
 REAL                       Func   1420                                 scalar                    1420                              
 TEMP                       Dummy  1407     R(8)            8           scalar   ARG,IN           1415                              
 TMP                        Local  1411     R(8)            8           scalar                    1415,1416,1420                    

Page 61          Source Listing                  LOOKUP_DES_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1425 !#######################################################################
   1426  subroutine lookup_es_k_0d(temp, esat, nbad)
   1427  real, intent(in)     :: temp
   1428  real, intent(out)    :: esat
   1429  integer, intent(out) :: nbad
   1430  real    :: tmp, del
   1431  integer :: ind
   1432 
   1433    nbad = 0
   1434    tmp = temp-tminl
   1435    ind = int(dtinvl*(tmp+tepsl))
   1436    if (ind < 0 .or. ind >= table_siz)  then
   1437      nbad = nbad+1
   1438    else
   1439      del = tmp-dtres*real(ind)
   1440      esat = TABLE(ind+1) + del*(DTABLE(ind+1) + del*D2TABLE(ind+1))
   1441    endif
   1442 
   1443  end subroutine lookup_es_k_0d


ENTRY POINTS

  Name                                               
                                                     
 sat_vapor_pres_k_mod_mp_lookup_es_k_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1430     R(8)            8           scalar                    1439,1440                         
 ESAT                       Dummy  1426     R(8)            8           scalar   ARG,OUT          1440                              
 IND                        Local  1431     I(4)            4           scalar                    1435,1436,1439,1440               
 INT                        Func   1435                                 scalar                    1435                              
 LOOKUP_ES_K_0D             Subr   1426                                          PRIV             777,1115                          
 NBAD                       Dummy  1426     I(4)            4           scalar   ARG,OUT          1433,1437                         
 REAL                       Func   1439                                 scalar                    1439                              
 TEMP                       Dummy  1426     R(8)            8           scalar   ARG,IN           1434                              
 TMP                        Local  1430     R(8)            8           scalar                    1434,1435,1439                    

Page 62          Source Listing                  LOOKUP_ES_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1444 !#######################################################################
   1445 
   1446  subroutine lookup_es2_des2_k_3d (temp, esat, desat, nbad)
   1447  real, intent(in),  dimension(:,:,:)  :: temp
   1448  real, intent(out), dimension(:,:,:)  :: esat, desat
   1449  integer, intent(out)                 :: nbad
   1450 
   1451  real    :: tmp, del
   1452  integer :: ind, i, j, k
   1453 
   1454    nbad = 0
   1455    do k = 1, size(temp,3)
   1456    do j = 1, size(temp,2)
   1457    do i = 1, size(temp,1)
   1458      tmp = temp(i,j,k)-tminl
   1459      ind = int(dtinvl*(tmp+tepsl))
   1460      if (ind < 0 .or. ind >= table_siz) then
   1461        nbad = nbad+1
   1462      else
   1463        del = tmp-dtres*real(ind)
   1464        esat(i,j,k) = TABLE2(ind+1) +  &
   1465                      del*(DTABLE2(ind+1) + del*D2TABLE2(ind+1))
   1466        desat(i,j,k) = DTABLE2(ind+1) + 2.*del*D2TABLE2(ind+1)
   1467      endif
   1468    enddo
   1469    enddo
   1470    enddo
   1471 
   1472  end subroutine lookup_es2_des2_k_3d

Page 63          Source Listing                  LOOKUP_ES2_DES2_K_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                     
                                                           
 sat_vapor_pres_k_mod_mp_lookup_es2_des2_k_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1451     R(8)            8           scalar                    1463,1465,1466                    
 DESAT                      Dummy  1446     R(8)            8     3     1        ARG,OUT          1466                              
 ESAT                       Dummy  1446     R(8)            8     3     1        ARG,OUT          1464                              
 I                          Local  1452     I(4)            4           scalar                    1457,1458,1464,1466               
 IND                        Local  1452     I(4)            4           scalar                    1459,1460,1463,1464,1465,1466     
 INT                        Func   1459                                 scalar                    1459                              
 J                          Local  1452     I(4)            4           scalar                    1456,1458,1464,1466               
 K                          Local  1452     I(4)            4           scalar                    1455,1458,1464,1466               
 LOOKUP_ES2_DES2_K_3D       Subr   1446                                          PRIV             506,844                           
 NBAD                       Dummy  1446     I(4)            4           scalar   ARG,OUT          1454,1461                         
 REAL                       Func   1463                                 scalar                    1463                              
 SIZE                       Func   1455                                 scalar                    1455,1456,1457                    
 TEMP                       Dummy  1446     R(8)            8     3     1        ARG,IN           1455,1456,1457,1458               
 TMP                        Local  1451     R(8)            8           scalar                    1458,1459,1463                    

Page 64          Source Listing                  LOOKUP_ES2_DES2_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1473 
   1474 !#######################################################################
   1475 
   1476  subroutine lookup_es2_des2_k_2d (temp, esat, desat, nbad)
   1477  real, intent(in),  dimension(:,:)  :: temp
   1478  real, intent(out), dimension(:,:)  :: esat, desat
   1479  integer, intent(out)               :: nbad
   1480 
   1481  real    :: tmp, del
   1482  integer :: ind, i, j
   1483 
   1484    nbad = 0
   1485    do j = 1, size(temp,2)
   1486    do i = 1, size(temp,1)
   1487      tmp = temp(i,j)-tminl
   1488      ind = int(dtinvl*(tmp+tepsl))
   1489      if (ind < 0 .or. ind >= table_siz)  then
   1490        nbad = nbad+1
   1491      else
   1492        del = tmp-dtres*real(ind)
   1493        esat(i,j) = TABLE2(ind+1) + &
   1494                    del*(DTABLE2(ind+1) + del*D2TABLE2(ind+1))
   1495        desat(i,j) = DTABLE2(ind+1) + 2.*del*D2TABLE2(ind+1)
   1496      endif
   1497    enddo
   1498    enddo
   1499 
   1500  end subroutine lookup_es2_des2_k_2d

Page 65          Source Listing                  LOOKUP_ES2_DES2_K_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                     
                                                           
 sat_vapor_pres_k_mod_mp_lookup_es2_des2_k_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1481     R(8)            8           scalar                    1492,1494,1495                    
 DESAT                      Dummy  1476     R(8)            8     2     1        ARG,OUT          1495                              
 ESAT                       Dummy  1476     R(8)            8     2     1        ARG,OUT          1493                              
 I                          Local  1482     I(4)            4           scalar                    1486,1487,1493,1495               
 IND                        Local  1482     I(4)            4           scalar                    1488,1489,1492,1493,1494,1495     
 INT                        Func   1488                                 scalar                    1488                              
 J                          Local  1482     I(4)            4           scalar                    1485,1487,1493,1495               
 LOOKUP_ES2_DES2_K_2D       Subr   1476                                          PRIV             593,931                           
 NBAD                       Dummy  1476     I(4)            4           scalar   ARG,OUT          1484,1490                         
 REAL                       Func   1492                                 scalar                    1492                              
 SIZE                       Func   1485                                 scalar                    1485,1486                         
 TEMP                       Dummy  1476     R(8)            8     2     1        ARG,IN           1485,1486,1487                    
 TMP                        Local  1481     R(8)            8           scalar                    1487,1488,1492                    

Page 66          Source Listing                  LOOKUP_ES2_DES2_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1501 
   1502 !#######################################################################
   1503 
   1504  subroutine lookup_es2_des2_k_1d (temp, esat, desat, nbad)
   1505  real, intent(in),  dimension(:)  :: temp
   1506  real, intent(out), dimension(:)  :: esat, desat
   1507  integer, intent(out)             :: nbad
   1508 
   1509  real    :: tmp, del
   1510  integer :: ind, i
   1511 
   1512    nbad = 0
   1513    do i = 1, size(temp,1)
   1514      tmp = temp(i)-tminl
   1515      ind = int(dtinvl*(tmp+tepsl))
   1516      if (ind < 0 .or. ind >= table_siz)  then
   1517        nbad = nbad+1
   1518      else
   1519        del = tmp-dtres*real(ind)
   1520        esat(i) = TABLE2(ind+1) + &
   1521                    del*(DTABLE2(ind+1) + del*D2TABLE2(ind+1))
   1522        desat(i) = DTABLE2(ind+1) + 2.*del*D2TABLE2(ind+1)
   1523      endif
   1524    enddo
   1525 
   1526  end subroutine lookup_es2_des2_k_1d


ENTRY POINTS

  Name                                                     
                                                           
 sat_vapor_pres_k_mod_mp_lookup_es2_des2_k_1d_             

Page 67          Source Listing                  LOOKUP_ES2_DES2_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1509     R(8)            8           scalar                    1519,1521,1522                    
 DESAT                      Dummy  1504     R(8)            8     1     1        ARG,OUT          1522                              
 ESAT                       Dummy  1504     R(8)            8     1     1        ARG,OUT          1520                              
 I                          Local  1510     I(4)            4           scalar                    1513,1514,1520,1522               
 IND                        Local  1510     I(4)            4           scalar                    1515,1516,1519,1520,1521,1522     
 INT                        Func   1515                                 scalar                    1515                              
 LOOKUP_ES2_DES2_K_1D       Subr   1504                                          PRIV             678,1016                          
 NBAD                       Dummy  1504     I(4)            4           scalar   ARG,OUT          1512,1517                         
 REAL                       Func   1519                                 scalar                    1519                              
 SIZE                       Func   1513                                 scalar                    1513                              
 TEMP                       Dummy  1504     R(8)            8     1     1        ARG,IN           1513,1514                         
 TMP                        Local  1509     R(8)            8           scalar                    1514,1515,1519                    

Page 68          Source Listing                  LOOKUP_ES2_DES2_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1527 
   1528 !#######################################################################
   1529 
   1530  subroutine lookup_es2_des2_k_0d (temp, esat, desat, nbad)
   1531  real, intent(in)     :: temp
   1532  real, intent(out)    :: esat, desat
   1533  integer, intent(out) :: nbad
   1534 
   1535  real    :: tmp, del
   1536  integer :: ind
   1537 
   1538    nbad = 0
   1539    tmp = temp-tminl
   1540    ind = int(dtinvl*(tmp+tepsl))
   1541    if (ind < 0 .or. ind >= table_siz)  then
   1542      nbad = nbad+1
   1543    else
   1544      del = tmp-dtres*real(ind)
   1545      esat = TABLE2(ind+1) + &
   1546             del*(DTABLE2(ind+1) + del*D2TABLE2(ind+1))
   1547      desat = DTABLE2(ind+1) + 2.*del*D2TABLE2(ind+1)
   1548    endif
   1549 
   1550  end subroutine lookup_es2_des2_k_0d


ENTRY POINTS

  Name                                                     
                                                           
 sat_vapor_pres_k_mod_mp_lookup_es2_des2_k_0d_             

Page 69          Source Listing                  LOOKUP_ES2_DES2_K_0D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1535     R(8)            8           scalar                    1544,1546,1547                    
 DESAT                      Dummy  1530     R(8)            8           scalar   ARG,OUT          1547                              
 ESAT                       Dummy  1530     R(8)            8           scalar   ARG,OUT          1545                              
 IND                        Local  1536     I(4)            4           scalar                    1540,1541,1544,1545,1546,1547     
 INT                        Func   1540                                 scalar                    1540                              
 LOOKUP_ES2_DES2_K_0D       Subr   1530                                          PRIV             760,1098                          
 NBAD                       Dummy  1530     I(4)            4           scalar   ARG,OUT          1538,1542                         
 REAL                       Func   1544                                 scalar                    1544                              
 TEMP                       Dummy  1530     R(8)            8           scalar   ARG,IN           1539                              
 TMP                        Local  1535     R(8)            8           scalar                    1539,1540,1544                    

Page 70          Source Listing                  LOOKUP_ES2_DES2_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1551 
   1552 !#######################################################################
   1553 
   1554  subroutine lookup_es2_k_3d(temp, esat, nbad)
   1555  real, intent(in),  dimension(:,:,:)  :: temp
   1556  real, intent(out), dimension(:,:,:)  :: esat
   1557  integer, intent(out) :: nbad
   1558  real    :: tmp, del
   1559  integer :: ind, i, j, k
   1560 
   1561    nbad = 0
   1562    do k = 1, size(temp,3)
   1563    do j = 1, size(temp,2)
   1564    do i = 1, size(temp,1)
   1565      tmp = temp(i,j,k)-tminl
   1566      ind = int(dtinvl*(tmp+tepsl))
   1567      if (ind < 0 .or. ind >= table_siz)  then
   1568        nbad = nbad+1
   1569      else
   1570        del = tmp-dtres*real(ind)
   1571        esat(i,j,k) = TABLE2(ind+1) + &
   1572                      del*(DTABLE2(ind+1) + del*D2TABLE2(ind+1))
   1573      endif
   1574    enddo
   1575    enddo
   1576    enddo
   1577 
   1578  end subroutine lookup_es2_k_3d

Page 71          Source Listing                  LOOKUP_ES2_K_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_es2_k_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1558     R(8)            8           scalar                    1570,1572                         
 ESAT                       Dummy  1554     R(8)            8     3     1        ARG,OUT          1571                              
 I                          Local  1559     I(4)            4           scalar                    1564,1565,1571                    
 IND                        Local  1559     I(4)            4           scalar                    1566,1567,1570,1571,1572          
 INT                        Func   1566                                 scalar                    1566                              
 J                          Local  1559     I(4)            4           scalar                    1563,1565,1571                    
 K                          Local  1559     I(4)            4           scalar                    1562,1565,1571                    
 LOOKUP_ES2_K_3D            Subr   1554                                          PRIV             509,847                           
 NBAD                       Dummy  1554     I(4)            4           scalar   ARG,OUT          1561,1568                         
 REAL                       Func   1570                                 scalar                    1570                              
 SIZE                       Func   1562                                 scalar                    1562,1563,1564                    
 TEMP                       Dummy  1554     R(8)            8     3     1        ARG,IN           1562,1563,1564,1565               
 TMP                        Local  1558     R(8)            8           scalar                    1565,1566,1570                    

Page 72          Source Listing                  LOOKUP_ES2_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1579 
   1580 !#######################################################################
   1581 
   1582  subroutine lookup_des2_k_3d(temp, desat, nbad)
   1583  real, intent(in),  dimension(:,:,:)  :: temp
   1584  real, intent(out), dimension(:,:,:)  :: desat
   1585  integer, intent(out) :: nbad
   1586  real    :: tmp, del
   1587  integer :: ind, i, j, k
   1588 
   1589    nbad = 0
   1590    do k = 1, size(temp,3)
   1591    do j = 1, size(temp,2)
   1592    do i = 1, size(temp,1)
   1593      tmp = temp(i,j,k)-tminl
   1594      ind = int(dtinvl*(tmp+tepsl))
   1595      if (ind < 0 .or. ind >= table_siz)  then
   1596        nbad = nbad+1
   1597      else
   1598        del = tmp-dtres*real(ind)
   1599        desat(i,j,k) = DTABLE2(ind+1) + 2.*del*D2TABLE2(ind+1)
   1600      endif
   1601    enddo
   1602    enddo
   1603    enddo
   1604 
   1605  end subroutine lookup_des2_k_3d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_lookup_des2_k_3d_             

Page 73          Source Listing                  LOOKUP_DES2_K_3D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1586     R(8)            8           scalar                    1598,1599                         
 DESAT                      Dummy  1582     R(8)            8     3     1        ARG,OUT          1599                              
 I                          Local  1587     I(4)            4           scalar                    1592,1593,1599                    
 IND                        Local  1587     I(4)            4           scalar                    1594,1595,1598,1599               
 INT                        Func   1594                                 scalar                    1594                              
 J                          Local  1587     I(4)            4           scalar                    1591,1593,1599                    
 K                          Local  1587     I(4)            4           scalar                    1590,1593,1599                    
 LOOKUP_DES2_K_3D           Subr   1582                                          PRIV                                               
 NBAD                       Dummy  1582     I(4)            4           scalar   ARG,OUT          1589,1596                         
 REAL                       Func   1598                                 scalar                    1598                              
 SIZE                       Func   1590                                 scalar                    1590,1591,1592                    
 TEMP                       Dummy  1582     R(8)            8     3     1        ARG,IN           1590,1591,1592,1593               
 TMP                        Local  1586     R(8)            8           scalar                    1593,1594,1598                    

Page 74          Source Listing                  LOOKUP_DES2_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1606 
   1607 !#######################################################################
   1608  subroutine lookup_des2_k_2d(temp, desat, nbad)
   1609  real, intent(in),  dimension(:,:)  :: temp
   1610  real, intent(out), dimension(:,:)  :: desat
   1611  integer, intent(out) :: nbad
   1612  real    :: tmp, del
   1613  integer :: ind, i, j
   1614 
   1615    nbad = 0
   1616    do j = 1, size(temp,2)
   1617    do i = 1, size(temp,1)
   1618      tmp = temp(i,j)-tminl
   1619      ind = int(dtinvl*(tmp+tepsl))
   1620      if (ind < 0 .or. ind >= table_siz)  then
   1621        nbad = nbad+1
   1622      else
   1623        del = tmp-dtres*real(ind)
   1624        desat(i,j) = DTABLE2(ind+1) + 2.*del*D2TABLE2(ind+1)
   1625      endif
   1626    enddo
   1627    enddo
   1628 
   1629  end subroutine lookup_des2_k_2d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_lookup_des2_k_2d_             

Page 75          Source Listing                  LOOKUP_DES2_K_2D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1612     R(8)            8           scalar                    1623,1624                         
 DESAT                      Dummy  1608     R(8)            8     2     1        ARG,OUT          1624                              
 I                          Local  1613     I(4)            4           scalar                    1617,1618,1624                    
 IND                        Local  1613     I(4)            4           scalar                    1619,1620,1623,1624               
 INT                        Func   1619                                 scalar                    1619                              
 J                          Local  1613     I(4)            4           scalar                    1616,1618,1624                    
 LOOKUP_DES2_K_2D           Subr   1608                                          PRIV                                               
 NBAD                       Dummy  1608     I(4)            4           scalar   ARG,OUT          1615,1621                         
 REAL                       Func   1623                                 scalar                    1623                              
 SIZE                       Func   1616                                 scalar                    1616,1617                         
 TEMP                       Dummy  1608     R(8)            8     2     1        ARG,IN           1616,1617,1618                    
 TMP                        Local  1612     R(8)            8           scalar                    1618,1619,1623                    

Page 76          Source Listing                  LOOKUP_DES2_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1630 !#######################################################################
   1631  subroutine lookup_es2_k_2d(temp, esat, nbad)
   1632  real, intent(in),  dimension(:,:)  :: temp
   1633  real, intent(out), dimension(:,:)  :: esat
   1634  integer, intent(out) :: nbad
   1635  real    :: tmp, del
   1636  integer :: ind, i, j
   1637 
   1638    nbad = 0
   1639    do j = 1, size(temp,2)
   1640    do i = 1, size(temp,1)
   1641      tmp = temp(i,j)-tminl
   1642      ind = int(dtinvl*(tmp+tepsl))
   1643      if (ind < 0 .or. ind >= table_siz)  then
   1644        nbad = nbad+1
   1645      else
   1646        del = tmp-dtres*real(ind)
   1647        esat(i,j) = TABLE2(ind+1) + del*(DTABLE2(ind+1) +   &
   1648                                                   del*D2TABLE2(ind+1))
   1649      endif
   1650    enddo
   1651    enddo
   1652 
   1653  end subroutine lookup_es2_k_2d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_es2_k_2d_             

Page 77          Source Listing                  LOOKUP_ES2_K_2D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1635     R(8)            8           scalar                    1646,1647,1648                    
 ESAT                       Dummy  1631     R(8)            8     2     1        ARG,OUT          1647                              
 I                          Local  1636     I(4)            4           scalar                    1640,1641,1647                    
 IND                        Local  1636     I(4)            4           scalar                    1642,1643,1646,1647,1648          
 INT                        Func   1642                                 scalar                    1642                              
 J                          Local  1636     I(4)            4           scalar                    1639,1641,1647                    
 LOOKUP_ES2_K_2D            Subr   1631                                          PRIV             596,934                           
 NBAD                       Dummy  1631     I(4)            4           scalar   ARG,OUT          1638,1644                         
 REAL                       Func   1646                                 scalar                    1646                              
 SIZE                       Func   1639                                 scalar                    1639,1640                         
 TEMP                       Dummy  1631     R(8)            8     2     1        ARG,IN           1639,1640,1641                    
 TMP                        Local  1635     R(8)            8           scalar                    1641,1642,1646                    

Page 78          Source Listing                  LOOKUP_ES2_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1654 !#######################################################################
   1655  subroutine lookup_des2_k_1d(temp, desat, nbad)
   1656  real, intent(in),  dimension(:)  :: temp
   1657  real, intent(out), dimension(:)  :: desat
   1658  integer, intent(out) :: nbad
   1659  real    :: tmp, del
   1660  integer :: ind, i
   1661 
   1662    nbad = 0
   1663    do i = 1, size(temp,1)
   1664      tmp = temp(i)-tminl
   1665      ind = int(dtinvl*(tmp+tepsl))
   1666      if (ind < 0 .or. ind >= table_siz)  then
   1667        nbad = nbad+1
   1668      else
   1669        del = tmp-dtres*real(ind)
   1670        desat(i) = DTABLE2(ind+1) + 2.*del*D2TABLE2(ind+1)
   1671      endif
   1672    enddo
   1673 
   1674  end subroutine lookup_des2_k_1d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_lookup_des2_k_1d_             

Page 79          Source Listing                  LOOKUP_DES2_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1659     R(8)            8           scalar                    1669,1670                         
 DESAT                      Dummy  1655     R(8)            8     1     1        ARG,OUT          1670                              
 I                          Local  1660     I(4)            4           scalar                    1663,1664,1670                    
 IND                        Local  1660     I(4)            4           scalar                    1665,1666,1669,1670               
 INT                        Func   1665                                 scalar                    1665                              
 LOOKUP_DES2_K_1D           Subr   1655                                          PRIV                                               
 NBAD                       Dummy  1655     I(4)            4           scalar   ARG,OUT          1662,1667                         
 REAL                       Func   1669                                 scalar                    1669                              
 SIZE                       Func   1663                                 scalar                    1663                              
 TEMP                       Dummy  1655     R(8)            8     1     1        ARG,IN           1663,1664                         
 TMP                        Local  1659     R(8)            8           scalar                    1664,1665,1669                    

Page 80          Source Listing                  LOOKUP_DES2_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1675 !#######################################################################
   1676  subroutine lookup_es2_k_1d(temp, esat, nbad)
   1677  real, intent(in),  dimension(:)  :: temp
   1678  real, intent(out), dimension(:)  :: esat
   1679  integer, intent(out) :: nbad
   1680  real    :: tmp, del
   1681  integer :: ind, i
   1682 
   1683    nbad = 0
   1684    do i = 1, size(temp,1)
   1685      tmp = temp(i)-tminl
   1686      ind = int(dtinvl*(tmp+tepsl))
   1687      if (ind < 0 .or. ind >= table_siz)  then
   1688        nbad = nbad+1
   1689      else
   1690        del = tmp-dtres*real(ind)
   1691        esat(i) = TABLE2(ind+1) + del*(DTABLE2(ind+1) + del*D2TABLE2(ind+1))
   1692      endif
   1693    enddo
   1694 
   1695  end subroutine lookup_es2_k_1d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_es2_k_1d_             

Page 81          Source Listing                  LOOKUP_ES2_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1680     R(8)            8           scalar                    1690,1691                         
 ESAT                       Dummy  1676     R(8)            8     1     1        ARG,OUT          1691                              
 I                          Local  1681     I(4)            4           scalar                    1684,1685,1691                    
 IND                        Local  1681     I(4)            4           scalar                    1686,1687,1690,1691               
 INT                        Func   1686                                 scalar                    1686                              
 LOOKUP_ES2_K_1D            Subr   1676                                          PRIV             681,1019                          
 NBAD                       Dummy  1676     I(4)            4           scalar   ARG,OUT          1683,1688                         
 REAL                       Func   1690                                 scalar                    1690                              
 SIZE                       Func   1684                                 scalar                    1684                              
 TEMP                       Dummy  1676     R(8)            8     1     1        ARG,IN           1684,1685                         
 TMP                        Local  1680     R(8)            8           scalar                    1685,1686,1690                    

Page 82          Source Listing                  LOOKUP_ES2_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1696 !#######################################################################
   1697  subroutine lookup_des2_k_0d(temp, desat, nbad)
   1698  real, intent(in)     :: temp
   1699  real, intent(out)    :: desat
   1700  integer, intent(out) :: nbad
   1701  real    :: tmp, del
   1702  integer :: ind
   1703 
   1704    nbad = 0
   1705    tmp = temp-tminl
   1706    ind = int(dtinvl*(tmp+tepsl))
   1707    if (ind < 0 .or. ind >= table_siz)  then
   1708      nbad = nbad+1
   1709    else
   1710      del = tmp-dtres*real(ind)
   1711      desat = DTABLE2(ind+1) + 2.*del*D2TABLE2(ind+1)
   1712    endif
   1713 
   1714  end subroutine lookup_des2_k_0d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_lookup_des2_k_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1701     R(8)            8           scalar                    1710,1711                         
 DESAT                      Dummy  1697     R(8)            8           scalar   ARG,OUT          1711                              
 IND                        Local  1702     I(4)            4           scalar                    1706,1707,1710,1711               
 INT                        Func   1706                                 scalar                    1706                              
 LOOKUP_DES2_K_0D           Subr   1697                                          PRIV                                               
 NBAD                       Dummy  1697     I(4)            4           scalar   ARG,OUT          1704,1708                         
 REAL                       Func   1710                                 scalar                    1710                              
 TEMP                       Dummy  1697     R(8)            8           scalar   ARG,IN           1705                              
 TMP                        Local  1701     R(8)            8           scalar                    1705,1706,1710                    

Page 83          Source Listing                  LOOKUP_DES2_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1715 !#######################################################################
   1716  subroutine lookup_es2_k_0d(temp, esat, nbad)
   1717  real, intent(in)     :: temp
   1718  real, intent(out)    :: esat
   1719  integer, intent(out) :: nbad
   1720  real    :: tmp, del
   1721  integer :: ind
   1722 
   1723    nbad = 0
   1724    tmp = temp-tminl
   1725    ind = int(dtinvl*(tmp+tepsl))
   1726    if (ind < 0 .or. ind >= table_siz)  then
   1727      nbad = nbad+1
   1728    else
   1729      del = tmp-dtres*real(ind)
   1730      esat = TABLE2(ind+1) + del*(DTABLE2(ind+1) + del*D2TABLE2(ind+1))
   1731    endif
   1732 
   1733  end subroutine lookup_es2_k_0d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_es2_k_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1720     R(8)            8           scalar                    1729,1730                         
 ESAT                       Dummy  1716     R(8)            8           scalar   ARG,OUT          1730                              
 IND                        Local  1721     I(4)            4           scalar                    1725,1726,1729,1730               
 INT                        Func   1725                                 scalar                    1725                              
 LOOKUP_ES2_K_0D            Subr   1716                                          PRIV             763,1101                          
 NBAD                       Dummy  1716     I(4)            4           scalar   ARG,OUT          1723,1727                         
 REAL                       Func   1729                                 scalar                    1729                              
 TEMP                       Dummy  1716     R(8)            8           scalar   ARG,IN           1724                              
 TMP                        Local  1720     R(8)            8           scalar                    1724,1725,1729                    

Page 84          Source Listing                  LOOKUP_ES2_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1734 !#######################################################################
   1735 
   1736 !#######################################################################
   1737 
   1738  subroutine lookup_es3_des3_k_3d (temp, esat, desat, nbad)
   1739  real, intent(in),  dimension(:,:,:)  :: temp
   1740  real, intent(out), dimension(:,:,:)  :: esat, desat
   1741  integer, intent(out)                 :: nbad
   1742 
   1743  real    :: tmp, del
   1744  integer :: ind, i, j, k
   1745 
   1746    nbad = 0
   1747    do k = 1, size(temp,3)
   1748    do j = 1, size(temp,2)
   1749    do i = 1, size(temp,1)
   1750      tmp = temp(i,j,k)-tminl
   1751      ind = int(dtinvl*(tmp+tepsl))
   1752      if (ind < 0 .or. ind >= table_siz) then
   1753        nbad = nbad+1
   1754      else
   1755        del = tmp-dtres*real(ind)
   1756        esat(i,j,k) = TABLE3(ind+1) +  &
   1757                      del*(DTABLE3(ind+1) + del*D2TABLE3(ind+1))
   1758        desat(i,j,k) = DTABLE3(ind+1) + 2.*del*D2TABLE3(ind+1)
   1759      endif
   1760    enddo
   1761    enddo
   1762    enddo
   1763 
   1764  end subroutine lookup_es3_des3_k_3d

Page 85          Source Listing                  LOOKUP_ES3_DES3_K_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                     
                                                           
 sat_vapor_pres_k_mod_mp_lookup_es3_des3_k_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1743     R(8)            8           scalar                    1755,1757,1758                    
 DESAT                      Dummy  1738     R(8)            8     3     1        ARG,OUT          1758                              
 ESAT                       Dummy  1738     R(8)            8     3     1        ARG,OUT          1756                              
 I                          Local  1744     I(4)            4           scalar                    1749,1750,1756,1758               
 IND                        Local  1744     I(4)            4           scalar                    1751,1752,1755,1756,1757,1758     
 INT                        Func   1751                                 scalar                    1751                              
 J                          Local  1744     I(4)            4           scalar                    1748,1750,1756,1758               
 K                          Local  1744     I(4)            4           scalar                    1747,1750,1756,1758               
 LOOKUP_ES3_DES3_K_3D       Subr   1738                                          PRIV             513,851                           
 NBAD                       Dummy  1738     I(4)            4           scalar   ARG,OUT          1746,1753                         
 REAL                       Func   1755                                 scalar                    1755                              
 SIZE                       Func   1747                                 scalar                    1747,1748,1749                    
 TEMP                       Dummy  1738     R(8)            8     3     1        ARG,IN           1747,1748,1749,1750               
 TMP                        Local  1743     R(8)            8           scalar                    1750,1751,1755                    

Page 86          Source Listing                  LOOKUP_ES3_DES3_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1765 
   1766 !#######################################################################
   1767 
   1768  subroutine lookup_es3_des3_k_2d (temp, esat, desat, nbad)
   1769  real, intent(in),  dimension(:,:)  :: temp
   1770  real, intent(out), dimension(:,:)  :: esat, desat
   1771  integer, intent(out)               :: nbad
   1772 
   1773  real    :: tmp, del
   1774  integer :: ind, i, j
   1775 
   1776    nbad = 0
   1777    do j = 1, size(temp,2)
   1778    do i = 1, size(temp,1)
   1779      tmp = temp(i,j)-tminl
   1780      ind = int(dtinvl*(tmp+tepsl))
   1781      if (ind < 0 .or. ind >= table_siz)  then
   1782        nbad = nbad+1
   1783      else
   1784        del = tmp-dtres*real(ind)
   1785        esat(i,j) = TABLE3(ind+1) + &
   1786                    del*(DTABLE3(ind+1) + del*D2TABLE3(ind+1))
   1787        desat(i,j) = DTABLE3(ind+1) + 2.*del*D2TABLE3(ind+1)
   1788      endif
   1789    enddo
   1790    enddo
   1791 
   1792  end subroutine lookup_es3_des3_k_2d

Page 87          Source Listing                  LOOKUP_ES3_DES3_K_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                     
                                                           
 sat_vapor_pres_k_mod_mp_lookup_es3_des3_k_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1773     R(8)            8           scalar                    1784,1786,1787                    
 DESAT                      Dummy  1768     R(8)            8     2     1        ARG,OUT          1787                              
 ESAT                       Dummy  1768     R(8)            8     2     1        ARG,OUT          1785                              
 I                          Local  1774     I(4)            4           scalar                    1778,1779,1785,1787               
 IND                        Local  1774     I(4)            4           scalar                    1780,1781,1784,1785,1786,1787     
 INT                        Func   1780                                 scalar                    1780                              
 J                          Local  1774     I(4)            4           scalar                    1777,1779,1785,1787               
 LOOKUP_ES3_DES3_K_2D       Subr   1768                                          PRIV             600,938                           
 NBAD                       Dummy  1768     I(4)            4           scalar   ARG,OUT          1776,1782                         
 REAL                       Func   1784                                 scalar                    1784                              
 SIZE                       Func   1777                                 scalar                    1777,1778                         
 TEMP                       Dummy  1768     R(8)            8     2     1        ARG,IN           1777,1778,1779                    
 TMP                        Local  1773     R(8)            8           scalar                    1779,1780,1784                    

Page 88          Source Listing                  LOOKUP_ES3_DES3_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1793 
   1794 !#######################################################################
   1795 
   1796  subroutine lookup_es3_des3_k_1d (temp, esat, desat, nbad)
   1797  real, intent(in),  dimension(:)  :: temp
   1798  real, intent(out), dimension(:)  :: esat, desat
   1799  integer, intent(out)             :: nbad
   1800 
   1801  real    :: tmp, del
   1802  integer :: ind, i
   1803 
   1804    nbad = 0
   1805    do i = 1, size(temp,1)
   1806      tmp = temp(i)-tminl
   1807      ind = int(dtinvl*(tmp+tepsl))
   1808      if (ind < 0 .or. ind >= table_siz)  then
   1809        nbad = nbad+1
   1810      else
   1811        del = tmp-dtres*real(ind)
   1812        esat(i) = TABLE3(ind+1) + &
   1813                    del*(DTABLE3(ind+1) + del*D2TABLE3(ind+1))
   1814        desat(i) = DTABLE3(ind+1) + 2.*del*D2TABLE3(ind+1)
   1815      endif
   1816    enddo
   1817 
   1818  end subroutine lookup_es3_des3_k_1d


ENTRY POINTS

  Name                                                     
                                                           
 sat_vapor_pres_k_mod_mp_lookup_es3_des3_k_1d_             

Page 89          Source Listing                  LOOKUP_ES3_DES3_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1801     R(8)            8           scalar                    1811,1813,1814                    
 DESAT                      Dummy  1796     R(8)            8     1     1        ARG,OUT          1814                              
 ESAT                       Dummy  1796     R(8)            8     1     1        ARG,OUT          1812                              
 I                          Local  1802     I(4)            4           scalar                    1805,1806,1812,1814               
 IND                        Local  1802     I(4)            4           scalar                    1807,1808,1811,1812,1813,1814     
 INT                        Func   1807                                 scalar                    1807                              
 LOOKUP_ES3_DES3_K_1D       Subr   1796                                          PRIV             685,1023                          
 NBAD                       Dummy  1796     I(4)            4           scalar   ARG,OUT          1804,1809                         
 REAL                       Func   1811                                 scalar                    1811                              
 SIZE                       Func   1805                                 scalar                    1805                              
 TEMP                       Dummy  1796     R(8)            8     1     1        ARG,IN           1805,1806                         
 TMP                        Local  1801     R(8)            8           scalar                    1806,1807,1811                    

Page 90          Source Listing                  LOOKUP_ES3_DES3_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1819 
   1820 !#######################################################################
   1821 
   1822  subroutine lookup_es3_des3_k_0d (temp, esat, desat, nbad)
   1823  real, intent(in)     :: temp
   1824  real, intent(out)    :: esat, desat
   1825  integer, intent(out) :: nbad
   1826 
   1827  real    :: tmp, del
   1828  integer :: ind
   1829 
   1830    nbad = 0
   1831    tmp = temp-tminl
   1832    ind = int(dtinvl*(tmp+tepsl))
   1833    if (ind < 0 .or. ind >= table_siz)  then
   1834      nbad = nbad+1
   1835    else
   1836      del = tmp-dtres*real(ind)
   1837      esat = TABLE3(ind+1) + &
   1838             del*(DTABLE3(ind+1) + del*D2TABLE3(ind+1))
   1839      desat = DTABLE3(ind+1) + 2.*del*D2TABLE3(ind+1)
   1840    endif
   1841 
   1842  end subroutine lookup_es3_des3_k_0d


ENTRY POINTS

  Name                                                     
                                                           
 sat_vapor_pres_k_mod_mp_lookup_es3_des3_k_0d_             

Page 91          Source Listing                  LOOKUP_ES3_DES3_K_0D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1827     R(8)            8           scalar                    1836,1838,1839                    
 DESAT                      Dummy  1822     R(8)            8           scalar   ARG,OUT          1839                              
 ESAT                       Dummy  1822     R(8)            8           scalar   ARG,OUT          1837                              
 IND                        Local  1828     I(4)            4           scalar                    1832,1833,1836,1837,1838,1839     
 INT                        Func   1832                                 scalar                    1832                              
 LOOKUP_ES3_DES3_K_0D       Subr   1822                                          PRIV             767,1105                          
 NBAD                       Dummy  1822     I(4)            4           scalar   ARG,OUT          1830,1834                         
 REAL                       Func   1836                                 scalar                    1836                              
 TEMP                       Dummy  1822     R(8)            8           scalar   ARG,IN           1831                              
 TMP                        Local  1827     R(8)            8           scalar                    1831,1832,1836                    

Page 92          Source Listing                  LOOKUP_ES3_DES3_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1843 
   1844 !#######################################################################
   1845 
   1846  subroutine lookup_es3_k_3d(temp, esat, nbad)
   1847  real, intent(in),  dimension(:,:,:)  :: temp
   1848  real, intent(out), dimension(:,:,:)  :: esat
   1849  integer, intent(out) :: nbad
   1850  real    :: tmp, del
   1851  integer :: ind, i, j, k
   1852 
   1853    nbad = 0
   1854    do k = 1, size(temp,3)
   1855    do j = 1, size(temp,2)
   1856    do i = 1, size(temp,1)
   1857      tmp = temp(i,j,k)-tminl
   1858      ind = int(dtinvl*(tmp+tepsl))
   1859      if (ind < 0 .or. ind >= table_siz)  then
   1860        nbad = nbad+1
   1861      else
   1862        del = tmp-dtres*real(ind)
   1863        esat(i,j,k) = TABLE3(ind+1) + &
   1864                      del*(DTABLE3(ind+1) + del*D2TABLE3(ind+1))
   1865      endif
   1866    enddo
   1867    enddo
   1868    enddo
   1869 
   1870  end subroutine lookup_es3_k_3d

Page 93          Source Listing                  LOOKUP_ES3_K_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres_k.F90



ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_es3_k_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1850     R(8)            8           scalar                    1862,1864                         
 ESAT                       Dummy  1846     R(8)            8     3     1        ARG,OUT          1863                              
 I                          Local  1851     I(4)            4           scalar                    1856,1857,1863                    
 IND                        Local  1851     I(4)            4           scalar                    1858,1859,1862,1863,1864          
 INT                        Func   1858                                 scalar                    1858                              
 J                          Local  1851     I(4)            4           scalar                    1855,1857,1863                    
 K                          Local  1851     I(4)            4           scalar                    1854,1857,1863                    
 LOOKUP_ES3_K_3D            Subr   1846                                          PRIV             516,854                           
 NBAD                       Dummy  1846     I(4)            4           scalar   ARG,OUT          1853,1860                         
 REAL                       Func   1862                                 scalar                    1862                              
 SIZE                       Func   1854                                 scalar                    1854,1855,1856                    
 TEMP                       Dummy  1846     R(8)            8     3     1        ARG,IN           1854,1855,1856,1857               
 TMP                        Local  1850     R(8)            8           scalar                    1857,1858,1862                    

Page 94          Source Listing                  LOOKUP_ES3_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1871 
   1872 !#######################################################################
   1873 
   1874  subroutine lookup_des3_k_3d(temp, desat, nbad)
   1875  real, intent(in),  dimension(:,:,:)  :: temp
   1876  real, intent(out), dimension(:,:,:)  :: desat
   1877  integer, intent(out) :: nbad
   1878  real    :: tmp, del
   1879  integer :: ind, i, j, k
   1880 
   1881    nbad = 0
   1882    do k = 1, size(temp,3)
   1883    do j = 1, size(temp,2)
   1884    do i = 1, size(temp,1)
   1885      tmp = temp(i,j,k)-tminl
   1886      ind = int(dtinvl*(tmp+tepsl))
   1887      if (ind < 0 .or. ind >= table_siz)  then
   1888        nbad = nbad+1
   1889      else
   1890        del = tmp-dtres*real(ind)
   1891        desat(i,j,k) = DTABLE3(ind+1) + 2.*del*D2TABLE3(ind+1)
   1892      endif
   1893    enddo
   1894    enddo
   1895    enddo
   1896 
   1897  end subroutine lookup_des3_k_3d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_lookup_des3_k_3d_             

Page 95          Source Listing                  LOOKUP_DES3_K_3D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1878     R(8)            8           scalar                    1890,1891                         
 DESAT                      Dummy  1874     R(8)            8     3     1        ARG,OUT          1891                              
 I                          Local  1879     I(4)            4           scalar                    1884,1885,1891                    
 IND                        Local  1879     I(4)            4           scalar                    1886,1887,1890,1891               
 INT                        Func   1886                                 scalar                    1886                              
 J                          Local  1879     I(4)            4           scalar                    1883,1885,1891                    
 K                          Local  1879     I(4)            4           scalar                    1882,1885,1891                    
 LOOKUP_DES3_K_3D           Subr   1874                                          PRIV                                               
 NBAD                       Dummy  1874     I(4)            4           scalar   ARG,OUT          1881,1888                         
 REAL                       Func   1890                                 scalar                    1890                              
 SIZE                       Func   1882                                 scalar                    1882,1883,1884                    
 TEMP                       Dummy  1874     R(8)            8     3     1        ARG,IN           1882,1883,1884,1885               
 TMP                        Local  1878     R(8)            8           scalar                    1885,1886,1890                    

Page 96          Source Listing                  LOOKUP_DES3_K_3D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1898 
   1899 !#######################################################################
   1900  subroutine lookup_des3_k_2d(temp, desat, nbad)
   1901  real, intent(in),  dimension(:,:)  :: temp
   1902  real, intent(out), dimension(:,:)  :: desat
   1903  integer, intent(out) :: nbad
   1904  real    :: tmp, del
   1905  integer :: ind, i, j
   1906 
   1907    nbad = 0
   1908    do j = 1, size(temp,2)
   1909    do i = 1, size(temp,1)
   1910      tmp = temp(i,j)-tminl
   1911      ind = int(dtinvl*(tmp+tepsl))
   1912      if (ind < 0 .or. ind >= table_siz)  then
   1913        nbad = nbad+1
   1914      else
   1915        del = tmp-dtres*real(ind)
   1916        desat(i,j) = DTABLE3(ind+1) + 2.*del*D2TABLE3(ind+1)
   1917      endif
   1918    enddo
   1919    enddo
   1920 
   1921  end subroutine lookup_des3_k_2d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_lookup_des3_k_2d_             

Page 97          Source Listing                  LOOKUP_DES3_K_2D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1904     R(8)            8           scalar                    1915,1916                         
 DESAT                      Dummy  1900     R(8)            8     2     1        ARG,OUT          1916                              
 I                          Local  1905     I(4)            4           scalar                    1909,1910,1916                    
 IND                        Local  1905     I(4)            4           scalar                    1911,1912,1915,1916               
 INT                        Func   1911                                 scalar                    1911                              
 J                          Local  1905     I(4)            4           scalar                    1908,1910,1916                    
 LOOKUP_DES3_K_2D           Subr   1900                                          PRIV                                               
 NBAD                       Dummy  1900     I(4)            4           scalar   ARG,OUT          1907,1913                         
 REAL                       Func   1915                                 scalar                    1915                              
 SIZE                       Func   1908                                 scalar                    1908,1909                         
 TEMP                       Dummy  1900     R(8)            8     2     1        ARG,IN           1908,1909,1910                    
 TMP                        Local  1904     R(8)            8           scalar                    1910,1911,1915                    

Page 98          Source Listing                  LOOKUP_DES3_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1922 !#######################################################################
   1923  subroutine lookup_es3_k_2d(temp, esat, nbad)
   1924  real, intent(in),  dimension(:,:)  :: temp
   1925  real, intent(out), dimension(:,:)  :: esat
   1926  integer, intent(out) :: nbad
   1927  real    :: tmp, del
   1928  integer :: ind, i, j
   1929 
   1930    nbad = 0
   1931    do j = 1, size(temp,2)
   1932    do i = 1, size(temp,1)
   1933      tmp = temp(i,j)-tminl
   1934      ind = int(dtinvl*(tmp+tepsl))
   1935      if (ind < 0 .or. ind >= table_siz)  then
   1936        nbad = nbad+1
   1937      else
   1938        del = tmp-dtres*real(ind)
   1939        esat(i,j) = TABLE3(ind+1) + del*(DTABLE3(ind+1) +   &
   1940                                                   del*D2TABLE3(ind+1))
   1941      endif
   1942    enddo
   1943    enddo
   1944 
   1945  end subroutine lookup_es3_k_2d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_es3_k_2d_             

Page 99          Source Listing                  LOOKUP_ES3_K_2D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1927     R(8)            8           scalar                    1938,1939,1940                    
 ESAT                       Dummy  1923     R(8)            8     2     1        ARG,OUT          1939                              
 I                          Local  1928     I(4)            4           scalar                    1932,1933,1939                    
 IND                        Local  1928     I(4)            4           scalar                    1934,1935,1938,1939,1940          
 INT                        Func   1934                                 scalar                    1934                              
 J                          Local  1928     I(4)            4           scalar                    1931,1933,1939                    
 LOOKUP_ES3_K_2D            Subr   1923                                          PRIV             603,941                           
 NBAD                       Dummy  1923     I(4)            4           scalar   ARG,OUT          1930,1936                         
 REAL                       Func   1938                                 scalar                    1938                              
 SIZE                       Func   1931                                 scalar                    1931,1932                         
 TEMP                       Dummy  1923     R(8)            8     2     1        ARG,IN           1931,1932,1933                    
 TMP                        Local  1927     R(8)            8           scalar                    1933,1934,1938                    

Page 100         Source Listing                  LOOKUP_ES3_K_2D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1946 !#######################################################################
   1947  subroutine lookup_des3_k_1d(temp, desat, nbad)
   1948  real, intent(in),  dimension(:)  :: temp
   1949  real, intent(out), dimension(:)  :: desat
   1950  integer, intent(out) :: nbad
   1951  real    :: tmp, del
   1952  integer :: ind, i
   1953 
   1954    nbad = 0
   1955    do i = 1, size(temp,1)
   1956      tmp = temp(i)-tminl
   1957      ind = int(dtinvl*(tmp+tepsl))
   1958      if (ind < 0 .or. ind >= table_siz)  then
   1959        nbad = nbad+1
   1960      else
   1961        del = tmp-dtres*real(ind)
   1962        desat(i) = DTABLE3(ind+1) + 2.*del*D2TABLE3(ind+1)
   1963      endif
   1964    enddo
   1965 
   1966  end subroutine lookup_des3_k_1d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_lookup_des3_k_1d_             

Page 101         Source Listing                  LOOKUP_DES3_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1951     R(8)            8           scalar                    1961,1962                         
 DESAT                      Dummy  1947     R(8)            8     1     1        ARG,OUT          1962                              
 I                          Local  1952     I(4)            4           scalar                    1955,1956,1962                    
 IND                        Local  1952     I(4)            4           scalar                    1957,1958,1961,1962               
 INT                        Func   1957                                 scalar                    1957                              
 LOOKUP_DES3_K_1D           Subr   1947                                          PRIV                                               
 NBAD                       Dummy  1947     I(4)            4           scalar   ARG,OUT          1954,1959                         
 REAL                       Func   1961                                 scalar                    1961                              
 SIZE                       Func   1955                                 scalar                    1955                              
 TEMP                       Dummy  1947     R(8)            8     1     1        ARG,IN           1955,1956                         
 TMP                        Local  1951     R(8)            8           scalar                    1956,1957,1961                    

Page 102         Source Listing                  LOOKUP_DES3_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1967 !#######################################################################
   1968  subroutine lookup_es3_k_1d(temp, esat, nbad)
   1969  real, intent(in),  dimension(:)  :: temp
   1970  real, intent(out), dimension(:)  :: esat
   1971  integer, intent(out) :: nbad
   1972  real    :: tmp, del
   1973  integer :: ind, i
   1974 
   1975    nbad = 0
   1976    do i = 1, size(temp,1)
   1977      tmp = temp(i)-tminl
   1978      ind = int(dtinvl*(tmp+tepsl))
   1979      if (ind < 0 .or. ind >= table_siz)  then
   1980        nbad = nbad+1
   1981      else
   1982        del = tmp-dtres*real(ind)
   1983        esat(i) = TABLE3(ind+1) + del*(DTABLE3(ind+1) + del*D2TABLE3(ind+1))
   1984      endif
   1985    enddo
   1986 
   1987  end subroutine lookup_es3_k_1d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_es3_k_1d_             

Page 103         Source Listing                  LOOKUP_ES3_K_1D
2021-06-01 08:56 Symbol Table                    sat_vapor_pres_k.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1972     R(8)            8           scalar                    1982,1983                         
 ESAT                       Dummy  1968     R(8)            8     1     1        ARG,OUT          1983                              
 I                          Local  1973     I(4)            4           scalar                    1976,1977,1983                    
 IND                        Local  1973     I(4)            4           scalar                    1978,1979,1982,1983               
 INT                        Func   1978                                 scalar                    1978                              
 LOOKUP_ES3_K_1D            Subr   1968                                          PRIV             688,1026                          
 NBAD                       Dummy  1968     I(4)            4           scalar   ARG,OUT          1975,1980                         
 REAL                       Func   1982                                 scalar                    1982                              
 SIZE                       Func   1976                                 scalar                    1976                              
 TEMP                       Dummy  1968     R(8)            8     1     1        ARG,IN           1976,1977                         
 TMP                        Local  1972     R(8)            8           scalar                    1977,1978,1982                    

Page 104         Source Listing                  LOOKUP_ES3_K_1D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   1988 !#######################################################################
   1989  subroutine lookup_des3_k_0d(temp, desat, nbad)
   1990  real, intent(in)     :: temp
   1991  real, intent(out)    :: desat
   1992  integer, intent(out) :: nbad
   1993  real    :: tmp, del
   1994  integer :: ind
   1995 
   1996    nbad = 0
   1997    tmp = temp-tminl
   1998    ind = int(dtinvl*(tmp+tepsl))
   1999    if (ind < 0 .or. ind >= table_siz)  then
   2000      nbad = nbad+1
   2001    else
   2002      del = tmp-dtres*real(ind)
   2003      desat = DTABLE3(ind+1) + 2.*del*D2TABLE3(ind+1)
   2004    endif
   2005 
   2006  end subroutine lookup_des3_k_0d


ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_k_mod_mp_lookup_des3_k_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  1993     R(8)            8           scalar                    2002,2003                         
 DESAT                      Dummy  1989     R(8)            8           scalar   ARG,OUT          2003                              
 IND                        Local  1994     I(4)            4           scalar                    1998,1999,2002,2003               
 INT                        Func   1998                                 scalar                    1998                              
 LOOKUP_DES3_K_0D           Subr   1989                                          PRIV                                               
 NBAD                       Dummy  1989     I(4)            4           scalar   ARG,OUT          1996,2000                         
 REAL                       Func   2002                                 scalar                    2002                              
 TEMP                       Dummy  1989     R(8)            8           scalar   ARG,IN           1997                              
 TMP                        Local  1993     R(8)            8           scalar                    1997,1998,2002                    

Page 105         Source Listing                  LOOKUP_DES3_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   2007 !#######################################################################
   2008  subroutine lookup_es3_k_0d(temp, esat, nbad)
   2009  real, intent(in)     :: temp
   2010  real, intent(out)    :: esat
   2011  integer, intent(out) :: nbad
   2012  real    :: tmp, del
   2013  integer :: ind
   2014 
   2015    nbad = 0
   2016    tmp = temp-tminl
   2017    ind = int(dtinvl*(tmp+tepsl))
   2018    if (ind < 0 .or. ind >= table_siz)  then
   2019      nbad = nbad+1
   2020    else
   2021      del = tmp-dtres*real(ind)
   2022      esat = TABLE3(ind+1) + del*(DTABLE3(ind+1) + del*D2TABLE3(ind+1))
   2023    endif
   2024 
   2025  end subroutine lookup_es3_k_0d


ENTRY POINTS

  Name                                                
                                                      
 sat_vapor_pres_k_mod_mp_lookup_es3_k_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEL                        Local  2012     R(8)            8           scalar                    2021,2022                         
 ESAT                       Dummy  2008     R(8)            8           scalar   ARG,OUT          2022                              
 IND                        Local  2013     I(4)            4           scalar                    2017,2018,2021,2022               
 INT                        Func   2017                                 scalar                    2017                              
 LOOKUP_ES3_K_0D            Subr   2008                                          PRIV             770,1108                          
 NBAD                       Dummy  2008     I(4)            4           scalar   ARG,OUT          2015,2019                         
 REAL                       Func   2021                                 scalar                    2021                              
 TEMP                       Dummy  2008     R(8)            8           scalar   ARG,IN           2016                              
 TMP                        Local  2012     R(8)            8           scalar                    2016,2017,2021                    

Page 106         Source Listing                  LOOKUP_ES3_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

   2026 !#######################################################################
   2027  end module sat_vapor_pres_k_mod


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS_K              Local  161                                  scalar                    89                                
 COMPUTE_QS_K               Local  154                                  scalar                    88                                
 LOOKUP_DES2_K              Local  119                                  scalar                    83                                
 LOOKUP_DES3_K              Local  140                                  scalar                    86                                
 LOOKUP_DES_K               Local  98                                   scalar                    80                                
 SAT_VAPOR_PRES_INIT_K      Subr   78                                                             78                                
 SAT_VAPOR_PRES_K_MOD       Module 21                                                                                               
 VERSION                    Param  74       CHAR            7           scalar                                                      

Page 107         Source Listing                  LOOKUP_ES3_K_0D
2021-06-01 08:56 Subprograms/Common Blocks       sat_vapor_pres_k.F90



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_ES_K               Func   355      R(8)            8     1     0                         271                               
 COMPUTE_ES_LIQ_ICE_K       Func   441      R(8)            8     1     0                         329                               
 COMPUTE_ES_LIQ_K           Func   409      R(8)            8     1     0                         300                               
 COMPUTE_MRS_K_0D           Subr   1074                                          PRIV                                               
 COMPUTE_MRS_K_1D           Subr   991                                           PRIV                                               
 COMPUTE_MRS_K_2D           Subr   906                                           PRIV                                               
 COMPUTE_MRS_K_3D           Subr   818                                           PRIV                                               
 COMPUTE_QS_K_0D            Subr   736                                           PRIV                                               
 COMPUTE_QS_K_1D            Subr   653                                           PRIV                                               
 COMPUTE_QS_K_2D            Subr   568                                           PRIV                                               
 COMPUTE_QS_K_3D            Subr   481                                           PRIV                                               
 LOOKUP_DES2_K_0D           Subr   1697                                          PRIV                                               
 LOOKUP_DES2_K_1D           Subr   1655                                          PRIV                                               
 LOOKUP_DES2_K_2D           Subr   1608                                          PRIV                                               
 LOOKUP_DES2_K_3D           Subr   1582                                          PRIV                                               
 LOOKUP_DES3_K_0D           Subr   1989                                          PRIV                                               
 LOOKUP_DES3_K_1D           Subr   1947                                          PRIV                                               
 LOOKUP_DES3_K_2D           Subr   1900                                          PRIV                                               
 LOOKUP_DES3_K_3D           Subr   1874                                          PRIV                                               
 LOOKUP_DES_K_0D            Subr   1407                                          PRIV                                               
 LOOKUP_DES_K_1D            Subr   1365                                          PRIV                                               
 LOOKUP_DES_K_2D            Subr   1318                                          PRIV                                               
 LOOKUP_DES_K_3D            Subr   1292                                          PRIV                                               
 LOOKUP_ES2_DES2_K_0D       Subr   1530                                          PRIV             760,1098                          
 LOOKUP_ES2_DES2_K_1D       Subr   1504                                          PRIV             678,1016                          
 LOOKUP_ES2_DES2_K_2D       Subr   1476                                          PRIV             593,931                           
 LOOKUP_ES2_DES2_K_3D       Subr   1446                                          PRIV             506,844                           
 LOOKUP_ES2_K_0D            Subr   1716                                          PRIV             763,1101                          
 LOOKUP_ES2_K_1D            Subr   1676                                          PRIV             681,1019                          
 LOOKUP_ES2_K_2D            Subr   1631                                          PRIV             596,934                           
 LOOKUP_ES2_K_3D            Subr   1554                                          PRIV             509,847                           
 LOOKUP_ES3_DES3_K_0D       Subr   1822                                          PRIV             767,1105                          
 LOOKUP_ES3_DES3_K_1D       Subr   1796                                          PRIV             685,1023                          
 LOOKUP_ES3_DES3_K_2D       Subr   1768                                          PRIV             600,938                           
 LOOKUP_ES3_DES3_K_3D       Subr   1738                                          PRIV             513,851                           
 LOOKUP_ES3_K_0D            Subr   2008                                          PRIV             770,1108                          
 LOOKUP_ES3_K_1D            Subr   1968                                          PRIV             688,1026                          
 LOOKUP_ES3_K_2D            Subr   1923                                          PRIV             603,941                           
 LOOKUP_ES3_K_3D            Subr   1846                                          PRIV             516,854                           
 LOOKUP_ES_DES_K_0D         Subr   1240                                          PRIV             774,1112                          
 LOOKUP_ES_DES_K_1D         Subr   1214                                          PRIV             692,1030                          
 LOOKUP_ES_DES_K_2D         Subr   1186                                          PRIV             607,945                           
 LOOKUP_ES_DES_K_3D         Subr   1156                                          PRIV             520,858                           
 LOOKUP_ES_K_0D             Subr   1426                                          PRIV             777,1115                          
 LOOKUP_ES_K_1D             Subr   1386                                          PRIV             695,1033                          
 LOOKUP_ES_K_2D             Subr   1341                                          PRIV             610,948                           
 LOOKUP_ES_K_3D             Subr   1264                                          PRIV             523,861                           
 SAT_VAPOR_PRES_INIT_K      Subr   185                                                                                              
 SAT_VAPOR_PRES_K_MOD       Module 21                                                                                               

COMPILER OPTIONS BEING USED

Page 108         Source Listing                  LOOKUP_ES3_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume cc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file
       -convert native                       -cross_reference
       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=0
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20191121       -D _OPENMP=201611
       -D __INTEL_OFFLOAD                    -D __MMX__
       -D __SSE__                            -D __SSE_MATH__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __pentium4                         -D __pentium4__
       -D __tune_pentium4__                  -D PACKAGE_NAME='"GFDL FMS Library"'
       -D PACKAGE_TARNAME='"FMS"'            -D PACKAGE_VERSION='"2021.02.0"'
       -D PACKAGE_STRING='"GFDL FMS Library 2021.02.0"'       -D PACKAGE_BUGREPORT='"gfdl.climate.model.info@noaa.gov"'
       -D PACKAGE_URL='"https://www.gfdl.noaa.gov/fms"'       -D PACKAGE='"FMS"'
       -D VERSION='"2021.02.0"'              -D STDC_HEADERS=1
       -D HAVE_SYS_TYPES_H=1                 -D HAVE_SYS_STAT_H=1

Page 109         Source Listing                  LOOKUP_ES3_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

       -D HAVE_STDLIB_H=1                    -D HAVE_STRING_H=1
       -D HAVE_MEMORY_H=1                    -D HAVE_STRINGS_H=1
       -D HAVE_INTTYPES_H=1                  -D HAVE_STDINT_H=1
       -D HAVE_UNISTD_H=1                    -D HAVE_DLFCN_H=1
       -D LT_OBJDIR='".libs/"'               -D HAVE_MPI_H=1
       -D HAVE_NETCDF_H=1                    -D HAVE_SCHED_GETAFFINITY=1
       -D HAVE_MOD_MPI=1                     -D HAVE_MOD_NETCDF=1
       -D HAVE_CRAY_POINTER=1                -D HAVE_QUAD_PRECISION=1
       -D HAVE_INTERNAL_NML=1                -D use_netCDF=1
       -D use_libMPI=1                       -D INTERNAL_FILE_NML
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
  no   -fpconstant                           -fpe3
       -fprm nearest                         -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -fp_modbits nofp_contract
       -fp_modbits nono_fp_contract          -fp_modbits nofenv_access
       -fp_modbits nono_fenv_access          -fp_modbits nocx_limited_range
       -fp_modbits nono_cx_limited_range       -fp_modbits noprec_div
       -fp_modbits nono_prec_div             -fp_modbits noprec_sqrt
       -fp_modbits nono_prec_sqrt            -fp_modbits ftz
       -fp_modbits nono_ftz                  -fp_modbits nointrin_limited_range
       -fp_modbits nono_intrin_limited_range       -fp_modbits notrunc_compares
       -fp_modbits nono_trunc_compares       -fp_modbits noieee_nan_compares
       -fp_modbits nono_ieee_nan_compares       -fp_modbits honor_f32_conversion
       -fp_modbits nono_honor_f32_conversion       -fp_modbits honor_f64_conversion
       -fp_modbits nono_honor_f64_conversion       -fp_modbits nono_x87_copy
       -fp_modbits nono_no_x87_copy          -fp_modbits noexception_semantics
       -fp_modbits nono_exception_semantics       -fp_modbits noprecise_libm_functions
       -fp_modbits nono_precise_libm_functions       -heap_arrays 0
  no   -threadprivate_compat                 -free
       -g2                                   -iface nomixed_str_len_arg
       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity
       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
       -module ../.mods                      -names lowercase
  no   -noinclude                       no   -o
       -offload-build=host                   -openmp
       -openmp-simd                          -openmp-offload
       -O0                              no   -pad_source
       -real_size 64                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms

Page 110         Source Listing                  LOOKUP_ES3_K_0D
2021-06-01 08:56                                 sat_vapor_pres_k.F90

       -w noall                              -w nonone
       -w noalignments                       -w nodeclarations
       -w noexternals                        -w nogeneral
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w nouncalled
       -w nouninitialized                    -w nounused
       -w nousage                       no   -wrap-margins

       -includepath : /opt/netcdf/4.6.1/INTEL/include/,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/,.f90,./.f90,./.f90,../include/.f90,
           ./.f90,/opt/netcdf/4.6.1/INTEL/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/ipp/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mkl/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/tbb/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/daal/include/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/intel64/.f90,/opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/icc/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/.f90,/usr/local/include/.f90,
           /usr/lib/gcc/x86_64-redhat-linux/4.8.5/include/.f90,/usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : sat_vapor_pres_k.lst
  no   -o

COMPILER: Intel(R) Fortran 19.1-1555
