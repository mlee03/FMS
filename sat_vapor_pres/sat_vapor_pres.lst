Page 1           Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 /tmp/iforti1iynm.i90

      1 # 1 "sat_vapor_pres.F90"
      2 !***********************************************************************
      3 !*                   GNU Lesser General Public License
      4 !*
      5 !* This file is part of the GFDL Flexible Modeling System (FMS).
      6 !*
      7 !* FMS is free software: you can redistribute it and/or modify it under
      8 !* the terms of the GNU Lesser General Public License as published by
      9 !* the Free Software Foundation, either version 3 of the License, or (at
     10 !* your option) any later version.
     11 !*
     12 !* FMS is distributed in the hope that it will be useful, but WITHOUT
     13 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
     14 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
     15 !* for more details.
     16 !*
     17 !* You should have received a copy of the GNU Lesser General Public
     18 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
     19 !***********************************************************************
     20 
     21 module sat_vapor_pres_mod
     22 
     23 !-----------------------------------------------------------------------
     24 !
     25 !                 saturation vapor pressure lookup
     26 !                 saturation vapor specific humidity calculation
     27 !                 saturation vapor mixing ratio calculation
     28 !
     29 !      routines for computing the saturation vapor pressure (es),
     30 !      the specific humidity (qs) and vapor mixing ratio (mrs) at
     31 !      a specified relative humidity, the derivatives of es, qs and mrs
     32 !      with respect to temperature, and initialization of the
     33 !      look-up table.
     34 !
     35 !-----------------------------------------------------------------------
     36 !
     37 !                               usage
     38 !                               -----
     39 !
     40 !              call lookup_es  (temp, es, err_msg)
     41 !
     42 !              call lookup_des (temp, des, err_msg)
     43 !
     44 !              call lookup_es_des (temp, es, des, err_msg)
     45 !
     46 !              call lookup_es2 (temp, es, err_msg)
     47 !
     48 !              call lookup_des2 (temp, des, err_msg)
     49 !
     50 !              call lookup_es2_des2 (temp, es, des, err_msg)
     51 !
     52 !              call compute_qs (temp, press, qs, q, hc, dqsdT, esat,
     53 !                               err_msg, es_over_liq)
     54 !
     55 !              call compute_mrs (temp, press, mrs, mr, hc, dmrsdT, esat,
     56 !                                err_msg, es_over_liq)
     57 !

Page 2           Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

     58 !    arguments
     59 !    ---------
     60 !      temp    intent in       temperature in degrees kelvin
     61 !      es      intent out      saturation vapor pressure in Pascals
     62 !      des     intent out      derivative of saturation vapor pressure
     63 !                              with respect to temperature
     64 !                              (Pascals/degree)
     65 !      press   intent in       atmospheric pressure in Pascals
     66 !      qs      intent out      specific humidity at relative humidity hc
     67 !                              (kg(vapor) / kg(moist air)
     68 !      mrs     intent out      mixing ratio at relative humidity hc
     69 !                              (kg(vapor) / kg(dry air)
     70 !
     71 !   optional arguments
     72 !   ------------------
     73 !      q       intent in       vapor specific humidity
     74 !                              (kg(vapor) / kg(moist air)
     75 !      hc      intent in       relative humidity at which output
     76 !                              fields are desired: default is 100 %
     77 !      dqsdT   intent out      derivative of saturation specific
     78 !                              humidity with respect to temperature
     79 !                              (kg(vapor) / kg(moist air) /degree)
     80 !      mr      intent in       vapor mixing ratio
     81 !                              (kg(vapor) / kg(dry air)
     82 !      dmrsdT  intent out      derivative of saturation mixing ratio
     83 !                              with respect to temperature
     84 !                              (kg(vapor) / kg(dry air) /degree)
     85 !      esat    intent out      saturation vapor pressure
     86 !                              (Pascals)
     87 !      err_msg intent out      character string to hold error message
     88 !      es_over_liq
     89 !              intent  in      use es table wrt liquid only
     90 !
     91 !-----------------------------------------------------------------------
     92 
     93 ! <CONTACT EMAIL="Bruce.Wyman@noaa.gov">
     94 !   Bruce Wyman
     95 ! </CONTACT>
     96 
     97 ! <HISTORY SRC="http://www.gfdl.noaa.gov/fms-cgi-bin/cvsweb.cgi/FMS/"/>
     98 
     99 ! <OVERVIEW>
    100 !   Routines for determining the saturation vapor pressure
    101 !   (<TT>ES</TT>), saturation vapor specific humidity and saturation
    102 !   vapor mixing ratio, and their derivatives with respect to
    103 !   temperature.
    104 ! </OVERVIEW>
    105 
    106 ! <DESCRIPTION>
    107 !   This module contains routines for determining the saturation vapor
    108 !   pressure (<TT>ES</TT>) from lookup tables constructed using equations given
    109 !   in the Smithsonian tables.  The <TT>ES</TT> lookup tables are valid between
    110 !   -160C and +100C (approx 113K to 373K).
    111 
    112 !   The values of <TT>ES</TT> are computed over ice from -160C to -20C,
    113 !   over water from 0C to 100C, and a blended value (over water and ice)
    114 !   from -20C to 0C.

Page 3           Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    115 
    116 !   Routines are also included to calculate the saturation specific
    117 !   humidity and saturation mixing ratio for vapor, and their deriv-
    118 !   atives with respect to temperature.  By default, the values returned
    119 !   are those at saturation; optionally, values of q and mr at a spec-
    120 !   ified relative humidity may instead be returned. Two forms are
    121 !   available; the approximate form that has been traditionally used in
    122 !   GCMs, and an exact form provided by SJ Lin in which saturation is
    123 !   reached while maintaining constant pressure and temperature.
    124 
    125 !   This version was written for non-vector machines.
    126 !   See the <LINK SRC="#NOTES">notes</LINK> section for details on vectorization.
    127 
    128 ! </DESCRIPTION>
    129 
    130 ! <PUBLIC>
    131 !   Description summarizing public interface.
    132 ! </PUBLIC>
    133 
    134  use         constants_mod, only:  TFREEZE, RDGAS, RVGAS, HLV, ES0
    135  use        fms_mod, only:  write_version_number, stdout, stdlog, mpp_pe, mpp_root_pe, &
    136                             mpp_error, FATAL, fms_error_handler,   &
    137                             error_mesg, check_nml_error
    138  use        mpp_mod, only: input_nml_file
    139  use  sat_vapor_pres_k_mod, only:  sat_vapor_pres_init_k, lookup_es_k, &
    140                                    lookup_des_k, lookup_es_des_k, &
    141                                    lookup_es2_k,  &
    142                                    lookup_des2_k, lookup_es2_des2_k, &
    143                                    lookup_es3_k,  &
    144                                    lookup_des3_k, lookup_es3_des3_k, &
    145                                    compute_qs_k, compute_mrs_k
    146 
    147 implicit none
    148 private
    149 
    150  public :: lookup_es, lookup_des, sat_vapor_pres_init
    151  public :: lookup_es2, lookup_des2, lookup_es2_des2
    152  public :: lookup_es3, lookup_des3, lookup_es3_des3
    153  public :: lookup_es_des, compute_qs, compute_mrs
    154 !public :: compute_es
    155  public :: escomp, descomp ! for backward compatibility
    156 ! use lookup_es, lookup_des instead
    157 
    158 !-----------------------------------------------------------------------
    159 
    160 ! <INTERFACE NAME="lookup_es">
    161 
    162 !   <OVERVIEW>
    163 !     For the given temperatures, returns the saturation vapor pressures.
    164 !   </OVERVIEW>
    165 !   <DESCRIPTION>
    166 !     For the given temperatures these routines return the
    167 !     saturation vapor pressure (esat). The return values are derived from
    168 !     lookup tables (see notes below).
    169 !   </DESCRIPTION>
    170 !   <TEMPLATE>
    171 !     call lookup_es( temp, esat, err_msg )

Page 4           Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    172 !   </TEMPLATE>
    173 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    174 !     Temperature in degrees Kelvin.
    175 !   </IN>
    176 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    177 !     Saturation vapor pressure in pascals.
    178 !             May be a scalar, 1d, 2d, or 3d array.
    179 !             Must have the same order and size as temp.
    180 !   </OUT>
    181 !   <OUT NAME="err_msg" UNITS="      " TYPE="character">
    182 !     Character string containing error message to be returned to
    183 !     calling routine.
    184 !   </OUT>
    185 !   <ERROR MSG="table overflow, nbad=##" STATUS="FATAL">
    186 !     Temperature(s) provided to the saturation vapor pressure lookup
    187 !          are outside the valid range of the lookup table (-160 to 100 deg C).
    188 !          This may be due to a numerical instability in the model.
    189 !          Information should have been printed to standard output to help
    190 !          determine where the instability may have occurred.
    191 !          If the lookup table needs a larger temperature range,
    192 !          then parameters in the module header must be modified.
    193 !   </ERROR> *
    194 
    195  interface lookup_es
    196    module procedure lookup_es_0d, lookup_es_1d, lookup_es_2d, lookup_es_3d
    197  end interface
    198 ! for backward compatibility (to be removed soon)
    199  interface escomp
    200    module procedure lookup_es_0d, lookup_es_1d, lookup_es_2d, lookup_es_3d
    201  end interface
    202 ! </INTERFACE>
    203 !-----------------------------------------------------------------------
    204 ! <INTERFACE NAME="lookup_des">
    205 
    206 !   <OVERVIEW>
    207 !     For the given temperatures, returns the derivative of saturation vapor pressure
    208 !     with respect to temperature.
    209 !   </OVERVIEW>
    210 !   <DESCRIPTION>
    211 !     For the given temperatures these routines return the derivative of esat w.r.t.
    212 !     temperature (desat). The return values are derived from
    213 !     lookup tables (see notes below).
    214 !   </DESCRIPTION>
    215 !   <TEMPLATE>
    216 !     call lookup_des( temp, desat )
    217 !   </TEMPLATE>
    218 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    219 !     Temperature in degrees Kelvin.
    220 !   </IN>
    221 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    222 !     Derivative of saturation vapor pressure w.r.t. temperature
    223 !                 in pascals/degree. May be a scalar, 1d, 2d, or 3d array.
    224 !                 Must have the same order and size as temp.
    225 !   </OUT>
    226 !   <OUT NAME="err_msg" UNITS="      " TYPE="character">
    227 !     Character string containing error message to be returned to
    228 !     calling routine.

Page 5           Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    229 !   </OUT>
    230 !   <ERROR MSG="table overflow, nbad=##" STATUS="FATAL">
    231 !     Temperature(s) provided to the saturation vapor pressure lookup
    232 !          are outside the valid range of the lookup table (-160 to 100 deg C).
    233 !          This may be due to a numerical instability in the model.
    234 !          Information should have been printed to standard output to help
    235 !          determine where the instability may have occurred.
    236 !          If the lookup table needs a larger temperature range,
    237 !          then parameters in the module header must be modified.
    238 !   </ERROR> *
    239 
    240  interface lookup_des
    241    module procedure lookup_des_0d, lookup_des_1d, lookup_des_2d, lookup_des_3d
    242  end interface
    243 ! </INTERFACE>
    244 ! for backward compatibility (to be removed soon)
    245  interface descomp
    246    module procedure lookup_des_0d, lookup_des_1d, lookup_des_2d, lookup_des_3d
    247  end interface
    248 
    249 !-----------------------------------------------------------------------
    250 
    251 ! <INTERFACE NAME="lookup_es_des">
    252 
    253 !   <OVERVIEW>
    254 !     For the given temperatures, returns the saturation vapor pressure
    255 !     and the derivative of saturation vapor pressure with respect to
    256 !     temperature.
    257 !   </OVERVIEW>
    258 !   <DESCRIPTION>
    259 !     For the given temperatures these routines return the
    260 !     saturation vapor pressure (esat) and the derivative of esat w.r.t
    261 !     temperature (desat). The return values are derived from
    262 !     lookup tables (see notes below).
    263 !   </DESCRIPTION>
    264 !   <TEMPLATE>
    265 !     call lookup_es_des( temp, esat, desat, err_msg )
    266 !   </TEMPLATE>
    267 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    268 !     Temperature in degrees Kelvin.
    269 !   </IN>
    270 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    271 !     Saturation vapor pressure in pascals.
    272 !             May be a scalar, 1d, 2d, or 3d array.
    273 !             Must have the same order and size as temp.
    274 !   </OUT>
    275 !   <OUT NAME="desat" UNITS="pascal/ degree" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    276 !     Derivative of saturation vapor pressure w.r.t. temperature
    277 !                 in pascals/degree. May be a scalar, 1d, 2d, or 3d array.
    278 !                 Must have the same order and size as temp.
    279 !   </OUT>
    280 !   <OUT NAME="err_msg" UNITS="      " TYPE="character">
    281 !     Character string containing error message to be returned to
    282 !     calling routine.
    283 !   </OUT>
    284 !   <ERROR MSG="table overflow, nbad=##" STATUS="FATAL">
    285 !     Temperature(s) provided to the saturation vapor pressure lookup

Page 6           Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    286 !          are outside the valid range of the lookup table (-160 to 100 deg C).
    287 !          This may be due to a numerical instability in the model.
    288 !          Information should have been printed to standard output to help
    289 !          determine where the instability may have occurred.
    290 !          If the lookup table needs a larger temperature range,
    291 !          then parameters in the module header must be modified.
    292 !   </ERROR> *
    293 
    294  interface lookup_es_des
    295    module procedure lookup_es_des_0d, lookup_es_des_1d, lookup_es_des_2d, lookup_es_des_3d
    296  end interface
    297 
    298  interface lookup_es2
    299    module procedure lookup_es2_0d, lookup_es2_1d, lookup_es2_2d, lookup_es2_3d
    300  end interface
    301 
    302  interface lookup_des2
    303    module procedure lookup_des2_0d, lookup_des2_1d, lookup_des2_2d, lookup_des2_3d
    304  end interface
    305 
    306  interface lookup_es2_des2
    307    module procedure lookup_es2_des2_0d, lookup_es2_des2_1d, lookup_es2_des2_2d, lookup_es2_des2_3d
    308  end interface
    309 
    310 
    311  interface lookup_es3
    312    module procedure lookup_es3_0d, lookup_es3_1d, lookup_es3_2d, lookup_es3_3d
    313  end interface
    314 
    315  interface lookup_des3
    316    module procedure lookup_des3_0d, lookup_des3_1d, lookup_des3_2d, lookup_des3_3d
    317  end interface
    318 
    319  interface lookup_es3_des3
    320    module procedure lookup_es3_des3_0d, lookup_es3_des3_1d, lookup_es3_des3_2d, lookup_es3_des3_3d
    321  end interface
    322 
    323 !-----------------------------------------------------------------------
    324 
    325 ! <INTERFACE NAME="compute_qs">
    326 
    327 !   <OVERVIEW>
    328 !     For the given temperatures, pressures and optionally vapor
    329 !     specific humidity, returns the specific humidity at saturation
    330 !     (optionally at relative humidity hc instead of at saturation) and
    331 !     optionally the derivative of saturation specific humidity w.r.t.
    332 !     temperature, and the saturation vapor pressure.
    333 !   </OVERVIEW>
    334 !   <DESCRIPTION>
    335 !     For the input temperature and pressure these routines return the
    336 !     specific humidity (qsat) at saturation (unless optional argument
    337 !     hc is used to specify the relative humidity at which qsat should
    338 !     apply) and, if desired, the derivative of qsat w.r.t temperature
    339 !     (dqsdT) and / or the saturation vapor pressure (esat). If the
    340 !     optional input argument specific humidity (q) is present, the
    341 !     exact expression for qs is used; if q is not present the tradit-
    342 !     ional form (valid at saturation) is used. if the optional qsat

Page 7           Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    343 !     derivative argument is present, the derivative of qsat w.r.t.
    344 !     temperature will also be returned, defined consistent with the
    345 !     expression used for qsat. The return values are derived from
    346 !     lookup tables (see notes below).
    347 !   </DESCRIPTION>
    348 !   <TEMPLATE>
    349 !     call compute_qs( temp, press, qsat, q, hc, dqsdT, esat, err_msg )
    350 !   </TEMPLATE>
    351 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    352 !     Temperature in degrees Kelvin.
    353 !   </IN>
    354 !   <IN NAME="press" UNIT="Pascals" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    355 !     Air pressure in Pascals.
    356 !   </IN>
    357 !   <OUT NAME="qsat" UNITS="kg(vapor) / kg(moist air)" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    358 !     Specific humidity in kg (vapor) / kg (moist air)
    359 !             May be a scalar, 1d, 2d, or 3d array.
    360 !             Must have the same order and size as temp.
    361 !   </OUT>
    362 !   <IN NAME="q" UNIT="kg(vapor) / kg (moist air)" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    363 !     Vapor specific humidity in kg (vapor) / kg (moist air).
    364 !     If present, exact formulation for qsat and dqsdT will be used.
    365 !   </IN>
    366 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)">
    367 !     Relative humidity at which output variables are desired.
    368 !     If not present, values will apply at saturation.
    369 !   </IN>
    370 !   <OUT NAME="dqsdT" UNITS="kg(vapor) / kg(moist air) / degree" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    371 !     Derivative of saturation specific humidity w.r.t. temperature
    372 !                 in kg(vapor) / kg(moist air) / degree. May be a
    373 !                 scalar, 1d, 2d, or 3d array.
    374 !                 Must have the same order and size as temp.
    375 !   </OUT>
    376 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    377 !     Saturation vapor pressure. May be a scalar, 1d, 2d, or 3d array.
    378 !                 Must have the same order and size as temp.
    379 !   </OUT>
    380 !   <OUT NAME="err_msg" UNITS="      " TYPE="character">
    381 !     Character string containing error message to be returned to
    382 !     calling routine.
    383 !   </OUT>
    384 !   <ERROR MSG="table overflow, nbad=##" STATUS="FATAL">
    385 !     Temperature(s) provided to the saturation vapor pressure lookup
    386 !          are outside the valid range of the lookup table (-160 to 100 deg C).
    387 !          This may be due to a numerical instability in the model.
    388 !          Information should have been printed to standard output to help
    389 !          determine where the instability may have occurred.
    390 !          If the lookup table needs a larger temperature range,
    391 !          then parameters in the module header must be modified.
    392 !   </ERROR> *
    393 
    394  interface compute_qs
    395    module procedure compute_qs_0d, compute_qs_1d, compute_qs_2d, compute_qs_3d
    396  end interface
    397 
    398 !-----------------------------------------------------------------------
    399 

Page 8           Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    400 ! <INTERFACE NAME="compute_mrs">
    401 
    402 !   <OVERVIEW>
    403 !     For the given temperatures, pressures and optionally vapor
    404 !     mixing ratio, returns the  vapor mixing ratio at saturation
    405 !     (optionally at relative humidity hc instead of at saturation) and
    406 !     optionally the derivative of saturation vapor mixing ratio w.r.t.
    407 !     temperature, and the saturation vapor pressure.
    408 !   </OVERVIEW>
    409 !   <DESCRIPTION>
    410 !     For the input temperature and pressure these routines return the
    411 !     vapor mixing ratio (mrsat) at saturation (unless optional argument
    412 !     hc is used to specify the relative humidity at which mrsat should
    413 !     apply) and, if desired, the derivative of mrsat w.r.t temperature
    414 !     (dmrsdT) and / or the saturation vapor pressure (esat). If the
    415 !     optional input argument specific humidity (mr) is present, the
    416 !     exact expression for mrs is used; if qr is not present the tradit-
    417 !     ional form (valid at saturation) is used. if the optional mrsat
    418 !     derivative argument is present, the derivative of mrsat w.r.t.
    419 !     temperature will also be returned, defined consistent with the
    420 !     expression used for mrsat. The return values are derived from
    421 !     lookup tables (see notes below).
    422 !   </DESCRIPTION>
    423 !   <TEMPLATE>
    424 !     call compute_mrs( temp, press, mrsat, mr, hc, dmrsdT, esat,
    425 !                       err_msg )
    426 !   </TEMPLATE>
    427 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    428 !     Temperature in degrees Kelvin.
    429 !   </IN>
    430 !   <IN NAME="press" UNIT="Pascals" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    431 !     Air pressure in Pascals.
    432 !   </IN>
    433 !   <OUT NAME="mrsat" UNITS="kg(vapor) / kg (dry air)" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    434 !     Vapor mixing ratio in kg (vapor) / kg (dry air)
    435 !             May be a scalar, 1d, 2d, or 3d array.
    436 !             Must have the same order and size as temp.
    437 !   </OUT>
    438 !   <IN NAME="mr" UNIT="kg(vapor) / kg (dry air)" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    439 !     Vapor mixing ratio in kg (vapor) / kg (dry air).
    440 !     If present, exact formulation for mrsat and dmrsdT will be used.
    441 !   </IN>
    442 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)">
    443 !     Relative humidity at which output variables are desired.
    444 !     If not present, values will apply at saturation.
    445 !   </IN>
    446 !   <OUT NAME="dmrsdT" UNITS="kg(vapor) / kg(dry air) / degree" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    447 !     Derivative of saturation vapor mixing ratio w.r.t. temperature
    448 !                 in kg(vapor) / kg(dry air) / degree. May be a
    449 !                 scalar, 1d, 2d, or 3d array.
    450 !                 Must have the same order and size as temp.
    451 !   </OUT>
    452 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    453 !     Saturation vapor pressure. May be a scalar, 1d, 2d, or 3d array.
    454 !                 Must have the same order and size as temp.
    455 !   </OUT>
    456 !   <OUT NAME="err_msg" UNITS="      " TYPE="character">

Page 9           Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    457 !     Character string containing error message to be returned to
    458 !     calling routine.
    459 !   </OUT>
    460 !   <ERROR MSG="table overflow, nbad=##" STATUS="FATAL">
    461 !     Temperature(s) provided to the saturation vapor pressure lookup
    462 !          are outside the valid range of the lookup table (-160 to 100 deg C).
    463 !          This may be due to a numerical instability in the model.
    464 !          Information should have been printed to standard output to help
    465 !          determine where the instability may have occurred.
    466 !          If the lookup table needs a larger temperature range,
    467 !          then parameters in the module header must be modified.
    468 !   </ERROR> *
    469 
    470  interface compute_mrs
    471    module procedure compute_mrs_0d, compute_mrs_1d, compute_mrs_2d, compute_mrs_3d
    472  end interface
    473 
    474 !-----------------------------------------------------------------------
    475 ! <INTERFACE NAME="compute_es">
    476 
    477 !   <OVERVIEW>
    478 !     For the given temperatures, computes the saturation vapor pressures.
    479 !   </OVERVIEW>
    480 !   <DESCRIPTION>
    481 !     Computes saturation vapor pressure for the given temperature using
    482 !     the equations given in the Smithsonian Meteorological Tables.
    483 !     Between -20C and 0C a blended value over ice and water is returned.
    484 !   </DESCRIPTION>
    485 !   <TEMPLATE>
    486 !     es = compute_es ( temp )
    487 !   </TEMPLATE>
    488 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    489 !     Temperature in degrees Kelvin.
    490 !   </IN>
    491 !   <OUT NAME="es" UNITS="pascal" TYPE="real" DIM="(scalar),(:),(:,:),(:,:,:)">
    492 !     Saturation vapor pressure in pascals.
    493 !             May be a scalar, 1d, 2d, or 3d array.
    494 !             Must have the same order and size as temp.
    495 !   </OUT>
    496 
    497 !interface compute_es
    498 !  module procedure compute_es_0d, compute_es_1d, compute_es_2d, compute_es_3d
    499 !end interface
    500 ! </INTERFACE>
    501 !-----------------------------------------------------------------------
    502  interface temp_check
    503    module procedure temp_check_1d, temp_check_2d, temp_check_3d
    504  end interface
    505 
    506  interface show_all_bad
    507    module procedure show_all_bad_0d, show_all_bad_1d, show_all_bad_2d, show_all_bad_3d
    508  end interface
    509 !-----------------------------------------------------------------------
    510 ! Include variable "version" to be written to log file.
    511 # 1 "../include/file_version.h" 1 
    512 ! -*-f90-*-
    513 !***********************************************************************

Page 10          Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 ../include/file_version.h

    514 !*                   GNU Lesser General Public License
    515 !*
    516 !* This file is part of the GFDL Flexible Modeling System (FMS).
    517 !*
    518 !* FMS is free software: you can redistribute it and/or modify it under
    519 !* the terms of the GNU Lesser General Public License as published by
    520 !* the Free Software Foundation, either version 3 of the License, or (at
    521 !* your option) any later version.
    522 !*
    523 !* FMS is distributed in the hope that it will be useful, but WITHOUT
    524 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
    525 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
    526 !* for more details.
    527 !*
    528 !* You should have received a copy of the GNU Lesser General Public
    529 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
    530 !***********************************************************************
    531 
    532 # 23
    533 
    534   character(len=*), parameter :: version = 'unknown'
    535 
    536 # 511 "sat_vapor_pres.F90" 2 
    537 
    538  logical :: module_is_initialized = .false.
    539 
    540 !-----------------------------------------------------------------------
    541 !  parameters for use in computing qs and mrs
    542 
    543  real, parameter    :: EPSILO = RDGAS/RVGAS
    544  real, parameter    :: ZVIR = RVGAS/RDGAS - 1.0
    545 
    546 !-----------------------------------------------------------------------
    547 !  parameters for table size and resolution
    548 
    549  integer, public :: tcmin = -160  ! minimum temperature (degC) in lookup table
    550  integer, public :: tcmax =  100  ! maximum temperature (degC) in lookup table
    551  integer :: esres =  10   ! table resolution (increments per degree)
    552  integer :: nsize  ! (tcmax-tcmin)*esres+1    !  lookup table size
    553  integer :: nlim   ! nsize-1
    554 
    555  integer :: stdoutunit=0
    556 !-----------------------------------------------------------------------
    557 !  variables needed by temp_check
    558  real :: tmin, dtinv, teps
    559 
    560 ! The default values below preserve the behavior of omsk and earlier revisions.
    561  logical :: show_bad_value_count_by_slice=.true.
    562  logical :: show_all_bad_values=.false.
    563  logical :: use_exact_qs = .false.
    564  logical :: do_simple             =.false.
    565  logical :: construct_table_wrt_liq = .false.
    566  logical :: construct_table_wrt_liq_and_ice = .false.
    567 
    568  namelist / sat_vapor_pres_nml / show_bad_value_count_by_slice, show_all_bad_values, &
    569                                  use_exact_qs, do_simple, &
    570                                  construct_table_wrt_liq, &

Page 11          Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    571                                  construct_table_wrt_liq_and_ice
    572 
    573 contains
    574 
    575 !#######################################################################
    576 ! <SUBROUTINE NAME="lookup_es_0d" INTERFACE="lookup_es">
    577 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
    578 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
    579 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    580 ! </SUBROUTINE>
    581  subroutine lookup_es_0d ( temp, esat, err_msg )
    582 
    583  real, intent(in)  :: temp
    584  real, intent(out) :: esat
    585  character(len=*), intent(out), optional :: err_msg
    586 
    587  integer :: nbad
    588  character(len=128) :: err_msg_local
    589 
    590    if (.not.module_is_initialized) then
    591       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    592    endif
    593 
    594    call lookup_es_k(temp, esat, nbad)
    595 
    596    if ( nbad == 0 ) then
    597      if(present(err_msg)) err_msg = ''
    598    else
    599      if(show_all_bad_values) call show_all_bad ( temp )
    600      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    601      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
    602    endif
    603 
    604  end subroutine lookup_es_0d

Page 12          Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                           
                                                 
 sat_vapor_pres_mod_mp_lookup_es_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  581      CHAR                        scalar   ARG,OUT          591,597,601                       
 ERR_MSG_LOCAL              Local  588      CHAR            128         scalar                    600,601                           
 ESAT                       Dummy  581      R(8)            8           scalar   ARG,OUT          594                               
 FMS_ERROR_HANDLER          Func   591      L(4)            4           scalar   PRIV             136,591,601,624,635,660,671,695,70
                                                                                                  6,728,738,761,772,797,808,832,843,
                                                                                                  865,875,898,909,934,945,969,980,10
                                                                                                  05,1015,1038,1051,1075,1086,1108,1
                                                                                                  119,1140,1150,1173,1186,1210,1221,
                                                                                                  1243,1254,1275,1285,1308,1321,1345
                                                                                                  ,1356,1378,1389,1414,1424,1447,145
                                                                                                  8,1481,1492,1515,1526,1550,1560,15
                                                                                                  83,1594,1617,1628,1651,1662,1687,1
                                                                                                  697,1720,1731,1754,1765,1788,1799,
                                                                                                  1831,1857,1890,1918,1952,1980,2013
                                                                                                  ,2042,2075,2101,2135,2164,2197,222
                                                                                                  6,2259,2288,2364                  
 LOOKUP_ES_0D               Subr   581                                           PRIV                                               
 LOOKUP_ES_K                Local  594                                  scalar   PRIV             139,594,627,663,698               
 LOOKUP_ES_K_0D             Subr   594                                           PRIV             594                               
 MODULE_IS_INITIALIZED      Local  590      L(4)            4           scalar                    538,590,623,659,694,727,760,796,83
                                                                                                  1,864,897,933,968,1004,1037,1074,1
                                                                                                  107,1139,1172,1209,1242,1274,1307,
                                                                                                  1344,1377,1413,1446,1480,1514,1549
                                                                                                  ,1582,1616,1650,1686,1719,1753,178
                                                                                                  7,1830,1889,1951,2012,2074,2134,21
                                                                                                  96,2258,2338,2367                 
 NBAD                       Local  587      I(4)            4           scalar                    594,596,600                       
 PRESENT                    Func   597                                  scalar                    597                               
 SHOW_ALL_BAD               Local  599                                  scalar                    599,633,669,704,736,770,806,841,87
                                                                                                  3,907,943,978,1013,1049,1084,1117,
                                                                                                  1148,1184,1219,1252,1283,1319,1354
                                                                                                  ,1387,1422,1456,1490,1524,1558,159
                                                                                                  2,1626,1660,1695,1729,1763,1797,18
                                                                                                  55,1916,1978,2040,2099,2162,2224,2
                                                                                                  286                               
 SHOW_ALL_BAD_VALUES        Local  599      L(4)            4           scalar                    562,568,599,633,669,704,736,770,80
                                                                                                  6,841,873,907,943,978,1013,1049,10
                                                                                                  84,1117,1148,1184,1219,1252,1283,1
                                                                                                  319,1354,1387,1422,1456,1490,1524,
                                                                                                  1558,1592,1626,1660,1695,1729,1763
                                                                                                  ,1797,1855,1916,1978,2040,2099,216
                                                                                                  2,2224,2286                       
 TEMP                       Dummy  581      R(8)            8           scalar   ARG,IN           594,599                           

Page 13          Source Listing                  LOOKUP_ES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    605 
    606 !#######################################################################
    607 
    608 ! <SUBROUTINE NAME="lookup_es_1d" INTERFACE="lookup_es">
    609 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
    610 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
    611 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    612 ! </SUBROUTINE>
    613  subroutine lookup_es_1d ( temp, esat, err_msg )
    614 
    615  real, intent(in)  :: temp(:)
    616  real, intent(out) :: esat(:)
    617  character(len=*), intent(out), optional :: err_msg
    618 
    619  character(len=54) :: err_msg_local
    620  integer :: nbad
    621 !-----------------------------------------------
    622 
    623    if (.not.module_is_initialized) then
    624       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    625    endif
    626 
    627    call lookup_es_k(temp, esat, nbad)
    628 
    629    if ( nbad == 0 ) then
    630      if(present(err_msg)) err_msg = ''
    631    else
    632      if(show_bad_value_count_by_slice) call temp_check ( temp )
    633      if(show_all_bad_values) call show_all_bad ( temp )
    634      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    635      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
    636    endif
    637 
    638 !-----------------------------------------------
    639 
    640  end subroutine lookup_es_1d

Page 14          Source Listing                  LOOKUP_ES_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                           
                                                 
 sat_vapor_pres_mod_mp_lookup_es_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  613      CHAR                        scalar   ARG,OUT          624,630,635                       
 ERR_MSG_LOCAL              Local  619      CHAR            54          scalar                    634,635                           
 ESAT                       Dummy  613      R(8)            8     1     1        ARG,OUT          627                               
 LOOKUP_ES_1D               Subr   613                                           PRIV                                               
 LOOKUP_ES_K_1D             Subr   627                                           PRIV             627                               
 NBAD                       Local  620      I(4)            4           scalar                    627,629,634                       
 PRESENT                    Func   630                                  scalar                    630                               
 SHOW_BAD_VALUE_COUNT_BY_SL                                                                                                         
 ICE                        Local  632      L(4)            4           scalar                    561,568,632,668,703,769,805,840,90
                                                                                                  6,942,977,1048,1083,1116,1183,1218
                                                                                                  ,1251,1318,1353,1386,1455,1489,152
                                                                                                  3,1591,1625,1659,1728,1762,1796,19
                                                                                                  15,1977,2039,2161,2223,2285       
 TEMP                       Dummy  613      R(8)            8     1     1        ARG,IN           627,632,633                       
 TEMP_CHECK                 Local  632                                  scalar                    632,668,703,769,805,840,906,942,97
                                                                                                  7,1048,1083,1116,1183,1218,1251,13
                                                                                                  18,1353,1386,1455,1489,1523,1591,1
                                                                                                  625,1659,1728,1762,1796,1915,1977,
                                                                                                  2039,2161,2223,2285               

Page 15          Source Listing                  LOOKUP_ES_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

    641 
    642 !#######################################################################
    643 
    644 ! <SUBROUTINE NAME="lookup_es_2d" INTERFACE="lookup_es">
    645 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
    646 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
    647 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    648 ! </SUBROUTINE>
    649  subroutine lookup_es_2d ( temp, esat, err_msg )
    650 
    651  real, intent(in)  :: temp(:,:)
    652  real, intent(out) :: esat(:,:)
    653  character(len=*), intent(out), optional :: err_msg
    654 
    655  character(len=54) :: err_msg_local
    656  integer :: nbad
    657 !-----------------------------------------------
    658 
    659    if (.not.module_is_initialized) then
    660       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    661    endif
    662 
    663    call lookup_es_k(temp, esat, nbad)
    664 
    665    if ( nbad == 0 ) then
    666      if(present(err_msg)) err_msg = ''
    667    else
    668      if(show_bad_value_count_by_slice) call temp_check ( temp )
    669      if(show_all_bad_values) call show_all_bad ( temp )
    670      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    671      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
    672    endif
    673 
    674 !-----------------------------------------------
    675 
    676  end subroutine lookup_es_2d

Page 16          Source Listing                  LOOKUP_ES_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                           
                                                 
 sat_vapor_pres_mod_mp_lookup_es_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  649      CHAR                        scalar   ARG,OUT          660,666,671                       
 ERR_MSG_LOCAL              Local  655      CHAR            54          scalar                    670,671                           
 ESAT                       Dummy  649      R(8)            8     2     1        ARG,OUT          663                               
 LOOKUP_ES_2D               Subr   649                                           PRIV                                               
 LOOKUP_ES_K_2D             Subr   663                                           PRIV             663                               
 NBAD                       Local  656      I(4)            4           scalar                    663,665,670                       
 PRESENT                    Func   666                                  scalar                    666                               
 TEMP                       Dummy  649      R(8)            8     2     1        ARG,IN           663,668,669                       

Page 17          Source Listing                  LOOKUP_ES_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

    677 
    678 !#######################################################################
    679 
    680 ! <SUBROUTINE NAME="lookup_es_3d" INTERFACE="lookup_es">
    681 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
    682 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
    683 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    684 ! </SUBROUTINE>
    685  subroutine lookup_es_3d ( temp, esat, err_msg )
    686 
    687  real, intent(in)  :: temp(:,:,:)
    688  real, intent(out) :: esat(:,:,:)
    689  character(len=*), intent(out), optional :: err_msg
    690 
    691  integer :: nbad
    692  character(len=128) :: err_msg_tmp
    693 
    694    if (.not.module_is_initialized) then
    695       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    696    endif
    697 
    698    call lookup_es_k(temp, esat, nbad)
    699 
    700    if ( nbad == 0 ) then
    701      if(present(err_msg)) err_msg = ''
    702    else
    703      if(show_bad_value_count_by_slice) call temp_check ( temp )
    704      if(show_all_bad_values) call show_all_bad ( temp )
    705      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    706      if(fms_error_handler('lookup_es',err_msg_tmp,err_msg)) return
    707    endif
    708 
    709  end subroutine lookup_es_3d

Page 18          Source Listing                  LOOKUP_ES_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                           
                                                 
 sat_vapor_pres_mod_mp_lookup_es_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  685      CHAR                        scalar   ARG,OUT          695,701,706                       
 ERR_MSG_TMP                Local  692      CHAR            128         scalar                    705,706                           
 ESAT                       Dummy  685      R(8)            8     3     1        ARG,OUT          698                               
 LOOKUP_ES_3D               Subr   685                                           PRIV                                               
 LOOKUP_ES_K_3D             Subr   698                                           PRIV             698                               
 NBAD                       Local  691      I(4)            4           scalar                    698,700,705                       
 PRESENT                    Func   701                                  scalar                    701                               
 TEMP                       Dummy  685      R(8)            8     3     1        ARG,IN           698,703,704                       

Page 19          Source Listing                  LOOKUP_ES_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

    710 
    711 
    712 !#######################################################################
    713 ! <SUBROUTINE NAME="lookup_es2_0d" INTERFACE="lookup_es2">
    714 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
    715 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
    716 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    717 ! </SUBROUTINE>
    718  subroutine lookup_es2_0d ( temp, esat, err_msg )
    719 
    720  real, intent(in)  :: temp
    721  real, intent(out) :: esat
    722  character(len=*), intent(out), optional :: err_msg
    723 
    724  integer :: nbad
    725  character(len=128) :: err_msg_local
    726 
    727    if (.not.module_is_initialized) then
    728       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    729    endif
    730 
    731    call lookup_es2_k(temp, esat, nbad)
    732 
    733    if ( nbad == 0 ) then
    734      if(present(err_msg)) err_msg = ''
    735    else
    736      if(show_all_bad_values) call show_all_bad ( temp )
    737      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    738      if(fms_error_handler('lookup_es2',err_msg_local,err_msg)) return
    739    endif
    740 
    741  end subroutine lookup_es2_0d

Page 20          Source Listing                  LOOKUP_ES2_0D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_es2_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  718      CHAR                        scalar   ARG,OUT          728,734,738                       
 ERR_MSG_LOCAL              Local  725      CHAR            128         scalar                    737,738                           
 ESAT                       Dummy  718      R(8)            8           scalar   ARG,OUT          731                               
 LOOKUP_ES2_0D              Subr   718                                           PRIV                                               
 LOOKUP_ES2_K               Local  731                                  scalar   PRIV             141,731,764,800,835               
 LOOKUP_ES2_K_0D            Subr   731                                           PRIV             731                               
 NBAD                       Local  724      I(4)            4           scalar                    731,733,737                       
 PRESENT                    Func   734                                  scalar                    734                               
 TEMP                       Dummy  718      R(8)            8           scalar   ARG,IN           731,736                           

Page 21          Source Listing                  LOOKUP_ES2_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    742 
    743 !#######################################################################
    744 
    745 ! <SUBROUTINE NAME="lookup_es2_1d" INTERFACE="lookup_es2">
    746 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
    747 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
    748 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    749 ! </SUBROUTINE>
    750  subroutine lookup_es2_1d ( temp, esat, err_msg )
    751 
    752  real, intent(in)  :: temp(:)
    753  real, intent(out) :: esat(:)
    754  character(len=*), intent(out), optional :: err_msg
    755 
    756  character(len=54) :: err_msg_local
    757  integer :: nbad
    758 !-----------------------------------------------
    759 
    760    if (.not.module_is_initialized) then
    761       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    762    endif
    763 
    764    call lookup_es2_k(temp, esat, nbad)
    765 
    766    if ( nbad == 0 ) then
    767      if(present(err_msg)) err_msg = ''
    768    else
    769      if(show_bad_value_count_by_slice) call temp_check ( temp )
    770      if(show_all_bad_values) call show_all_bad ( temp )
    771      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    772      if(fms_error_handler('lookup_es2',err_msg_local,err_msg)) return
    773    endif
    774 
    775 !-----------------------------------------------
    776 
    777  end subroutine lookup_es2_1d

Page 22          Source Listing                  LOOKUP_ES2_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_es2_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  750      CHAR                        scalar   ARG,OUT          761,767,772                       
 ERR_MSG_LOCAL              Local  756      CHAR            54          scalar                    771,772                           
 ESAT                       Dummy  750      R(8)            8     1     1        ARG,OUT          764                               
 LOOKUP_ES2_1D              Subr   750                                           PRIV                                               
 LOOKUP_ES2_K_1D            Subr   764                                           PRIV             764                               
 NBAD                       Local  757      I(4)            4           scalar                    764,766,771                       
 PRESENT                    Func   767                                  scalar                    767                               
 TEMP                       Dummy  750      R(8)            8     1     1        ARG,IN           764,769,770                       

Page 23          Source Listing                  LOOKUP_ES2_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

    778 
    779 !#######################################################################
    780 
    781 ! <SUBROUTINE NAME="lookup_es2_2d" INTERFACE="lookup_es2">
    782 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
    783 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
    784 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    785 ! </SUBROUTINE>
    786  subroutine lookup_es2_2d ( temp, esat, err_msg )
    787 
    788  real, intent(in)  :: temp(:,:)
    789  real, intent(out) :: esat(:,:)
    790  character(len=*), intent(out), optional :: err_msg
    791 
    792  character(len=54) :: err_msg_local
    793  integer :: nbad
    794 !-----------------------------------------------
    795 
    796    if (.not.module_is_initialized) then
    797       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    798    endif
    799 
    800    call lookup_es2_k(temp, esat, nbad)
    801 
    802    if ( nbad == 0 ) then
    803      if(present(err_msg)) err_msg = ''
    804    else
    805      if(show_bad_value_count_by_slice) call temp_check ( temp )
    806      if(show_all_bad_values) call show_all_bad ( temp )
    807      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    808      if(fms_error_handler('lookup_es2',err_msg_local,err_msg)) return
    809    endif
    810 
    811 !-----------------------------------------------
    812 
    813  end subroutine lookup_es2_2d

Page 24          Source Listing                  LOOKUP_ES2_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_es2_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  786      CHAR                        scalar   ARG,OUT          797,803,808                       
 ERR_MSG_LOCAL              Local  792      CHAR            54          scalar                    807,808                           
 ESAT                       Dummy  786      R(8)            8     2     1        ARG,OUT          800                               
 LOOKUP_ES2_2D              Subr   786                                           PRIV                                               
 LOOKUP_ES2_K_2D            Subr   800                                           PRIV             800                               
 NBAD                       Local  793      I(4)            4           scalar                    800,802,807                       
 PRESENT                    Func   803                                  scalar                    803                               
 TEMP                       Dummy  786      R(8)            8     2     1        ARG,IN           800,805,806                       

Page 25          Source Listing                  LOOKUP_ES2_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

    814 
    815 !#######################################################################
    816 
    817 ! <SUBROUTINE NAME="lookup_es2_3d" INTERFACE="lookup_es2">
    818 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
    819 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
    820 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    821 ! </SUBROUTINE>
    822  subroutine lookup_es2_3d ( temp, esat, err_msg )
    823 
    824  real, intent(in)  :: temp(:,:,:)
    825  real, intent(out) :: esat(:,:,:)
    826  character(len=*), intent(out), optional :: err_msg
    827 
    828  integer :: nbad
    829  character(len=128) :: err_msg_tmp
    830 
    831    if (.not.module_is_initialized) then
    832       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    833    endif
    834 
    835    call lookup_es2_k(temp, esat, nbad)
    836 
    837    if ( nbad == 0 ) then
    838      if(present(err_msg)) err_msg = ''
    839    else
    840      if(show_bad_value_count_by_slice) call temp_check ( temp )
    841      if(show_all_bad_values) call show_all_bad ( temp )
    842      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    843      if(fms_error_handler('lookup_es2',err_msg_tmp,err_msg)) return
    844    endif
    845 
    846  end subroutine lookup_es2_3d

Page 26          Source Listing                  LOOKUP_ES2_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_es2_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  822      CHAR                        scalar   ARG,OUT          832,838,843                       
 ERR_MSG_TMP                Local  829      CHAR            128         scalar                    842,843                           
 ESAT                       Dummy  822      R(8)            8     3     1        ARG,OUT          835                               
 LOOKUP_ES2_3D              Subr   822                                           PRIV                                               
 LOOKUP_ES2_K_3D            Subr   835                                           PRIV             835                               
 NBAD                       Local  828      I(4)            4           scalar                    835,837,842                       
 PRESENT                    Func   838                                  scalar                    838                               
 TEMP                       Dummy  822      R(8)            8     3     1        ARG,IN           835,840,841                       

Page 27          Source Listing                  LOOKUP_ES2_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

    847 
    848 
    849 !#######################################################################
    850 ! <SUBROUTINE NAME="lookup_es3_0d" INTERFACE="lookup_es3">
    851 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
    852 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
    853 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    854 ! </SUBROUTINE>
    855  subroutine lookup_es3_0d ( temp, esat, err_msg )
    856 
    857  real, intent(in)  :: temp
    858  real, intent(out) :: esat
    859  character(len=*), intent(out), optional :: err_msg
    860 
    861  integer :: nbad
    862  character(len=128) :: err_msg_local
    863 
    864    if (.not.module_is_initialized) then
    865       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    866    endif
    867 
    868    call lookup_es3_k(temp, esat, nbad)
    869 
    870    if ( nbad == 0 ) then
    871      if(present(err_msg)) err_msg = ''
    872    else
    873      if(show_all_bad_values) call show_all_bad ( temp )
    874      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    875      if(fms_error_handler('lookup_es3',err_msg_local,err_msg)) return
    876    endif
    877 
    878  end subroutine lookup_es3_0d

Page 28          Source Listing                  LOOKUP_ES3_0D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_es3_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  855      CHAR                        scalar   ARG,OUT          865,871,875                       
 ERR_MSG_LOCAL              Local  862      CHAR            128         scalar                    874,875                           
 ESAT                       Dummy  855      R(8)            8           scalar   ARG,OUT          868                               
 LOOKUP_ES3_0D              Subr   855                                           PRIV                                               
 LOOKUP_ES3_K               Local  868                                  scalar   PRIV             143,868,901,937,972               
 LOOKUP_ES3_K_0D            Subr   868                                           PRIV             868                               
 NBAD                       Local  861      I(4)            4           scalar                    868,870,874                       
 PRESENT                    Func   871                                  scalar                    871                               
 TEMP                       Dummy  855      R(8)            8           scalar   ARG,IN           868,873                           

Page 29          Source Listing                  LOOKUP_ES3_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

    879 
    880 !#######################################################################
    881 
    882 ! <SUBROUTINE NAME="lookup_es3_1d" INTERFACE="lookup_es3">
    883 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
    884 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
    885 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    886 ! </SUBROUTINE>
    887  subroutine lookup_es3_1d ( temp, esat, err_msg )
    888 
    889  real, intent(in)  :: temp(:)
    890  real, intent(out) :: esat(:)
    891  character(len=*), intent(out), optional :: err_msg
    892 
    893  character(len=54) :: err_msg_local
    894  integer :: nbad
    895 !-----------------------------------------------
    896 
    897    if (.not.module_is_initialized) then
    898       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    899    endif
    900 
    901    call lookup_es3_k(temp, esat, nbad)
    902 
    903    if ( nbad == 0 ) then
    904      if(present(err_msg)) err_msg = ''
    905    else
    906      if(show_bad_value_count_by_slice) call temp_check ( temp )
    907      if(show_all_bad_values) call show_all_bad ( temp )
    908      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    909      if(fms_error_handler('lookup_es3',err_msg_local,err_msg)) return
    910    endif
    911 
    912 !-----------------------------------------------
    913 
    914  end subroutine lookup_es3_1d

Page 30          Source Listing                  LOOKUP_ES3_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_es3_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  887      CHAR                        scalar   ARG,OUT          898,904,909                       
 ERR_MSG_LOCAL              Local  893      CHAR            54          scalar                    908,909                           
 ESAT                       Dummy  887      R(8)            8     1     1        ARG,OUT          901                               
 LOOKUP_ES3_1D              Subr   887                                           PRIV                                               
 LOOKUP_ES3_K_1D            Subr   901                                           PRIV             901                               
 NBAD                       Local  894      I(4)            4           scalar                    901,903,908                       
 PRESENT                    Func   904                                  scalar                    904                               
 TEMP                       Dummy  887      R(8)            8     1     1        ARG,IN           901,906,907                       

Page 31          Source Listing                  LOOKUP_ES3_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

    915 
    916 !#######################################################################
    917 
    918 ! <SUBROUTINE NAME="lookup_es3_2d" INTERFACE="lookup_es3">
    919 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
    920 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
    921 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    922 ! </SUBROUTINE>
    923  subroutine lookup_es3_2d ( temp, esat, err_msg )
    924 
    925  real, intent(in)  :: temp(:,:)
    926  real, intent(out) :: esat(:,:)
    927  character(len=*), intent(out), optional :: err_msg
    928 
    929  character(len=54) :: err_msg_local
    930  integer :: nbad
    931 !-----------------------------------------------
    932 
    933    if (.not.module_is_initialized) then
    934       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    935    endif
    936 
    937    call lookup_es3_k(temp, esat, nbad)
    938 
    939    if ( nbad == 0 ) then
    940      if(present(err_msg)) err_msg = ''
    941    else
    942      if(show_bad_value_count_by_slice) call temp_check ( temp )
    943      if(show_all_bad_values) call show_all_bad ( temp )
    944      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    945      if(fms_error_handler('lookup_es3',err_msg_local,err_msg)) return
    946    endif
    947 
    948 !-----------------------------------------------
    949 
    950  end subroutine lookup_es3_2d

Page 32          Source Listing                  LOOKUP_ES3_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_es3_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  923      CHAR                        scalar   ARG,OUT          934,940,945                       
 ERR_MSG_LOCAL              Local  929      CHAR            54          scalar                    944,945                           
 ESAT                       Dummy  923      R(8)            8     2     1        ARG,OUT          937                               
 LOOKUP_ES3_2D              Subr   923                                           PRIV                                               
 LOOKUP_ES3_K_2D            Subr   937                                           PRIV             937                               
 NBAD                       Local  930      I(4)            4           scalar                    937,939,944                       
 PRESENT                    Func   940                                  scalar                    940                               
 TEMP                       Dummy  923      R(8)            8     2     1        ARG,IN           937,942,943                       

Page 33          Source Listing                  LOOKUP_ES3_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

    951 
    952 !#######################################################################
    953 
    954 ! <SUBROUTINE NAME="lookup_es3_3d" INTERFACE="lookup_es3">
    955 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
    956 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
    957 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    958 ! </SUBROUTINE>
    959  subroutine lookup_es3_3d ( temp, esat, err_msg )
    960 
    961  real, intent(in)  :: temp(:,:,:)
    962  real, intent(out) :: esat(:,:,:)
    963  character(len=*), intent(out), optional :: err_msg
    964 
    965  integer :: nbad
    966  character(len=128) :: err_msg_tmp
    967 
    968    if (.not.module_is_initialized) then
    969       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
    970    endif
    971 
    972    call lookup_es3_k(temp, esat, nbad)
    973 
    974    if ( nbad == 0 ) then
    975      if(present(err_msg)) err_msg = ''
    976    else
    977      if(show_bad_value_count_by_slice) call temp_check ( temp )
    978      if(show_all_bad_values) call show_all_bad ( temp )
    979      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
    980      if(fms_error_handler('lookup_es3',err_msg_tmp,err_msg)) return
    981    endif
    982 
    983  end subroutine lookup_es3_3d

Page 34          Source Listing                  LOOKUP_ES3_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_es3_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ERR_MSG                    Dummy  959      CHAR                        scalar   ARG,OUT          969,975,980                       
 ERR_MSG_TMP                Local  966      CHAR            128         scalar                    979,980                           
 ESAT                       Dummy  959      R(8)            8     3     1        ARG,OUT          972                               
 LOOKUP_ES3_3D              Subr   959                                           PRIV                                               
 LOOKUP_ES3_K_3D            Subr   972                                           PRIV             972                               
 NBAD                       Local  965      I(4)            4           scalar                    972,974,979                       
 PRESENT                    Func   975                                  scalar                    975                               
 TEMP                       Dummy  959      R(8)            8     3     1        ARG,IN           972,977,978                       

Page 35          Source Listing                  LOOKUP_ES3_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

    984 
    985 
    986 !#######################################################################
    987 !  routines for computing derivative of es
    988 !#######################################################################
    989 
    990 ! <SUBROUTINE NAME="lookup_des_0d" INTERFACE="lookup_des">
    991 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
    992 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
    993 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
    994 ! </SUBROUTINE>
    995  subroutine lookup_des_0d ( temp, desat, err_msg )
    996 
    997  real, intent(in)  :: temp
    998  real, intent(out) :: desat
    999  character(len=*), intent(out), optional :: err_msg
   1000 
   1001  integer :: nbad
   1002  character(len=128) :: err_msg_local
   1003 
   1004    if (.not.module_is_initialized) then
   1005       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1006    endif
   1007 
   1008    call lookup_des_k( temp, desat, nbad)
   1009 
   1010    if ( nbad == 0 ) then
   1011      if(present(err_msg)) err_msg = ''
   1012    else
   1013      if(show_all_bad_values) call show_all_bad ( temp )
   1014      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1015      if(fms_error_handler('lookup_des',err_msg_local,err_msg)) return
   1016    endif
   1017 
   1018  end subroutine lookup_des_0d

Page 36          Source Listing                  LOOKUP_DES_0D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_des_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  995      R(8)            8           scalar   ARG,OUT          1008                              
 ERR_MSG                    Dummy  995      CHAR                        scalar   ARG,OUT          1005,1011,1015                    
 ERR_MSG_LOCAL              Local  1002     CHAR            128         scalar                    1014,1015                         
 LOOKUP_DES_0D              Subr   995                                           PRIV                                               
 LOOKUP_DES_K               Local  1008                                 scalar   PRIV             140,1008,1043,1078,1111           
 LOOKUP_DES_K_0D            Subr   1008                                          PRIV             1008                              
 NBAD                       Local  1001     I(4)            4           scalar                    1008,1010,1014                    
 PRESENT                    Func   1011                                 scalar                    1011                              
 TEMP                       Dummy  995      R(8)            8           scalar   ARG,IN           1008,1013                         

Page 37          Source Listing                  LOOKUP_DES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1019 
   1020 !#######################################################################
   1021 
   1022 ! <SUBROUTINE NAME="lookup_des_1d" INTERFACE="lookup_des">
   1023 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
   1024 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
   1025 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1026 ! </SUBROUTINE>
   1027  subroutine lookup_des_1d ( temp, desat, err_msg )
   1028 
   1029  real, intent(in)  :: temp (:)
   1030  real, intent(out) :: desat(:)
   1031  character(len=*), intent(out), optional :: err_msg
   1032 
   1033  character(len=54) :: err_msg_local
   1034  integer :: nbad
   1035 !-----------------------------------------------
   1036 
   1037    if (.not.module_is_initialized) then
   1038       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1039    endif
   1040 
   1041    if(present(err_msg)) err_msg=''
   1042 
   1043    call lookup_des_k(temp, desat, nbad)
   1044 
   1045    if ( nbad == 0 ) then
   1046      if(present(err_msg)) err_msg = ''
   1047    else
   1048      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1049      if(show_all_bad_values) call show_all_bad ( temp )
   1050      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1051      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
   1052    endif
   1053 !-----------------------------------------------
   1054 
   1055  end subroutine lookup_des_1d

Page 38          Source Listing                  LOOKUP_DES_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_des_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1027     R(8)            8     1     1        ARG,OUT          1043                              
 ERR_MSG                    Dummy  1027     CHAR                        scalar   ARG,OUT          1038,1041,1046,1051               
 ERR_MSG_LOCAL              Local  1033     CHAR            54          scalar                    1050,1051                         
 LOOKUP_DES_1D              Subr   1027                                          PRIV                                               
 LOOKUP_DES_K_1D            Subr   1043                                          PRIV             1043                              
 NBAD                       Local  1034     I(4)            4           scalar                    1043,1045,1050                    
 PRESENT                    Func   1041                                 scalar                    1041,1046                         
 TEMP                       Dummy  1027     R(8)            8     1     1        ARG,IN           1043,1048,1049                    

Page 39          Source Listing                  LOOKUP_DES_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1056 
   1057 !#######################################################################
   1058 
   1059 ! <SUBROUTINE NAME="lookup_des_2d" INTERFACE="lookup_des">
   1060 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
   1061 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
   1062 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1063 ! </SUBROUTINE>
   1064  subroutine lookup_des_2d ( temp, desat, err_msg )
   1065 
   1066  real, intent(in)  :: temp (:,:)
   1067  real, intent(out) :: desat(:,:)
   1068  character(len=*), intent(out), optional :: err_msg
   1069 
   1070  character(len=54) :: err_msg_local
   1071  integer :: nbad
   1072 !-----------------------------------------------
   1073 
   1074    if (.not.module_is_initialized) then
   1075       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1076    endif
   1077 
   1078    call lookup_des_k(temp, desat, nbad)
   1079 
   1080    if ( nbad == 0 ) then
   1081      if(present(err_msg)) err_msg = ''
   1082    else
   1083      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1084      if(show_all_bad_values) call show_all_bad ( temp )
   1085      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1086      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
   1087    endif
   1088 !-----------------------------------------------
   1089 
   1090  end subroutine lookup_des_2d

Page 40          Source Listing                  LOOKUP_DES_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_des_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1064     R(8)            8     2     1        ARG,OUT          1078                              
 ERR_MSG                    Dummy  1064     CHAR                        scalar   ARG,OUT          1075,1081,1086                    
 ERR_MSG_LOCAL              Local  1070     CHAR            54          scalar                    1085,1086                         
 LOOKUP_DES_2D              Subr   1064                                          PRIV                                               
 LOOKUP_DES_K_2D            Subr   1078                                          PRIV             1078                              
 NBAD                       Local  1071     I(4)            4           scalar                    1078,1080,1085                    
 PRESENT                    Func   1081                                 scalar                    1081                              
 TEMP                       Dummy  1064     R(8)            8     2     1        ARG,IN           1078,1083,1084                    

Page 41          Source Listing                  LOOKUP_DES_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1091 
   1092 !#######################################################################
   1093 ! <SUBROUTINE NAME="lookup_des_3d" INTERFACE="lookup_des">
   1094 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
   1095 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
   1096 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1097 ! </SUBROUTINE>
   1098  subroutine lookup_des_3d ( temp, desat, err_msg )
   1099 
   1100  real, intent(in)  :: temp (:,:,:)
   1101  real, intent(out) :: desat(:,:,:)
   1102  character(len=*), intent(out), optional :: err_msg
   1103 
   1104  integer :: nbad
   1105  character(len=128) :: err_msg_tmp
   1106 
   1107    if (.not.module_is_initialized) then
   1108       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1109    endif
   1110 
   1111    call lookup_des_k( temp, desat, nbad )
   1112 
   1113    if ( nbad == 0 ) then
   1114      if(present(err_msg)) err_msg=''
   1115    else
   1116      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1117      if(show_all_bad_values) call show_all_bad ( temp )
   1118      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1119      if(fms_error_handler('lookup_des',err_msg_tmp,err_msg)) return
   1120    endif
   1121 
   1122  end subroutine lookup_des_3d

Page 42          Source Listing                  LOOKUP_DES_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_lookup_des_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1098     R(8)            8     3     1        ARG,OUT          1111                              
 ERR_MSG                    Dummy  1098     CHAR                        scalar   ARG,OUT          1108,1114,1119                    
 ERR_MSG_TMP                Local  1105     CHAR            128         scalar                    1118,1119                         
 LOOKUP_DES_3D              Subr   1098                                          PRIV                                               
 LOOKUP_DES_K_3D            Subr   1111                                          PRIV             1111                              
 NBAD                       Local  1104     I(4)            4           scalar                    1111,1113,1118                    
 PRESENT                    Func   1114                                 scalar                    1114                              
 TEMP                       Dummy  1098     R(8)            8     3     1        ARG,IN           1111,1116,1117                    

Page 43          Source Listing                  LOOKUP_DES_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1123 
   1124 
   1125 ! <SUBROUTINE NAME="lookup_des2_0d" INTERFACE="lookup_des2">
   1126 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
   1127 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
   1128 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1129 ! </SUBROUTINE>
   1130  subroutine lookup_des2_0d ( temp, desat, err_msg )
   1131 
   1132  real, intent(in)  :: temp
   1133  real, intent(out) :: desat
   1134  character(len=*), intent(out), optional :: err_msg
   1135 
   1136  integer :: nbad
   1137  character(len=128) :: err_msg_local
   1138 
   1139    if (.not.module_is_initialized) then
   1140       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1141    endif
   1142 
   1143    call lookup_des2_k( temp, desat, nbad)
   1144 
   1145    if ( nbad == 0 ) then
   1146      if(present(err_msg)) err_msg = ''
   1147    else
   1148      if(show_all_bad_values) call show_all_bad ( temp )
   1149      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1150      if(fms_error_handler('lookup_des2',err_msg_local,err_msg)) return
   1151    endif
   1152 
   1153  end subroutine lookup_des2_0d

Page 44          Source Listing                  LOOKUP_DES2_0D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_lookup_des2_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1130     R(8)            8           scalar   ARG,OUT          1143                              
 ERR_MSG                    Dummy  1130     CHAR                        scalar   ARG,OUT          1140,1146,1150                    
 ERR_MSG_LOCAL              Local  1137     CHAR            128         scalar                    1149,1150                         
 LOOKUP_DES2_0D             Subr   1130                                          PRIV                                               
 LOOKUP_DES2_K              Local  1143                                 scalar   PRIV             142,1143,1178,1213,1246           
 LOOKUP_DES2_K_0D           Subr   1143                                          PRIV             1143                              
 NBAD                       Local  1136     I(4)            4           scalar                    1143,1145,1149                    
 PRESENT                    Func   1146                                 scalar                    1146                              
 TEMP                       Dummy  1130     R(8)            8           scalar   ARG,IN           1143,1148                         

Page 45          Source Listing                  LOOKUP_DES2_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1154 
   1155 !#######################################################################
   1156 
   1157 ! <SUBROUTINE NAME="lookup_des2_1d" INTERFACE="lookup_des2">
   1158 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
   1159 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
   1160 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1161 ! </SUBROUTINE>
   1162  subroutine lookup_des2_1d ( temp, desat, err_msg )
   1163 
   1164  real, intent(in)  :: temp (:)
   1165  real, intent(out) :: desat(:)
   1166  character(len=*), intent(out), optional :: err_msg
   1167 
   1168  character(len=54) :: err_msg_local
   1169  integer :: nbad
   1170 !-----------------------------------------------
   1171 
   1172    if (.not.module_is_initialized) then
   1173       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1174    endif
   1175 
   1176    if(present(err_msg)) err_msg=''
   1177 
   1178    call lookup_des2_k(temp, desat, nbad)
   1179 
   1180    if ( nbad == 0 ) then
   1181      if(present(err_msg)) err_msg = ''
   1182    else
   1183      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1184      if(show_all_bad_values) call show_all_bad ( temp )
   1185      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1186      if(fms_error_handler('lookup_des2',err_msg_local,err_msg)) return
   1187    endif
   1188 !-----------------------------------------------
   1189 
   1190  end subroutine lookup_des2_1d

Page 46          Source Listing                  LOOKUP_DES2_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_lookup_des2_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1162     R(8)            8     1     1        ARG,OUT          1178                              
 ERR_MSG                    Dummy  1162     CHAR                        scalar   ARG,OUT          1173,1176,1181,1186               
 ERR_MSG_LOCAL              Local  1168     CHAR            54          scalar                    1185,1186                         
 LOOKUP_DES2_1D             Subr   1162                                          PRIV                                               
 LOOKUP_DES2_K_1D           Subr   1178                                          PRIV             1178                              
 NBAD                       Local  1169     I(4)            4           scalar                    1178,1180,1185                    
 PRESENT                    Func   1176                                 scalar                    1176,1181                         
 TEMP                       Dummy  1162     R(8)            8     1     1        ARG,IN           1178,1183,1184                    

Page 47          Source Listing                  LOOKUP_DES2_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1191 
   1192 !#######################################################################
   1193 
   1194 ! <SUBROUTINE NAME="lookup_des2_2d" INTERFACE="lookup_des2">
   1195 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
   1196 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
   1197 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1198 ! </SUBROUTINE>
   1199  subroutine lookup_des2_2d ( temp, desat, err_msg )
   1200 
   1201  real, intent(in)  :: temp (:,:)
   1202  real, intent(out) :: desat(:,:)
   1203  character(len=*), intent(out), optional :: err_msg
   1204 
   1205  character(len=54) :: err_msg_local
   1206  integer :: nbad
   1207 !-----------------------------------------------
   1208 
   1209    if (.not.module_is_initialized) then
   1210       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1211    endif
   1212 
   1213    call lookup_des2_k(temp, desat, nbad)
   1214 
   1215    if ( nbad == 0 ) then
   1216      if(present(err_msg)) err_msg = ''
   1217    else
   1218      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1219      if(show_all_bad_values) call show_all_bad ( temp )
   1220      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1221      if(fms_error_handler('lookup_des2',err_msg_local,err_msg)) return
   1222    endif
   1223 !-----------------------------------------------
   1224 
   1225  end subroutine lookup_des2_2d

Page 48          Source Listing                  LOOKUP_DES2_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_lookup_des2_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1199     R(8)            8     2     1        ARG,OUT          1213                              
 ERR_MSG                    Dummy  1199     CHAR                        scalar   ARG,OUT          1210,1216,1221                    
 ERR_MSG_LOCAL              Local  1205     CHAR            54          scalar                    1220,1221                         
 LOOKUP_DES2_2D             Subr   1199                                          PRIV                                               
 LOOKUP_DES2_K_2D           Subr   1213                                          PRIV             1213                              
 NBAD                       Local  1206     I(4)            4           scalar                    1213,1215,1220                    
 PRESENT                    Func   1216                                 scalar                    1216                              
 TEMP                       Dummy  1199     R(8)            8     2     1        ARG,IN           1213,1218,1219                    

Page 49          Source Listing                  LOOKUP_DES2_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1226 
   1227 !#######################################################################
   1228 ! <SUBROUTINE NAME="lookup_des2_3d" INTERFACE="lookup_des2">
   1229 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
   1230 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
   1231 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1232 ! </SUBROUTINE>
   1233  subroutine lookup_des2_3d ( temp, desat, err_msg )
   1234 
   1235  real, intent(in)  :: temp (:,:,:)
   1236  real, intent(out) :: desat(:,:,:)
   1237  character(len=*), intent(out), optional :: err_msg
   1238 
   1239  integer :: nbad
   1240  character(len=128) :: err_msg_tmp
   1241 
   1242    if (.not.module_is_initialized) then
   1243       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1244    endif
   1245 
   1246    call lookup_des2_k( temp, desat, nbad )
   1247 
   1248    if ( nbad == 0 ) then
   1249      if(present(err_msg)) err_msg=''
   1250    else
   1251      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1252      if(show_all_bad_values) call show_all_bad ( temp )
   1253      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1254      if(fms_error_handler('lookup_des2',err_msg_tmp,err_msg)) return
   1255    endif
   1256 
   1257  end subroutine lookup_des2_3d

Page 50          Source Listing                  LOOKUP_DES2_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_lookup_des2_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1233     R(8)            8     3     1        ARG,OUT          1246                              
 ERR_MSG                    Dummy  1233     CHAR                        scalar   ARG,OUT          1243,1249,1254                    
 ERR_MSG_TMP                Local  1240     CHAR            128         scalar                    1253,1254                         
 LOOKUP_DES2_3D             Subr   1233                                          PRIV                                               
 LOOKUP_DES2_K_3D           Subr   1246                                          PRIV             1246                              
 NBAD                       Local  1239     I(4)            4           scalar                    1246,1248,1253                    
 PRESENT                    Func   1249                                 scalar                    1249                              
 TEMP                       Dummy  1233     R(8)            8     3     1        ARG,IN           1246,1251,1252                    

Page 51          Source Listing                  LOOKUP_DES2_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1258 
   1259 
   1260 ! <SUBROUTINE NAME="lookup_des3_0d" INTERFACE="lookup_des3">
   1261 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
   1262 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
   1263 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1264 ! </SUBROUTINE>
   1265  subroutine lookup_des3_0d ( temp, desat, err_msg )
   1266 
   1267  real, intent(in)  :: temp
   1268  real, intent(out) :: desat
   1269  character(len=*), intent(out), optional :: err_msg
   1270 
   1271  integer :: nbad
   1272  character(len=128) :: err_msg_local
   1273 
   1274    if (.not.module_is_initialized) then
   1275       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1276    endif
   1277 
   1278    call lookup_des3_k( temp, desat, nbad)
   1279 
   1280    if ( nbad == 0 ) then
   1281      if(present(err_msg)) err_msg = ''
   1282    else
   1283      if(show_all_bad_values) call show_all_bad ( temp )
   1284      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1285      if(fms_error_handler('lookup_des3',err_msg_local,err_msg)) return
   1286    endif
   1287 
   1288  end subroutine lookup_des3_0d

Page 52          Source Listing                  LOOKUP_DES3_0D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_lookup_des3_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1265     R(8)            8           scalar   ARG,OUT          1278                              
 ERR_MSG                    Dummy  1265     CHAR                        scalar   ARG,OUT          1275,1281,1285                    
 ERR_MSG_LOCAL              Local  1272     CHAR            128         scalar                    1284,1285                         
 LOOKUP_DES3_0D             Subr   1265                                          PRIV                                               
 LOOKUP_DES3_K              Local  1278                                 scalar   PRIV             144,1278,1313,1348,1381           
 LOOKUP_DES3_K_0D           Subr   1278                                          PRIV             1278                              
 NBAD                       Local  1271     I(4)            4           scalar                    1278,1280,1284                    
 PRESENT                    Func   1281                                 scalar                    1281                              
 TEMP                       Dummy  1265     R(8)            8           scalar   ARG,IN           1278,1283                         

Page 53          Source Listing                  LOOKUP_DES3_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1289 
   1290 !#######################################################################
   1291 
   1292 ! <SUBROUTINE NAME="lookup_des3_1d" INTERFACE="lookup_des3">
   1293 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
   1294 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
   1295 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1296 ! </SUBROUTINE>
   1297  subroutine lookup_des3_1d ( temp, desat, err_msg )
   1298 
   1299  real, intent(in)  :: temp (:)
   1300  real, intent(out) :: desat(:)
   1301  character(len=*), intent(out), optional :: err_msg
   1302 
   1303  character(len=54) :: err_msg_local
   1304  integer :: nbad
   1305 !-----------------------------------------------
   1306 
   1307    if (.not.module_is_initialized) then
   1308       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1309    endif
   1310 
   1311    if(present(err_msg)) err_msg=''
   1312 
   1313    call lookup_des3_k(temp, desat, nbad)
   1314 
   1315    if ( nbad == 0 ) then
   1316      if(present(err_msg)) err_msg = ''
   1317    else
   1318      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1319      if(show_all_bad_values) call show_all_bad ( temp )
   1320      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1321      if(fms_error_handler('lookup_des3',err_msg_local,err_msg)) return
   1322    endif
   1323 !-----------------------------------------------
   1324 
   1325  end subroutine lookup_des3_1d

Page 54          Source Listing                  LOOKUP_DES3_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_lookup_des3_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1297     R(8)            8     1     1        ARG,OUT          1313                              
 ERR_MSG                    Dummy  1297     CHAR                        scalar   ARG,OUT          1308,1311,1316,1321               
 ERR_MSG_LOCAL              Local  1303     CHAR            54          scalar                    1320,1321                         
 LOOKUP_DES3_1D             Subr   1297                                          PRIV                                               
 LOOKUP_DES3_K_1D           Subr   1313                                          PRIV             1313                              
 NBAD                       Local  1304     I(4)            4           scalar                    1313,1315,1320                    
 PRESENT                    Func   1311                                 scalar                    1311,1316                         
 TEMP                       Dummy  1297     R(8)            8     1     1        ARG,IN           1313,1318,1319                    

Page 55          Source Listing                  LOOKUP_DES3_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1326 
   1327 !#######################################################################
   1328 
   1329 ! <SUBROUTINE NAME="lookup_des3_2d" INTERFACE="lookup_des3">
   1330 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
   1331 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
   1332 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1333 ! </SUBROUTINE>
   1334  subroutine lookup_des3_2d ( temp, desat, err_msg )
   1335 
   1336  real, intent(in)  :: temp (:,:)
   1337  real, intent(out) :: desat(:,:)
   1338  character(len=*), intent(out), optional :: err_msg
   1339 
   1340  character(len=54) :: err_msg_local
   1341  integer :: nbad
   1342 !-----------------------------------------------
   1343 
   1344    if (.not.module_is_initialized) then
   1345       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1346    endif
   1347 
   1348    call lookup_des3_k(temp, desat, nbad)
   1349 
   1350    if ( nbad == 0 ) then
   1351      if(present(err_msg)) err_msg = ''
   1352    else
   1353      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1354      if(show_all_bad_values) call show_all_bad ( temp )
   1355      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1356      if(fms_error_handler('lookup_des3',err_msg_local,err_msg)) return
   1357    endif
   1358 !-----------------------------------------------
   1359 
   1360  end subroutine lookup_des3_2d

Page 56          Source Listing                  LOOKUP_DES3_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_lookup_des3_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1334     R(8)            8     2     1        ARG,OUT          1348                              
 ERR_MSG                    Dummy  1334     CHAR                        scalar   ARG,OUT          1345,1351,1356                    
 ERR_MSG_LOCAL              Local  1340     CHAR            54          scalar                    1355,1356                         
 LOOKUP_DES3_2D             Subr   1334                                          PRIV                                               
 LOOKUP_DES3_K_2D           Subr   1348                                          PRIV             1348                              
 NBAD                       Local  1341     I(4)            4           scalar                    1348,1350,1355                    
 PRESENT                    Func   1351                                 scalar                    1351                              
 TEMP                       Dummy  1334     R(8)            8     2     1        ARG,IN           1348,1353,1354                    

Page 57          Source Listing                  LOOKUP_DES3_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1361 
   1362 !#######################################################################
   1363 ! <SUBROUTINE NAME="lookup_des3_3d" INTERFACE="lookup_des3">
   1364 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
   1365 !   <OUT NAME="desat" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
   1366 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1367 ! </SUBROUTINE>
   1368  subroutine lookup_des3_3d ( temp, desat, err_msg )
   1369 
   1370  real, intent(in)  :: temp (:,:,:)
   1371  real, intent(out) :: desat(:,:,:)
   1372  character(len=*), intent(out), optional :: err_msg
   1373 
   1374  integer :: nbad
   1375  character(len=128) :: err_msg_tmp
   1376 
   1377    if (.not.module_is_initialized) then
   1378       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1379    endif
   1380 
   1381    call lookup_des3_k( temp, desat, nbad )
   1382 
   1383    if ( nbad == 0 ) then
   1384      if(present(err_msg)) err_msg=''
   1385    else
   1386      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1387      if(show_all_bad_values) call show_all_bad ( temp )
   1388      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1389      if(fms_error_handler('lookup_des3',err_msg_tmp,err_msg)) return
   1390    endif
   1391 
   1392  end subroutine lookup_des3_3d

Page 58          Source Listing                  LOOKUP_DES3_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_lookup_des3_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1368     R(8)            8     3     1        ARG,OUT          1381                              
 ERR_MSG                    Dummy  1368     CHAR                        scalar   ARG,OUT          1378,1384,1389                    
 ERR_MSG_TMP                Local  1375     CHAR            128         scalar                    1388,1389                         
 LOOKUP_DES3_3D             Subr   1368                                          PRIV                                               
 LOOKUP_DES3_K_3D           Subr   1381                                          PRIV             1381                              
 NBAD                       Local  1374     I(4)            4           scalar                    1381,1383,1388                    
 PRESENT                    Func   1384                                 scalar                    1384                              
 TEMP                       Dummy  1368     R(8)            8     3     1        ARG,IN           1381,1386,1387                    

Page 59          Source Listing                  LOOKUP_DES3_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1393 
   1394 !========================================================================================================
   1395 
   1396 !#######################################################################
   1397 
   1398 ! <SUBROUTINE NAME="lookup_es_des_0d" INTERFACE="lookup_es_des">
   1399 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
   1400 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
   1401 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(scalar)"></OUT>
   1402 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1403 ! </SUBROUTINE>
   1404  subroutine lookup_es_des_0d ( temp, esat, desat, err_msg )
   1405 
   1406  real, intent(in)  :: temp
   1407  real, intent(out) :: esat, desat
   1408  character(len=*), intent(out), optional :: err_msg
   1409 
   1410  integer :: nbad
   1411  character(len=128) :: err_msg_local
   1412 
   1413    if (.not.module_is_initialized) then
   1414       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1415    endif
   1416 
   1417    call lookup_es_des_k(temp, esat, desat, nbad)
   1418 
   1419    if ( nbad == 0 ) then
   1420      if(present(err_msg)) err_msg = ''
   1421    else
   1422      if(show_all_bad_values) call show_all_bad ( temp )
   1423      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1424      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
   1425    endif
   1426 
   1427  end subroutine lookup_es_des_0d

Page 60          Source Listing                  LOOKUP_ES_DES_0D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                               
                                                     
 sat_vapor_pres_mod_mp_lookup_es_des_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1404     R(8)            8           scalar   ARG,OUT          1417                              
 ERR_MSG                    Dummy  1404     CHAR                        scalar   ARG,OUT          1414,1420,1424                    
 ERR_MSG_LOCAL              Local  1411     CHAR            128         scalar                    1423,1424                         
 ESAT                       Dummy  1404     R(8)            8           scalar   ARG,OUT          1417                              
 LOOKUP_ES_DES_0D           Subr   1404                                          PRIV                                               
 LOOKUP_ES_DES_K            Local  1417                                 scalar   PRIV             140,1417,1450,1484,1518           
 LOOKUP_ES_DES_K_0D         Subr   1417                                          PRIV             1417                              
 NBAD                       Local  1410     I(4)            4           scalar                    1417,1419,1423                    
 PRESENT                    Func   1420                                 scalar                    1420                              
 TEMP                       Dummy  1404     R(8)            8           scalar   ARG,IN           1417,1422                         

Page 61          Source Listing                  LOOKUP_ES_DES_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1428 
   1429 !#######################################################################
   1430 
   1431 ! <SUBROUTINE NAME="lookup_es_des_1d" INTERFACE="lookup_es_des">
   1432 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
   1433 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
   1434 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(:)"></OUT>
   1435 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1436 ! </SUBROUTINE>
   1437  subroutine lookup_es_des_1d ( temp, esat, desat, err_msg )
   1438 
   1439  real, dimension(:), intent(in)  :: temp
   1440  real, dimension(:), intent(out) :: esat, desat
   1441  character(len=*), intent(out), optional :: err_msg
   1442 
   1443  integer :: nbad
   1444  character(len=128) :: err_msg_local
   1445 
   1446    if (.not.module_is_initialized) then
   1447       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1448    endif
   1449 
   1450    call lookup_es_des_k(temp, esat, desat, nbad)
   1451 
   1452    if ( nbad == 0 ) then
   1453      if(present(err_msg)) err_msg = ''
   1454    else
   1455      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1456      if(show_all_bad_values) call show_all_bad ( temp )
   1457      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1458      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
   1459    endif
   1460 
   1461  end subroutine lookup_es_des_1d

Page 62          Source Listing                  LOOKUP_ES_DES_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                               
                                                     
 sat_vapor_pres_mod_mp_lookup_es_des_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1437     R(8)            8     1     1        ARG,OUT          1450                              
 ERR_MSG                    Dummy  1437     CHAR                        scalar   ARG,OUT          1447,1453,1458                    
 ERR_MSG_LOCAL              Local  1444     CHAR            128         scalar                    1457,1458                         
 ESAT                       Dummy  1437     R(8)            8     1     1        ARG,OUT          1450                              
 LOOKUP_ES_DES_1D           Subr   1437                                          PRIV                                               
 LOOKUP_ES_DES_K_1D         Subr   1450                                          PRIV             1450                              
 NBAD                       Local  1443     I(4)            4           scalar                    1450,1452,1457                    
 PRESENT                    Func   1453                                 scalar                    1453                              
 TEMP                       Dummy  1437     R(8)            8     1     1        ARG,IN           1450,1455,1456                    

Page 63          Source Listing                  LOOKUP_ES_DES_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1462 
   1463 !#######################################################################
   1464 
   1465 ! <SUBROUTINE NAME="lookup_es_des_2d" INTERFACE="lookup_es_des">
   1466 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
   1467 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
   1468 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(:,:)"></OUT>
   1469 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1470 ! </SUBROUTINE>
   1471  subroutine lookup_es_des_2d ( temp, esat, desat, err_msg )
   1472 
   1473  real, dimension(:,:), intent(in)  :: temp
   1474  real, dimension(:,:), intent(out) :: esat, desat
   1475  character(len=*), intent(out), optional :: err_msg
   1476 
   1477  integer :: nbad
   1478  character(len=128) :: err_msg_local
   1479 
   1480    if (.not.module_is_initialized) then
   1481       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1482    endif
   1483 
   1484    call lookup_es_des_k(temp, esat, desat, nbad)
   1485 
   1486    if ( nbad == 0 ) then
   1487      if(present(err_msg)) err_msg = ''
   1488    else
   1489      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1490      if(show_all_bad_values) call show_all_bad ( temp )
   1491      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1492      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
   1493    endif
   1494 
   1495  end subroutine lookup_es_des_2d

Page 64          Source Listing                  LOOKUP_ES_DES_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                               
                                                     
 sat_vapor_pres_mod_mp_lookup_es_des_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1471     R(8)            8     2     1        ARG,OUT          1484                              
 ERR_MSG                    Dummy  1471     CHAR                        scalar   ARG,OUT          1481,1487,1492                    
 ERR_MSG_LOCAL              Local  1478     CHAR            128         scalar                    1491,1492                         
 ESAT                       Dummy  1471     R(8)            8     2     1        ARG,OUT          1484                              
 LOOKUP_ES_DES_2D           Subr   1471                                          PRIV                                               
 LOOKUP_ES_DES_K_2D         Subr   1484                                          PRIV             1484                              
 NBAD                       Local  1477     I(4)            4           scalar                    1484,1486,1491                    
 PRESENT                    Func   1487                                 scalar                    1487                              
 TEMP                       Dummy  1471     R(8)            8     2     1        ARG,IN           1484,1489,1490                    

Page 65          Source Listing                  LOOKUP_ES_DES_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1496 
   1497 !#######################################################################
   1498 
   1499 ! <SUBROUTINE NAME="lookup_es_des_3d" INTERFACE="lookup_es_des">
   1500 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
   1501 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
   1502 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(:,:,:)"></OUT>
   1503 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1504 ! </SUBROUTINE>
   1505  subroutine lookup_es_des_3d ( temp, esat, desat, err_msg )
   1506 
   1507  real, dimension(:,:,:), intent(in)  :: temp
   1508  real, dimension(:,:,:), intent(out) :: esat, desat
   1509  character(len=*), intent(out), optional :: err_msg
   1510 
   1511  integer :: nbad
   1512  character(len=128) :: err_msg_local
   1513 
   1514    if (.not.module_is_initialized) then
   1515       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1516    endif
   1517 
   1518    call lookup_es_des_k(temp, esat, desat, nbad)
   1519 
   1520    if ( nbad == 0 ) then
   1521      if(present(err_msg)) err_msg = ''
   1522    else
   1523      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1524      if(show_all_bad_values) call show_all_bad ( temp )
   1525      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1526      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
   1527    endif
   1528 
   1529  end subroutine lookup_es_des_3d

Page 66          Source Listing                  LOOKUP_ES_DES_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                               
                                                     
 sat_vapor_pres_mod_mp_lookup_es_des_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1505     R(8)            8     3     1        ARG,OUT          1518                              
 ERR_MSG                    Dummy  1505     CHAR                        scalar   ARG,OUT          1515,1521,1526                    
 ERR_MSG_LOCAL              Local  1512     CHAR            128         scalar                    1525,1526                         
 ESAT                       Dummy  1505     R(8)            8     3     1        ARG,OUT          1518                              
 LOOKUP_ES_DES_3D           Subr   1505                                          PRIV                                               
 LOOKUP_ES_DES_K_3D         Subr   1518                                          PRIV             1518                              
 NBAD                       Local  1511     I(4)            4           scalar                    1518,1520,1525                    
 PRESENT                    Func   1521                                 scalar                    1521                              
 TEMP                       Dummy  1505     R(8)            8     3     1        ARG,IN           1518,1523,1524                    

Page 67          Source Listing                  LOOKUP_ES_DES_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1530 
   1531 !#######################################################################
   1532 !#######################################################################
   1533 
   1534 ! <SUBROUTINE NAME="lookup_es2_des2_0d" INTERFACE="lookup_es2_des2">
   1535 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
   1536 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
   1537 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(scalar)"></OUT>
   1538 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1539 ! </SUBROUTINE>
   1540  subroutine lookup_es2_des2_0d ( temp, esat, desat, err_msg )
   1541 
   1542  real, intent(in)  :: temp
   1543  real, intent(out) :: esat, desat
   1544  character(len=*), intent(out), optional :: err_msg
   1545 
   1546  integer :: nbad
   1547  character(len=128) :: err_msg_local
   1548 
   1549    if (.not.module_is_initialized) then
   1550       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1551    endif
   1552 
   1553    call lookup_es2_des2_k(temp, esat, desat, nbad)
   1554 
   1555    if ( nbad == 0 ) then
   1556      if(present(err_msg)) err_msg = ''
   1557    else
   1558      if(show_all_bad_values) call show_all_bad ( temp )
   1559      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1560      if(fms_error_handler('lookup_es2_des2',err_msg_local,err_msg)) return
   1561    endif
   1562 
   1563  end subroutine lookup_es2_des2_0d

Page 68          Source Listing                  LOOKUP_ES2_DES2_0D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_mod_mp_lookup_es2_des2_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1540     R(8)            8           scalar   ARG,OUT          1553                              
 ERR_MSG                    Dummy  1540     CHAR                        scalar   ARG,OUT          1550,1556,1560                    
 ERR_MSG_LOCAL              Local  1547     CHAR            128         scalar                    1559,1560                         
 ESAT                       Dummy  1540     R(8)            8           scalar   ARG,OUT          1553                              
 LOOKUP_ES2_DES2_0D         Subr   1540                                          PRIV                                               
 LOOKUP_ES2_DES2_K          Local  1553                                 scalar   PRIV             142,1553,1586,1620,1654           
 LOOKUP_ES2_DES2_K_0D       Subr   1553                                          PRIV             1553                              
 NBAD                       Local  1546     I(4)            4           scalar                    1553,1555,1559                    
 PRESENT                    Func   1556                                 scalar                    1556                              
 TEMP                       Dummy  1540     R(8)            8           scalar   ARG,IN           1553,1558                         

Page 69          Source Listing                  LOOKUP_ES2_DES2_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1564 
   1565 !#######################################################################
   1566 
   1567 ! <SUBROUTINE NAME="lookup_es2_des2_1d" INTERFACE="lookup_es2_des2">
   1568 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
   1569 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
   1570 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(:)"></OUT>
   1571 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1572 ! </SUBROUTINE>
   1573  subroutine lookup_es2_des2_1d ( temp, esat, desat, err_msg )
   1574 
   1575  real, dimension(:), intent(in)  :: temp
   1576  real, dimension(:), intent(out) :: esat, desat
   1577  character(len=*), intent(out), optional :: err_msg
   1578 
   1579  integer :: nbad
   1580  character(len=128) :: err_msg_local
   1581 
   1582    if (.not.module_is_initialized) then
   1583       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1584    endif
   1585 
   1586    call lookup_es2_des2_k(temp, esat, desat, nbad)
   1587 
   1588    if ( nbad == 0 ) then
   1589      if(present(err_msg)) err_msg = ''
   1590    else
   1591      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1592      if(show_all_bad_values) call show_all_bad ( temp )
   1593      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1594      if(fms_error_handler('lookup_es2_des2',err_msg_local,err_msg)) return
   1595    endif
   1596 
   1597  end subroutine lookup_es2_des2_1d

Page 70          Source Listing                  LOOKUP_ES2_DES2_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_mod_mp_lookup_es2_des2_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1573     R(8)            8     1     1        ARG,OUT          1586                              
 ERR_MSG                    Dummy  1573     CHAR                        scalar   ARG,OUT          1583,1589,1594                    
 ERR_MSG_LOCAL              Local  1580     CHAR            128         scalar                    1593,1594                         
 ESAT                       Dummy  1573     R(8)            8     1     1        ARG,OUT          1586                              
 LOOKUP_ES2_DES2_1D         Subr   1573                                          PRIV                                               
 LOOKUP_ES2_DES2_K_1D       Subr   1586                                          PRIV             1586                              
 NBAD                       Local  1579     I(4)            4           scalar                    1586,1588,1593                    
 PRESENT                    Func   1589                                 scalar                    1589                              
 TEMP                       Dummy  1573     R(8)            8     1     1        ARG,IN           1586,1591,1592                    

Page 71          Source Listing                  LOOKUP_ES2_DES2_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1598 
   1599 !#######################################################################
   1600 
   1601 ! <SUBROUTINE NAME="lookup_es2_des2_2d" INTERFACE="lookup_es2_des2">
   1602 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
   1603 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
   1604 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(:,:)"></OUT>
   1605 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1606 ! </SUBROUTINE>
   1607  subroutine lookup_es2_des2_2d ( temp, esat, desat, err_msg )
   1608 
   1609  real, dimension(:,:), intent(in)  :: temp
   1610  real, dimension(:,:), intent(out) :: esat, desat
   1611  character(len=*), intent(out), optional :: err_msg
   1612 
   1613  integer :: nbad
   1614  character(len=128) :: err_msg_local
   1615 
   1616    if (.not.module_is_initialized) then
   1617       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1618    endif
   1619 
   1620    call lookup_es2_des2_k(temp, esat, desat, nbad)
   1621 
   1622    if ( nbad == 0 ) then
   1623      if(present(err_msg)) err_msg = ''
   1624    else
   1625      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1626      if(show_all_bad_values) call show_all_bad ( temp )
   1627      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1628      if(fms_error_handler('lookup_es2_des2',err_msg_local,err_msg)) return
   1629    endif
   1630 
   1631  end subroutine lookup_es2_des2_2d

Page 72          Source Listing                  LOOKUP_ES2_DES2_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_mod_mp_lookup_es2_des2_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1607     R(8)            8     2     1        ARG,OUT          1620                              
 ERR_MSG                    Dummy  1607     CHAR                        scalar   ARG,OUT          1617,1623,1628                    
 ERR_MSG_LOCAL              Local  1614     CHAR            128         scalar                    1627,1628                         
 ESAT                       Dummy  1607     R(8)            8     2     1        ARG,OUT          1620                              
 LOOKUP_ES2_DES2_2D         Subr   1607                                          PRIV                                               
 LOOKUP_ES2_DES2_K_2D       Subr   1620                                          PRIV             1620                              
 NBAD                       Local  1613     I(4)            4           scalar                    1620,1622,1627                    
 PRESENT                    Func   1623                                 scalar                    1623                              
 TEMP                       Dummy  1607     R(8)            8     2     1        ARG,IN           1620,1625,1626                    

Page 73          Source Listing                  LOOKUP_ES2_DES2_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1632 
   1633 !#######################################################################
   1634 
   1635 ! <SUBROUTINE NAME="lookup_es2_des2_3d" INTERFACE="lookup_es2_des2">
   1636 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
   1637 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
   1638 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(:,:,:)"></OUT>
   1639 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1640 ! </SUBROUTINE>
   1641  subroutine lookup_es2_des2_3d ( temp, esat, desat, err_msg )
   1642 
   1643  real, dimension(:,:,:), intent(in)  :: temp
   1644  real, dimension(:,:,:), intent(out) :: esat, desat
   1645  character(len=*), intent(out), optional :: err_msg
   1646 
   1647  integer :: nbad
   1648  character(len=128) :: err_msg_local
   1649 
   1650    if (.not.module_is_initialized) then
   1651       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1652    endif
   1653 
   1654    call lookup_es2_des2_k(temp, esat, desat, nbad)
   1655 
   1656    if ( nbad == 0 ) then
   1657      if(present(err_msg)) err_msg = ''
   1658    else
   1659      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1660      if(show_all_bad_values) call show_all_bad ( temp )
   1661      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1662      if(fms_error_handler('lookup_es2_des2',err_msg_local,err_msg)) return
   1663    endif
   1664 
   1665  end subroutine lookup_es2_des2_3d

Page 74          Source Listing                  LOOKUP_ES2_DES2_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_mod_mp_lookup_es2_des2_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1641     R(8)            8     3     1        ARG,OUT          1654                              
 ERR_MSG                    Dummy  1641     CHAR                        scalar   ARG,OUT          1651,1657,1662                    
 ERR_MSG_LOCAL              Local  1648     CHAR            128         scalar                    1661,1662                         
 ESAT                       Dummy  1641     R(8)            8     3     1        ARG,OUT          1654                              
 LOOKUP_ES2_DES2_3D         Subr   1641                                          PRIV                                               
 LOOKUP_ES2_DES2_K_3D       Subr   1654                                          PRIV             1654                              
 NBAD                       Local  1647     I(4)            4           scalar                    1654,1656,1661                    
 PRESENT                    Func   1657                                 scalar                    1657                              
 TEMP                       Dummy  1641     R(8)            8     3     1        ARG,IN           1654,1659,1660                    

Page 75          Source Listing                  LOOKUP_ES2_DES2_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1666 
   1667 
   1668 !#######################################################################
   1669 !#######################################################################
   1670 
   1671 ! <SUBROUTINE NAME="lookup_es3_des3_0d" INTERFACE="lookup_es3_des3">
   1672 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
   1673 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
   1674 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(scalar)"></OUT>
   1675 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1676 ! </SUBROUTINE>
   1677  subroutine lookup_es3_des3_0d ( temp, esat, desat, err_msg )
   1678 
   1679  real, intent(in)  :: temp
   1680  real, intent(out) :: esat, desat
   1681  character(len=*), intent(out), optional :: err_msg
   1682 
   1683  integer :: nbad
   1684  character(len=128) :: err_msg_local
   1685 
   1686    if (.not.module_is_initialized) then
   1687       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1688    endif
   1689 
   1690    call lookup_es3_des3_k(temp, esat, desat, nbad)
   1691 
   1692    if ( nbad == 0 ) then
   1693      if(present(err_msg)) err_msg = ''
   1694    else
   1695      if(show_all_bad_values) call show_all_bad ( temp )
   1696      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1697      if(fms_error_handler('lookup_es3_des3',err_msg_local,err_msg)) return
   1698    endif
   1699 
   1700  end subroutine lookup_es3_des3_0d

Page 76          Source Listing                  LOOKUP_ES3_DES3_0D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_mod_mp_lookup_es3_des3_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1677     R(8)            8           scalar   ARG,OUT          1690                              
 ERR_MSG                    Dummy  1677     CHAR                        scalar   ARG,OUT          1687,1693,1697                    
 ERR_MSG_LOCAL              Local  1684     CHAR            128         scalar                    1696,1697                         
 ESAT                       Dummy  1677     R(8)            8           scalar   ARG,OUT          1690                              
 LOOKUP_ES3_DES3_0D         Subr   1677                                          PRIV                                               
 LOOKUP_ES3_DES3_K          Local  1690                                 scalar   PRIV             144,1690,1723,1757,1791           
 LOOKUP_ES3_DES3_K_0D       Subr   1690                                          PRIV             1690                              
 NBAD                       Local  1683     I(4)            4           scalar                    1690,1692,1696                    
 PRESENT                    Func   1693                                 scalar                    1693                              
 TEMP                       Dummy  1677     R(8)            8           scalar   ARG,IN           1690,1695                         

Page 77          Source Listing                  LOOKUP_ES3_DES3_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1701 
   1702 !#######################################################################
   1703 
   1704 ! <SUBROUTINE NAME="lookup_es3_des3_1d" INTERFACE="lookup_es3_des3">
   1705 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
   1706 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
   1707 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(:)"></OUT>
   1708 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1709 ! </SUBROUTINE>
   1710  subroutine lookup_es3_des3_1d ( temp, esat, desat, err_msg )
   1711 
   1712  real, dimension(:), intent(in)  :: temp
   1713  real, dimension(:), intent(out) :: esat, desat
   1714  character(len=*), intent(out), optional :: err_msg
   1715 
   1716  integer :: nbad
   1717  character(len=128) :: err_msg_local
   1718 
   1719    if (.not.module_is_initialized) then
   1720       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1721    endif
   1722 
   1723    call lookup_es3_des3_k(temp, esat, desat, nbad)
   1724 
   1725    if ( nbad == 0 ) then
   1726      if(present(err_msg)) err_msg = ''
   1727    else
   1728      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1729      if(show_all_bad_values) call show_all_bad ( temp )
   1730      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1731      if(fms_error_handler('lookup_es3_des3',err_msg_local,err_msg)) return
   1732    endif
   1733 
   1734  end subroutine lookup_es3_des3_1d

Page 78          Source Listing                  LOOKUP_ES3_DES3_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_mod_mp_lookup_es3_des3_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1710     R(8)            8     1     1        ARG,OUT          1723                              
 ERR_MSG                    Dummy  1710     CHAR                        scalar   ARG,OUT          1720,1726,1731                    
 ERR_MSG_LOCAL              Local  1717     CHAR            128         scalar                    1730,1731                         
 ESAT                       Dummy  1710     R(8)            8     1     1        ARG,OUT          1723                              
 LOOKUP_ES3_DES3_1D         Subr   1710                                          PRIV                                               
 LOOKUP_ES3_DES3_K_1D       Subr   1723                                          PRIV             1723                              
 NBAD                       Local  1716     I(4)            4           scalar                    1723,1725,1730                    
 PRESENT                    Func   1726                                 scalar                    1726                              
 TEMP                       Dummy  1710     R(8)            8     1     1        ARG,IN           1723,1728,1729                    

Page 79          Source Listing                  LOOKUP_ES3_DES3_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1735 
   1736 !#######################################################################
   1737 
   1738 ! <SUBROUTINE NAME="lookup_es3_des3_2d" INTERFACE="lookup_es3_des3">
   1739 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
   1740 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
   1741 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(:,:)"></OUT>
   1742 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1743 ! </SUBROUTINE>
   1744  subroutine lookup_es3_des3_2d ( temp, esat, desat, err_msg )
   1745 
   1746  real, dimension(:,:), intent(in)  :: temp
   1747  real, dimension(:,:), intent(out) :: esat, desat
   1748  character(len=*), intent(out), optional :: err_msg
   1749 
   1750  integer :: nbad
   1751  character(len=128) :: err_msg_local
   1752 
   1753    if (.not.module_is_initialized) then
   1754       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1755    endif
   1756 
   1757    call lookup_es3_des3_k(temp, esat, desat, nbad)
   1758 
   1759    if ( nbad == 0 ) then
   1760      if(present(err_msg)) err_msg = ''
   1761    else
   1762      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1763      if(show_all_bad_values) call show_all_bad ( temp )
   1764      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1765      if(fms_error_handler('lookup_es3_des3',err_msg_local,err_msg)) return
   1766    endif
   1767 
   1768  end subroutine lookup_es3_des3_2d

Page 80          Source Listing                  LOOKUP_ES3_DES3_2D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_mod_mp_lookup_es3_des3_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1744     R(8)            8     2     1        ARG,OUT          1757                              
 ERR_MSG                    Dummy  1744     CHAR                        scalar   ARG,OUT          1754,1760,1765                    
 ERR_MSG_LOCAL              Local  1751     CHAR            128         scalar                    1764,1765                         
 ESAT                       Dummy  1744     R(8)            8     2     1        ARG,OUT          1757                              
 LOOKUP_ES3_DES3_2D         Subr   1744                                          PRIV                                               
 LOOKUP_ES3_DES3_K_2D       Subr   1757                                          PRIV             1757                              
 NBAD                       Local  1750     I(4)            4           scalar                    1757,1759,1764                    
 PRESENT                    Func   1760                                 scalar                    1760                              
 TEMP                       Dummy  1744     R(8)            8     2     1        ARG,IN           1757,1762,1763                    

Page 81          Source Listing                  LOOKUP_ES3_DES3_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1769 
   1770 !#######################################################################
   1771 
   1772 ! <SUBROUTINE NAME="lookup_es3_des3_3d" INTERFACE="lookup_es3_des3">
   1773 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
   1774 !   <OUT NAME="esat" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
   1775 !   <OUT NAME="desat" UNITS="pascal / degree" TYPE="real" DIM="(:,:,:)"></OUT>
   1776 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1777 ! </SUBROUTINE>
   1778  subroutine lookup_es3_des3_3d ( temp, esat, desat, err_msg )
   1779 
   1780  real, dimension(:,:,:), intent(in)  :: temp
   1781  real, dimension(:,:,:), intent(out) :: esat, desat
   1782  character(len=*), intent(out), optional :: err_msg
   1783 
   1784  integer :: nbad
   1785  character(len=128) :: err_msg_local
   1786 
   1787    if (.not.module_is_initialized) then
   1788       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1789    endif
   1790 
   1791    call lookup_es3_des3_k(temp, esat, desat, nbad)
   1792 
   1793    if ( nbad == 0 ) then
   1794      if(present(err_msg)) err_msg = ''
   1795    else
   1796      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1797      if(show_all_bad_values) call show_all_bad ( temp )
   1798      write(err_msg_local,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1799      if(fms_error_handler('lookup_es3_des3',err_msg_local,err_msg)) return
   1800    endif
   1801 
   1802  end subroutine lookup_es3_des3_3d

Page 82          Source Listing                  LOOKUP_ES3_DES3_3D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                                 
                                                       
 sat_vapor_pres_mod_mp_lookup_es3_des3_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DESAT                      Dummy  1778     R(8)            8     3     1        ARG,OUT          1791                              
 ERR_MSG                    Dummy  1778     CHAR                        scalar   ARG,OUT          1788,1794,1799                    
 ERR_MSG_LOCAL              Local  1785     CHAR            128         scalar                    1798,1799                         
 ESAT                       Dummy  1778     R(8)            8     3     1        ARG,OUT          1791                              
 LOOKUP_ES3_DES3_3D         Subr   1778                                          PRIV                                               
 LOOKUP_ES3_DES3_K_3D       Subr   1791                                          PRIV             1791                              
 NBAD                       Local  1784     I(4)            4           scalar                    1791,1793,1798                    
 PRESENT                    Func   1794                                 scalar                    1794                              
 TEMP                       Dummy  1778     R(8)            8     3     1        ARG,IN           1791,1796,1797                    

Page 83          Source Listing                  LOOKUP_ES3_DES3_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1803 
   1804 !#######################################################################
   1805 
   1806 ! <SUBROUTINE NAME="compute_qs_0d" INTERFACE="compute_qs">
   1807 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(SCALAR)"></IN>
   1808 !   <IN NAME="press UNIT="Pascals" TYPE="real" DIM="(SCALAR)"></IN>
   1809 !   <OUT NAME="qsat" UNITS="kg(vapor)/kg(moist air)" TYPE="real" DIM="(SCALAR)"></OUT>
   1810 !   <IN NAME="q" UNIT="kg(vapor)/kg(moistair)" TYPE="real" DIM="(SCALAR)"></IN>
   1811 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)"></IN>
   1812 !   <OUT NAME="dqsdT" UNIT="kg(vapor)/kg(moistair)/ degree Kelvin" TYPE="real" DIM="(SCALAR)"></OUT>
   1813 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(scalar)"> </OUT>
   1814 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1815 ! </SUBROUTINE>
   1816  subroutine compute_qs_0d ( temp, press, qsat, q, hc, dqsdT, esat, &
   1817                             err_msg, es_over_liq, es_over_liq_and_ice )
   1818 
   1819  real, intent(in)                        :: temp, press
   1820  real, intent(out)                       :: qsat
   1821  real, intent(in),              optional :: q, hc
   1822  real, intent(out),             optional :: dqsdT, esat
   1823  character(len=*), intent(out), optional :: err_msg
   1824  logical,intent(in),            optional :: es_over_liq
   1825  logical,intent(in),            optional :: es_over_liq_and_ice
   1826 
   1827  integer :: nbad
   1828  character(len=128) :: err_msg_tmp
   1829 
   1830    if (.not.module_is_initialized) then
   1831       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1832    endif
   1833 
   1834    if (present(es_over_liq)) then
   1835      if (.not. (construct_table_wrt_liq)) then
   1836        call error_mesg ('compute_qs', &
   1837           'requesting es wrt liq, but that table not constructed', &
   1838                                                                 FATAL)
   1839      endif
   1840    endif
   1841    if (present(es_over_liq_and_ice)) then
   1842      if (.not. (construct_table_wrt_liq_and_ice)) then
   1843        call error_mesg ('compute_qs', &
   1844       'requesting es wrt liq and ice, but that table not constructed', &
   1845                                                                 FATAL)
   1846      endif
   1847    endif
   1848 
   1849    call compute_qs_k (temp, press,  EPSILO, ZVIR, qsat, nbad, q, hc, &
   1850                        dqsdT, esat, es_over_liq, es_over_liq_and_ice)
   1851 
   1852    if ( nbad == 0 ) then
   1853      if(present(err_msg)) err_msg = ''
   1854    else
   1855      if(show_all_bad_values) call show_all_bad ( temp )
   1856      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1857      if(fms_error_handler('compute_qs',err_msg_tmp,err_msg)) return
   1858    endif
   1859 

Page 84          Source Listing                  COMPUTE_QS_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1860  end subroutine compute_qs_0d


ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_compute_qs_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_QS_0D              Subr   1816                                          PRIV                                               
 COMPUTE_QS_K               Local  1849                                 scalar   PRIV             145,1849,1909,1971,2032           
 COMPUTE_QS_K_0D            Subr   1849                                          PRIV             1849                              
 CONSTRUCT_TABLE_WRT_LIQ    Local  1835     L(4)            4           scalar                    565,570,1835,1894,1956,2017,2079,2
                                                                                                  139,2201,2263,2358                
 CONSTRUCT_TABLE_WRT_LIQ_AN                                                                                                         
 D_ICE                      Local  1842     L(4)            4           scalar                    566,571,1842,1901,1963,2024,2086,2
                                                                                                  146,2208,2270,2359                
 DQSDT                      Dummy  1816     R(8)            8           scalar   ARG,OUT          1850                              
 EPSILO                     Param  1849     R(8)            8           scalar                    1849,1909,1971,2032,2093,2155,2217
                                                                                                  ,2279                             
 ERROR_MESG                 Subr   1836                                          PRIV             137,1836,1843,1895,1902,1957,1964,
                                                                                                  2018,2025,2080,2087,2140,2147,2202
                                                                                                  ,2209,2264,2271                   
 ERR_MSG                    Dummy  1817     CHAR                        scalar   ARG,OUT          1831,1853,1857                    
 ERR_MSG_TMP                Local  1828     CHAR            128         scalar                    1856,1857                         
 ESAT                       Dummy  1816     R(8)            8           scalar   ARG,OUT          1850                              
 ES_OVER_LIQ                Dummy  1817     L(4)            4           scalar   ARG,IN           1834,1850                         
 ES_OVER_LIQ_AND_ICE        Dummy  1817     L(4)            4           scalar   ARG,IN           1841,1850                         
 FATAL                      Param  1838     I(4)            4           scalar   PRIV             136,1838,1845,1897,1904,1959,1966,
                                                                                                  2020,2027,2082,2089,2142,2149,2204
                                                                                                  ,2211,2266,2273                   
 HC                         Dummy  1816     R(8)            8           scalar   ARG,IN           1849                              
 NBAD                       Local  1827     I(4)            4           scalar                    1849,1852,1856                    
 PRESENT                    Func   1834                                 scalar                    1834,1841,1853                    
 PRESS                      Dummy  1816     R(8)            8           scalar   ARG,IN           1849                              
 Q                          Dummy  1816     R(8)            8           scalar   ARG,IN           1849                              
 QSAT                       Dummy  1816     R(8)            8           scalar   ARG,OUT          1849                              
 TEMP                       Dummy  1816     R(8)            8           scalar   ARG,IN           1849,1855                         
 ZVIR                       Param  1849     R(8)            8           scalar                    1849,1909,1971,2032,2093,2155,2217
                                                                                                  ,2279                             

Page 85          Source Listing                  COMPUTE_QS_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1861 
   1862 !#######################################################################
   1863 
   1864 ! <SUBROUTINE NAME="compute_qs_1d" INTERFACE="compute_qs">
   1865 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
   1866 !   <IN NAME="press UNIT="Pascals" TYPE="real" DIM="(:)"></IN>
   1867 !   <OUT NAME="qsat" UNITS="kg(vapor)/kg(moist air)" TYPE="real" DIM="(:)"></OUT>
   1868 !   <IN NAME="q" UNIT="kg(vapor)/kg(moistair)" TYPE="real" DIM="(:)"></IN>
   1869 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)"></IN>
   1870 !   <OUT NAME="dqsdT" UNIT="kg(vapor)/kg(moistair)/ degree Kelvin" TYPE="real" DIM="(:)"></OUT>
   1871 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(:)"> </OUT>
   1872 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1873 ! </SUBROUTINE>
   1874  subroutine compute_qs_1d ( temp, press, qsat, q, hc, dqsdT, esat, &
   1875                             err_msg, es_over_liq, es_over_liq_and_ice )
   1876 
   1877  real, intent(in)                        :: temp(:), press(:)
   1878  real, intent(out)                       :: qsat(:)
   1879  real, intent(in),              optional :: q(:)
   1880 real,  intent(in),              optional :: hc
   1881  real, intent(out),             optional :: dqsdT(:), esat(:)
   1882  character(len=*), intent(out), optional :: err_msg
   1883  logical,intent(in),            optional :: es_over_liq
   1884  logical,intent(in),            optional :: es_over_liq_and_ice
   1885 
   1886  integer :: nbad
   1887  character(len=128) :: err_msg_tmp
   1888 
   1889    if (.not.module_is_initialized) then
   1890       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1891    endif
   1892 
   1893    if (present(es_over_liq)) then
   1894      if (.not. (construct_table_wrt_liq)) then
   1895        call error_mesg ('compute_qs', &
   1896           'requesting es wrt liq, but that table not constructed', &
   1897                                                                 FATAL)
   1898      endif
   1899    endif
   1900    if (present(es_over_liq_and_ice)) then
   1901      if (.not. (construct_table_wrt_liq_and_ice)) then
   1902        call error_mesg ('compute_qs', &
   1903       'requesting es wrt liq and ice, but that table not constructed', &
   1904                                                                 FATAL)
   1905      endif
   1906    endif
   1907 
   1908 !  call compute_qs_k (temp, press,  EPSILO, ZVIR, qsat, nbad, q, dqsdT)
   1909    call compute_qs_k (temp, press,  EPSILO, ZVIR, qsat, nbad, q, hc, &
   1910                        dqsdT, esat, es_over_liq, es_over_liq_and_ice)
   1911 
   1912    if ( nbad == 0 ) then
   1913      if(present(err_msg)) err_msg = ''
   1914    else
   1915      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1916      if(show_all_bad_values) call show_all_bad ( temp )
   1917      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad

Page 86          Source Listing                  COMPUTE_QS_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1918      if(fms_error_handler('compute_qs',err_msg_tmp,err_msg)) return
   1919    endif
   1920 
   1921  end subroutine compute_qs_1d


ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_compute_qs_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_QS_1D              Subr   1874                                          PRIV                                               
 COMPUTE_QS_K_1D            Subr   1909                                          PRIV             1909                              
 DQSDT                      Dummy  1874     R(8)            8     1     1        ARG,OUT          1910                              
 ERR_MSG                    Dummy  1875     CHAR                        scalar   ARG,OUT          1890,1913,1918                    
 ERR_MSG_TMP                Local  1887     CHAR            128         scalar                    1917,1918                         
 ESAT                       Dummy  1874     R(8)            8     1     1        ARG,OUT          1910                              
 ES_OVER_LIQ                Dummy  1875     L(4)            4           scalar   ARG,IN           1893,1910                         
 ES_OVER_LIQ_AND_ICE        Dummy  1875     L(4)            4           scalar   ARG,IN           1900,1910                         
 HC                         Dummy  1874     R(8)            8           scalar   ARG,IN           1909                              
 NBAD                       Local  1886     I(4)            4           scalar                    1909,1912,1917                    
 PRESENT                    Func   1893                                 scalar                    1893,1900,1913                    
 PRESS                      Dummy  1874     R(8)            8     1     1        ARG,IN           1909                              
 Q                          Dummy  1874     R(8)            8     1     1        ARG,IN           1909                              
 QSAT                       Dummy  1874     R(8)            8     1     1        ARG,OUT          1909                              
 TEMP                       Dummy  1874     R(8)            8     1     1        ARG,IN           1909,1915,1916                    

Page 87          Source Listing                  COMPUTE_QS_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1922 
   1923 
   1924 !#######################################################################
   1925 
   1926 ! <SUBROUTINE NAME="compute_qs_2d" INTERFACE="compute_qs">
   1927 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
   1928 !   <IN NAME="press UNIT="Pascals" TYPE="real" DIM="(:,:)"></IN>
   1929 !   <OUT NAME="qsat" UNITS="kg(vapor)/kg(moist air)" TYPE="real" DIM="(;,:)"></OUT>
   1930 !   <IN NAME="q" UNIT="kg(vapor)/kg(moistair)" TYPE="real" DIM="(:,:)"></IN>
   1931 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)"></IN>
   1932 !   <OUT NAME="dqsdT" UNIT="kg(vapor)/kg(moistair)/ degree Kelvin" TYPE="real" DIM="(:,:)"></OUT>
   1933 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(:,:)"> </OUT>
   1934 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1935 ! </SUBROUTINE>
   1936  subroutine compute_qs_2d ( temp, press, qsat, q, hc, dqsdT, esat, &
   1937                             err_msg, es_over_liq, es_over_liq_and_ice )
   1938 
   1939  real, intent(in)                        :: temp(:,:), press(:,:)
   1940  real, intent(out)                       :: qsat(:,:)
   1941  real, intent(in),              optional :: q(:,:)
   1942  real, intent(in),              optional :: hc
   1943  real, intent(out),             optional :: dqsdT(:,:), esat(:,:)
   1944  character(len=*), intent(out), optional :: err_msg
   1945  logical,intent(in),            optional :: es_over_liq
   1946  logical,intent(in),            optional :: es_over_liq_and_ice
   1947 
   1948  integer :: nbad
   1949  character(len=128) :: err_msg_tmp
   1950 
   1951    if (.not.module_is_initialized) then
   1952       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   1953    endif
   1954 
   1955    if (present(es_over_liq)) then
   1956      if (.not. (construct_table_wrt_liq)) then
   1957        call error_mesg ('compute_qs', &
   1958           'requesting es wrt liq, but that table not constructed', &
   1959                                                                 FATAL)
   1960      endif
   1961    endif
   1962    if (present(es_over_liq_and_ice)) then
   1963      if (.not. (construct_table_wrt_liq_and_ice)) then
   1964        call error_mesg ('compute_qs', &
   1965       'requesting es wrt liq and ice, but that table not constructed', &
   1966                                                                 FATAL)
   1967      endif
   1968    endif
   1969 
   1970 !  call compute_qs_k (temp, press,  EPSILO, ZVIR, qsat, nbad, q, dqsdT)
   1971    call compute_qs_k (temp, press,  EPSILO, ZVIR, qsat, nbad, q, hc, &
   1972                        dqsdT, esat, es_over_liq, es_over_liq_and_ice)
   1973 
   1974    if ( nbad == 0 ) then
   1975      if(present(err_msg)) err_msg = ''
   1976    else
   1977      if(show_bad_value_count_by_slice) call temp_check ( temp )
   1978      if(show_all_bad_values) call show_all_bad ( temp )

Page 88          Source Listing                  COMPUTE_QS_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1979      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   1980      if(fms_error_handler('compute_qs',err_msg_tmp,err_msg)) return
   1981    endif
   1982 
   1983  end subroutine compute_qs_2d


ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_compute_qs_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_QS_2D              Subr   1936                                          PRIV                                               
 COMPUTE_QS_K_2D            Subr   1971                                          PRIV             1971                              
 DQSDT                      Dummy  1936     R(8)            8     2     1        ARG,OUT          1972                              
 ERR_MSG                    Dummy  1937     CHAR                        scalar   ARG,OUT          1952,1975,1980                    
 ERR_MSG_TMP                Local  1949     CHAR            128         scalar                    1979,1980                         
 ESAT                       Dummy  1936     R(8)            8     2     1        ARG,OUT          1972                              
 ES_OVER_LIQ                Dummy  1937     L(4)            4           scalar   ARG,IN           1955,1972                         
 ES_OVER_LIQ_AND_ICE        Dummy  1937     L(4)            4           scalar   ARG,IN           1962,1972                         
 HC                         Dummy  1936     R(8)            8           scalar   ARG,IN           1971                              
 NBAD                       Local  1948     I(4)            4           scalar                    1971,1974,1979                    
 PRESENT                    Func   1955                                 scalar                    1955,1962,1975                    
 PRESS                      Dummy  1936     R(8)            8     2     1        ARG,IN           1971                              
 Q                          Dummy  1936     R(8)            8     2     1        ARG,IN           1971                              
 QSAT                       Dummy  1936     R(8)            8     2     1        ARG,OUT          1971                              
 TEMP                       Dummy  1936     R(8)            8     2     1        ARG,IN           1971,1977,1978                    

Page 89          Source Listing                  COMPUTE_QS_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   1984 
   1985 !#######################################################################
   1986 
   1987 ! <SUBROUTINE NAME="compute_qs_3d" INTERFACE="compute_qs">
   1988 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
   1989 !   <IN NAME="press UNIT="Pascals" TYPE="real" DIM="(:,:,:)"></IN>
   1990 !   <OUT NAME="qsat" UNITS="kg(vapor)/kg(moist air)" TYPE="real" DIM="(;,:,:)"></OUT>
   1991 !   <IN NAME="q" UNIT="kg(vapor)/kg(moistair)" TYPE="real" DIM="(:,:,:)"></IN>
   1992 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)"></IN>
   1993 !   <OUT NAME="dqsdT" UNIT="kg(vapor)/kg(moistair)/ degree Kelvin" TYPE="real" DIM="(:,:,:)"></OUT>
   1994 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(:,:,:)"> </OUT>
   1995 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   1996 ! </SUBROUTINE>
   1997  subroutine compute_qs_3d ( temp, press, qsat, q, hc, dqsdT, esat, &
   1998                             err_msg, es_over_liq, es_over_liq_and_ice )
   1999 
   2000  real, intent(in)                        :: temp(:,:,:), press(:,:,:)
   2001  real, intent(out)                       :: qsat(:,:,:)
   2002  real, intent(in),              optional :: q(:,:,:)
   2003  real, intent(in),              optional :: hc
   2004  real, intent(out),             optional :: dqsdT(:,:,:), esat(:,:,:)
   2005  character(len=*), intent(out), optional :: err_msg
   2006  logical,intent(in),            optional :: es_over_liq
   2007  logical,intent(in),            optional :: es_over_liq_and_ice
   2008 
   2009  integer :: nbad
   2010  character(len=128) :: err_msg_tmp
   2011 
   2012    if (.not.module_is_initialized) then
   2013       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   2014    endif
   2015 
   2016    if (present(es_over_liq)) then
   2017      if (.not. (construct_table_wrt_liq)) then
   2018        call error_mesg ('compute_qs', &
   2019           'requesting es wrt liq, but that table not constructed', &
   2020                                                                 FATAL)
   2021      endif
   2022    endif
   2023    if (present(es_over_liq_and_ice)) then
   2024      if (.not. (construct_table_wrt_liq_and_ice)) then
   2025        call error_mesg ('compute_qs', &
   2026       'requesting es wrt liq and ice, but that table not constructed', &
   2027                                                                 FATAL)
   2028      endif
   2029    endif
   2030 
   2031 !  call compute_qs_k (temp, press,  EPSILO, ZVIR, qsat, nbad, q, dqsdT)
   2032    call compute_qs_k (temp, press,  EPSILO, ZVIR, qsat, nbad, q, hc, &
   2033                        dqsdT, esat, es_over_liq, es_over_liq_and_ice)
   2034 
   2035 
   2036    if ( nbad == 0 ) then
   2037      if(present(err_msg)) err_msg = ''
   2038    else
   2039      if(show_bad_value_count_by_slice) call temp_check ( temp )
   2040      if(show_all_bad_values) call show_all_bad ( temp )

Page 90          Source Listing                  COMPUTE_QS_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2041      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   2042      if(fms_error_handler('compute_qs',err_msg_tmp,err_msg)) return
   2043    endif
   2044 
   2045  end subroutine compute_qs_3d


ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_compute_qs_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_QS_3D              Subr   1997                                          PRIV                                               
 COMPUTE_QS_K_3D            Subr   2032                                          PRIV             2032                              
 DQSDT                      Dummy  1997     R(8)            8     3     1        ARG,OUT          2033                              
 ERR_MSG                    Dummy  1998     CHAR                        scalar   ARG,OUT          2013,2037,2042                    
 ERR_MSG_TMP                Local  2010     CHAR            128         scalar                    2041,2042                         
 ESAT                       Dummy  1997     R(8)            8     3     1        ARG,OUT          2033                              
 ES_OVER_LIQ                Dummy  1998     L(4)            4           scalar   ARG,IN           2016,2033                         
 ES_OVER_LIQ_AND_ICE        Dummy  1998     L(4)            4           scalar   ARG,IN           2023,2033                         
 HC                         Dummy  1997     R(8)            8           scalar   ARG,IN           2032                              
 NBAD                       Local  2009     I(4)            4           scalar                    2032,2036,2041                    
 PRESENT                    Func   2016                                 scalar                    2016,2023,2037                    
 PRESS                      Dummy  1997     R(8)            8     3     1        ARG,IN           2032                              
 Q                          Dummy  1997     R(8)            8     3     1        ARG,IN           2032                              
 QSAT                       Dummy  1997     R(8)            8     3     1        ARG,OUT          2032                              
 TEMP                       Dummy  1997     R(8)            8     3     1        ARG,IN           2032,2039,2040                    

Page 91          Source Listing                  COMPUTE_QS_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2046 
   2047 !#######################################################################
   2048 !#######################################################################
   2049 
   2050 ! <SUBROUTINE NAME="compute_mrs_0d" INTERFACE="compute_mrs">
   2051 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(SCALAR)"></IN>
   2052 !   <IN NAME="press" UNIT="Pascals" TYPE="real" DIM="(SCALAR)"></IN>
   2053 !   <OUT NAME="mrsat" UNITS="kg(vapor)/kg(dry air)" TYPE="real" DIM="(SCALAR</OUT>
   2054 !   <IN NAME="mr" UNIT="kg(vapor)/kg(dry air)" TYPE="real" DIM="(SCALAR)"></IN>
   2055 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)"></IN>
   2056 !   <OUT NAME="dmrsdT" UNIT="kg(vapor)/kg(dry air)/ degree Kelvin" TYPE="real" DIM="(SCALAR)"></OUT>
   2057 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(scalar)"> </OUT>
   2058 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   2059 ! </SUBROUTINE>
   2060  subroutine compute_mrs_0d ( temp, press, mrsat, mr, hc, dmrsdT, esat, &
   2061                             err_msg, es_over_liq, es_over_liq_and_ice )
   2062 
   2063  real, intent(in)                        :: temp, press
   2064  real, intent(out)                       :: mrsat
   2065  real, intent(in),              optional :: mr, hc
   2066  real, intent(out),             optional :: dmrsdT, esat
   2067  character(len=*), intent(out), optional :: err_msg
   2068  logical,intent(in),            optional :: es_over_liq
   2069  logical,intent(in),            optional :: es_over_liq_and_ice
   2070 
   2071  integer :: nbad
   2072  character(len=128) :: err_msg_tmp
   2073 
   2074    if (.not.module_is_initialized) then
   2075       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   2076    endif
   2077 
   2078    if (present(es_over_liq)) then
   2079      if (.not. (construct_table_wrt_liq)) then
   2080        call error_mesg ('compute_mrs', &
   2081           'requesting es wrt liq, but that table not constructed', &
   2082                                                                 FATAL)
   2083      endif
   2084    endif
   2085    if (present(es_over_liq_and_ice)) then
   2086      if (.not. (construct_table_wrt_liq_and_ice)) then
   2087        call error_mesg ('compute_qs', &
   2088       'requesting es wrt liq and ice, but that table not constructed', &
   2089                                                                 FATAL)
   2090      endif
   2091    endif
   2092 
   2093    call compute_mrs_k (temp, press, EPSILO, ZVIR, mrsat, nbad, mr,  &
   2094                      hc, dmrsdT, esat, es_over_liq, es_over_liq_and_ice)
   2095 
   2096    if ( nbad == 0 ) then
   2097      if(present(err_msg)) err_msg = ''
   2098    else
   2099      if(show_all_bad_values) call show_all_bad ( temp )
   2100      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   2101      if(fms_error_handler('compute_mrs',err_msg_tmp,err_msg)) return
   2102    endif

Page 92          Source Listing                  COMPUTE_MRS_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2103 
   2104  end subroutine compute_mrs_0d


ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_compute_mrs_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS_0D             Subr   2060                                          PRIV                                               
 COMPUTE_MRS_K              Local  2093                                 scalar   PRIV             145,2093,2155,2217,2279           
 COMPUTE_MRS_K_0D           Subr   2093                                          PRIV             2093                              
 DMRSDT                     Dummy  2060     R(8)            8           scalar   ARG,OUT          2094                              
 ERR_MSG                    Dummy  2061     CHAR                        scalar   ARG,OUT          2075,2097,2101                    
 ERR_MSG_TMP                Local  2072     CHAR            128         scalar                    2100,2101                         
 ESAT                       Dummy  2060     R(8)            8           scalar   ARG,OUT          2094                              
 ES_OVER_LIQ                Dummy  2061     L(4)            4           scalar   ARG,IN           2078,2094                         
 ES_OVER_LIQ_AND_ICE        Dummy  2061     L(4)            4           scalar   ARG,IN           2085,2094                         
 HC                         Dummy  2060     R(8)            8           scalar   ARG,IN           2094                              
 MR                         Dummy  2060     R(8)            8           scalar   ARG,IN           2093                              
 MRSAT                      Dummy  2060     R(8)            8           scalar   ARG,OUT          2093                              
 NBAD                       Local  2071     I(4)            4           scalar                    2093,2096,2100                    
 PRESENT                    Func   2078                                 scalar                    2078,2085,2097                    
 PRESS                      Dummy  2060     R(8)            8           scalar   ARG,IN           2093                              
 TEMP                       Dummy  2060     R(8)            8           scalar   ARG,IN           2093,2099                         

Page 93          Source Listing                  COMPUTE_MRS_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2105 
   2106 !#######################################################################
   2107 !#######################################################################
   2108 
   2109 ! <SUBROUTINE NAME="compute_mrs_1d" INTERFACE="compute_mrs">
   2110 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
   2111 !   <IN NAME="press" UNIT="Pascals" TYPE="real" DIM="(:)"></IN>
   2112 !   <OUT NAME="mrsat" UNITS="kg(vapor)/kg(dry air)" TYPE="real" DIM="(:)"></OUT>
   2113 !   <IN NAME="mr" UNIT="kg(vapor)/kg(dry air)" TYPE="real" DIM="(:)"></IN>
   2114 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)"></IN>
   2115 !   <OUT NAME="dmrsdT" UNIT="kg(vapor)/kg(dry air)/ degree Kelvin" TYPE="real" DIM="(:)"></OUT>
   2116 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(:)"> </OUT>
   2117 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   2118 ! </SUBROUTINE>
   2119  subroutine compute_mrs_1d ( temp, press, mrsat, mr, hc, dmrsdT, esat,&
   2120                             err_msg, es_over_liq, es_over_liq_and_ice )
   2121 
   2122  real, intent(in)                        :: temp(:), press(:)
   2123  real, intent(out)                       :: mrsat(:)
   2124  real, intent(in),              optional :: mr(:)
   2125  real, intent(in),              optional :: hc
   2126  real, intent(out),             optional :: dmrsdT(:), esat(:)
   2127  character(len=*), intent(out), optional :: err_msg
   2128  logical,intent(in),            optional :: es_over_liq
   2129  logical,intent(in),            optional :: es_over_liq_and_ice
   2130 
   2131  integer :: nbad
   2132  character(len=128) :: err_msg_tmp
   2133 
   2134    if (.not.module_is_initialized) then
   2135       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   2136    endif
   2137 
   2138    if (present(es_over_liq)) then
   2139      if (.not. (construct_table_wrt_liq)) then
   2140        call error_mesg ('compute_mrs', &
   2141           'requesting es wrt liq, but that table not constructed', &
   2142                                                                 FATAL)
   2143      endif
   2144    endif
   2145    if (present(es_over_liq_and_ice)) then
   2146      if (.not. (construct_table_wrt_liq_and_ice)) then
   2147        call error_mesg ('compute_qs', &
   2148       'requesting es wrt liq and ice, but that table not constructed', &
   2149                                                                 FATAL)
   2150      endif
   2151    endif
   2152 
   2153 !  call compute_mrs_k (temp, press, EPSILO, ZVIR, mrsat,  &
   2154 !                                                     nbad, mr, dmrsdT)
   2155    call compute_mrs_k (temp, press, EPSILO, ZVIR, mrsat, nbad, mr,  &
   2156                      hc, dmrsdT, esat, es_over_liq, es_over_liq_and_ice)
   2157 
   2158    if ( nbad == 0 ) then
   2159      if(present(err_msg)) err_msg = ''
   2160    else
   2161      if(show_bad_value_count_by_slice) call temp_check ( temp )

Page 94          Source Listing                  COMPUTE_MRS_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2162      if(show_all_bad_values) call show_all_bad ( temp )
   2163      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   2164      if(fms_error_handler('compute_mrs',err_msg_tmp,err_msg)) return
   2165    endif
   2166 
   2167  end subroutine compute_mrs_1d


ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_compute_mrs_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS_1D             Subr   2119                                          PRIV                                               
 COMPUTE_MRS_K_1D           Subr   2155                                          PRIV             2155                              
 DMRSDT                     Dummy  2119     R(8)            8     1     1        ARG,OUT          2156                              
 ERR_MSG                    Dummy  2120     CHAR                        scalar   ARG,OUT          2135,2159,2164                    
 ERR_MSG_TMP                Local  2132     CHAR            128         scalar                    2163,2164                         
 ESAT                       Dummy  2119     R(8)            8     1     1        ARG,OUT          2156                              
 ES_OVER_LIQ                Dummy  2120     L(4)            4           scalar   ARG,IN           2138,2156                         
 ES_OVER_LIQ_AND_ICE        Dummy  2120     L(4)            4           scalar   ARG,IN           2145,2156                         
 HC                         Dummy  2119     R(8)            8           scalar   ARG,IN           2156                              
 MR                         Dummy  2119     R(8)            8     1     1        ARG,IN           2155                              
 MRSAT                      Dummy  2119     R(8)            8     1     1        ARG,OUT          2155                              
 NBAD                       Local  2131     I(4)            4           scalar                    2155,2158,2163                    
 PRESENT                    Func   2138                                 scalar                    2138,2145,2159                    
 PRESS                      Dummy  2119     R(8)            8     1     1        ARG,IN           2155                              
 TEMP                       Dummy  2119     R(8)            8     1     1        ARG,IN           2155,2161,2162                    

Page 95          Source Listing                  COMPUTE_MRS_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2168 
   2169 !#######################################################################
   2170 
   2171 ! <SUBROUTINE NAME="compute_mrs_2d" INTERFACE="compute_mrs">
   2172 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
   2173 !   <IN NAME="press" UNIT="Pascals" TYPE="real" DIM="(:,:)"></IN>
   2174 !   <OUT NAME="mrsat" UNITS="kg(vapor)/kg(dry air)" TYPE="real" DIM="(:,:)"></OUT>
   2175 !   <IN NAME="mr" UNIT="kg(vapor)/kg(dry air)" TYPE="real" DIM="(:,:)"></IN>
   2176 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)"></IN>
   2177 !   <OUT NAME="dmrsdT" UNIT="kg(vapor)/kg(dry air)/ degree Kelvin" TYPE="real" DIM="(:,:)"></OUT>
   2178 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(:,:)"> </OUT>
   2179 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   2180 ! </SUBROUTINE>
   2181  subroutine compute_mrs_2d ( temp, press, mrsat, mr, hc, dmrsdT, esat,&
   2182                             err_msg, es_over_liq, es_over_liq_and_ice )
   2183 
   2184  real, intent(in)                        :: temp(:,:), press(:,:)
   2185  real, intent(out)                       :: mrsat(:,:)
   2186  real, intent(in),              optional :: mr(:,:)
   2187  real, intent(in),              optional :: hc
   2188  real, intent(out),             optional :: dmrsdT(:,:), esat(:,:)
   2189  character(len=*), intent(out), optional :: err_msg
   2190  logical,intent(in),            optional :: es_over_liq
   2191  logical,intent(in),            optional :: es_over_liq_and_ice
   2192 
   2193  integer :: nbad
   2194  character(len=128) :: err_msg_tmp
   2195 
   2196    if (.not.module_is_initialized) then
   2197       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   2198    endif
   2199 
   2200    if (present(es_over_liq)) then
   2201      if (.not. (construct_table_wrt_liq)) then
   2202        call error_mesg ('compute_mrs', &
   2203           'requesting es wrt liq, but that table not constructed', &
   2204                                                                 FATAL)
   2205      endif
   2206    endif
   2207    if (present(es_over_liq_and_ice)) then
   2208      if (.not. (construct_table_wrt_liq_and_ice)) then
   2209        call error_mesg ('compute_qs', &
   2210       'requesting es wrt liq and ice, but that table not constructed', &
   2211                                                                 FATAL)
   2212      endif
   2213    endif
   2214 
   2215 !  call compute_mrs_k (temp, press, EPSILO, ZVIR, mrsat,  &
   2216 !                                                     nbad, mr, dmrsdT)
   2217    call compute_mrs_k (temp, press, EPSILO, ZVIR, mrsat, nbad, mr,  &
   2218                      hc, dmrsdT, esat, es_over_liq, es_over_liq_and_ice)
   2219 
   2220    if ( nbad == 0 ) then
   2221      if(present(err_msg)) err_msg = ''
   2222    else
   2223      if(show_bad_value_count_by_slice) call temp_check ( temp )
   2224      if(show_all_bad_values) call show_all_bad ( temp )

Page 96          Source Listing                  COMPUTE_MRS_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2225      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   2226      if(fms_error_handler('compute_mrs',err_msg_tmp,err_msg)) return
   2227    endif
   2228 
   2229  end subroutine compute_mrs_2d


ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_compute_mrs_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS_2D             Subr   2181                                          PRIV                                               
 COMPUTE_MRS_K_2D           Subr   2217                                          PRIV             2217                              
 DMRSDT                     Dummy  2181     R(8)            8     2     1        ARG,OUT          2218                              
 ERR_MSG                    Dummy  2182     CHAR                        scalar   ARG,OUT          2197,2221,2226                    
 ERR_MSG_TMP                Local  2194     CHAR            128         scalar                    2225,2226                         
 ESAT                       Dummy  2181     R(8)            8     2     1        ARG,OUT          2218                              
 ES_OVER_LIQ                Dummy  2182     L(4)            4           scalar   ARG,IN           2200,2218                         
 ES_OVER_LIQ_AND_ICE        Dummy  2182     L(4)            4           scalar   ARG,IN           2207,2218                         
 HC                         Dummy  2181     R(8)            8           scalar   ARG,IN           2218                              
 MR                         Dummy  2181     R(8)            8     2     1        ARG,IN           2217                              
 MRSAT                      Dummy  2181     R(8)            8     2     1        ARG,OUT          2217                              
 NBAD                       Local  2193     I(4)            4           scalar                    2217,2220,2225                    
 PRESENT                    Func   2200                                 scalar                    2200,2207,2221                    
 PRESS                      Dummy  2181     R(8)            8     2     1        ARG,IN           2217                              
 TEMP                       Dummy  2181     R(8)            8     2     1        ARG,IN           2217,2223,2224                    

Page 97          Source Listing                  COMPUTE_MRS_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2230 
   2231 !#######################################################################
   2232 
   2233 ! <SUBROUTINE NAME="compute_mrs_3d" INTERFACE="compute_mrs">
   2234 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
   2235 !   <IN NAME="press" UNIT="Pascals" TYPE="real" DIM="(:,:,:)"></IN>
   2236 !   <OUT NAME="mrsat" UNITS="kg(vapor)/kg(dry air)" TYPE="real" DIM="(:,:,:)"></OUT>
   2237 !   <IN NAME="mr" UNIT="kg(vapor)/kg(dry air)" TYPE="real" DIM="(:,:,:)"></IN>
   2238 !   <IN NAME="hc" UNIT="fraction" TYPE="real" DIM="(scalar)"></IN>
   2239 !   <OUT NAME="dmrsdT" UNIT="kg(vapor)/kg(dry air)/ degree Kelvin" TYPE="real" DIM="(:,:,:)"></OUT>
   2240 !   <OUT NAME="esat" UNITS="Pascals" TYPE="real" DIM="(:,:,:)"> </OUT>
   2241 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   2242 ! </SUBROUTINE>
   2243  subroutine compute_mrs_3d ( temp, press, mrsat, mr, hc, dmrsdT, esat,&
   2244                             err_msg, es_over_liq, es_over_liq_and_ice )
   2245 
   2246  real, intent(in)                        :: temp(:,:,:), press(:,:,:)
   2247  real, intent(out)                       :: mrsat(:,:,:)
   2248  real, intent(in),              optional :: mr(:,:,:)
   2249  real, intent(in),              optional :: hc
   2250  real, intent(out),             optional :: dmrsdT(:,:,:), esat(:,:,:)
   2251  character(len=*), intent(out), optional :: err_msg
   2252  logical,intent(in),            optional :: es_over_liq
   2253  logical,intent(in),            optional :: es_over_liq_and_ice
   2254 
   2255  integer :: nbad
   2256  character(len=128) :: err_msg_tmp
   2257 
   2258    if (.not.module_is_initialized) then
   2259       if(fms_error_handler('lookup_es','sat_vapor_pres_init is not called' ,err_msg)) return
   2260    endif
   2261 
   2262    if (present(es_over_liq)) then
   2263      if (.not. (construct_table_wrt_liq)) then
   2264        call error_mesg ('compute_mrs', &
   2265           'requesting es wrt liq, but that table not constructed', &
   2266                                                                 FATAL)
   2267      endif
   2268    endif
   2269    if (present(es_over_liq_and_ice)) then
   2270      if (.not. (construct_table_wrt_liq_and_ice)) then
   2271        call error_mesg ('compute_qs', &
   2272       'requesting es wrt liq and ice, but that table not constructed', &
   2273                                                                 FATAL)
   2274      endif
   2275    endif
   2276 
   2277 !  call compute_mrs_k (temp, press, EPSILO, ZVIR, mrsat,   &
   2278 !                                                    nbad, mr, dmrsdT)
   2279    call compute_mrs_k (temp, press, EPSILO, ZVIR, mrsat, nbad, mr,  &
   2280                      hc, dmrsdT, esat, es_over_liq, es_over_liq_and_ice)
   2281 
   2282    if ( nbad == 0 ) then
   2283      if(present(err_msg)) err_msg = ''
   2284    else
   2285      if(show_bad_value_count_by_slice) call temp_check ( temp )
   2286      if(show_all_bad_values) call show_all_bad ( temp )

Page 98          Source Listing                  COMPUTE_MRS_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2287      write(err_msg_tmp,'(a47,i7)') 'saturation vapor pressure table overflow, nbad=', nbad
   2288      if(fms_error_handler('compute_mrs',err_msg_tmp,err_msg)) return
   2289    endif
   2290 
   2291  end subroutine compute_mrs_3d


ENTRY POINTS

  Name                                             
                                                   
 sat_vapor_pres_mod_mp_compute_mrs_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS_3D             Subr   2243                                          PRIV                                               
 COMPUTE_MRS_K_3D           Subr   2279                                          PRIV             2279                              
 DMRSDT                     Dummy  2243     R(8)            8     3     1        ARG,OUT          2280                              
 ERR_MSG                    Dummy  2244     CHAR                        scalar   ARG,OUT          2259,2283,2288                    
 ERR_MSG_TMP                Local  2256     CHAR            128         scalar                    2287,2288                         
 ESAT                       Dummy  2243     R(8)            8     3     1        ARG,OUT          2280                              
 ES_OVER_LIQ                Dummy  2244     L(4)            4           scalar   ARG,IN           2262,2280                         
 ES_OVER_LIQ_AND_ICE        Dummy  2244     L(4)            4           scalar   ARG,IN           2269,2280                         
 HC                         Dummy  2243     R(8)            8           scalar   ARG,IN           2280                              
 MR                         Dummy  2243     R(8)            8     3     1        ARG,IN           2279                              
 MRSAT                      Dummy  2243     R(8)            8     3     1        ARG,OUT          2279                              
 NBAD                       Local  2255     I(4)            4           scalar                    2279,2282,2287                    
 PRESENT                    Func   2262                                 scalar                    2262,2269,2283                    
 PRESS                      Dummy  2243     R(8)            8     3     1        ARG,IN           2279                              
 TEMP                       Dummy  2243     R(8)            8     3     1        ARG,IN           2279,2285,2286                    

Page 99          Source Listing                  COMPUTE_MRS_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2292 
   2293 
   2294 !#######################################################################
   2295 
   2296 !#######################################################################
   2297 
   2298 ! <SUBROUTINE NAME="sat_vapor_pres_init">
   2299 
   2300 !   <OVERVIEW>
   2301 !     Initializes the lookup tables for saturation vapor pressure.
   2302 !   </OVERVIEW>
   2303 !   <DESCRIPTION>
   2304 !     Initializes the lookup tables for saturation vapor pressure.
   2305 !     This routine will be called automatically the first time
   2306 !     <B>lookup_es</B> or <B>lookup_des</B> is called,
   2307 !     the user does not need to call this routine.
   2308 !     There are no arguments.
   2309 !   </DESCRIPTION>
   2310 !   <TEMPLATE>
   2311 !     call sat_vapor_pres_init
   2312 !   </TEMPLATE>
   2313 !   <OUT NAME="err_msg" TYPE="character">  </OUT>
   2314 
   2315 ! </SUBROUTINE>
   2316  subroutine sat_vapor_pres_init(err_msg)
   2317 
   2318 !  =================================================================
   2319 !  +                                                               +
   2320 !  +             construction of the es table                      +
   2321 !  +                                                               +
   2322 !  + this table is constructed from es equations from the          +
   2323 !  + smithsonian tables.  the es input is computed from values     +
   2324 !  + (in one-tenth of a degree increments) of es over ice          +
   2325 !  + from -153c to 0c and values of es over water from 0c to 102c. +
   2326 !  + output table contains these data interleaved with their       +
   2327 !  + derivatives with respect to temperature except between -20c   +
   2328 !  + and 0c where blended (over water and over ice) es values and  +
   2329 !  + derivatives are calculated.                                   +
   2330 !  +   note: all es computation is done in pascals                 +
   2331 !  =================================================================
   2332 
   2333   character(len=*), intent(out), optional :: err_msg
   2334   character(len=128) :: err_msg_local
   2335   integer :: unit, ierr, io
   2336 
   2337 ! return silently if this routine has already been called
   2338   if (module_is_initialized) return
   2339 
   2340 !---- read namelist input ----
   2341   read (input_nml_file, sat_vapor_pres_nml, iostat=io)
   2342   ierr = check_nml_error(io,'sat_vapor_pres_nml')
   2343 
   2344 ! write version number and namelist to log file
   2345   call write_version_number("SAT_VAPOR_PRES_MOD", version)
   2346   unit = stdlog()
   2347   stdoutunit = stdout()
   2348   if (mpp_pe() == mpp_root_pe()) write (unit, nml=sat_vapor_pres_nml)

Page 100         Source Listing                  SAT_VAPOR_PRES_INIT
2021-06-01 08:56                                 sat_vapor_pres.F90

   2349 
   2350   if(do_simple) then
   2351     tcmin = -173
   2352     tcmax =  350
   2353   endif
   2354   nsize = (tcmax-tcmin)*esres+1
   2355   nlim  = nsize-1
   2356   call sat_vapor_pres_init_k(nsize, real(tcmin), real(tcmax), TFREEZE, HLV, &
   2357                              RVGAS, ES0, err_msg_local, use_exact_qs, do_simple, &
   2358                              construct_table_wrt_liq, &
   2359                              construct_table_wrt_liq_and_ice, &
   2360                              teps, tmin, dtinv)
   2361   if ( err_msg_local == '' ) then
   2362      if(present(err_msg)) err_msg = ''
   2363   else
   2364      if(fms_error_handler('lookup_es',err_msg_local,err_msg)) return
   2365   endif
   2366 
   2367   module_is_initialized = .true.
   2368 
   2369 end subroutine sat_vapor_pres_init


ENTRY POINTS

  Name                                                  
                                                        
 sat_vapor_pres_mod_mp_sat_vapor_pres_init_             

Page 101         Source Listing                  SAT_VAPOR_PRES_INIT
2021-06-01 08:56 Symbol Table                    sat_vapor_pres.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHECK_NML_ERROR            Func   2342     I(4)            4           scalar   PRIV             137,2342                          
 DO_SIMPLE                  Local  2350     L(4)            4           scalar                    564,569,2350,2357                 
 DTINV                      Local  2360     R(8)            8           scalar                    2360,2457,2519,2534,2551,2570     
 ERR_MSG                    Dummy  2316     CHAR                        scalar   ARG,OUT          2362,2364                         
 ERR_MSG_LOCAL              Local  2334     CHAR            128         scalar                    2357,2361,2364                    
 ES0                        Param  2357     R(8)            8           scalar   PRIV             134,2357                          
 ESRES                      Local  2354     I(4)            4           scalar                    551,2354                          
 HLV                        Param  2356     R(8)            8           scalar   PRIV             134,2356                          
 IERR                       Local  2335     I(4)            4           scalar                    2342                              
 INPUT_NML_FILE             Local  2341     CHAR                  1     1        ALC,TGT,PRIV     138,2341                          
 IO                         Local  2335     I(4)            4           scalar                    2341,2342                         
 MPP_PE                     Func   2348     I(4)            4           scalar   PRIV             135,2348,2521,2536,2553,2572      
 MPP_ROOT_PE                Func   2348     I(4)            4           scalar   PRIV             135,2348                          
 NLIM                       Local  2355     I(4)            4           scalar                    2355,2458,2520,2535,2552,2571     
 NSIZE                      Local  2354     I(4)            4           scalar                    2354,2355,2356                    
 PRESENT                    Func   2362                                 scalar                    2362                              
 REAL                       Func   2356                                 scalar                    2356                              
 RVGAS                      Param  2357     R(8)            8           scalar   PRIV             134,543,544,2357                  
 SAT_VAPOR_PRES_INIT        Subr   2316                                                                                             
 SAT_VAPOR_PRES_INIT_K      Subr   2356                                          PRIV             139,2356                          
 SAT_VAPOR_PRES_NML         Local  2341                                 scalar                    2341,2348                         
 STDLOG                     Func   2346     I(4)            4           scalar   PRIV             135,2346                          
 STDOUT                     Func   2347     I(4)            4           scalar   PRIV             135,2347                          
 STDOUTUNIT                 Local  2347     I(4)            4           scalar                    555,2347,2482,2493,2505,2518,2532,
                                                                                                  2548,2566                         
 TCMAX                      Local  2352     I(4)            4           scalar                    550,2352,2354,2356                
 TCMIN                      Local  2351     I(4)            4           scalar                    549,2351,2354,2356                
 TEPS                       Local  2360     R(8)            8           scalar                    2360,2457,2519,2534,2551,2570     
 TFREEZE                    Param  2356     R(8)            8           scalar   PRIV             134,2356                          
 TMIN                       Local  2360     R(8)            8           scalar                    2360,2457,2519,2534,2551,2570     
 UNIT                       Local  2335     I(4)            4           scalar                    2346,2348                         
 USE_EXACT_QS               Local  2357     L(4)            4           scalar                    563,569,2357                      
 VERSION                    Param  2345     CHAR            7           scalar                    2345                              
 WRITE_VERSION_NUMBER       Subr   2345                                          PRIV             135,2345                          

Page 102         Source Listing                  SAT_VAPOR_PRES_INIT
2021-06-01 08:56                                 sat_vapor_pres.F90

   2370 
   2371 !#######################################################################
   2372 !#######################################################################
   2373 !-------------------------------------------------------------------
   2374 !                Computation of the es values
   2375 !
   2376 !   Saturation vapor pressure (es) values are computed from
   2377 !   equations in the Smithsonian meteorological tables page 350.
   2378 !   For temperatures < 0C, sat vapor pres is computed over ice.
   2379 !   For temperatures > -20C, sat vapor pres is computed over water.
   2380 !   Between -20C and 0C the returned value is blended (over water
   2381 !   and over ice).  All sat vapor pres values are returned in pascals.
   2382 !
   2383 !   Reference:  Smithsonian meteorological tables, page 350.
   2384 !-------------------------------------------------------------------
   2385 
   2386 ! <FUNCTION NAME="compute_es_1d" INTERFACE="compute_es">
   2387 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:)"></IN>
   2388 !   <OUT NAME="es" UNITS="pascal" TYPE="real" DIM="(:)"></OUT>
   2389 ! </FUNCTION>
   2390 !function compute_es_1d (tem) result (es)
   2391 !real, intent(in) :: tem(:)
   2392 !real :: es(size(tem,1))
   2393 
   2394 !es = compute_es_k(tem, TFREEZE)
   2395 
   2396 !end function compute_es_1d
   2397 !--------------------------------------------------------
   2398 
   2399 ! <FUNCTION NAME="compute_es_0d" INTERFACE="compute_es">
   2400 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(scalar)"></IN>
   2401 !   <OUT NAME="es" UNITS="pascal" TYPE="real" DIM="(scalar)"></OUT>
   2402 ! </FUNCTION>
   2403 !function compute_es_0d (tem) result (es)
   2404 !real, intent(in) :: tem
   2405 !real :: es
   2406 !real, dimension(1) :: tem1, es1
   2407 
   2408 !  tem1(1) = tem
   2409 !  es1 = compute_es_1d (tem1)
   2410 !  es = es1(1)
   2411 
   2412 !end function compute_es_0d
   2413 
   2414 !--------------------------
   2415 
   2416 ! <FUNCTION NAME="compute_es_2d" INTERFACE="compute_es">
   2417 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:)"></IN>
   2418 !   <OUT NAME="es" UNITS="pascal" TYPE="real" DIM="(:,:)"></OUT>
   2419 ! </FUNCTION>
   2420 !function compute_es_2d (tem) result (es)
   2421 !real, intent(in) :: tem(:,:)
   2422 !real, dimension(size(tem,1),size(tem,2)) :: es
   2423 !integer :: j
   2424 
   2425 !   do j = 1, size(tem,2)
   2426 !     es(:,j) = compute_es_1d (tem(:,j))

Page 103         Source Listing                  SAT_VAPOR_PRES_INIT
2021-06-01 08:56                                 sat_vapor_pres.F90

   2427 !   enddo
   2428 
   2429 !end function compute_es_2d
   2430 
   2431 !--------------------------
   2432 ! <FUNCTION NAME="compute_es_3d" INTERFACE="compute_es">
   2433 !   <IN NAME="temp" UNIT="degrees Kelvin" TYPE="real" DIM="(:,:,:)"></IN>
   2434 !   <OUT NAME="es" UNITS="pascal" TYPE="real" DIM="(:,:,:)"></OUT>
   2435 ! </FUNCTION>
   2436 !function compute_es_3d (tem) result (es)
   2437 !real, intent(in) :: tem(:,:,:)
   2438 !real, dimension(size(tem,1),size(tem,2),size(tem,3)) :: es
   2439 !integer :: j, k
   2440 
   2441 !   do k = 1, size(tem,3)
   2442 !   do j = 1, size(tem,2)
   2443 !     es(:,j,k) = compute_es_1d (tem(:,j,k))
   2444 !   enddo
   2445 !   enddo
   2446 
   2447 !end function compute_es_3d
   2448 
   2449 !#######################################################################
   2450 
   2451  function check_1d ( temp ) result ( nbad )
   2452  real   , intent(in)  :: temp(:)
   2453  integer :: nbad, ind, i
   2454 
   2455    nbad = 0
   2456    do i = 1, size(temp,1)
   2457      ind = int(dtinv*(temp(i)-tmin+teps))
   2458      if (ind < 0 .or. ind > nlim) nbad = nbad+1
   2459    enddo
   2460 
   2461  end function check_1d

Page 104         Source Listing                  CHECK_1D
2021-06-01 08:56 Entry Points                    sat_vapor_pres.F90



ENTRY POINTS

  Name                                       
                                             
 sat_vapor_pres_mod_mp_check_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHECK_1D                   Func   2451     I(4)            4           scalar                    2472,2483,2494,2495               
 I                          Local  2453     I(4)            4           scalar                    2456,2457                         
 IND                        Local  2453     I(4)            4           scalar                    2457,2458                         
 INT                        Func   2457                                 scalar                    2457                              
 NBAD                       Local  2453     I(4)            4           scalar                    2455,2458                         
 SIZE                       Func   2456                                 scalar                    2456                              
 TEMP                       Dummy  2451     R(8)            8     1     1        ARG,IN           2456,2457                         

Page 105         Source Listing                  CHECK_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2462 
   2463 !------------------------------------------------
   2464 
   2465  function check_2d ( temp ) result ( nbad )
   2466  real   , intent(in)  :: temp(:,:)
   2467  integer :: nbad
   2468  integer :: j
   2469 
   2470     nbad = 0
   2471     do j = 1, size(temp,2)
   2472       nbad = nbad + check_1d ( temp(:,j) )
   2473     enddo
   2474  end function check_2d


ENTRY POINTS

  Name                                       
                                             
 sat_vapor_pres_mod_mp_check_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHECK_2D                   Func   2465     I(4)            4           scalar                    2506,2507,2508                    
 J                          Local  2468     I(4)            4           scalar                    2471,2472                         
 NBAD                       Local  2467     I(4)            4           scalar                    2470,2472                         
 SIZE                       Func   2471                                 scalar                    2471                              
 TEMP                       Dummy  2465     R(8)            8     2     1        ARG,IN           2471,2472                         

Page 106         Source Listing                  CHECK_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2475 
   2476 !#######################################################################
   2477 
   2478  subroutine temp_check_1d ( temp )
   2479  real   , intent(in) :: temp(:)
   2480  integer :: i, unit
   2481 
   2482    unit = stdoutunit
   2483    write(unit,*) 'Bad temperatures (dimension 1): ', (check_1d(temp(i:i)),i=1,size(temp,1))
   2484 
   2485  end subroutine temp_check_1d


ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_temp_check_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 I                          Local  2480     I(4)            4           scalar                    2483                              
 SIZE                       Func   2483                                 scalar                    2483                              
 TEMP                       Dummy  2478     R(8)            8     1     1        ARG,IN           2483                              
 TEMP_CHECK_1D              Subr   2478                                                           632,769,906,1048,1183,1318,1455,15
                                                                                                  91,1728,1915,2161                 
 UNIT                       Local  2480     I(4)            4           scalar                    2482,2483                         

Page 107         Source Listing                  TEMP_CHECK_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2486 
   2487 !--------------------------------------------------------------
   2488 
   2489  subroutine temp_check_2d ( temp )
   2490  real   , intent(in) :: temp(:,:)
   2491  integer :: i, j, unit
   2492 
   2493    unit = stdoutunit
   2494    write(unit,*) 'Bad temperatures (dimension 1): ', (check_1d(temp(i,:)),i=1,size(temp,1))
   2495    write(unit,*) 'Bad temperatures (dimension 2): ', (check_1d(temp(:,j)),j=1,size(temp,2))
   2496 
   2497  end subroutine temp_check_2d


ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_temp_check_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 I                          Local  2491     I(4)            4           scalar                    2494                              
 J                          Local  2491     I(4)            4           scalar                    2495                              
 SIZE                       Func   2494                                 scalar                    2494,2495                         
 TEMP                       Dummy  2489     R(8)            8     2     1        ARG,IN           2494,2495                         
 TEMP_CHECK_2D              Subr   2489                                                           668,805,942,1083,1218,1353,1489,16
                                                                                                  25,1762,1977,2223                 
 UNIT                       Local  2491     I(4)            4           scalar                    2493,2494,2495                    

Page 108         Source Listing                  TEMP_CHECK_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2498 
   2499 !--------------------------------------------------------------
   2500 
   2501  subroutine temp_check_3d ( temp )
   2502  real, intent(in)  :: temp(:,:,:)
   2503  integer :: i, j, k, unit
   2504 
   2505    unit = stdoutunit
   2506    write(unit,*) 'Bad temperatures (dimension 1): ', (check_2d(temp(i,:,:)),i=1,size(temp,1))
   2507    write(unit,*) 'Bad temperatures (dimension 2): ', (check_2d(temp(:,j,:)),j=1,size(temp,2))
   2508    write(unit,*) 'Bad temperatures (dimension 3): ', (check_2d(temp(:,:,k)),k=1,size(temp,3))
   2509 
   2510  end subroutine temp_check_3d


ENTRY POINTS

  Name                                            
                                                  
 sat_vapor_pres_mod_mp_temp_check_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 I                          Local  2503     I(4)            4           scalar                    2506                              
 J                          Local  2503     I(4)            4           scalar                    2507                              
 K                          Local  2503     I(4)            4           scalar                    2508                              
 SIZE                       Func   2506                                 scalar                    2506,2507,2508                    
 TEMP                       Dummy  2501     R(8)            8     3     1        ARG,IN           2506,2507,2508                    
 TEMP_CHECK_3D              Subr   2501                                                           703,840,977,1116,1251,1386,1523,16
                                                                                                  59,1796,2039,2285                 
 UNIT                       Local  2503     I(4)            4           scalar                    2505,2506,2507,2508               

Page 109         Source Listing                  TEMP_CHECK_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2511 
   2512 !#######################################################################
   2513 
   2514 subroutine show_all_bad_0d ( temp )
   2515  real   , intent(in) :: temp
   2516  integer :: ind, unit
   2517 
   2518  unit = stdoutunit
   2519  ind = int(dtinv*(temp-tmin+teps))
   2520  if (ind < 0 .or. ind > nlim) then
   2521    write(unit,'(a,e10.3,a,i6)') 'Bad temperature=',temp,' pe=',mpp_pe()
   2522  endif
   2523 
   2524  end subroutine show_all_bad_0d


ENTRY POINTS

  Name                                              
                                                    
 sat_vapor_pres_mod_mp_show_all_bad_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IND                        Local  2516     I(4)            4           scalar                    2519,2520                         
 INT                        Func   2519                                 scalar                    2519                              
 SHOW_ALL_BAD_0D            Subr   2514                                                           599,736,873,1013,1148,1283,1422,15
                                                                                                  58,1695,1855,2099                 
 TEMP                       Dummy  2514     R(8)            8           scalar   ARG,IN           2519,2521                         
 UNIT                       Local  2516     I(4)            4           scalar                    2518,2521                         

Page 110         Source Listing                  SHOW_ALL_BAD_0D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2525 
   2526 !--------------------------------------------------------------
   2527 
   2528  subroutine show_all_bad_1d ( temp )
   2529  real   , intent(in) :: temp(:)
   2530  integer :: i, ind, unit
   2531 
   2532  unit = stdoutunit
   2533  do i=1,size(temp)
   2534    ind = int(dtinv*(temp(i)-tmin+teps))
   2535    if (ind < 0 .or. ind > nlim) then
   2536      write(unit,'(a,e10.3,a,i4,a,i6)') 'Bad temperature=',temp(i),'  at i=',i,' pe=',mpp_pe()
   2537    endif
   2538  enddo
   2539 
   2540  end subroutine show_all_bad_1d


ENTRY POINTS

  Name                                              
                                                    
 sat_vapor_pres_mod_mp_show_all_bad_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 I                          Local  2530     I(4)            4           scalar                    2533,2534,2536                    
 IND                        Local  2530     I(4)            4           scalar                    2534,2535                         
 INT                        Func   2534                                 scalar                    2534                              
 SHOW_ALL_BAD_1D            Subr   2528                                                           633,770,907,1049,1184,1319,1456,15
                                                                                                  92,1729,1916,2162                 
 SIZE                       Func   2533                                 scalar                    2533                              
 TEMP                       Dummy  2528     R(8)            8     1     1        ARG,IN           2533,2534,2536                    
 UNIT                       Local  2530     I(4)            4           scalar                    2532,2536                         

Page 111         Source Listing                  SHOW_ALL_BAD_1D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2541 
   2542 !--------------------------------------------------------------
   2543 
   2544  subroutine show_all_bad_2d ( temp )
   2545  real   , intent(in) :: temp(:,:)
   2546  integer :: i, j, ind, unit
   2547 
   2548  unit = stdoutunit
   2549  do j=1,size(temp,2)
   2550  do i=1,size(temp,1)
   2551    ind = int(dtinv*(temp(i,j)-tmin+teps))
   2552    if (ind < 0 .or. ind > nlim) then
   2553      write(unit,'(a,e10.3,a,i4,a,i4,a,i6)') 'Bad temperature=',temp(i,j),'  at i=',i,' j=',j,' pe=',mpp_pe()
   2554    endif
   2555  enddo
   2556  enddo
   2557 
   2558  end subroutine show_all_bad_2d


ENTRY POINTS

  Name                                              
                                                    
 sat_vapor_pres_mod_mp_show_all_bad_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 I                          Local  2546     I(4)            4           scalar                    2550,2551,2553                    
 IND                        Local  2546     I(4)            4           scalar                    2551,2552                         
 INT                        Func   2551                                 scalar                    2551                              
 J                          Local  2546     I(4)            4           scalar                    2549,2551,2553                    
 SHOW_ALL_BAD_2D            Subr   2544                                                           669,806,943,1084,1219,1354,1490,16
                                                                                                  26,1763,1978,2224                 
 SIZE                       Func   2549                                 scalar                    2549,2550                         
 TEMP                       Dummy  2544     R(8)            8     2     1        ARG,IN           2549,2550,2551,2553               
 UNIT                       Local  2546     I(4)            4           scalar                    2548,2553                         

Page 112         Source Listing                  SHOW_ALL_BAD_2D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2559 
   2560 !--------------------------------------------------------------
   2561 
   2562  subroutine show_all_bad_3d ( temp )
   2563  real, intent(in)  :: temp(:,:,:)
   2564  integer :: i, j, k, ind, unit
   2565 
   2566  unit = stdoutunit
   2567  do k=1,size(temp,3)
   2568  do j=1,size(temp,2)
   2569  do i=1,size(temp,1)
   2570    ind = int(dtinv*(temp(i,j,k)-tmin+teps))
   2571    if (ind < 0 .or. ind > nlim) then
   2572      write(unit,'(a,e10.3,a,i4,a,i4,a,i4,a,i6)') 'Bad temperature=',temp(i,j,k),'  at i=',i,' j=',j,' k=',k,' pe=',mpp_pe()
   2573    endif
   2574  enddo
   2575  enddo
   2576  enddo
   2577 
   2578  end subroutine show_all_bad_3d


ENTRY POINTS

  Name                                              
                                                    
 sat_vapor_pres_mod_mp_show_all_bad_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 I                          Local  2564     I(4)            4           scalar                    2569,2570,2572                    
 IND                        Local  2564     I(4)            4           scalar                    2570,2571                         
 INT                        Func   2570                                 scalar                    2570                              
 J                          Local  2564     I(4)            4           scalar                    2568,2570,2572                    
 K                          Local  2564     I(4)            4           scalar                    2567,2570,2572                    
 SHOW_ALL_BAD_3D            Subr   2562                                                           704,841,978,1117,1252,1387,1524,16
                                                                                                  60,1797,2040,2286                 
 SIZE                       Func   2567                                 scalar                    2567,2568,2569                    
 TEMP                       Dummy  2562     R(8)            8     3     1        ARG,IN           2567,2568,2569,2570,2572          
 UNIT                       Local  2564     I(4)            4           scalar                    2566,2572                         

Page 113         Source Listing                  SHOW_ALL_BAD_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2579 
   2580 !#######################################################################
   2581 end module sat_vapor_pres_mod


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPUTE_MRS                Local  470                                  scalar                    153                               
 COMPUTE_QS                 Local  394                                  scalar                    153                               
 CONSTANTS_MOD              Module 134                                                            134                               
 DESCOMP                    Local  245                                  scalar                    155                               
 ESCOMP                     Local  199                                  scalar                    155                               
 FMS_MOD                    Module 135                                                            135                               
 LOOKUP_DES                 Local  240                                  scalar                    150                               
 LOOKUP_DES2                Local  302                                  scalar                    151                               
 LOOKUP_DES3                Local  315                                  scalar                    152                               
 LOOKUP_ES                  Local  195                                  scalar                    150                               
 LOOKUP_ES2                 Local  298                                  scalar                    151                               
 LOOKUP_ES2_DES2            Local  306                                  scalar                    151                               
 LOOKUP_ES3                 Local  311                                  scalar                    152                               
 LOOKUP_ES3_DES3            Local  319                                  scalar                    152                               
 LOOKUP_ES_DES              Local  294                                  scalar                    153                               
 MPP_ERROR                  Local  136                                  scalar   PRIV             136                               
 MPP_MOD                    Module 138                                                            138                               
 RDGAS                      Param  134      R(8)            8           scalar   PRIV             134,543,544                       
 SAT_VAPOR_PRES_INIT        Subr   150                                                            150                               
 SAT_VAPOR_PRES_K_MOD       Module 139                                                            139                               
 SAT_VAPOR_PRES_MOD         Module 21                                                                                               

Page 114         Source Listing                  SHOW_ALL_BAD_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2582 !#######################################################################
   2583 
   2584 ! <INFO>
   2585 
   2586 !   <REFERENCE>
   2587 !     Smithsonian Meteorological Tables Page 350.
   2588 !   </REFERENCE>
   2589 
   2590 !   <BUG>
   2591 !     No error checking is done to make sure that the size of the
   2592 !     input and output fields match.
   2593 !   </BUG>
   2594 
   2595 !   <NOTE>
   2596 !     1. <B>Vectorization</B><BR/>
   2597 !        To create a vector version the lookup routines need to be modified.
   2598 !    The local variables: tmp, del, ind, should be changed to arrays
   2599 !    with the same size and order as input array temp.
   2600 !
   2601 !     2. <B>Construction of the <TT>ES</TT> tables</B><BR/>
   2602 !         The tables are constructed using the saturation vapor pressure (<TT>ES</TT>)
   2603 !    equations in the Smithsonian tables. The tables are valid between
   2604 !    -160C to +100C with increments at 1/10 degree. Between -160C and -20C
   2605 !    values of <TT>ES</TT> over ice are used, between 0C and 100C values of<TT> ES</TT>
   2606 !    over water are used, between -20C and 0C blended values of <TT>ES</TT>
   2607 !    (over water and over ice) are used.
   2608 !
   2609 !    There are three tables constructed: <TT>ES</TT>, first derivative
   2610 !       (<TT>ES'</TT>), and
   2611 !    second derivative (<TT>ES</TT>'').  The ES table is constructed directly from
   2612 !    the equations in the Smithsonian tables. The <TT>ES</TT>' table is constructed
   2613 !    by bracketing temperature values at +/- 0.01 degrees. The <TT>ES</TT>'' table
   2614 !    is estimated by using centered differencing of the <TT>ES</TT>' table.
   2615 !
   2616 !     3. <B>Determination of <TT>es</TT> and <TT>es'</TT> from lookup tables</B><BR/>
   2617 !         Values of the saturation vapor pressure (<TT>es</TT>) and the
   2618 !    derivative (<TT>es'</TT>) are determined at temperature (T) from the lookup
   2619 !    tables (<TT>ES</TT>, <TT>ES'</TT>, <TT>ES''</TT>)
   2620 !    using the following formula.
   2621 !<PRE>
   2622 !    es (T) = ES(t) + ES'(t) * dt + 0.5 * ES''(t) * dt**2
   2623 !    es'(T) = ES'(t) + ES''(t) * dt
   2624 !
   2625 !    where     t = lookup table temperature closest to T
   2626 !             dt = T - t
   2627 !</PRE>
   2628 !
   2629 !     4. Internal (private) parameters<BR/>
   2630 !       These parameters can be modified to increase/decrease the size/range
   2631 !    of the lookup tables.
   2632 !<PRE>
   2633 !!    tcmin   The minimum temperature (in deg C) in the lookup tables.
   2634 !!              [integer, default: tcmin = -160]
   2635 !!
   2636 !!    tcmax   The maximum temperature (in deg C) in the lookup tables.
   2637 !!              [integer, default: tcmin = +100]
   2638 !!</PRE>

Page 115         Source Listing                  SHOW_ALL_BAD_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

   2639 !!   </NOTE>
   2640 !
   2641 !!   <TESTPROGRAM NAME="test_sat_vapor_pres">
   2642 !<PRE>
   2643 !use sat_vapor_pres_mod
   2644 !implicit none
   2645 !
   2646 !integer, parameter :: ipts=500, jpts=100, kpts=50, nloop=1
   2647 !real, dimension(ipts,jpts,kpts) :: t,es,esn,des,desn
   2648 !integer :: n
   2649 !
   2650 !! generate temperatures between 120K and 340K
   2651 !  call random_number (t)
   2652 !  t = 130. + t * 200.
   2653 !
   2654 !! initialize the tables (optional)
   2655 !  call sat_vapor_pres_init
   2656 !
   2657 !! compute actual es and "almost" actual des
   2658 !   es = compute_es  (t)
   2659 !  des = compute_des (t)
   2660 !
   2661 !do n = 1, nloop
   2662 !! es and des
   2663 !  call lookup_es  (t, esn)
   2664 !  call lookup_des (t,desn)
   2665 !enddo
   2666 !
   2667 !! terminate, print deviation from actual
   2668 !  print *, 'size=',ipts,jpts,kpts,nloop
   2669 !  print *, 'err es  = ', sum((esn-es)**2)
   2670 !  print *, 'err des = ', sum((desn-des)**2)
   2671 !
   2672 !contains
   2673 !
   2674 !!----------------------------------
   2675 !! routine to estimate derivative
   2676 !
   2677 ! function compute_des (tem) result (des)
   2678 ! real, intent(in) :: tem(:,:,:)
   2679 ! real, dimension(size(tem,1),size(tem,2),size(tem,3)) :: des,esp,esm
   2680 ! real, parameter :: tdel = .01
   2681 !    esp = compute_es (tem+tdel)
   2682 !    esm = compute_es (tem-tdel)
   2683 !    des = (esp-esm)/(2*tdel)
   2684 ! end function compute_des
   2685 !!----------------------------------
   2686 !
   2687 !end program test_sat_vapor_pres
   2688 !</PRE>
   2689 !   </TESTPROGRAM>
   2690 ! </INFO>

Page 116         Source Listing                  SHOW_ALL_BAD_3D
2021-06-01 08:56 Subprograms/Common Blocks       sat_vapor_pres.F90



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHECK_1D                   Func   2451     I(4)            4           scalar                    2472,2483,2494,2495               
 CHECK_2D                   Func   2465     I(4)            4           scalar                    2506,2507,2508                    
 COMPUTE_MRS_0D             Subr   2060                                          PRIV                                               
 COMPUTE_MRS_1D             Subr   2119                                          PRIV                                               
 COMPUTE_MRS_2D             Subr   2181                                          PRIV                                               
 COMPUTE_MRS_3D             Subr   2243                                          PRIV                                               
 COMPUTE_QS_0D              Subr   1816                                          PRIV                                               
 COMPUTE_QS_1D              Subr   1874                                          PRIV                                               
 COMPUTE_QS_2D              Subr   1936                                          PRIV                                               
 COMPUTE_QS_3D              Subr   1997                                          PRIV                                               
 LOOKUP_DES2_0D             Subr   1130                                          PRIV                                               
 LOOKUP_DES2_1D             Subr   1162                                          PRIV                                               
 LOOKUP_DES2_2D             Subr   1199                                          PRIV                                               
 LOOKUP_DES2_3D             Subr   1233                                          PRIV                                               
 LOOKUP_DES3_0D             Subr   1265                                          PRIV                                               
 LOOKUP_DES3_1D             Subr   1297                                          PRIV                                               
 LOOKUP_DES3_2D             Subr   1334                                          PRIV                                               
 LOOKUP_DES3_3D             Subr   1368                                          PRIV                                               
 LOOKUP_DES_0D              Subr   995                                           PRIV                                               
 LOOKUP_DES_1D              Subr   1027                                          PRIV                                               
 LOOKUP_DES_2D              Subr   1064                                          PRIV                                               
 LOOKUP_DES_3D              Subr   1098                                          PRIV                                               
 LOOKUP_ES2_0D              Subr   718                                           PRIV                                               
 LOOKUP_ES2_1D              Subr   750                                           PRIV                                               
 LOOKUP_ES2_2D              Subr   786                                           PRIV                                               
 LOOKUP_ES2_3D              Subr   822                                           PRIV                                               
 LOOKUP_ES2_DES2_0D         Subr   1540                                          PRIV                                               
 LOOKUP_ES2_DES2_1D         Subr   1573                                          PRIV                                               
 LOOKUP_ES2_DES2_2D         Subr   1607                                          PRIV                                               
 LOOKUP_ES2_DES2_3D         Subr   1641                                          PRIV                                               
 LOOKUP_ES3_0D              Subr   855                                           PRIV                                               
 LOOKUP_ES3_1D              Subr   887                                           PRIV                                               
 LOOKUP_ES3_2D              Subr   923                                           PRIV                                               
 LOOKUP_ES3_3D              Subr   959                                           PRIV                                               
 LOOKUP_ES3_DES3_0D         Subr   1677                                          PRIV                                               
 LOOKUP_ES3_DES3_1D         Subr   1710                                          PRIV                                               
 LOOKUP_ES3_DES3_2D         Subr   1744                                          PRIV                                               
 LOOKUP_ES3_DES3_3D         Subr   1778                                          PRIV                                               
 LOOKUP_ES_0D               Subr   581                                           PRIV                                               
 LOOKUP_ES_1D               Subr   613                                           PRIV                                               
 LOOKUP_ES_2D               Subr   649                                           PRIV                                               
 LOOKUP_ES_3D               Subr   685                                           PRIV                                               
 LOOKUP_ES_DES_0D           Subr   1404                                          PRIV                                               
 LOOKUP_ES_DES_1D           Subr   1437                                          PRIV                                               
 LOOKUP_ES_DES_2D           Subr   1471                                          PRIV                                               
 LOOKUP_ES_DES_3D           Subr   1505                                          PRIV                                               
 SAT_VAPOR_PRES_INIT        Subr   2316                                                                                             
 SAT_VAPOR_PRES_MOD         Module 21                                                                                               
 SHOW_ALL_BAD_0D            Subr   2514                                                           599,736,873,1013,1148,1283,1422,15
                                                                                                  58,1695,1855,2099                 
 SHOW_ALL_BAD_1D            Subr   2528                                                           633,770,907,1049,1184,1319,1456,15

Page 117         Source Listing                  SHOW_ALL_BAD_3D
2021-06-01 08:56 Subprograms/Common Blocks       sat_vapor_pres.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  92,1729,1916,2162                 
 SHOW_ALL_BAD_2D            Subr   2544                                                           669,806,943,1084,1219,1354,1490,16
                                                                                                  26,1763,1978,2224                 
 SHOW_ALL_BAD_3D            Subr   2562                                                           704,841,978,1117,1252,1387,1524,16
                                                                                                  60,1797,2040,2286                 
 TEMP_CHECK_1D              Subr   2478                                                           632,769,906,1048,1183,1318,1455,15
                                                                                                  91,1728,1915,2161                 
 TEMP_CHECK_2D              Subr   2489                                                           668,805,942,1083,1218,1353,1489,16
                                                                                                  25,1762,1977,2223                 
 TEMP_CHECK_3D              Subr   2501                                                           703,840,977,1116,1251,1386,1523,16
                                                                                                  59,1796,2039,2285                 

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume cc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file
       -convert native                       -cross_reference
       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=0
       -D __unix__                           -D __unix

Page 118         Source Listing                  SHOW_ALL_BAD_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20191121       -D _OPENMP=201611
       -D __INTEL_OFFLOAD                    -D __MMX__
       -D __SSE__                            -D __SSE_MATH__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __pentium4                         -D __pentium4__
       -D __tune_pentium4__                  -D PACKAGE_NAME='"GFDL FMS Library"'
       -D PACKAGE_TARNAME='"FMS"'            -D PACKAGE_VERSION='"2021.02.0"'
       -D PACKAGE_STRING='"GFDL FMS Library 2021.02.0"'       -D PACKAGE_BUGREPORT='"gfdl.climate.model.info@noaa.gov"'
       -D PACKAGE_URL='"https://www.gfdl.noaa.gov/fms"'       -D PACKAGE='"FMS"'
       -D VERSION='"2021.02.0"'              -D STDC_HEADERS=1
       -D HAVE_SYS_TYPES_H=1                 -D HAVE_SYS_STAT_H=1
       -D HAVE_STDLIB_H=1                    -D HAVE_STRING_H=1
       -D HAVE_MEMORY_H=1                    -D HAVE_STRINGS_H=1
       -D HAVE_INTTYPES_H=1                  -D HAVE_STDINT_H=1
       -D HAVE_UNISTD_H=1                    -D HAVE_DLFCN_H=1
       -D LT_OBJDIR='".libs/"'               -D HAVE_MPI_H=1
       -D HAVE_NETCDF_H=1                    -D HAVE_SCHED_GETAFFINITY=1
       -D HAVE_MOD_MPI=1                     -D HAVE_MOD_NETCDF=1
       -D HAVE_CRAY_POINTER=1                -D HAVE_QUAD_PRECISION=1
       -D HAVE_INTERNAL_NML=1                -D use_netCDF=1
       -D use_libMPI=1                       -D INTERNAL_FILE_NML
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
  no   -fpconstant                           -fpe3
       -fprm nearest                         -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -fp_modbits nofp_contract
       -fp_modbits nono_fp_contract          -fp_modbits nofenv_access
       -fp_modbits nono_fenv_access          -fp_modbits nocx_limited_range
       -fp_modbits nono_cx_limited_range       -fp_modbits noprec_div
       -fp_modbits nono_prec_div             -fp_modbits noprec_sqrt
       -fp_modbits nono_prec_sqrt            -fp_modbits ftz
       -fp_modbits nono_ftz                  -fp_modbits nointrin_limited_range
       -fp_modbits nono_intrin_limited_range       -fp_modbits notrunc_compares
       -fp_modbits nono_trunc_compares       -fp_modbits noieee_nan_compares
       -fp_modbits nono_ieee_nan_compares       -fp_modbits honor_f32_conversion
       -fp_modbits nono_honor_f32_conversion       -fp_modbits honor_f64_conversion
       -fp_modbits nono_honor_f64_conversion       -fp_modbits nono_x87_copy
       -fp_modbits nono_no_x87_copy          -fp_modbits noexception_semantics
       -fp_modbits nono_exception_semantics       -fp_modbits noprecise_libm_functions
       -fp_modbits nono_precise_libm_functions       -heap_arrays 0
  no   -threadprivate_compat                 -free
       -g2                                   -iface nomixed_str_len_arg
       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity

Page 119         Source Listing                  SHOW_ALL_BAD_3D
2021-06-01 08:56                                 sat_vapor_pres.F90

       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
       -module ../.mods                      -names lowercase
  no   -noinclude                       no   -o
       -offload-build=host                   -openmp
       -openmp-simd                          -openmp-offload
       -O0                              no   -pad_source
       -real_size 64                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w noalignments                       -w nodeclarations
       -w noexternals                        -w nogeneral
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w nouncalled
       -w nouninitialized                    -w nounused
       -w nousage                       no   -wrap-margins

       -includepath : /opt/netcdf/4.6.1/INTEL/include/,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/,.f90,./.f90,./.f90,../include/.f90,
           ./.f90,/opt/netcdf/4.6.1/INTEL/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/ipp/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mkl/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/tbb/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/daal/include/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/intel64/.f90,/opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/icc/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/.f90,/usr/local/include/.f90,
           /usr/lib/gcc/x86_64-redhat-linux/4.8.5/include/.f90,/usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : sat_vapor_pres.lst
  no   -o

COMPILER: Intel(R) Fortran 19.1-1555
