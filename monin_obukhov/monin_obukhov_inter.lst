Page 1           Source Listing                  MONIN_OBUKHOV_DIFF
2021-06-01 08:55                                 /tmp/ifortwModL1.i90

      1 # 1 "monin_obukhov_inter.F90"
      2 !***********************************************************************
      3 !*                   GNU Lesser General Public License
      4 !*
      5 !* This file is part of the GFDL Flexible Modeling System (FMS).
      6 !*
      7 !* FMS is free software: you can redistribute it and/or modify it under
      8 !* the terms of the GNU Lesser General Public License as published by
      9 !* the Free Software Foundation, either version 3 of the License, or (at
     10 !* your option) any later version.
     11 !*
     12 !* FMS is distributed in the hope that it will be useful, but WITHOUT
     13 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
     14 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
     15 !* for more details.
     16 !*
     17 !* You should have received a copy of the GNU Lesser General Public
     18 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
     19 !***********************************************************************
     20 
     21 
     22 module monin_obukhov_inter
     23 implicit none
     24 private
     25 
     26 
     27 public :: monin_obukhov_diff
     28 public :: monin_obukhov_drag_1d
     29 public :: monin_obukhov_solve_zeta
     30 public :: monin_obukhov_derivative_t
     31 public :: monin_obukhov_derivative_m
     32 public :: monin_obukhov_profile_1d
     33 public :: monin_obukhov_integral_m
     34 public :: monin_obukhov_integral_tq
     35 public :: monin_obukhov_stable_mix
     36 
     37 
     38 contains
     39 
     40 
     41 pure subroutine monin_obukhov_diff(vonkarm,                &
     42      & ustar_min,                                     &
     43      & neutral, stable_option,new_mo_option,rich_crit, zeta_trans, &
     44      & ni, nj, nk, z, u_star, b_star, k_m, k_h, ier)
     45 
     46   real   , intent(in   )                        :: vonkarm
     47   real   , intent(in   )                        :: ustar_min ! = 1.e-10
     48   logical, intent(in   )                        :: neutral
     49   integer, intent(in   )                        :: stable_option
     50   logical, intent(in   )                        :: new_mo_option !miz
     51   real   , intent(in   )                        :: rich_crit, zeta_trans
     52   integer, intent(in   )                        :: ni, nj, nk
     53   real   , intent(in   ), dimension(ni, nj, nk) :: z
     54   real   , intent(in   ), dimension(ni, nj)     :: u_star, b_star
     55   real   , intent(  out), dimension(ni, nj, nk) :: k_m, k_h
     56   integer, intent(  out)                        :: ier
     57 

Page 2           Source Listing                  MONIN_OBUKHOV_DIFF
2021-06-01 08:55                                 monin_obukhov_inter.F90

     58   real , dimension(ni, nj) :: phi_m, phi_h, zeta, uss
     59   integer :: j, k
     60   logical, dimension(ni) :: mask
     61 
     62   ier = 0
     63 
     64   mask = .true.
     65   uss = max(u_star, ustar_min)
     66 
     67   if(neutral) then
     68      do k = 1, size(z,3)
     69         k_m(:,:,k) = vonkarm *uss*z(:,:,k)
     70         k_h(:,:,k) = k_m(:,:,k)
     71      end do
     72   else
     73      do k = 1, size(z,3)
     74         zeta = - vonkarm * b_star*z(:,:,k)/(uss*uss)
     75         do j = 1, size(z,2)
     76            call monin_obukhov_derivative_m(stable_option, rich_crit, zeta_trans, &
     77                 & ni, phi_m(:,j), zeta(:,j), mask, ier)
     78            call monin_obukhov_derivative_t(stable_option, new_mo_option,rich_crit, zeta_trans, &
     79                 & ni, phi_h(:,j), zeta(:,j), mask, ier)
     80         enddo
     81         k_m(:,:,k) = vonkarm * uss*z(:,:,k)/phi_m
     82         k_h(:,:,k) = vonkarm * uss*z(:,:,k)/phi_h
     83      end do
     84   endif
     85 
     86 end subroutine monin_obukhov_diff

Page 3           Source Listing                  MONIN_OBUKHOV_DIFF
2021-06-01 08:55 Entry Points                    monin_obukhov_inter.F90



ENTRY POINTS

  Name                                                  
                                                        
 monin_obukhov_inter_mp_monin_obukhov_diff_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  44       R(8)            8     2     0        ARG,IN           74                                
 IER                        Dummy  44       I(4)            4           scalar   ARG,OUT          62,77,79                          
 J                          Local  59       I(4)            4           scalar                    75,77,79                          
 K                          Local  59       I(4)            4           scalar                    68,69,70,73,74,81,82              
 K_H                        Dummy  44       R(8)            8     3     0        ARG,OUT          70,82                             
 K_M                        Dummy  44       R(8)            8     3     0        ARG,OUT          69,70,81                          
 MASK                       Local  60       L(4)            4     1     0                         64,77,79                          
 MAX                        Func   65                                   scalar                    65                                
 MONIN_OBUKHOV_DERIVATIVE_M Subr   76                                                             31,76,270,272                     
 MONIN_OBUKHOV_DERIVATIVE_T Subr   78                                                             30,78,274,276                     
 MONIN_OBUKHOV_DIFF         Subr   41                                                                                               
 NEUTRAL                    Dummy  43       L(4)            4           scalar   ARG,IN           67                                
 NEW_MO_OPTION              Dummy  43       L(4)            4           scalar   ARG,IN           78                                
 NI                         Dummy  44       I(4)            4           scalar   ARG,IN           53,54,55,58,60,77,79              
 NJ                         Dummy  44       I(4)            4           scalar   ARG,IN           53,54,55,58                       
 NK                         Dummy  44       I(4)            4           scalar   ARG,IN           53,55                             
 PHI_H                      Local  58       R(8)            8     2     0                         79,82                             
 PHI_M                      Local  58       R(8)            8     2     0                         77,81                             
 RICH_CRIT                  Dummy  43       R(8)            8           scalar   ARG,IN           76,78                             
 SIZE                       Func   68                                   scalar                    68,73,75                          
 STABLE_OPTION              Dummy  43       I(4)            4           scalar   ARG,IN           76,78                             
 USS                        Local  58       R(8)            8     2     0                         65,69,74,81,82                    
 USTAR_MIN                  Dummy  42       R(8)            8           scalar   ARG,IN           65                                
 U_STAR                     Dummy  44       R(8)            8     2     0        ARG,IN           65                                
 VONKARM                    Dummy  41       R(8)            8           scalar   ARG,IN           69,74,81,82                       
 Z                          Dummy  44       R(8)            8     3     0        ARG,IN           68,69,73,74,75,81,82              
 ZETA                       Local  58       R(8)            8     2     0                         74,77,79                          
 ZETA_TRANS                 Dummy  43       R(8)            8           scalar   ARG,IN           76,78                             

Page 4           Source Listing                  MONIN_OBUKHOV_DIFF
2021-06-01 08:55                                 monin_obukhov_inter.F90

     87 
     88 
     89 pure subroutine monin_obukhov_drag_1d(grav, vonkarm,               &
     90      & error, zeta_min, max_iter, small,                         &
     91      & neutral, stable_option, new_mo_option, rich_crit, zeta_trans,&
     92      & drag_min_heat, drag_min_moist, drag_min_mom,              &
     93      & n, pt, pt0, z, z0, zt, zq, speed, drag_m, drag_t,         &
     94      & drag_q, u_star, b_star, lavail, avail, ier)
     95 
     96   real   , intent(in   )                :: grav
     97   real   , intent(in   )                :: vonkarm
     98   real   , intent(in   )                :: error    ! = 1.e-04
     99   real   , intent(in   )                :: zeta_min ! = 1.e-06
    100   integer, intent(in   )                :: max_iter ! = 20
    101   real   , intent(in   )                :: small    ! = 1.e-04
    102   logical, intent(in   )                :: neutral
    103   integer, intent(in   )                :: stable_option
    104   logical, intent(in   )                :: new_mo_option
    105   real   , intent(in   )                :: rich_crit, zeta_trans
    106   real   , intent(in   )                :: drag_min_heat, drag_min_moist, drag_min_mom
    107   integer, intent(in   )                :: n
    108   real   , intent(in   ), dimension(n)  :: pt, pt0, z, z0, zt, zq, speed
    109   real   , intent(inout), dimension(n)  :: drag_m, drag_t, drag_q, u_star, b_star
    110   logical, intent(in   )                :: lavail ! whether to use provided mask or not
    111   logical, intent(in   ), dimension(n)  :: avail  ! provided mask
    112   integer, intent(out  )                :: ier
    113 
    114   real   , dimension(n) :: rich, fm, ft, fq, zz
    115   logical, dimension(n) :: mask, mask_1, mask_2
    116   real   , dimension(n) :: delta_b !!, us, bs, qs
    117   real                  :: r_crit, sqrt_drag_min_heat
    118   real                  :: sqrt_drag_min_moist, sqrt_drag_min_mom
    119   real                  :: us, bs, qs
    120   integer               :: i
    121 
    122   ier = 0
    123   r_crit = 0.95*rich_crit  ! convergence can get slow if one is
    124 ! close to rich_crit
    125   sqrt_drag_min_heat = 0.0
    126   if(drag_min_heat.ne.0.0) sqrt_drag_min_heat = sqrt(drag_min_heat)
    127   sqrt_drag_min_moist = 0.0
    128   if(drag_min_moist.ne.0.0) sqrt_drag_min_moist = sqrt(drag_min_moist)
    129   sqrt_drag_min_mom = 0.0
    130   if(drag_min_mom.ne.0.0) sqrt_drag_min_mom = sqrt(drag_min_mom)
    131 
    132   mask = .true.
    133   if(lavail) mask = avail
    134 
    135   where(mask)
    136      delta_b = grav*(pt0 - pt)/pt0
    137      rich    = - z*delta_b/(speed*speed + small)
    138      zz      = max(z,z0,zt,zq)
    139   elsewhere
    140      rich = 0.0
    141   end where
    142 
    143   if(neutral) then

Page 5           Source Listing                  MONIN_OBUKHOV_DRAG_1D
2021-06-01 08:55                                 monin_obukhov_inter.F90

    144 
    145      do i = 1, n
    146         if(mask(i)) then
    147            fm(i)   = log(zz(i)/z0(i))
    148            ft(i)   = log(zz(i)/zt(i))
    149            fq(i)   = log(zz(i)/zq(i))
    150            us   = vonkarm/fm(i)
    151            bs   = vonkarm/ft(i)
    152            qs   = vonkarm/fq(i)
    153            drag_m(i)    = us*us
    154            drag_t(i)    = us*bs
    155            drag_q(i)    = us*qs
    156            u_star(i) = us*speed(i)
    157            b_star(i) = bs*delta_b(i)
    158         end if
    159      enddo
    160 
    161   else
    162 
    163      mask_1 = mask .and. rich <  r_crit
    164      mask_2 = mask .and. rich >= r_crit
    165 
    166      do i = 1, n
    167         if(mask_2(i)) then
    168            drag_m(i)   = drag_min_mom
    169            drag_t(i)   = drag_min_heat
    170            drag_q(i)   = drag_min_moist
    171            us       = sqrt_drag_min_mom
    172            bs       = sqrt_drag_min_heat
    173            u_star(i)   = us*speed(i)
    174            b_star(i)   = bs*delta_b(i)
    175         end if
    176      enddo
    177 
    178      call monin_obukhov_solve_zeta (error, zeta_min, max_iter, small, &
    179           & stable_option, new_mo_option, rich_crit, zeta_trans,      &
    180           & n, rich, zz, z0, zt, zq, fm, ft, fq, mask_1, ier)
    181 
    182      do i = 1, n
    183         if(mask_1(i)) then
    184            us   = max(vonkarm/fm(i), sqrt_drag_min_mom)
    185            bs   = max(vonkarm/ft(i), sqrt_drag_min_heat)
    186            qs   = max(vonkarm/fq(i), sqrt_drag_min_moist)
    187            drag_m(i)   = us*us
    188            drag_t(i)   = us*bs
    189            drag_q(i)   = us*qs
    190            u_star(i)   = us*speed(i)
    191            b_star(i)   = bs*delta_b(i)
    192         endif
    193      enddo
    194 
    195   end if
    196 
    197 end subroutine monin_obukhov_drag_1d

Page 6           Source Listing                  MONIN_OBUKHOV_DRAG_1D
2021-06-01 08:55 Entry Points                    monin_obukhov_inter.F90



ENTRY POINTS

  Name                                                     
                                                           
 monin_obukhov_inter_mp_monin_obukhov_drag_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AVAIL                      Dummy  94       L(4)            4     1     0        ARG,IN           133                               
 BS                         Local  119      R(8)            8           scalar                    151,154,157,172,174,185,188,191   
 B_STAR                     Dummy  94       R(8)            8     1     0        ARG,INOUT        157,174,191                       
 DELTA_B                    Local  116      R(8)            8     1     0                         136,137,157,174,191               
 DRAG_M                     Dummy  93       R(8)            8     1     0        ARG,INOUT        153,168,187                       
 DRAG_MIN_HEAT              Dummy  92       R(8)            8           scalar   ARG,IN           126,169                           
 DRAG_MIN_MOIST             Dummy  92       R(8)            8           scalar   ARG,IN           128,170                           
 DRAG_MIN_MOM               Dummy  92       R(8)            8           scalar   ARG,IN           130,168                           
 DRAG_Q                     Dummy  94       R(8)            8     1     0        ARG,INOUT        155,170,189                       
 DRAG_T                     Dummy  93       R(8)            8     1     0        ARG,INOUT        154,169,188                       
 ERROR                      Dummy  90       R(8)            8           scalar   ARG,IN           178                               
 FM                         Local  114      R(8)            8     1     0                         147,150,180,184                   
 FQ                         Local  114      R(8)            8     1     0                         149,152,180,186                   
 FT                         Local  114      R(8)            8     1     0                         148,151,180,185                   
 GRAV                       Dummy  89       R(8)            8           scalar   ARG,IN           136                               
 I                          Local  120      I(4)            4           scalar                    145,146,147,148,149,150,151,152,15
                                                                                                  3,154,155,156,157,166,167,168,169,
                                                                                                  170,173,174,182,183,184,185,186,18
                                                                                                  7,188,189,190,191                 
 IER                        Dummy  94       I(4)            4           scalar   ARG,OUT          122,180                           
 LAVAIL                     Dummy  94       L(4)            4           scalar   ARG,IN           133                               
 LOG                        Func   147                                  scalar                    147,148,149                       
 MASK                       Local  115      L(4)            4     1     0                         132,133,135,146,163,164           
 MASK_1                     Local  115      L(4)            4     1     0                         163,180,183                       
 MASK_2                     Local  115      L(4)            4     1     0                         164,167                           
 MAX                        Func   138                                  scalar                    138,184,185,186                   
 MAX_ITER                   Dummy  90       I(4)            4           scalar   ARG,IN           178                               
 MONIN_OBUKHOV_DRAG_1D      Subr   89                                                                                               
 MONIN_OBUKHOV_SOLVE_ZETA   Subr   178                                                            29,178                            
 N                          Dummy  93       I(4)            4           scalar   ARG,IN           108,109,111,114,115,116,145,166,18
                                                                                                  0,182                             
 NEUTRAL                    Dummy  91       L(4)            4           scalar   ARG,IN           143                               
 NEW_MO_OPTION              Dummy  91       L(4)            4           scalar   ARG,IN           179                               
 PT                         Dummy  93       R(8)            8     1     0        ARG,IN           136                               
 PT0                        Dummy  93       R(8)            8     1     0        ARG,IN           136                               
 QS                         Local  119      R(8)            8           scalar                    152,155,186,189                   
 RICH                       Local  114      R(8)            8     1     0                         137,140,163,164,180               
 RICH_CRIT                  Dummy  91       R(8)            8           scalar   ARG,IN           123,179                           
 R_CRIT                     Local  117      R(8)            8           scalar                    123,163,164                       
 SMALL                      Dummy  90       R(8)            8           scalar   ARG,IN           137,178                           
 SPEED                      Dummy  93       R(8)            8     1     0        ARG,IN           137,156,173,190                   
 SQRT                       Func   126                                  scalar                    126,128,130                       
 SQRT_DRAG_MIN_HEAT         Local  117      R(8)            8           scalar                    125,126,172,185                   
 SQRT_DRAG_MIN_MOIST        Local  118      R(8)            8           scalar                    127,128,186                       

Page 7           Source Listing                  MONIN_OBUKHOV_DRAG_1D
2021-06-01 08:55 Symbol Table                    monin_obukhov_inter.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SQRT_DRAG_MIN_MOM          Local  118      R(8)            8           scalar                    129,130,171,184                   
 STABLE_OPTION              Dummy  91       I(4)            4           scalar   ARG,IN           179                               
 US                         Local  119      R(8)            8           scalar                    150,153,154,155,156,171,173,184,18
                                                                                                  7,188,189,190                     
 U_STAR                     Dummy  94       R(8)            8     1     0        ARG,INOUT        156,173,190                       
 VONKARM                    Dummy  89       R(8)            8           scalar   ARG,IN           150,151,152,184,185,186           
 Z                          Dummy  93       R(8)            8     1     0        ARG,IN           137,138                           
 Z0                         Dummy  93       R(8)            8     1     0        ARG,IN           138,147,180                       
 ZETA_MIN                   Dummy  90       R(8)            8           scalar   ARG,IN           178                               
 ZETA_TRANS                 Dummy  91       R(8)            8           scalar   ARG,IN           179                               
 ZQ                         Dummy  93       R(8)            8     1     0        ARG,IN           138,149,180                       
 ZT                         Dummy  93       R(8)            8     1     0        ARG,IN           138,148,180                       
 ZZ                         Local  114      R(8)            8     1     0                         138,147,148,149,180               

Page 8           Source Listing                  MONIN_OBUKHOV_DRAG_1D
2021-06-01 08:55                                 monin_obukhov_inter.F90

    198 
    199 
    200 pure subroutine monin_obukhov_solve_zeta(error, zeta_min, max_iter, small,  &
    201      & stable_option, new_mo_option, rich_crit, zeta_trans,        & !miz
    202      & n, rich, z, z0, zt, zq, f_m, f_t, f_q, mask, ier)
    203 
    204   real   , intent(in   )                :: error    ! = 1.e-04
    205   real   , intent(in   )                :: zeta_min ! = 1.e-06
    206   integer, intent(in   )                :: max_iter ! = 20
    207   real   , intent(in   )                :: small    ! = 1.e-04
    208   integer, intent(in   )                :: stable_option
    209   logical, intent(in   )                :: new_mo_option
    210   real   , intent(in   )                :: rich_crit, zeta_trans
    211   integer, intent(in   )                :: n
    212   real   , intent(in   ), dimension(n)  :: rich, z, z0, zt, zq
    213   logical, intent(in   ), dimension(n)  :: mask
    214   real   , intent(  out), dimension(n)  :: f_m, f_t, f_q
    215   integer, intent(  out)                :: ier
    216 
    217   real    :: max_cor
    218   integer :: iter
    219   real, dimension(n) ::   &
    220        d_rich, rich_1, correction, corr, z_z0, z_zt, z_zq, &
    221        ln_z_z0, ln_z_zt, ln_z_zq, zeta,                    &
    222        phi_m, phi_m_0, phi_t, phi_t_0, rzeta,              &
    223        zeta_0, zeta_t, zeta_q, df_m, df_t
    224   logical, dimension(n) :: mask_1
    225 
    226   ier = 0
    227 
    228   z_z0 = z/z0
    229   z_zt = z/zt
    230   z_zq = z/zq
    231   ln_z_z0 = log(z_z0)
    232   ln_z_zt = log(z_zt)
    233   ln_z_zq = log(z_zq)
    234 
    235   corr = 0.0
    236   mask_1 = mask
    237 
    238 ! initial guess
    239 
    240   zeta = 0.0
    241   where(mask_1)
    242      zeta = rich*ln_z_z0*ln_z_z0/ln_z_zt
    243   end where
    244 
    245   where (mask_1 .and. rich >= 0.0)
    246      zeta = zeta/(1.0 - rich/rich_crit)
    247   end where
    248 
    249   iter_loop: do iter = 1, max_iter
    250 
    251      where (mask_1 .and. abs(zeta).lt.zeta_min)
    252         zeta = 0.0
    253         f_m = ln_z_z0
    254         f_t = ln_z_zt

Page 9           Source Listing                  MONIN_OBUKHOV_SOLVE_ZETA
2021-06-01 08:55                                 monin_obukhov_inter.F90

    255         f_q = ln_z_zq
    256         mask_1 = .false.  ! don't do any more calculations at these pts
    257      end where
    258 
    259 
    260      zeta_0 = 0.0
    261      zeta_t = 0.0
    262      zeta_q = 0.0
    263      where (mask_1)
    264         rzeta  = 1.0/zeta
    265         zeta_0 = zeta/z_z0
    266         zeta_t = zeta/z_zt
    267         zeta_q = zeta/z_zq
    268      end where
    269 
    270      call monin_obukhov_derivative_m(stable_option, rich_crit, zeta_trans, &
    271           & n, phi_m  , zeta  , mask_1, ier)
    272      call monin_obukhov_derivative_m(stable_option, rich_crit, zeta_trans, &
    273           & n, phi_m_0, zeta_0,  mask_1, ier)
    274      call monin_obukhov_derivative_t(stable_option, new_mo_option,rich_crit, zeta_trans, &
    275           & n, phi_t  , zeta  , mask_1, ier)
    276      call monin_obukhov_derivative_t(stable_option, new_mo_option,rich_crit, zeta_trans, &
    277           & n, phi_t_0, zeta_t, mask_1, ier)
    278 
    279      call monin_obukhov_integral_m(stable_option, rich_crit, zeta_trans, &
    280           & n, f_m, zeta, zeta_0, ln_z_z0, mask_1, ier)
    281      call monin_obukhov_integral_tq(stable_option, new_mo_option, rich_crit, zeta_trans, &
    282           & n, f_t, f_q, zeta, zeta_t, zeta_q, ln_z_zt, ln_z_zq, mask_1, ier)
    283 
    284      where (mask_1)
    285         df_m  = (phi_m - phi_m_0)*rzeta
    286         df_t  = (phi_t - phi_t_0)*rzeta
    287         rich_1 = zeta*f_t/(f_m*f_m)
    288         d_rich = rich_1*( rzeta +  df_t/f_t - 2.0 *df_m/f_m)
    289         correction = (rich - rich_1)/d_rich
    290         corr = min(abs(correction),abs(correction/zeta))
    291 ! the criterion corr < error seems to work ok, but is a bit arbitrary
    292 !  when zeta is small the tolerance is reduced
    293      end where
    294 
    295      max_cor= maxval(corr)
    296 
    297      if(max_cor > error) then
    298         mask_1 = mask_1 .and. (corr > error)
    299 ! change the mask so computation proceeds only on non-converged points
    300         where(mask_1)
    301            zeta = zeta + correction
    302         end where
    303         cycle iter_loop
    304      else
    305         return
    306      end if
    307 
    308   end do iter_loop
    309 
    310   ier = 1 ! surface drag iteration did not converge
    311 

Page 10          Source Listing                  MONIN_OBUKHOV_SOLVE_ZETA
2021-06-01 08:55                                 monin_obukhov_inter.F90

    312 end subroutine monin_obukhov_solve_zeta


ENTRY POINTS

  Name                                                        
                                                              
 monin_obukhov_inter_mp_monin_obukhov_solve_zeta_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ABS                        Func   251                                  scalar                    251,290                           
 CORR                       Local  220      R(8)            8     1     0                         235,290,295,298                   
 CORRECTION                 Local  220      R(8)            8     1     0                         289,290,301                       
 DF_M                       Local  223      R(8)            8     1     0                         285,288                           
 DF_T                       Local  223      R(8)            8     1     0                         286,288                           
 D_RICH                     Local  220      R(8)            8     1     0                         288,289                           
 ERROR                      Dummy  200      R(8)            8           scalar   ARG,IN           297,298                           
 F_M                        Dummy  202      R(8)            8     1     0        ARG,OUT          253,280,287,288                   
 F_Q                        Dummy  202      R(8)            8     1     0        ARG,OUT          255,282                           
 F_T                        Dummy  202      R(8)            8     1     0        ARG,OUT          254,282,287,288                   
 IER                        Dummy  202      I(4)            4           scalar   ARG,OUT          226,271,273,275,277,280,282,310   
 ITER                       Local  218      I(4)            4           scalar                    249                               
 ITER_LOOP                  Label  249                                  scalar                    303,308                           
 LN_Z_Z0                    Local  221      R(8)            8     1     0                         231,242,253,280                   
 LN_Z_ZQ                    Local  221      R(8)            8     1     0                         233,255,282                       
 LN_Z_ZT                    Local  221      R(8)            8     1     0                         232,242,254,282                   
 LOG                        Func   231                                  scalar                    231,232,233                       
 MASK                       Dummy  202      L(4)            4     1     0        ARG,IN           236                               
 MASK_1                     Local  224      L(4)            4     1     0                         236,241,245,251,256,263,271,273,27
                                                                                                  5,277,280,282,284,298,300         
 MAXVAL                     Func   295                                  scalar                    295                               
 MAX_COR                    Local  217      R(8)            8           scalar                    295,297                           
 MAX_ITER                   Dummy  200      I(4)            4           scalar   ARG,IN           249                               
 MIN                        Func   290                                  scalar                    290                               
 MONIN_OBUKHOV_INTEGRAL_M   Subr   279                                                            33,279,482,484                    
 MONIN_OBUKHOV_INTEGRAL_TQ  Subr   281                                                            34,281,487,489                    
 MONIN_OBUKHOV_SOLVE_ZETA   Subr   200                                                                                              
 N                          Dummy  202      I(4)            4           scalar   ARG,IN           212,213,214,220,221,222,223,224,27
                                                                                                  1,273,275,277,280,282             
 NEW_MO_OPTION              Dummy  201      L(4)            4           scalar   ARG,IN           274,276,281                       
 PHI_M                      Local  222      R(8)            8     1     0                         271,285                           
 PHI_M_0                    Local  222      R(8)            8     1     0                         273,285                           
 PHI_T                      Local  222      R(8)            8     1     0                         275,286                           
 PHI_T_0                    Local  222      R(8)            8     1     0                         277,286                           
 RICH                       Dummy  202      R(8)            8     1     0        ARG,IN           242,245,246,289                   
 RICH_1                     Local  220      R(8)            8     1     0                         287,288,289                       
 RICH_CRIT                  Dummy  201      R(8)            8           scalar   ARG,IN           246,270,272,274,276,279,281       
 RZETA                      Local  222      R(8)            8     1     0                         264,285,286,288                   
 SMALL                      Dummy  200      R(8)            8           scalar   ARG,IN                                             
 STABLE_OPTION              Dummy  201      I(4)            4           scalar   ARG,IN           270,272,274,276,279,281           
 Z                          Dummy  202      R(8)            8     1     0        ARG,IN           228,229,230                       
 Z0                         Dummy  202      R(8)            8     1     0        ARG,IN           228                               
 ZETA                       Local  221      R(8)            8     1     0                         240,242,246,251,252,264,265,266,26

Page 11          Source Listing                  MONIN_OBUKHOV_SOLVE_ZETA
2021-06-01 08:55 Symbol Table                    monin_obukhov_inter.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  7,271,275,280,282,287,290,301     
 ZETA_0                     Local  223      R(8)            8     1     0                         260,265,273,280                   
 ZETA_MIN                   Dummy  200      R(8)            8           scalar   ARG,IN           251                               
 ZETA_Q                     Local  223      R(8)            8     1     0                         262,267,282                       
 ZETA_T                     Local  223      R(8)            8     1     0                         261,266,277,282                   
 ZETA_TRANS                 Dummy  201      R(8)            8           scalar   ARG,IN           270,272,274,276,279,281           
 ZQ                         Dummy  202      R(8)            8     1     0        ARG,IN           230                               
 ZT                         Dummy  202      R(8)            8     1     0        ARG,IN           229                               
 Z_Z0                       Local  220      R(8)            8     1     0                         228,231,265                       
 Z_ZQ                       Local  220      R(8)            8     1     0                         230,233,267                       
 Z_ZT                       Local  220      R(8)            8     1     0                         229,232,266                       

Page 12          Source Listing                  MONIN_OBUKHOV_SOLVE_ZETA
2021-06-01 08:55                                 monin_obukhov_inter.F90

    313 
    314 
    315 ! the differential similarity function for buoyancy and tracers
    316 ! Note: seems to be the same as monin_obukhov_derivative_m?
    317 pure subroutine monin_obukhov_derivative_t(stable_option,new_mo_option,rich_crit, zeta_trans, &
    318      & n, phi_t, zeta, mask, ier)
    319 
    320   integer, intent(in   )                :: stable_option
    321   logical, intent(in   )                :: new_mo_option !miz
    322   real   , intent(in   )                :: rich_crit, zeta_trans
    323   integer, intent(in   )                :: n
    324   real   , intent(  out), dimension(n)  :: phi_t
    325   real   , intent(in   ), dimension(n)  :: zeta
    326   logical, intent(in   ), dimension(n)  :: mask
    327   integer, intent(  out)                :: ier
    328 
    329   logical, dimension(n) :: stable, unstable
    330   real                  :: b_stab, lambda
    331 
    332   ier = 0
    333   b_stab     = 1.0/rich_crit
    334 
    335   stable   = mask .and. zeta >= 0.0
    336   unstable = mask .and. zeta <  0.0
    337 
    338 !miz: modified to include new monin-obukhov option
    339   if (new_mo_option) then
    340      where (unstable)
    341         phi_t = (1 - 16.0*zeta)**(-1./3.)
    342      end where
    343   else
    344   where (unstable)
    345      phi_t = (1 - 16.0*zeta)**(-0.5)
    346   end where
    347   end if
    348 !miz
    349 
    350   if(stable_option == 1) then
    351 
    352      where (stable)
    353         phi_t = 1.0 + zeta*(5.0 + b_stab*zeta)/(1.0 + zeta)
    354      end where
    355 
    356   else if(stable_option == 2) then
    357 
    358      lambda = 1.0 + (5.0 - b_stab)*zeta_trans
    359 
    360      where (stable .and. zeta < zeta_trans)
    361         phi_t = 1 + 5.0*zeta
    362      end where
    363      where (stable .and. zeta >= zeta_trans)
    364         phi_t = lambda + b_stab*zeta
    365      end where
    366 
    367   endif
    368 
    369 end subroutine monin_obukhov_derivative_t

Page 13          Source Listing                  MONIN_OBUKHOV_DERIVATIVE_T
2021-06-01 08:55 Entry Points                    monin_obukhov_inter.F90



ENTRY POINTS

  Name                                                          
                                                                
 monin_obukhov_inter_mp_monin_obukhov_derivative_t_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAB                     Local  330      R(8)            8           scalar                    333,353,358,364                   
 IER                        Dummy  318      I(4)            4           scalar   ARG,OUT          332                               
 LAMBDA                     Local  330      R(8)            8           scalar                    358,364                           
 MASK                       Dummy  318      L(4)            4     1     0        ARG,IN           335,336                           
 MONIN_OBUKHOV_DERIVATIVE_T Subr   317                                                                                              
 N                          Dummy  318      I(4)            4           scalar   ARG,IN           324,325,326,329                   
 NEW_MO_OPTION              Dummy  317      L(4)            4           scalar   ARG,IN           339                               
 PHI_T                      Dummy  318      R(8)            8     1     0        ARG,OUT          341,345,353,361,364               
 RICH_CRIT                  Dummy  317      R(8)            8           scalar   ARG,IN           333                               
 STABLE                     Local  329      L(4)            4     1     0                         335,352,360,363                   
 STABLE_OPTION              Dummy  317      I(4)            4           scalar   ARG,IN           350,356                           
 UNSTABLE                   Local  329      L(4)            4     1     0                         336,340,344                       
 ZETA                       Dummy  318      R(8)            8     1     0        ARG,IN           335,336,341,345,353,360,361,363,36
                                                                                                  4                                 
 ZETA_TRANS                 Dummy  317      R(8)            8           scalar   ARG,IN           358,360,363                       

Page 14          Source Listing                  MONIN_OBUKHOV_DERIVATIVE_T
2021-06-01 08:55                                 monin_obukhov_inter.F90

    370 
    371 
    372 ! the differential similarity function for momentum
    373 pure subroutine monin_obukhov_derivative_m(stable_option, rich_crit, zeta_trans, &
    374      & n, phi_m, zeta, mask, ier)
    375 
    376   integer, intent(in   )                :: stable_option
    377   real   , intent(in   )                :: rich_crit, zeta_trans
    378   integer, intent(in   )                :: n
    379   real   , intent(  out), dimension(n)  :: phi_m
    380   real   , intent(in   ), dimension(n)  :: zeta
    381   logical, intent(in   ), dimension(n)  :: mask
    382   integer, intent(out  )                :: ier
    383 
    384   logical, dimension(n) :: stable, unstable
    385   real   , dimension(n) :: x
    386   real                  :: b_stab, lambda
    387 
    388   ier = 0
    389   b_stab     = 1.0/rich_crit
    390 
    391   stable   = mask .and. zeta >= 0.0
    392   unstable = mask .and. zeta <  0.0
    393 
    394   where (unstable)
    395      x     = (1 - 16.0*zeta  )**(-0.5)
    396      phi_m = sqrt(x)  ! phi_m = (1 - 16.0*zeta)**(-0.25)
    397   end where
    398 
    399   if(stable_option == 1) then
    400 
    401      where (stable)
    402         phi_m = 1.0 + zeta  *(5.0 + b_stab*zeta)/(1.0 + zeta)
    403      end where
    404 
    405   else if(stable_option == 2) then
    406 
    407      lambda = 1.0 + (5.0 - b_stab)*zeta_trans
    408 
    409      where (stable .and. zeta < zeta_trans)
    410         phi_m = 1 + 5.0*zeta
    411      end where
    412      where (stable .and. zeta >= zeta_trans)
    413         phi_m = lambda + b_stab*zeta
    414      end where
    415 
    416   endif
    417 
    418 end subroutine monin_obukhov_derivative_m

Page 15          Source Listing                  MONIN_OBUKHOV_DERIVATIVE_M
2021-06-01 08:55 Entry Points                    monin_obukhov_inter.F90



ENTRY POINTS

  Name                                                          
                                                                
 monin_obukhov_inter_mp_monin_obukhov_derivative_m_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAB                     Local  386      R(8)            8           scalar                    389,402,407,413                   
 IER                        Dummy  374      I(4)            4           scalar   ARG,OUT          388                               
 LAMBDA                     Local  386      R(8)            8           scalar                    407,413                           
 MASK                       Dummy  374      L(4)            4     1     0        ARG,IN           391,392                           
 MONIN_OBUKHOV_DERIVATIVE_M Subr   373                                                                                              
 N                          Dummy  374      I(4)            4           scalar   ARG,IN           379,380,381,384,385               
 PHI_M                      Dummy  374      R(8)            8     1     0        ARG,OUT          396,402,410,413                   
 RICH_CRIT                  Dummy  373      R(8)            8           scalar   ARG,IN           389                               
 SQRT                       Func   396                                  scalar                    396                               
 STABLE                     Local  384      L(4)            4     1     0                         391,401,409,412                   
 STABLE_OPTION              Dummy  373      I(4)            4           scalar   ARG,IN           399,405                           
 UNSTABLE                   Local  384      L(4)            4     1     0                         392,394                           
 X                          Local  385      R(8)            8     1     0                         395,396                           
 ZETA                       Dummy  374      R(8)            8     1     0        ARG,IN           391,392,395,402,409,410,412,413   
 ZETA_TRANS                 Dummy  373      R(8)            8           scalar   ARG,IN           407,409,412                       

Page 16          Source Listing                  MONIN_OBUKHOV_DERIVATIVE_M
2021-06-01 08:55                                 monin_obukhov_inter.F90

    419 
    420 
    421 pure subroutine monin_obukhov_profile_1d(vonkarm, &
    422      & neutral, stable_option, new_mo_option, rich_crit, zeta_trans, &
    423      & n, zref, zref_t, z, z0, zt, zq, u_star, b_star, q_star, &
    424      & del_m, del_t, del_q, lavail, avail, ier)
    425 
    426   real   , intent(in   )                :: vonkarm
    427   logical, intent(in   )                :: neutral
    428   integer, intent(in   )                :: stable_option
    429   logical, intent(in   )                :: new_mo_option
    430   real   , intent(in   )                :: rich_crit, zeta_trans
    431   integer, intent(in   )                :: n
    432   real,    intent(in   )                :: zref, zref_t
    433   real,    intent(in   ), dimension(n)  :: z, z0, zt, zq, u_star, b_star, q_star
    434   real,    intent(  out), dimension(n)  :: del_m, del_t, del_q
    435   logical, intent(in   )                :: lavail ! whether to use provided mask or not
    436   logical, intent(in   ), dimension(n)  :: avail  ! provided mask
    437   integer, intent(out  )                :: ier
    438 
    439   real, dimension(n) :: zeta, zeta_0, zeta_t, zeta_q, zeta_ref, zeta_ref_t, &
    440        ln_z_z0, ln_z_zt, ln_z_zq, ln_z_zref, ln_z_zref_t,  &
    441        f_m_ref, f_m, f_t_ref, f_t, f_q_ref, f_q,           &
    442        mo_length_inv
    443   logical, dimension(n) :: mask
    444 
    445   ier = 0
    446 
    447   mask = .true.
    448   if(lavail) mask = avail
    449 
    450   del_m = 0.0  ! zero output arrays
    451   del_t = 0.0
    452   del_q = 0.0
    453 
    454   where(mask)
    455      ln_z_z0     = log(z/z0)
    456      ln_z_zt     = log(z/zt)
    457      ln_z_zq     = log(z/zq)
    458      ln_z_zref   = log(z/zref)
    459      ln_z_zref_t = log(z/zref_t)
    460   endwhere
    461 
    462   if(neutral) then
    463 
    464      where(mask)
    465         del_m = 1.0 - ln_z_zref  /ln_z_z0
    466         del_t = 1.0 - ln_z_zref_t/ln_z_zt
    467         del_q = 1.0 - ln_z_zref_t/ln_z_zq
    468      endwhere
    469 
    470   else
    471 
    472      where(mask .and. u_star > 0.0)
    473         mo_length_inv = - vonkarm * b_star/(u_star*u_star)
    474         zeta       = z     *mo_length_inv
    475         zeta_0     = z0    *mo_length_inv

Page 17          Source Listing                  MONIN_OBUKHOV_PROFILE_1D
2021-06-01 08:55                                 monin_obukhov_inter.F90

    476         zeta_t     = zt    *mo_length_inv
    477         zeta_q     = zq    *mo_length_inv
    478         zeta_ref   = zref  *mo_length_inv
    479         zeta_ref_t = zref_t*mo_length_inv
    480      endwhere
    481 
    482      call monin_obukhov_integral_m(stable_option, rich_crit, zeta_trans, &
    483           & n, f_m,     zeta, zeta_0,   ln_z_z0,   mask, ier)
    484      call monin_obukhov_integral_m(stable_option, rich_crit, zeta_trans, &
    485           & n, f_m_ref, zeta, zeta_ref, ln_z_zref, mask, ier)
    486 
    487      call monin_obukhov_integral_tq(stable_option, new_mo_option, rich_crit, zeta_trans, &
    488           & n, f_t, f_q, zeta, zeta_t, zeta_q, ln_z_zt, ln_z_zq, mask, ier)
    489      call monin_obukhov_integral_tq(stable_option, new_mo_option, rich_crit, zeta_trans, &
    490           & n, f_t_ref, f_q_ref, zeta, zeta_ref_t, zeta_ref_t, ln_z_zref_t, ln_z_zref_t,  mask, ier)
    491 
    492      where(mask)
    493         del_m = 1.0 - f_m_ref/f_m
    494         del_t = 1.0 - f_t_ref/f_t
    495         del_q = 1.0 - f_q_ref/f_q
    496      endwhere
    497 
    498   end if
    499 
    500 
    501 end subroutine monin_obukhov_profile_1d


ENTRY POINTS

  Name                                                        
                                                              
 monin_obukhov_inter_mp_monin_obukhov_profile_1d_             

Page 18          Source Listing                  MONIN_OBUKHOV_PROFILE_1D
2021-06-01 08:55 Symbol Table                    monin_obukhov_inter.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AVAIL                      Dummy  424      L(4)            4     1     0        ARG,IN           448                               
 B_STAR                     Dummy  423      R(8)            8     1     0        ARG,IN           473                               
 DEL_M                      Dummy  424      R(8)            8     1     0        ARG,OUT          450,465,493                       
 DEL_Q                      Dummy  424      R(8)            8     1     0        ARG,OUT          452,467,495                       
 DEL_T                      Dummy  424      R(8)            8     1     0        ARG,OUT          451,466,494                       
 F_M                        Local  441      R(8)            8     1     0                         483,493                           
 F_M_REF                    Local  441      R(8)            8     1     0                         485,493                           
 F_Q                        Local  441      R(8)            8     1     0                         488,495                           
 F_Q_REF                    Local  441      R(8)            8     1     0                         490,495                           
 F_T                        Local  441      R(8)            8     1     0                         488,494                           
 F_T_REF                    Local  441      R(8)            8     1     0                         490,494                           
 IER                        Dummy  424      I(4)            4           scalar   ARG,OUT          445,483,485,488,490               
 LAVAIL                     Dummy  424      L(4)            4           scalar   ARG,IN           448                               
 LN_Z_Z0                    Local  440      R(8)            8     1     0                         455,465,483                       
 LN_Z_ZQ                    Local  440      R(8)            8     1     0                         457,467,488                       
 LN_Z_ZREF                  Local  440      R(8)            8     1     0                         458,465,485                       
 LN_Z_ZREF_T                Local  440      R(8)            8     1     0                         459,466,467,490                   
 LN_Z_ZT                    Local  440      R(8)            8     1     0                         456,466,488                       
 LOG                        Func   455                                  scalar                    455,456,457,458,459               
 MASK                       Local  443      L(4)            4     1     0                         447,448,454,464,472,483,485,488,49
                                                                                                  0,492                             
 MONIN_OBUKHOV_PROFILE_1D   Subr   421                                                                                              
 MO_LENGTH_INV              Local  442      R(8)            8     1     0                         473,474,475,476,477,478,479       
 N                          Dummy  423      I(4)            4           scalar   ARG,IN           433,434,436,439,440,441,442,443,48
                                                                                                  3,485,488,490                     
 NEUTRAL                    Dummy  422      L(4)            4           scalar   ARG,IN           462                               
 NEW_MO_OPTION              Dummy  422      L(4)            4           scalar   ARG,IN           487,489                           
 Q_STAR                     Dummy  423      R(8)            8     1     0        ARG,IN                                             
 RICH_CRIT                  Dummy  422      R(8)            8           scalar   ARG,IN           482,484,487,489                   
 STABLE_OPTION              Dummy  422      I(4)            4           scalar   ARG,IN           482,484,487,489                   
 U_STAR                     Dummy  423      R(8)            8     1     0        ARG,IN           472,473                           
 VONKARM                    Dummy  421      R(8)            8           scalar   ARG,IN           473                               
 Z                          Dummy  423      R(8)            8     1     0        ARG,IN           455,456,457,458,459,474           
 Z0                         Dummy  423      R(8)            8     1     0        ARG,IN           455,475                           
 ZETA                       Local  439      R(8)            8     1     0                         474,483,485,488,490               
 ZETA_0                     Local  439      R(8)            8     1     0                         475,483                           
 ZETA_Q                     Local  439      R(8)            8     1     0                         477,488                           
 ZETA_REF                   Local  439      R(8)            8     1     0                         478,485                           
 ZETA_REF_T                 Local  439      R(8)            8     1     0                         479,490                           
 ZETA_T                     Local  439      R(8)            8     1     0                         476,488                           
 ZETA_TRANS                 Dummy  422      R(8)            8           scalar   ARG,IN           482,484,487,489                   
 ZQ                         Dummy  423      R(8)            8     1     0        ARG,IN           457,477                           
 ZREF                       Dummy  423      R(8)            8           scalar   ARG,IN           458,478                           
 ZREF_T                     Dummy  423      R(8)            8           scalar   ARG,IN           459,479                           
 ZT                         Dummy  423      R(8)            8     1     0        ARG,IN           456,476                           

Page 19          Source Listing                  MONIN_OBUKHOV_PROFILE_1D
2021-06-01 08:55                                 monin_obukhov_inter.F90

    502 
    503 
    504 !  the integral similarity function for momentum
    505 pure subroutine monin_obukhov_integral_m(stable_option, rich_crit, zeta_trans, &
    506      & n, psi_m, zeta, zeta_0, ln_z_z0, mask, ier)
    507 
    508   integer, intent(in   )                :: stable_option
    509   real   , intent(in   )                :: rich_crit, zeta_trans
    510   integer, intent(in   )                :: n
    511   real   , intent(inout), dimension(n)  :: psi_m
    512   real   , intent(in)   , dimension(n)  :: zeta, zeta_0, ln_z_z0
    513   logical, intent(in)   , dimension(n)  :: mask
    514   integer, intent(out)                  :: ier
    515 
    516   real                   :: b_stab, lambda
    517   real, dimension(n) :: x, x_0, x1, x1_0, num, denom, y
    518   logical, dimension(n) :: stable, unstable, &
    519        weakly_stable, strongly_stable
    520 
    521   ier = 0
    522 
    523   b_stab     = 1.0/rich_crit
    524 
    525   stable   = mask .and. zeta >= 0.0
    526   unstable = mask .and. zeta <  0.0
    527 
    528   where(unstable)
    529 
    530      x     = sqrt(1 - 16.0*zeta)
    531      x_0   = sqrt(1 - 16.0*zeta_0)
    532 
    533      x      = sqrt(x)
    534      x_0    = sqrt(x_0)
    535 
    536      x1     = 1.0 + x
    537      x1_0   = 1.0 + x_0
    538 
    539      num    = x1*x1*(1.0 + x*x)
    540      denom  = x1_0*x1_0*(1.0 + x_0*x_0)
    541      y      = atan(x) - atan(x_0)
    542      psi_m  = ln_z_z0 - log(num/denom) + 2*y
    543 
    544   end where
    545 
    546   if( stable_option == 1) then
    547 
    548      where (stable)
    549         psi_m = ln_z_z0 + (5.0 - b_stab)*log((1.0 + zeta)/(1.0 + zeta_0)) &
    550              + b_stab*(zeta - zeta_0)
    551      end where
    552 
    553   else if (stable_option == 2) then
    554 
    555      lambda = 1.0 + (5.0 - b_stab)*zeta_trans
    556 
    557      weakly_stable   = stable .and. zeta <= zeta_trans
    558      strongly_stable = stable .and. zeta >  zeta_trans

Page 20          Source Listing                  MONIN_OBUKHOV_INTEGRAL_M
2021-06-01 08:55                                 monin_obukhov_inter.F90

    559 
    560      where (weakly_stable)
    561         psi_m = ln_z_z0 + 5.0*(zeta - zeta_0)
    562      end where
    563 
    564      where(strongly_stable)
    565         x = (lambda - 1.0)*log(zeta/zeta_trans) + b_stab*(zeta - zeta_trans)
    566      endwhere
    567 
    568      where (strongly_stable .and. zeta_0 <= zeta_trans)
    569         psi_m = ln_z_z0 + x + 5.0*(zeta_trans - zeta_0)
    570      end where
    571      where (strongly_stable .and. zeta_0 > zeta_trans)
    572         psi_m = lambda*ln_z_z0 + b_stab*(zeta  - zeta_0)
    573      endwhere
    574 
    575   end if
    576 
    577 end subroutine monin_obukhov_integral_m


ENTRY POINTS

  Name                                                        
                                                              
 monin_obukhov_inter_mp_monin_obukhov_integral_m_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ATAN                       Func   541                                  scalar                    541                               
 B_STAB                     Local  516      R(8)            8           scalar                    523,549,550,555,565,572           
 DENOM                      Local  517      R(8)            8     1     0                         540,542                           
 IER                        Dummy  506      I(4)            4           scalar   ARG,OUT          521                               
 LAMBDA                     Local  516      R(8)            8           scalar                    555,565,572                       
 LN_Z_Z0                    Dummy  506      R(8)            8     1     0        ARG,IN           542,549,561,569,572               
 LOG                        Func   542                                  scalar                    542,549,565                       
 MASK                       Dummy  506      L(4)            4     1     0        ARG,IN           525,526                           
 MONIN_OBUKHOV_INTEGRAL_M   Subr   505                                                                                              
 N                          Dummy  506      I(4)            4           scalar   ARG,IN           511,512,513,517,518,519           
 NUM                        Local  517      R(8)            8     1     0                         539,542                           
 PSI_M                      Dummy  506      R(8)            8     1     0        ARG,INOUT        542,549,561,569,572               
 RICH_CRIT                  Dummy  505      R(8)            8           scalar   ARG,IN           523                               
 SQRT                       Func   530                                  scalar                    530,531,533,534                   
 STABLE                     Local  518      L(4)            4     1     0                         525,548,557,558                   
 STABLE_OPTION              Dummy  505      I(4)            4           scalar   ARG,IN           546,553                           
 STRONGLY_STABLE            Local  519      L(4)            4     1     0                         558,564,568,571                   
 UNSTABLE                   Local  518      L(4)            4     1     0                         526,528                           
 WEAKLY_STABLE              Local  519      L(4)            4     1     0                         557,560                           
 X                          Local  517      R(8)            8     1     0                         530,533,536,539,541,565,569       
 X1                         Local  517      R(8)            8     1     0                         536,539                           
 X1_0                       Local  517      R(8)            8     1     0                         537,540                           
 X_0                        Local  517      R(8)            8     1     0                         531,534,537,540,541               
 Y                          Local  517      R(8)            8     1     0                         541,542                           
 ZETA                       Dummy  506      R(8)            8     1     0        ARG,IN           525,526,530,549,550,557,558,561,56

Page 21          Source Listing                  MONIN_OBUKHOV_INTEGRAL_M
2021-06-01 08:55 Symbol Table                    monin_obukhov_inter.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  5,572                             
 ZETA_0                     Dummy  506      R(8)            8     1     0        ARG,IN           531,549,550,561,568,569,571,572   
 ZETA_TRANS                 Dummy  505      R(8)            8           scalar   ARG,IN           555,557,558,565,568,569,571       

Page 22          Source Listing                  MONIN_OBUKHOV_INTEGRAL_M
2021-06-01 08:55                                 monin_obukhov_inter.F90

    578 
    579 
    580 ! the integral similarity function for moisture and tracers
    581 pure subroutine monin_obukhov_integral_tq(stable_option, new_mo_option, rich_crit, zeta_trans, &
    582      & n, psi_t, psi_q, zeta, zeta_t, zeta_q, &
    583      & ln_z_zt, ln_z_zq, mask, ier)
    584 
    585   integer, intent(in   )                :: stable_option
    586   logical, intent(in   )                :: new_mo_option !miz
    587   real,    intent(in   )                :: rich_crit, zeta_trans
    588   integer, intent(in   )                :: n
    589   real   , intent(inout), dimension(n)  :: psi_t, psi_q
    590   real   , intent(in)   , dimension(n)  :: zeta, zeta_t, zeta_q, ln_z_zt, ln_z_zq
    591   logical, intent(in)   , dimension(n)  :: mask
    592   integer, intent(  out)                :: ier
    593 
    594   real, dimension(n)     :: x, x_t, x_q
    595   logical, dimension(n)  :: stable, unstable, &
    596                                   weakly_stable, strongly_stable
    597   real                   :: b_stab, lambda
    598   real                   :: s3 !miz
    599 
    600   ier = 0
    601 
    602   b_stab     = 1.0/rich_crit
    603 
    604 stable   = mask .and. zeta >= 0.0
    605 unstable = mask .and. zeta <  0.0
    606 
    607 !miz: modified to include a new monin-obukhov option
    608 if (new_mo_option) then
    609  s3 = sqrt(3.0)
    610  where(unstable)
    611   x     = (1 - 16.0*zeta)**(1./3.)
    612   x_t   = (1 - 16.0*zeta_t)**(1./3.)
    613   x_q   = (1 - 16.0*zeta_q)**(1./3.)
    614 
    615   psi_t = ln_z_zt - 1.5*log((x**2+x+1)/(x_t**2 + x_t + 1)) + s3*(atan((2*x+1)/s3) - atan((2*x_t + 1)/s3))
    616   psi_q = ln_z_zq - 1.5*log((x**2+x+1)/(x_q**2 + x_q + 1)) + s3*(atan((2*x+1)/s3) - atan((2*x_q + 1)/s3))
    617   end where
    618 else
    619 
    620 where(unstable)
    621 
    622   x     = sqrt(1 - 16.0*zeta)
    623   x_t   = sqrt(1 - 16.0*zeta_t)
    624   x_q   = sqrt(1 - 16.0*zeta_q)
    625 
    626   psi_t = ln_z_zt - 2.0*log( (1.0 + x)/(1.0 + x_t) )
    627   psi_q = ln_z_zq - 2.0*log( (1.0 + x)/(1.0 + x_q) )
    628 
    629 end where
    630 end if
    631 !miz
    632 
    633 if( stable_option == 1) then
    634 

Page 23          Source Listing                  MONIN_OBUKHOV_INTEGRAL_TQ
2021-06-01 08:55                                 monin_obukhov_inter.F90

    635   where (stable)
    636 
    637     psi_t = ln_z_zt + (5.0 - b_stab)*log((1.0 + zeta)/(1.0 + zeta_t)) &
    638        + b_stab*(zeta - zeta_t)
    639     psi_q = ln_z_zq + (5.0 - b_stab)*log((1.0 + zeta)/(1.0 + zeta_q)) &
    640        + b_stab*(zeta - zeta_q)
    641 
    642   end where
    643 
    644 else if (stable_option == 2) then
    645 
    646    lambda = 1.0 + (5.0 - b_stab)*zeta_trans
    647 
    648   weakly_stable   = stable .and. zeta <= zeta_trans
    649   strongly_stable = stable .and. zeta >  zeta_trans
    650 
    651   where (weakly_stable)
    652     psi_t = ln_z_zt + 5.0*(zeta - zeta_t)
    653     psi_q = ln_z_zq + 5.0*(zeta - zeta_q)
    654   end where
    655 
    656   where(strongly_stable)
    657     x = (lambda - 1.0)*log(zeta/zeta_trans) + b_stab*(zeta - zeta_trans)
    658   endwhere
    659 
    660   where (strongly_stable .and. zeta_t <= zeta_trans)
    661     psi_t = ln_z_zt + x + 5.0*(zeta_trans - zeta_t)
    662   end where
    663   where (strongly_stable .and. zeta_t > zeta_trans)
    664     psi_t = lambda*ln_z_zt + b_stab*(zeta  - zeta_t)
    665   endwhere
    666 
    667   where (strongly_stable .and. zeta_q <= zeta_trans)
    668     psi_q = ln_z_zq + x + 5.0*(zeta_trans - zeta_q)
    669   end where
    670   where (strongly_stable .and. zeta_q > zeta_trans)
    671     psi_q = lambda*ln_z_zq + b_stab*(zeta  - zeta_q)
    672   endwhere
    673 
    674 end if
    675 
    676 end subroutine monin_obukhov_integral_tq

Page 24          Source Listing                  MONIN_OBUKHOV_INTEGRAL_TQ
2021-06-01 08:55 Entry Points                    monin_obukhov_inter.F90



ENTRY POINTS

  Name                                                         
                                                               
 monin_obukhov_inter_mp_monin_obukhov_integral_tq_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ATAN                       Func   615                                  scalar                    615,616                           
 B_STAB                     Local  597      R(8)            8           scalar                    602,637,638,639,640,646,657,664,67
                                                                                                  1                                 
 IER                        Dummy  583      I(4)            4           scalar   ARG,OUT          600                               
 LAMBDA                     Local  597      R(8)            8           scalar                    646,657,664,671                   
 LN_Z_ZQ                    Dummy  583      R(8)            8     1     0        ARG,IN           616,627,639,653,668,671           
 LN_Z_ZT                    Dummy  583      R(8)            8     1     0        ARG,IN           615,626,637,652,661,664           
 LOG                        Func   615                                  scalar                    615,616,626,627,637,639,657       
 MASK                       Dummy  583      L(4)            4     1     0        ARG,IN           604,605                           
 MONIN_OBUKHOV_INTEGRAL_TQ  Subr   581                                                                                              
 N                          Dummy  582      I(4)            4           scalar   ARG,IN           589,590,591,594,595,596           
 NEW_MO_OPTION              Dummy  581      L(4)            4           scalar   ARG,IN           608                               
 PSI_Q                      Dummy  582      R(8)            8     1     0        ARG,INOUT        616,627,639,653,668,671           
 PSI_T                      Dummy  582      R(8)            8     1     0        ARG,INOUT        615,626,637,652,661,664           
 RICH_CRIT                  Dummy  581      R(8)            8           scalar   ARG,IN           602                               
 S3                         Local  598      R(8)            8           scalar                    609,615,616                       
 SQRT                       Func   609                                  scalar                    609,622,623,624                   
 STABLE                     Local  595      L(4)            4     1     0                         604,635,648,649                   
 STABLE_OPTION              Dummy  581      I(4)            4           scalar   ARG,IN           633,644                           
 STRONGLY_STABLE            Local  596      L(4)            4     1     0                         649,656,660,663,667,670           
 UNSTABLE                   Local  595      L(4)            4     1     0                         605,610,620                       
 WEAKLY_STABLE              Local  596      L(4)            4     1     0                         648,651                           
 X                          Local  594      R(8)            8     1     0                         611,615,616,622,626,627,657,661,66
                                                                                                  8                                 
 X_Q                        Local  594      R(8)            8     1     0                         613,616,624,627                   
 X_T                        Local  594      R(8)            8     1     0                         612,615,623,626                   
 ZETA                       Dummy  582      R(8)            8     1     0        ARG,IN           604,605,611,622,637,638,639,640,64
                                                                                                  8,649,652,653,657,664,671         
 ZETA_Q                     Dummy  582      R(8)            8     1     0        ARG,IN           613,624,639,640,653,667,668,670,67
                                                                                                  1                                 
 ZETA_T                     Dummy  582      R(8)            8     1     0        ARG,IN           612,623,637,638,652,660,661,663,66
                                                                                                  4                                 
 ZETA_TRANS                 Dummy  581      R(8)            8           scalar   ARG,IN           646,648,649,657,660,661,663,667,66
                                                                                                  8,670                             

Page 25          Source Listing                  MONIN_OBUKHOV_INTEGRAL_TQ
2021-06-01 08:55                                 monin_obukhov_inter.F90

    677 
    678 
    679 pure subroutine monin_obukhov_stable_mix(stable_option, rich_crit, zeta_trans, &
    680      &                              n, rich, mix, ier)
    681 
    682   integer, intent(in   )                 :: stable_option
    683   real   , intent(in   )                 :: rich_crit, zeta_trans
    684   integer, intent(in   )                 :: n
    685   real   , intent(in   ), dimension(n)   :: rich
    686   real   , intent(  out), dimension(n)   :: mix
    687   integer, intent(  out)                 :: ier
    688 
    689   real               :: r, a, b, c, zeta, phi
    690   real               :: b_stab, rich_trans, lambda
    691   integer            :: i
    692 
    693   ier = 0
    694 
    695 mix = 0.0
    696 b_stab     = 1.0/rich_crit
    697 rich_trans = zeta_trans/(1.0 + 5.0*zeta_trans)
    698 
    699 if(stable_option == 1) then
    700 
    701      c = - 1.0
    702      do i = 1, n
    703         if(rich(i) > 0.0 .and. rich(i) < rich_crit) then
    704            r = 1.0/rich(i)
    705            a = r - b_stab
    706            b = r - (1.0 + 5.0)
    707            zeta = (-b + sqrt(b*b - 4.0*a*c))/(2.0*a)
    708            phi = 1.0 + b_stab*zeta + (5.0 - b_stab)*zeta/(1.0 + zeta)
    709            mix(i) = 1./(phi*phi)
    710      endif
    711   end do
    712 
    713 else if(stable_option == 2) then
    714 
    715   lambda = 1.0 + (5.0 - b_stab)*zeta_trans
    716 
    717   where(rich > 0.0 .and. rich <= rich_trans)
    718     mix = (1.0 - 5.0*rich)**2
    719   end where
    720   where(rich > rich_trans .and. rich < rich_crit)
    721     mix = ((1.0 - b_stab*rich)/lambda)**2
    722   end where
    723 
    724 end if
    725 
    726 end subroutine monin_obukhov_stable_mix

Page 26          Source Listing                  MONIN_OBUKHOV_STABLE_MIX
2021-06-01 08:55 Entry Points                    monin_obukhov_inter.F90



ENTRY POINTS

  Name                                                        
                                                              
 monin_obukhov_inter_mp_monin_obukhov_stable_mix_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Local  689      R(8)            8           scalar                    705,707                           
 B                          Local  689      R(8)            8           scalar                    706,707                           
 B_STAB                     Local  690      R(8)            8           scalar                    696,705,708,715,721               
 C                          Local  689      R(8)            8           scalar                    701,707                           
 I                          Local  691      I(4)            4           scalar                    702,703,704,709                   
 IER                        Dummy  680      I(4)            4           scalar   ARG,OUT          693                               
 LAMBDA                     Local  690      R(8)            8           scalar                    715,721                           
 MIX                        Dummy  680      R(8)            8     1     0        ARG,OUT          695,709,718,721                   
 MONIN_OBUKHOV_STABLE_MIX   Subr   679                                                                                              
 N                          Dummy  680      I(4)            4           scalar   ARG,IN           685,686,702                       
 PHI                        Local  689      R(8)            8           scalar                    708,709                           
 R                          Local  689      R(8)            8           scalar                    704,705,706                       
 RICH                       Dummy  680      R(8)            8     1     0        ARG,IN           703,704,717,718,720,721           
 RICH_CRIT                  Dummy  679      R(8)            8           scalar   ARG,IN           696,703,720                       
 RICH_TRANS                 Local  690      R(8)            8           scalar                    697,717,720                       
 SQRT                       Func   707                                  scalar                    707                               
 STABLE_OPTION              Dummy  679      I(4)            4           scalar   ARG,IN           699,713                           
 ZETA                       Local  689      R(8)            8           scalar                    707,708                           
 ZETA_TRANS                 Dummy  679      R(8)            8           scalar   ARG,IN           697,715                           

Page 27          Source Listing                  MONIN_OBUKHOV_STABLE_MIX
2021-06-01 08:55                                 monin_obukhov_inter.F90

    727 
    728 end module monin_obukhov_inter


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MONIN_OBUKHOV_DIFF         Subr   27                                                             27                                
 MONIN_OBUKHOV_DRAG_1D      Subr   28                                                             28                                
 MONIN_OBUKHOV_INTER        Module 22                                                                                               
 MONIN_OBUKHOV_PROFILE_1D   Subr   32                                                             32                                
 MONIN_OBUKHOV_STABLE_MIX   Subr   35                                                             35                                

Page 28          Source Listing                  MONIN_OBUKHOV_STABLE_MIX
2021-06-01 08:55 Subprograms/Common Blocks       monin_obukhov_inter.F90



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MONIN_OBUKHOV_DERIVATIVE_M Subr   373                                                                                              
 MONIN_OBUKHOV_DERIVATIVE_T Subr   317                                                                                              
 MONIN_OBUKHOV_DIFF         Subr   41                                                                                               
 MONIN_OBUKHOV_DRAG_1D      Subr   89                                                                                               
 MONIN_OBUKHOV_INTEGRAL_M   Subr   505                                                                                              
 MONIN_OBUKHOV_INTEGRAL_TQ  Subr   581                                                                                              
 MONIN_OBUKHOV_INTER        Module 22                                                                                               
 MONIN_OBUKHOV_PROFILE_1D   Subr   421                                                                                              
 MONIN_OBUKHOV_SOLVE_ZETA   Subr   200                                                                                              
 MONIN_OBUKHOV_STABLE_MIX   Subr   679                                                                                              

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume cc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file

Page 29          Source Listing                  MONIN_OBUKHOV_STABLE_MIX
2021-06-01 08:55                                 monin_obukhov_inter.F90

       -convert native                       -cross_reference
       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=0
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20191121       -D _OPENMP=201611
       -D __INTEL_OFFLOAD                    -D __MMX__
       -D __SSE__                            -D __SSE_MATH__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __pentium4                         -D __pentium4__
       -D __tune_pentium4__                  -D PACKAGE_NAME='"GFDL FMS Library"'
       -D PACKAGE_TARNAME='"FMS"'            -D PACKAGE_VERSION='"2021.02.0"'
       -D PACKAGE_STRING='"GFDL FMS Library 2021.02.0"'       -D PACKAGE_BUGREPORT='"gfdl.climate.model.info@noaa.gov"'
       -D PACKAGE_URL='"https://www.gfdl.noaa.gov/fms"'       -D PACKAGE='"FMS"'
       -D VERSION='"2021.02.0"'              -D STDC_HEADERS=1
       -D HAVE_SYS_TYPES_H=1                 -D HAVE_SYS_STAT_H=1
       -D HAVE_STDLIB_H=1                    -D HAVE_STRING_H=1
       -D HAVE_MEMORY_H=1                    -D HAVE_STRINGS_H=1
       -D HAVE_INTTYPES_H=1                  -D HAVE_STDINT_H=1
       -D HAVE_UNISTD_H=1                    -D HAVE_DLFCN_H=1
       -D LT_OBJDIR='".libs/"'               -D HAVE_MPI_H=1
       -D HAVE_NETCDF_H=1                    -D HAVE_SCHED_GETAFFINITY=1
       -D HAVE_MOD_MPI=1                     -D HAVE_MOD_NETCDF=1
       -D HAVE_CRAY_POINTER=1                -D HAVE_QUAD_PRECISION=1
       -D HAVE_INTERNAL_NML=1                -D use_netCDF=1
       -D use_libMPI=1                       -D INTERNAL_FILE_NML
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
  no   -fpconstant                           -fpe3
       -fprm nearest                         -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -fp_modbits nofp_contract
       -fp_modbits nono_fp_contract          -fp_modbits nofenv_access
       -fp_modbits nono_fenv_access          -fp_modbits nocx_limited_range
       -fp_modbits nono_cx_limited_range       -fp_modbits noprec_div
       -fp_modbits nono_prec_div             -fp_modbits noprec_sqrt
       -fp_modbits nono_prec_sqrt            -fp_modbits ftz
       -fp_modbits nono_ftz                  -fp_modbits nointrin_limited_range
       -fp_modbits nono_intrin_limited_range       -fp_modbits notrunc_compares
       -fp_modbits nono_trunc_compares       -fp_modbits noieee_nan_compares
       -fp_modbits nono_ieee_nan_compares       -fp_modbits honor_f32_conversion
       -fp_modbits nono_honor_f32_conversion       -fp_modbits honor_f64_conversion
       -fp_modbits nono_honor_f64_conversion       -fp_modbits nono_x87_copy
       -fp_modbits nono_no_x87_copy          -fp_modbits noexception_semantics
       -fp_modbits nono_exception_semantics       -fp_modbits noprecise_libm_functions
       -fp_modbits nono_precise_libm_functions       -heap_arrays 0
  no   -threadprivate_compat                 -free

Page 30          Source Listing                  MONIN_OBUKHOV_STABLE_MIX
2021-06-01 08:55                                 monin_obukhov_inter.F90

       -g2                                   -iface nomixed_str_len_arg
       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity
       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
       -module ../.mods                      -names lowercase
  no   -noinclude                       no   -o
       -offload-build=host                   -openmp
       -openmp-simd                          -openmp-offload
       -O0                              no   -pad_source
       -real_size 64                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w noalignments                       -w nodeclarations
       -w noexternals                        -w nogeneral
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w nouncalled
       -w nouninitialized                    -w nounused
       -w nousage                       no   -wrap-margins

       -includepath : /opt/netcdf/4.6.1/INTEL/include/,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/,.f90,./.f90,./.f90,../include/.f90,
           ./.f90,/opt/netcdf/4.6.1/INTEL/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/ipp/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mkl/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/tbb/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/daal/include/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/intel64/.f90,/opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/icc/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/.f90,/usr/local/include/.f90,
           /usr/lib/gcc/x86_64-redhat-linux/4.8.5/include/.f90,/usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : monin_obukhov_inter.lst
  no   -o

COMPILER: Intel(R) Fortran 19.1-1555
