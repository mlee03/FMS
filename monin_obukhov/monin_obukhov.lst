Page 1           Source Listing                  MONIN_OBUKHOV_INIT
2021-06-01 08:55                                 /tmp/ifortL2jAZ4.i90

      1 # 1 "monin_obukhov.F90"
      2 !***********************************************************************
      3 !*                   GNU Lesser General Public License
      4 !*
      5 !* This file is part of the GFDL Flexible Modeling System (FMS).
      6 !*
      7 !* FMS is free software: you can redistribute it and/or modify it under
      8 !* the terms of the GNU Lesser General Public License as published by
      9 !* the Free Software Foundation, either version 3 of the License, or (at
     10 !* your option) any later version.
     11 !*
     12 !* FMS is distributed in the hope that it will be useful, but WITHOUT
     13 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
     14 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
     15 !* for more details.
     16 !*
     17 !* You should have received a copy of the GNU Lesser General Public
     18 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
     19 !***********************************************************************
     20 
     21 module monin_obukhov_mod
     22 
     23 
     24 !=======================================================================
     25 !
     26 !                         MONIN-OBUKHOV MODULE
     27 !
     28 !          Routines for computing surface drag coefficients
     29 !                 from data at the lowest model level
     30 !              and for computing the profile of fields
     31 !           between the lowest model level and the ground
     32 !                  using Monin-Obukhov scaling
     33 !
     34 !=======================================================================
     35 
     36 
     37 use constants_mod, only: grav, vonkarm
     38 use mpp_mod,       only: input_nml_file
     39 use fms_mod,       only: error_mesg, FATAL, check_nml_error,   &
     40                          mpp_pe, mpp_root_pe, stdlog, &
     41                          write_version_number
     42 use monin_obukhov_inter, only: monin_obukhov_diff, monin_obukhov_drag_1d, &
     43                                monin_obukhov_profile_1d, monin_obukhov_stable_mix
     44 implicit none
     45 private
     46 
     47 !=======================================================================
     48  public :: monin_obukhov_init
     49  public :: monin_obukhov_end
     50  public :: mo_drag
     51  public :: mo_profile
     52  public :: mo_diff
     53  public :: stable_mix
     54 !=======================================================================
     55 
     56 interface mo_drag
     57     module procedure  mo_drag_0d, mo_drag_1d, mo_drag_2d

Page 2           Source Listing                  MONIN_OBUKHOV_INIT
2021-06-01 08:55                                 monin_obukhov.F90

     58 end interface
     59 
     60 
     61 interface mo_profile
     62     module procedure  mo_profile_0d,   mo_profile_1d,   mo_profile_2d, &
     63                       mo_profile_0d_n, mo_profile_1d_n, mo_profile_2d_n
     64 end interface
     65 
     66 interface mo_diff
     67     module procedure  mo_diff_0d_n, mo_diff_0d_1, &
     68                       mo_diff_1d_n, mo_diff_1d_1, &
     69                       mo_diff_2d_n, mo_diff_2d_1
     70 end interface
     71 
     72 interface stable_mix
     73     module procedure  stable_mix_0d, stable_mix_1d, &
     74                       stable_mix_2d, stable_mix_3d
     75 end interface
     76 
     77 !-----------------------------------------------------------------------
     78 ! version number of this module
     79 ! Include variable "version" to be written to log file.
     80 # 1 "../include/file_version.h" 1 
     81 ! -*-f90-*-
     82 !***********************************************************************
     83 !*                   GNU Lesser General Public License
     84 !*
     85 !* This file is part of the GFDL Flexible Modeling System (FMS).
     86 !*
     87 !* FMS is free software: you can redistribute it and/or modify it under
     88 !* the terms of the GNU Lesser General Public License as published by
     89 !* the Free Software Foundation, either version 3 of the License, or (at
     90 !* your option) any later version.
     91 !*
     92 !* FMS is distributed in the hope that it will be useful, but WITHOUT
     93 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
     94 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
     95 !* for more details.
     96 !*
     97 !* You should have received a copy of the GNU Lesser General Public
     98 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
     99 !***********************************************************************
    100 
    101 # 23
    102 
    103   character(len=*), parameter :: version = 'unknown'
    104 
    105 # 80 "monin_obukhov.F90" 2 
    106 
    107 !=======================================================================
    108 
    109 !  DEFAULT VALUES OF NAMELIST PARAMETERS:
    110 
    111 real    :: rich_crit      = 2.0
    112 real    :: drag_min_heat  = 1.e-05
    113 real    :: drag_min_moist = 1.e-05
    114 real    :: drag_min_mom   = 1.e-05

Page 3           Source Listing                  MONIN_OBUKHOV_INIT
2021-06-01 08:55                                 monin_obukhov.F90

    115 logical :: neutral        = .false.
    116 integer :: stable_option  = 1
    117 real    :: zeta_trans     = 0.5
    118 logical :: new_mo_option  = .false.
    119 
    120 
    121 namelist /monin_obukhov_nml/ rich_crit, neutral, drag_min_heat, &
    122                              drag_min_moist, drag_min_mom,      &
    123                              stable_option, zeta_trans, new_mo_option !miz
    124 
    125 !=======================================================================
    126 
    127 !  MODULE VARIABLES
    128 
    129 real, parameter    :: small  = 1.e-04
    130 real               :: b_stab, r_crit, lambda, rich_trans
    131 real               :: sqrt_drag_min_heat, sqrt_drag_min_moist, sqrt_drag_min_mom
    132 logical            :: module_is_initialized = .false.
    133 
    134 
    135 contains
    136 
    137 !=======================================================================
    138 
    139 subroutine monin_obukhov_init
    140 
    141 integer :: unit, ierr, io, logunit
    142 
    143 !------------------- read namelist input -------------------------------
    144 
    145       read (input_nml_file, nml=monin_obukhov_nml, iostat=io)
    146       ierr = check_nml_error(io,"monin_obukhov_nml")
    147 
    148 !---------- output namelist to log-------------------------------------
    149 
    150       if ( mpp_pe() == mpp_root_pe() ) then
    151            call write_version_number('MONIN_OBUKOV_MOD', version)
    152            logunit = stdlog()
    153            write (logunit, nml=monin_obukhov_nml)
    154       endif
    155 
    156 !----------------------------------------------------------------------
    157 
    158 if(rich_crit.le.0.25)  call error_mesg( &
    159         'MONIN_OBUKHOV_INIT in MONIN_OBUKHOV_MOD', &
    160         'rich_crit in monin_obukhov_mod must be > 0.25', FATAL)
    161 
    162 if(drag_min_heat.le.0.0)  call error_mesg( &
    163         'MONIN_OBUKHOV_INIT in MONIN_OBUKHOV_MOD', &
    164         'drag_min_heat in monin_obukhov_mod must be >= 0.0', FATAL)
    165 
    166 if(drag_min_moist.le.0.0)  call error_mesg( &
    167         'MONIN_OBUKHOV_INIT in MONIN_OBUKHOV_MOD', &
    168         'drag_min_moist in monin_obukhov_mod must be >= 0.0', FATAL)
    169 
    170 if(drag_min_mom.le.0.0)  call error_mesg( &
    171         'MONIN_OBUKHOV_INIT in MONIN_OBUKHOV_MOD', &

Page 4           Source Listing                  MONIN_OBUKHOV_INIT
2021-06-01 08:55                                 monin_obukhov.F90

    172         'drag_min_mom in monin_obukhov_mod must be >= 0.0', FATAL)
    173 
    174 if(stable_option < 1 .or. stable_option > 2) call error_mesg( &
    175         'MONIN_OBUKHOV_INIT in MONIN_OBUKHOV_MOD', &
    176         'the only allowable values of stable_option are 1 and 2', FATAL)
    177 
    178 if(stable_option == 2 .and. zeta_trans < 0) call error_mesg( &
    179         'MONIN_OBUKHOV_INIT in MONIN_OBUKHOV_MOD', &
    180         'zeta_trans must be positive', FATAL)
    181 
    182 b_stab = 1.0/rich_crit
    183 r_crit = 0.95*rich_crit  ! convergence can get slow if one is
    184 ! close to rich_crit
    185 
    186 sqrt_drag_min_heat = 0.0
    187 if(drag_min_heat.ne.0.0) sqrt_drag_min_heat = sqrt(drag_min_heat)
    188 
    189 sqrt_drag_min_moist = 0.0
    190 if(drag_min_moist.ne.0.0) sqrt_drag_min_moist = sqrt(drag_min_moist)
    191 
    192 sqrt_drag_min_mom = 0.0
    193 if(drag_min_mom.ne.0.0) sqrt_drag_min_mom = sqrt(drag_min_mom)
    194 
    195 lambda     = 1.0 + (5.0 - b_stab)*zeta_trans   ! used only if stable_option = 2
    196 rich_trans = zeta_trans/(1.0 + 5.0*zeta_trans) ! used only if stable_option = 2
    197 
    198 module_is_initialized = .true.
    199 
    200 return
    201 end subroutine monin_obukhov_init

Page 5           Source Listing                  MONIN_OBUKHOV_INIT
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                                
                                                      
 monin_obukhov_mod_mp_monin_obukhov_init_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAB                     Local  182      R(8)            8           scalar                    182,195,470,479,509,518,560,561,56
                                                                                                  2,563,578,585,592,639,640,653,660 
 CHECK_NML_ERROR            Func   146      I(4)            4           scalar   PRIV             39,146                            
 DRAG_MIN_HEAT              Local  162      R(8)            8           scalar                    112,121,162,187,242,249           
 DRAG_MIN_MOIST             Local  166      R(8)            8           scalar                    113,122,166,190,242,249           
 DRAG_MIN_MOM               Local  170      R(8)            8           scalar                    114,122,170,193,242,249           
 ERROR_MESG                 Subr   158                                           PRIV             39,158,162,166,170,174,178,229,272
                                                                                                  ,305,326,441,922,950              
 FATAL                      Param  160      I(4)            4           scalar   PRIV             39,160,164,168,172,176,180,230,273
                                                                                                  ,306,327,442,923,951              
 IERR                       Local  141      I(4)            4           scalar                    146                               
 INPUT_NML_FILE             Local  145      CHAR                  1     1        ALC,TGT,PRIV     38,145                            
 IO                         Local  141      I(4)            4           scalar                    145,146                           
 LAMBDA                     Local  195      R(8)            8           scalar                    195,479,518,578,585,592,653,660   
 LOGUNIT                    Local  141      I(4)            4           scalar                    152,153                           
 MODULE_IS_INITIALIZED      Local  198      L(4)            4           scalar                    132,198,207,229,272,305,326,922,95
                                                                                                  0                                 
 MONIN_OBUKHOV_INIT         Subr   139                                                                                              
 MONIN_OBUKHOV_NML          Local  145                                  scalar                    145,153                           
 MPP_PE                     Func   150      I(4)            4           scalar   PRIV             40,150                            
 MPP_ROOT_PE                Func   150      I(4)            4           scalar   PRIV             40,150                            
 RICH_CRIT                  Local  158      R(8)            8           scalar                    111,121,158,182,183,241,248,281,28
                                                                                                  8,309,332,383,931,959             
 RICH_TRANS                 Local  196      R(8)            8           scalar                    196                               
 R_CRIT                     Local  183      R(8)            8           scalar                    183                               
 SQRT                       Func   187                                  scalar                    187,190,193                       
 SQRT_DRAG_MIN_HEAT         Local  186      R(8)            8           scalar                    186,187                           
 SQRT_DRAG_MIN_MOIST        Local  189      R(8)            8           scalar                    189,190                           
 SQRT_DRAG_MIN_MOM          Local  192      R(8)            8           scalar                    192,193                           
 STABLE_OPTION              Local  174      I(4)            4           scalar                    116,123,174,178,241,248,281,288,30
                                                                                                  9,332,467,473,506,512,556,567,636,
                                                                                                  643,931,959                       
 STDLOG                     Func   152      I(4)            4           scalar   PRIV             40,152                            
 UNIT                       Local  141      I(4)            4           scalar                                                      
 VERSION                    Param  151      CHAR            7           scalar                    151                               
 WRITE_VERSION_NUMBER       Subr   151                                           PRIV             41,151                            
 ZETA_TRANS                 Local  178      R(8)            8           scalar                    117,123,178,195,196,241,248,281,28
                                                                                                  8,309,332,475,478,514,517,569,570,
                                                                                                  578,581,582,584,588,589,591,645,64
                                                                                                  6,653,656,657,659,931,959         

Page 6           Source Listing                  MONIN_OBUKHOV_INIT
2021-06-01 08:55                                 monin_obukhov.F90

    202 
    203 !=======================================================================
    204 
    205 subroutine monin_obukhov_end
    206 
    207 module_is_initialized = .false.
    208 
    209 end subroutine monin_obukhov_end


ENTRY POINTS

  Name                                               
                                                     
 monin_obukhov_mod_mp_monin_obukhov_end_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MONIN_OBUKHOV_END          Subr   205                                                                                              

Page 7           Source Listing                  MONIN_OBUKHOV_END
2021-06-01 08:55                                 monin_obukhov.F90

    210 
    211 !=======================================================================
    212 
    213 subroutine mo_drag_1d &
    214          (pt, pt0, z, z0, zt, zq, speed, drag_m, drag_t, drag_q, &
    215           u_star, b_star, avail)
    216 
    217 real, intent(in)   , dimension(:) :: pt, pt0, z, z0, zt, zq, speed
    218 real, intent(inout), dimension(:) :: drag_m, drag_t, drag_q, u_star, b_star
    219 logical, intent(in), optional, dimension(:) :: avail
    220 
    221 logical            :: lavail, avail_dummy(1)
    222 integer            :: n, ier
    223 
    224 integer, parameter :: max_iter = 20
    225 real   , parameter :: error=1.e-04, zeta_min=1.e-06, small=1.e-04
    226 
    227 ! #include "monin_obukhov_interfaces.h"
    228 
    229 if(.not.module_is_initialized) call error_mesg('mo_drag_1d in monin_obukhov_mod', &
    230      'monin_obukhov_init has not been called', FATAL)
    231 
    232 n      = size(pt)
    233 lavail = .false.
    234 if(present(avail)) lavail = .true.
    235 
    236 
    237 if(lavail) then
    238    if (count(avail) .eq. 0) return
    239    call monin_obukhov_drag_1d(grav, vonkarm,               &
    240         & error, zeta_min, max_iter, small,                         &
    241         & neutral, stable_option, new_mo_option, rich_crit, zeta_trans, &!miz
    242         & drag_min_heat, drag_min_moist, drag_min_mom,              &
    243         & n, pt, pt0, z, z0, zt, zq, speed, drag_m, drag_t,         &
    244         & drag_q, u_star, b_star, lavail, avail, ier)
    245 else
    246    call monin_obukhov_drag_1d(grav, vonkarm,               &
    247         & error, zeta_min, max_iter, small,                         &
    248         & neutral, stable_option, new_mo_option, rich_crit, zeta_trans, &!miz
    249         & drag_min_heat, drag_min_moist, drag_min_mom,              &
    250         & n, pt, pt0, z, z0, zt, zq, speed, drag_m, drag_t,         &
    251         & drag_q, u_star, b_star, lavail, avail_dummy, ier)
    252 endif
    253 
    254 end subroutine mo_drag_1d

Page 8           Source Listing                  MO_DRAG_1D
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                        
                                              
 monin_obukhov_mod_mp_mo_drag_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AVAIL                      Dummy  215      L(4)            4     1     1        ARG,IN           234,238,244                       
 AVAIL_DUMMY                Local  221      L(4)            4     1     1                         251                               
 B_STAR                     Dummy  215      R(8)            8     1     1        ARG,INOUT        244,251                           
 COUNT                      Func   238                                  scalar                    238                               
 DRAG_M                     Dummy  214      R(8)            8     1     1        ARG,INOUT        243,250                           
 DRAG_Q                     Dummy  214      R(8)            8     1     1        ARG,INOUT        244,251                           
 DRAG_T                     Dummy  214      R(8)            8     1     1        ARG,INOUT        243,250                           
 ERROR                      Param  225      R(8)            8           scalar                    240,247                           
 GRAV                       Param  239      R(8)            8           scalar   PRIV             37,239,246                        
 IER                        Local  222      I(4)            4           scalar                    244,251                           
 LAVAIL                     Local  221      L(4)            4           scalar                    233,234,237,244,251               
 MAX_ITER                   Param  224      I(4)            4           scalar                    240,247                           
 MONIN_OBUKHOV_DRAG_1D      Subr   239                                           PRIV             42,239,246                        
 MO_DRAG_1D                 Subr   213                                           PRIV             686,713                           
 N                          Local  222      I(4)            4           scalar                    232,243,250                       
 NEUTRAL                    Local  241      L(4)            4           scalar                    115,121,241,248,281,288,332,931,95
                                                                                                  9                                 
 NEW_MO_OPTION              Local  241      L(4)            4           scalar                    118,123,241,248,281,288,332,931,95
                                                                                                  9                                 
 PRESENT                    Func   234                                  scalar                    234                               
 PT                         Dummy  214      R(8)            8     1     1        ARG,IN           232,243,250                       
 PT0                        Dummy  214      R(8)            8     1     1        ARG,IN           243,250                           
 SIZE                       Func   232                                  scalar                    232                               
 SMALL                      Param  225      R(8)            8           scalar                    240,247                           
 SPEED                      Dummy  214      R(8)            8     1     1        ARG,IN           243,250                           
 U_STAR                     Dummy  215      R(8)            8     1     1        ARG,INOUT        244,251                           
 VONKARM                    Param  239      R(8)            8           scalar   PRIV             37,239,246,280,287,330,929,957    
 Z                          Dummy  214      R(8)            8     1     1        ARG,IN           243,250                           
 Z0                         Dummy  214      R(8)            8     1     1        ARG,IN           243,250                           
 ZETA_MIN                   Param  225      R(8)            8           scalar                    240,247                           
 ZQ                         Dummy  214      R(8)            8     1     1        ARG,IN           243,250                           
 ZT                         Dummy  214      R(8)            8     1     1        ARG,IN           243,250                           

Page 9           Source Listing                  MO_DRAG_1D
2021-06-01 08:55                                 monin_obukhov.F90

    255 
    256 
    257 !=======================================================================
    258 
    259 subroutine mo_profile_1d(zref, zref_t, z, z0, zt, zq, u_star, b_star, q_star, &
    260                          del_m, del_t, del_q, avail)
    261 
    262 real,    intent(in)                :: zref, zref_t
    263 real,    intent(in) , dimension(:) :: z, z0, zt, zq, u_star, b_star, q_star
    264 real,    intent(out), dimension(:) :: del_m, del_t, del_q
    265 logical, intent(in) , optional, dimension(:) :: avail
    266 
    267 logical                            :: dummy_avail(1)
    268 integer                            :: n, ier
    269 
    270 ! #include "monin_obukhov_interfaces.h"
    271 
    272 if(.not.module_is_initialized) call error_mesg('mo_profile_1d in monin_obukhov_mod', &
    273      'monin_obukhov_init has not been called', FATAL)
    274 
    275 n = size(z)
    276 if(present(avail)) then
    277 
    278    if (count(avail) .eq. 0) return
    279 
    280    call monin_obukhov_profile_1d(vonkarm, &
    281         & neutral, stable_option, new_mo_option,rich_crit, zeta_trans, &
    282         & n, zref, zref_t, z, z0, zt, zq, u_star, b_star, q_star, &
    283         & del_m, del_t, del_q, .true., avail, ier)
    284 
    285 else
    286 
    287    call monin_obukhov_profile_1d(vonkarm, &
    288         & neutral, stable_option, new_mo_option,rich_crit, zeta_trans, &
    289         & n, zref, zref_t, z, z0, zt, zq, u_star, b_star, q_star, &
    290         & del_m, del_t, del_q, .false., dummy_avail, ier)
    291 
    292 endif
    293 
    294 end subroutine mo_profile_1d

Page 10          Source Listing                  MO_PROFILE_1D
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                           
                                                 
 monin_obukhov_mod_mp_mo_profile_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AVAIL                      Dummy  260      L(4)            4     1     1        ARG,IN           276,278,283                       
 B_STAR                     Dummy  259      R(8)            8     1     1        ARG,IN           282,289                           
 COUNT                      Func   278                                  scalar                    278                               
 DEL_M                      Dummy  260      R(8)            8     1     1        ARG,OUT          283,290                           
 DEL_Q                      Dummy  260      R(8)            8     1     1        ARG,OUT          283,290                           
 DEL_T                      Dummy  260      R(8)            8     1     1        ARG,OUT          283,290                           
 DUMMY_AVAIL                Local  267      L(4)            4     1     1                         290                               
 IER                        Local  268      I(4)            4           scalar                    283,290                           
 MONIN_OBUKHOV_PROFILE_1D   Subr   280                                           PRIV             43,280,287                        
 MO_PROFILE_1D              Subr   259                                           PRIV             736,764,790,793                   
 N                          Local  268      I(4)            4           scalar                    275,282,289                       
 PRESENT                    Func   276                                  scalar                    276                               
 Q_STAR                     Dummy  259      R(8)            8     1     1        ARG,IN           282,289                           
 SIZE                       Func   275                                  scalar                    275                               
 U_STAR                     Dummy  259      R(8)            8     1     1        ARG,IN           282,289                           
 Z                          Dummy  259      R(8)            8     1     1        ARG,IN           275,282,289                       
 Z0                         Dummy  259      R(8)            8     1     1        ARG,IN           282,289                           
 ZQ                         Dummy  259      R(8)            8     1     1        ARG,IN           282,289                           
 ZREF                       Dummy  259      R(8)            8           scalar   ARG,IN           282,289                           
 ZREF_T                     Dummy  259      R(8)            8           scalar   ARG,IN           282,289                           
 ZT                         Dummy  259      R(8)            8     1     1        ARG,IN           282,289                           

Page 11          Source Listing                  MO_PROFILE_1D
2021-06-01 08:55                                 monin_obukhov.F90

    295 
    296 !=======================================================================
    297 
    298 subroutine stable_mix_3d(rich, mix)
    299 
    300 real, intent(in) , dimension(:,:,:)  :: rich
    301 real, intent(out), dimension(:,:,:)  :: mix
    302 
    303 integer :: n, ier
    304 
    305 if(.not.module_is_initialized) call error_mesg('stable_mix_3d in monin_obukhov_mod', &
    306      'monin_obukhov_init has not been called', FATAL)
    307 
    308 n = size(rich,1)*size(rich,2)*size(rich,3)
    309 call monin_obukhov_stable_mix(stable_option, rich_crit, zeta_trans, &
    310      & n, rich, mix, ier)
    311 
    312 
    313 end subroutine stable_mix_3d


ENTRY POINTS

  Name                                           
                                                 
 monin_obukhov_mod_mp_stable_mix_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IER                        Local  303      I(4)            4           scalar                    310                               
 MIX                        Dummy  298      R(8)            8     3     1        ARG,OUT          310                               
 MONIN_OBUKHOV_STABLE_MIX   Subr   309                                           PRIV             43,309                            
 N                          Local  303      I(4)            4           scalar                    308,310                           
 RICH                       Dummy  298      R(8)            8     3     1        ARG,IN           308,310                           
 SIZE                       Func   308                                  scalar                    308                               
 STABLE_MIX_3D              Subr   298                                           PRIV             976,995,1013                      

Page 12          Source Listing                  STABLE_MIX_3D
2021-06-01 08:55                                 monin_obukhov.F90

    314 
    315 !=======================================================================
    316 
    317 subroutine mo_diff_2d_n(z, u_star, b_star, k_m, k_h)
    318 
    319 real, intent(in),  dimension(:,:,:) :: z
    320 real, intent(in),  dimension(:,:)   :: u_star, b_star
    321 real, intent(out), dimension(:,:,:) :: k_m, k_h
    322 
    323 integer            :: ni, nj, nk, ier
    324 real, parameter    :: ustar_min = 1.e-10
    325 
    326 if(.not.module_is_initialized) call error_mesg('mo_diff_2d_n in monin_obukhov_mod', &
    327      'monin_obukhov_init has not been called', FATAL)
    328 
    329 ni = size(z, 1); nj = size(z, 2); nk = size(z, 3)
    330 call monin_obukhov_diff(vonkarm,                           &
    331           & ustar_min,                                     &
    332           & neutral, stable_option, new_mo_option,rich_crit, zeta_trans, &
    333           & ni, nj, nk, z, u_star, b_star, k_m, k_h, ier)
    334 
    335 end subroutine mo_diff_2d_n


ENTRY POINTS

  Name                                          
                                                
 monin_obukhov_mod_mp_mo_diff_2d_n_             

Page 13          Source Listing                  MO_DIFF_2D_N
2021-06-01 08:55 Symbol Table                    monin_obukhov.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  317      R(8)            8     2     1        ARG,IN           333                               
 IER                        Local  323      I(4)            4           scalar                    333                               
 K_H                        Dummy  317      R(8)            8     3     1        ARG,OUT          333                               
 K_M                        Dummy  317      R(8)            8     3     1        ARG,OUT          333                               
 MONIN_OBUKHOV_DIFF         Subr   330                                           PRIV             42,330,929,957                    
 MO_DIFF_2D_N               Subr   317                                           PRIV             850,873,900                       
 NI                         Local  323      I(4)            4           scalar                    329,333                           
 NJ                         Local  323      I(4)            4           scalar                    329,333                           
 NK                         Local  323      I(4)            4           scalar                    329,333                           
 SIZE                       Func   329                                  scalar                    329                               
 USTAR_MIN                  Param  324      R(8)            8           scalar                    331                               
 U_STAR                     Dummy  317      R(8)            8     2     1        ARG,IN           333                               
 Z                          Dummy  317      R(8)            8     3     1        ARG,IN           329,333                           

Page 14          Source Listing                  MO_DIFF_2D_N
2021-06-01 08:55                                 monin_obukhov.F90

    336 
    337 !=======================================================================
    338 ! The following routines are used by the public interfaces above
    339 !=======================================================================
    340 
    341 subroutine solve_zeta(rich, z, z0, zt, zq, f_m, f_t, f_q, mask)
    342 
    343 real   , intent(in) , dimension(:) :: rich, z, z0, zt, zq
    344 logical, intent(in) , dimension(:) :: mask
    345 real   , intent(out), dimension(:) :: f_m, f_t, f_q
    346 
    347 
    348 real, parameter    :: error    = 1.e-04
    349 real, parameter    :: zeta_min = 1.e-06
    350 integer, parameter :: max_iter = 20
    351 
    352 real    :: max_cor
    353 integer :: iter
    354 
    355 real, dimension(size(rich(:))) ::   &
    356           d_rich, rich_1, correction, corr, z_z0, z_zt, z_zq, &
    357           ln_z_z0, ln_z_zt, ln_z_zq, zeta,                    &
    358           phi_m, phi_m_0, phi_t, phi_t_0, rzeta,              &
    359           zeta_0, zeta_t, zeta_q, df_m, df_t
    360 
    361 logical, dimension(size(rich(:))) :: mask_1
    362 
    363 
    364 z_z0 = z/z0
    365 z_zt = z/zt
    366 z_zq = z/zq
    367 ln_z_z0 = log(z_z0)
    368 ln_z_zt = log(z_zt)
    369 ln_z_zq = log(z_zq)
    370 
    371 corr = 0.0
    372 mask_1 = mask
    373 
    374 ! initial guess
    375 
    376 where(mask_1)
    377   zeta = rich*ln_z_z0*ln_z_z0/ln_z_zt
    378 elsewhere
    379   zeta = 0.0
    380 end where
    381 
    382 where (mask_1 .and. rich >= 0.0)
    383   zeta = zeta/(1.0 - rich/rich_crit)
    384 end where
    385 
    386 iter_loop: do iter = 1, max_iter
    387 
    388   where (mask_1 .and. abs(zeta).lt.zeta_min)
    389     zeta = 0.0
    390     f_m = ln_z_z0
    391     f_t = ln_z_zt
    392     f_q = ln_z_zq

Page 15          Source Listing                  SOLVE_ZETA
2021-06-01 08:55                                 monin_obukhov.F90

    393     mask_1 = .false.  ! don't do any more calculations at these pts
    394   end where
    395 
    396   where (mask_1)
    397     rzeta  = 1.0/zeta
    398     zeta_0 = zeta/z_z0
    399     zeta_t = zeta/z_zt
    400     zeta_q = zeta/z_zq
    401   elsewhere
    402     zeta_0 = 0.0
    403     zeta_t = 0.0
    404     zeta_q = 0.0
    405   end where
    406 
    407   call mo_derivative_m(phi_m  , zeta  , mask_1)
    408   call mo_derivative_m(phi_m_0, zeta_0, mask_1)
    409   call mo_derivative_t(phi_t  , zeta  , mask_1)
    410   call mo_derivative_t(phi_t_0, zeta_t, mask_1)
    411 
    412   call mo_integral_m(f_m, zeta, zeta_0, ln_z_z0, mask_1)
    413   call mo_integral_tq(f_t, f_q, zeta, zeta_t, zeta_q, ln_z_zt, ln_z_zq, mask_1)
    414 
    415   where (mask_1)
    416     df_m  = (phi_m - phi_m_0)*rzeta
    417     df_t  = (phi_t - phi_t_0)*rzeta
    418     rich_1 = zeta*f_t/(f_m*f_m)
    419     d_rich = rich_1*( rzeta +  df_t/f_t - 2.0 *df_m/f_m)
    420     correction = (rich - rich_1)/d_rich
    421     corr = min(abs(correction),abs(correction/zeta))
    422 ! the criterion corr < error seems to work ok, but is a bit arbitrary
    423 !  when zeta is small the tolerance is reduced
    424   end where
    425 
    426   max_cor= maxval(corr)
    427 
    428   if(max_cor > error) then
    429     mask_1 = mask_1 .and. (corr > error)
    430 ! change the mask so computation proceeds only on non-converged points
    431     where(mask_1)
    432       zeta = zeta + correction
    433     end where
    434     cycle iter_loop
    435   else
    436     return
    437   end if
    438 
    439 end do iter_loop
    440 
    441 call error_mesg ('solve_zeta in monin_obukhov_mod',  &
    442                  'surface drag iteration did not converge', FATAL)
    443 
    444 end subroutine solve_zeta

Page 16          Source Listing                  SOLVE_ZETA
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                        
                                              
 monin_obukhov_mod_mp_solve_zeta_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ABS                        Func   388                                  scalar                    388,421                           
 CORR                       Local  356      R(8)            8     1     0                         371,421,426,429                   
 CORRECTION                 Local  356      R(8)            8     1     0                         420,421,432                       
 DF_M                       Local  359      R(8)            8     1     0                         416,419                           
 DF_T                       Local  359      R(8)            8     1     0                         417,419                           
 D_RICH                     Local  356      R(8)            8     1     0                         419,420                           
 ERROR                      Param  348      R(8)            8           scalar                    428,429                           
 F_M                        Dummy  341      R(8)            8     1     1        ARG,OUT          390,412,418,419                   
 F_Q                        Dummy  341      R(8)            8     1     1        ARG,OUT          392,413                           
 F_T                        Dummy  341      R(8)            8     1     1        ARG,OUT          391,413,418,419                   
 ITER                       Local  353      I(4)            4           scalar                    386                               
 ITER_LOOP                  Label  386                                  scalar                    434,439                           
 LN_Z_Z0                    Local  357      R(8)            8     1     0        TGT              367,377,390,412                   
 LN_Z_ZQ                    Local  357      R(8)            8     1     0        TGT              369,392,413                       
 LN_Z_ZT                    Local  357      R(8)            8     1     0        TGT              368,377,391,413                   
 LOG                        Func   367                                  scalar                    367,368,369                       
 MASK                       Dummy  341      L(4)            4     1     1        ARG,IN           372                               
 MASK_1                     Local  361      L(4)            4     1     0        TGT              372,376,382,388,393,396,407,408,40
                                                                                                  9,410,412,413,415,429,431         
 MAXVAL                     Func   426                                  scalar                    426                               
 MAX_COR                    Local  352      R(8)            8           scalar                    426,428                           
 MAX_ITER                   Param  350      I(4)            4           scalar                    386                               
 MIN                        Func   421                                  scalar                    421                               
 PHI_M                      Local  358      R(8)            8     1     0        TGT              407,416                           
 PHI_M_0                    Local  358      R(8)            8     1     0        TGT              408,416                           
 PHI_T                      Local  358      R(8)            8     1     0        TGT              409,417                           
 PHI_T_0                    Local  358      R(8)            8     1     0        TGT              410,417                           
 RICH                       Dummy  341      R(8)            8     1     1        ARG,IN           361,377,382,383,420               
 RICH_1                     Local  356      R(8)            8     1     0                         418,419,420                       
 RZETA                      Local  358      R(8)            8     1     0                         397,416,417,419                   
 SIZE                       Func   361                                  scalar                    361                               
 SOLVE_ZETA                 Subr   341                                                                                              
 Z                          Dummy  341      R(8)            8     1     1        ARG,IN           364,365,366                       
 Z0                         Dummy  341      R(8)            8     1     1        ARG,IN           364                               
 ZETA                       Local  357      R(8)            8     1     0        TGT              377,379,383,388,389,397,398,399,40
                                                                                                  0,407,409,412,413,418,421,432     
 ZETA_0                     Local  359      R(8)            8     1     0        TGT              398,402,408,412                   
 ZETA_MIN                   Param  349      R(8)            8           scalar                    388                               
 ZETA_Q                     Local  359      R(8)            8     1     0        TGT              400,404,413                       
 ZETA_T                     Local  359      R(8)            8     1     0        TGT              399,403,410,413                   
 ZQ                         Dummy  341      R(8)            8     1     1        ARG,IN           366                               
 ZT                         Dummy  341      R(8)            8     1     1        ARG,IN           365                               
 Z_Z0                       Local  356      R(8)            8     1     0                         364,367,398                       
 Z_ZQ                       Local  356      R(8)            8     1     0                         366,369,400                       

Page 17          Source Listing                  SOLVE_ZETA
2021-06-01 08:55 Symbol Table                    monin_obukhov.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 Z_ZT                       Local  356      R(8)            8     1     0                         365,368,399                       

Page 18          Source Listing                  SOLVE_ZETA
2021-06-01 08:55                                 monin_obukhov.F90

    445 
    446 !=======================================================================
    447 
    448 subroutine mo_derivative_m(phi_m, zeta, mask)
    449 
    450 ! the differential similarity function for momentum
    451 
    452 real    , intent(out),  dimension(:) :: phi_m
    453 real    , intent(in),   dimension(:) :: zeta
    454 logical , intent(in),   dimension(:) :: mask
    455 
    456 logical, dimension(size(zeta(:))) :: stable, unstable
    457 real   , dimension(size(zeta(:))) :: x
    458 
    459 stable   = mask .and. zeta >= 0.0
    460 unstable = mask .and. zeta <  0.0
    461 
    462 where (unstable)
    463   x     = (1 - 16.0*zeta  )**(-0.5)
    464   phi_m = sqrt(x)  ! phi_m = (1 - 16.0*zeta)**(-0.25)
    465 end where
    466 
    467 if(stable_option == 1) then
    468 
    469   where (stable)
    470     phi_m = 1.0 + zeta  *(5.0 + b_stab*zeta)/(1.0 + zeta)
    471   end where
    472 
    473 else if(stable_option == 2) then
    474 
    475   where (stable .and. zeta < zeta_trans)
    476     phi_m = 1 + 5.0*zeta
    477   end where
    478   where (stable .and. zeta >= zeta_trans)
    479     phi_m = lambda + b_stab*zeta
    480   end where
    481 
    482 endif
    483 
    484 return
    485 end subroutine mo_derivative_m

Page 19          Source Listing                  MO_DERIVATIVE_M
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                             
                                                   
 monin_obukhov_mod_mp_mo_derivative_m_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MASK                       Dummy  448      L(4)            4     1     1        ARG,IN           459,460                           
 MO_DERIVATIVE_M            Subr   448                                                            407,408                           
 PHI_M                      Dummy  448      R(8)            8     1     1        ARG,OUT          464,470,476,479                   
 SIZE                       Func   457                                  scalar                    457                               
 SQRT                       Func   464                                  scalar                    464                               
 STABLE                     Local  456      L(4)            4     1     0                         459,469,475,478                   
 UNSTABLE                   Local  456      L(4)            4     1     0                         460,462                           
 X                          Local  457      R(8)            8     1     0                         463,464                           
 ZETA                       Dummy  448      R(8)            8     1     1        ARG,IN           457,459,460,463,470,475,476,478,47
                                                                                                  9                                 

Page 20          Source Listing                  MO_DERIVATIVE_M
2021-06-01 08:55                                 monin_obukhov.F90

    486 
    487 !=======================================================================
    488 
    489 subroutine mo_derivative_t(phi_t, zeta, mask)
    490 
    491 ! the differential similarity function for buoyancy and tracers
    492 
    493 real    , intent(out),  dimension(:) :: phi_t
    494 real    , intent(in),   dimension(:) :: zeta
    495 logical , intent(in),   dimension(:) :: mask
    496 
    497 logical, dimension(size(zeta(:))) :: stable, unstable
    498 
    499 stable   = mask .and. zeta >= 0.0
    500 unstable = mask .and. zeta <  0.0
    501 
    502 where (unstable)
    503   phi_t = (1 - 16.0*zeta)**(-0.5)
    504 end where
    505 
    506 if(stable_option == 1) then
    507 
    508   where (stable)
    509     phi_t = 1.0 + zeta*(5.0 + b_stab*zeta)/(1.0 + zeta)
    510   end where
    511 
    512 else if(stable_option == 2) then
    513 
    514   where (stable .and. zeta < zeta_trans)
    515     phi_t = 1 + 5.0*zeta
    516   end where
    517   where (stable .and. zeta >= zeta_trans)
    518     phi_t = lambda + b_stab*zeta
    519   end where
    520 
    521 endif
    522 
    523 return
    524 end subroutine mo_derivative_t

Page 21          Source Listing                  MO_DERIVATIVE_T
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                             
                                                   
 monin_obukhov_mod_mp_mo_derivative_t_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MASK                       Dummy  489      L(4)            4     1     1        ARG,IN           499,500                           
 MO_DERIVATIVE_T            Subr   489                                                            409,410                           
 PHI_T                      Dummy  489      R(8)            8     1     1        ARG,OUT          503,509,515,518                   
 STABLE                     Local  497      L(4)            4     1     0                         499,508,514,517                   
 UNSTABLE                   Local  497      L(4)            4     1     0                         500,502                           
 ZETA                       Dummy  489      R(8)            8     1     1        ARG,IN           499,500,503,509,514,515,517,518   

Page 22          Source Listing                  MO_DERIVATIVE_T
2021-06-01 08:55                                 monin_obukhov.F90

    525 
    526 !=======================================================================
    527 
    528 subroutine mo_integral_tq (psi_t, psi_q, zeta, zeta_t, zeta_q, &
    529                            ln_z_zt, ln_z_zq, mask)
    530 
    531 ! the integral similarity function for moisture and tracers
    532 
    533 real    , intent(out), dimension(:) :: psi_t, psi_q
    534 real    , intent(in),  dimension(:) :: zeta, zeta_t, zeta_q, ln_z_zt, ln_z_zq
    535 logical , intent(in),  dimension(:) :: mask
    536 
    537 real, dimension(size(zeta(:))) :: x, x_t, x_q
    538 
    539 logical, dimension(size(zeta(:))) :: stable, unstable, &
    540                                   weakly_stable, strongly_stable
    541 
    542 stable   = mask .and. zeta >= 0.0
    543 unstable = mask .and. zeta <  0.0
    544 
    545 where(unstable)
    546 
    547   x     = sqrt(1 - 16.0*zeta)
    548   x_t   = sqrt(1 - 16.0*zeta_t)
    549   x_q   = sqrt(1 - 16.0*zeta_q)
    550 
    551   psi_t = ln_z_zt - 2.0*log( (1.0 + x)/(1.0 + x_t) )
    552   psi_q = ln_z_zq - 2.0*log( (1.0 + x)/(1.0 + x_q) )
    553 
    554 end where
    555 
    556 if( stable_option == 1) then
    557 
    558   where (stable)
    559 
    560     psi_t = ln_z_zt + (5.0 - b_stab)*log((1.0 + zeta)/(1.0 + zeta_t)) &
    561        + b_stab*(zeta - zeta_t)
    562     psi_q = ln_z_zq + (5.0 - b_stab)*log((1.0 + zeta)/(1.0 + zeta_q)) &
    563        + b_stab*(zeta - zeta_q)
    564 
    565   end where
    566 
    567 else if (stable_option == 2) then
    568 
    569   weakly_stable   = stable .and. zeta <= zeta_trans
    570   strongly_stable = stable .and. zeta >  zeta_trans
    571 
    572   where (weakly_stable)
    573     psi_t = ln_z_zt + 5.0*(zeta - zeta_t)
    574     psi_q = ln_z_zq + 5.0*(zeta - zeta_q)
    575   end where
    576 
    577   where(strongly_stable)
    578     x = (lambda - 1.0)*log(zeta/zeta_trans) + b_stab*(zeta - zeta_trans)
    579   endwhere
    580 
    581   where (strongly_stable .and. zeta_t <= zeta_trans)

Page 23          Source Listing                  MO_INTEGRAL_TQ
2021-06-01 08:55                                 monin_obukhov.F90

    582     psi_t = ln_z_zt + x + 5.0*(zeta_trans - zeta_t)
    583   end where
    584   where (strongly_stable .and. zeta_t > zeta_trans)
    585     psi_t = lambda*ln_z_zt + b_stab*(zeta  - zeta_t)
    586   endwhere
    587 
    588   where (strongly_stable .and. zeta_q <= zeta_trans)
    589     psi_q = ln_z_zq + x + 5.0*(zeta_trans - zeta_q)
    590   end where
    591   where (strongly_stable .and. zeta_q > zeta_trans)
    592     psi_q = lambda*ln_z_zq + b_stab*(zeta  - zeta_q)
    593   endwhere
    594 
    595 end if
    596 
    597 return
    598 end subroutine mo_integral_tq


ENTRY POINTS

  Name                                            
                                                  
 monin_obukhov_mod_mp_mo_integral_tq_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LN_Z_ZQ                    Dummy  529      R(8)            8     1     1        ARG,IN           552,562,574,589,592               
 LN_Z_ZT                    Dummy  529      R(8)            8     1     1        ARG,IN           551,560,573,582,585               
 LOG                        Func   551                                  scalar                    551,552,560,562,578               
 MASK                       Dummy  529      L(4)            4     1     1        ARG,IN           542,543                           
 MO_INTEGRAL_TQ             Subr   528                                                            413                               
 PSI_Q                      Dummy  528      R(8)            8     1     1        ARG,OUT          552,562,574,589,592               
 PSI_T                      Dummy  528      R(8)            8     1     1        ARG,OUT          551,560,573,582,585               
 SQRT                       Func   547                                  scalar                    547,548,549                       
 STABLE                     Local  539      L(4)            4     1     0                         542,558,569,570                   
 STRONGLY_STABLE            Local  540      L(4)            4     1     0                         570,577,581,584,588,591           
 UNSTABLE                   Local  539      L(4)            4     1     0                         543,545                           
 WEAKLY_STABLE              Local  540      L(4)            4     1     0                         569,572                           
 X                          Local  537      R(8)            8     1     0                         547,551,552,578,582,589           
 X_Q                        Local  537      R(8)            8     1     0                         549,552                           
 X_T                        Local  537      R(8)            8     1     0                         548,551                           
 ZETA                       Dummy  528      R(8)            8     1     1        ARG,IN           542,543,547,560,561,562,563,569,57
                                                                                                  0,573,574,578,585,592             
 ZETA_Q                     Dummy  528      R(8)            8     1     1        ARG,IN           549,562,563,574,588,589,591,592   
 ZETA_T                     Dummy  528      R(8)            8     1     1        ARG,IN           548,560,561,573,581,582,584,585   

Page 24          Source Listing                  MO_INTEGRAL_TQ
2021-06-01 08:55                                 monin_obukhov.F90

    599 
    600 !=======================================================================
    601 
    602 subroutine mo_integral_m (psi_m, zeta, zeta_0, ln_z_z0, mask)
    603 
    604 !  the integral similarity function for momentum
    605 
    606 real    , intent(out), dimension(:) :: psi_m
    607 real    , intent(in),  dimension(:) :: zeta, zeta_0, ln_z_z0
    608 logical , intent(in),  dimension(:) :: mask
    609 
    610 real, dimension(size(zeta(:))) :: x, x_0, x1, x1_0, num, denom, y
    611 
    612 logical, dimension(size(zeta(:))) :: stable, unstable, &
    613                                   weakly_stable, strongly_stable
    614 
    615 stable   = mask .and. zeta >= 0.0
    616 unstable = mask .and. zeta <  0.0
    617 
    618 where(unstable)
    619 
    620   x     = sqrt(1 - 16.0*zeta)
    621   x_0   = sqrt(1 - 16.0*zeta_0)
    622 
    623   x      = sqrt(x)
    624   x_0    = sqrt(x_0)
    625 
    626   x1     = 1.0 + x
    627   x1_0   = 1.0 + x_0
    628 
    629   num    = x1*x1*(1.0 + x*x)
    630   denom  = x1_0*x1_0*(1.0 + x_0*x_0)
    631   y      = atan(x) - atan(x_0)
    632   psi_m  = ln_z_z0 - log(num/denom) + 2*y
    633 
    634 end where
    635 
    636 if( stable_option == 1) then
    637 
    638   where (stable)
    639     psi_m = ln_z_z0 + (5.0 - b_stab)*log((1.0 + zeta)/(1.0 + zeta_0)) &
    640        + b_stab*(zeta - zeta_0)
    641   end where
    642 
    643 else if (stable_option == 2) then
    644 
    645   weakly_stable   = stable .and. zeta <= zeta_trans
    646   strongly_stable = stable .and. zeta >  zeta_trans
    647 
    648   where (weakly_stable)
    649     psi_m = ln_z_z0 + 5.0*(zeta - zeta_0)
    650   end where
    651 
    652   where(strongly_stable)
    653     x = (lambda - 1.0)*log(zeta/zeta_trans) + b_stab*(zeta - zeta_trans)
    654   endwhere
    655 

Page 25          Source Listing                  MO_INTEGRAL_M
2021-06-01 08:55                                 monin_obukhov.F90

    656   where (strongly_stable .and. zeta_0 <= zeta_trans)
    657     psi_m = ln_z_z0 + x + 5.0*(zeta_trans - zeta_0)
    658   end where
    659   where (strongly_stable .and. zeta_0 > zeta_trans)
    660     psi_m = lambda*ln_z_z0 + b_stab*(zeta  - zeta_0)
    661   endwhere
    662 
    663 end if
    664 
    665 return
    666 end subroutine mo_integral_m


ENTRY POINTS

  Name                                           
                                                 
 monin_obukhov_mod_mp_mo_integral_m_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ATAN                       Func   631                                  scalar                    631                               
 DENOM                      Local  610      R(8)            8     1     0                         630,632                           
 LN_Z_Z0                    Dummy  602      R(8)            8     1     1        ARG,IN           632,639,649,657,660               
 LOG                        Func   632                                  scalar                    632,639,653                       
 MASK                       Dummy  602      L(4)            4     1     1        ARG,IN           615,616                           
 MO_INTEGRAL_M              Subr   602                                                            412                               
 NUM                        Local  610      R(8)            8     1     0                         629,632                           
 PSI_M                      Dummy  602      R(8)            8     1     1        ARG,OUT          632,639,649,657,660               
 SQRT                       Func   620                                  scalar                    620,621,623,624                   
 STABLE                     Local  612      L(4)            4     1     0                         615,638,645,646                   
 STRONGLY_STABLE            Local  613      L(4)            4     1     0                         646,652,656,659                   
 UNSTABLE                   Local  612      L(4)            4     1     0                         616,618                           
 WEAKLY_STABLE              Local  613      L(4)            4     1     0                         645,648                           
 X                          Local  610      R(8)            8     1     0                         620,623,626,629,631,653,657       
 X1                         Local  610      R(8)            8     1     0                         626,629                           
 X1_0                       Local  610      R(8)            8     1     0                         627,630                           
 X_0                        Local  610      R(8)            8     1     0                         621,624,627,630,631               
 Y                          Local  610      R(8)            8     1     0                         631,632                           
 ZETA                       Dummy  602      R(8)            8     1     1        ARG,IN           615,616,620,639,640,645,646,649,65
                                                                                                  3,660                             
 ZETA_0                     Dummy  602      R(8)            8     1     1        ARG,IN           621,639,640,649,656,657,659,660   

Page 26          Source Listing                  MO_INTEGRAL_M
2021-06-01 08:55                                 monin_obukhov.F90

    667 
    668 
    669 !=======================================================================
    670 ! The following routines allow the public interfaces to be used
    671 ! with different dimensions of the input and output
    672 !
    673 !=======================================================================
    674 
    675 
    676 subroutine mo_drag_2d &
    677     (pt, pt0, z, z0, zt, zq, speed, drag_m, drag_t, drag_q, u_star, b_star)
    678 
    679 real, intent(in)   , dimension(:,:) :: z, speed, pt, pt0, z0, zt, zq
    680 real, intent(out)  , dimension(:,:) :: drag_m, drag_t, drag_q
    681 real, intent(inout), dimension(:,:) :: u_star, b_star
    682 
    683 integer :: j
    684 
    685 do j = 1, size(pt,2)
    686   call mo_drag_1d (pt(:,j), pt0(:,j), z(:,j), z0(:,j), zt(:,j), zq(:,j), &
    687                    speed(:,j), drag_m(:,j), drag_t(:,j), drag_q(:,j), &
    688                    u_star(:,j), b_star(:,j))
    689 end do
    690 
    691 
    692 return
    693 end subroutine mo_drag_2d


ENTRY POINTS

  Name                                        
                                              
 monin_obukhov_mod_mp_mo_drag_2d_             

Page 27          Source Listing                  MO_DRAG_2D
2021-06-01 08:55 Symbol Table                    monin_obukhov.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  677      R(8)            8     2     1        ARG,INOUT        688                               
 DRAG_M                     Dummy  677      R(8)            8     2     1        ARG,OUT          687                               
 DRAG_Q                     Dummy  677      R(8)            8     2     1        ARG,OUT          687                               
 DRAG_T                     Dummy  677      R(8)            8     2     1        ARG,OUT          687                               
 J                          Local  683      I(4)            4           scalar                    685,686,687,688                   
 MO_DRAG_2D                 Subr   676                                           PRIV                                               
 PT                         Dummy  677      R(8)            8     2     1        ARG,IN           685,686                           
 PT0                        Dummy  677      R(8)            8     2     1        ARG,IN           686                               
 SIZE                       Func   685                                  scalar                    685                               
 SPEED                      Dummy  677      R(8)            8     2     1        ARG,IN           687                               
 U_STAR                     Dummy  677      R(8)            8     2     1        ARG,INOUT        688                               
 Z                          Dummy  677      R(8)            8     2     1        ARG,IN           686                               
 Z0                         Dummy  677      R(8)            8     2     1        ARG,IN           686                               
 ZQ                         Dummy  677      R(8)            8     2     1        ARG,IN           686                               
 ZT                         Dummy  677      R(8)            8     2     1        ARG,IN           686                               

Page 28          Source Listing                  MO_DRAG_2D
2021-06-01 08:55                                 monin_obukhov.F90

    694 
    695 !=======================================================================
    696 subroutine mo_drag_0d &
    697     (pt, pt0, z, z0, zt, zq, speed, drag_m, drag_t, drag_q, u_star, b_star)
    698 
    699 real, intent(in)    :: z, speed, pt, pt0, z0, zt, zq
    700 real, intent(out)   :: drag_m, drag_t, drag_q, u_star, b_star
    701 
    702 real, dimension(1) :: pt_1, pt0_1, z_1, z0_1, zt_1, zq_1, speed_1, &
    703                       drag_m_1, drag_t_1, drag_q_1, u_star_1, b_star_1
    704 
    705 pt_1   (1) = pt
    706 pt0_1  (1) = pt0
    707 z_1    (1) = z
    708 z0_1   (1) = z0
    709 zt_1   (1) = zt
    710 zq_1   (1) = zq
    711 speed_1(1) = speed
    712 
    713 call mo_drag_1d (pt_1, pt0_1, z_1, z0_1, zt_1, zq_1, speed_1, &
    714                  drag_m_1, drag_t_1, drag_q_1, u_star_1, b_star_1)
    715 
    716 drag_m = drag_m_1(1)
    717 drag_t = drag_t_1(1)
    718 drag_q = drag_q_1(1)
    719 u_star = u_star_1(1)
    720 b_star = b_star_1(1)
    721 
    722 return
    723 end subroutine mo_drag_0d

Page 29          Source Listing                  MO_DRAG_0D
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                        
                                              
 monin_obukhov_mod_mp_mo_drag_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  697      R(8)            8           scalar   ARG,OUT          720                               
 B_STAR_1                   Local  703      R(8)            8     1     1        TGT              714,720                           
 DRAG_M                     Dummy  697      R(8)            8           scalar   ARG,OUT          716                               
 DRAG_M_1                   Local  703      R(8)            8     1     1        TGT              714,716                           
 DRAG_Q                     Dummy  697      R(8)            8           scalar   ARG,OUT          718                               
 DRAG_Q_1                   Local  703      R(8)            8     1     1        TGT              714,718                           
 DRAG_T                     Dummy  697      R(8)            8           scalar   ARG,OUT          717                               
 DRAG_T_1                   Local  703      R(8)            8     1     1        TGT              714,717                           
 MO_DRAG_0D                 Subr   696                                           PRIV                                               
 PT                         Dummy  697      R(8)            8           scalar   ARG,IN           705                               
 PT0                        Dummy  697      R(8)            8           scalar   ARG,IN           706                               
 PT0_1                      Local  702      R(8)            8     1     1        TGT              706,713                           
 PT_1                       Local  702      R(8)            8     1     1        TGT              705,713                           
 SPEED                      Dummy  697      R(8)            8           scalar   ARG,IN           711                               
 SPEED_1                    Local  702      R(8)            8     1     1        TGT              711,713                           
 U_STAR                     Dummy  697      R(8)            8           scalar   ARG,OUT          719                               
 U_STAR_1                   Local  703      R(8)            8     1     1        TGT              714,719                           
 Z                          Dummy  697      R(8)            8           scalar   ARG,IN           707                               
 Z0                         Dummy  697      R(8)            8           scalar   ARG,IN           708                               
 Z0_1                       Local  702      R(8)            8     1     1        TGT              708,713                           
 ZQ                         Dummy  697      R(8)            8           scalar   ARG,IN           710                               
 ZQ_1                       Local  702      R(8)            8     1     1        TGT              710,713                           
 ZT                         Dummy  697      R(8)            8           scalar   ARG,IN           709                               
 ZT_1                       Local  702      R(8)            8     1     1        TGT              709,713                           
 Z_1                        Local  702      R(8)            8     1     1        TGT              707,713                           

Page 30          Source Listing                  MO_DRAG_0D
2021-06-01 08:55                                 monin_obukhov.F90

    724 !=======================================================================
    725 
    726 subroutine mo_profile_2d(zref, zref_t, z, z0, zt, zq, u_star, b_star, q_star, &
    727                          del_m, del_h, del_q)
    728 
    729 real, intent(in)                  :: zref, zref_t
    730 real, intent(in) , dimension(:,:) :: z, z0, zt, zq, u_star, b_star, q_star
    731 real, intent(out), dimension(:,:) :: del_m, del_h, del_q
    732 
    733 integer :: j
    734 
    735 do j = 1, size(z,2)
    736   call mo_profile_1d (zref, zref_t, z(:,j), z0(:,j), zt(:,j),         &
    737                       zq(:,j), u_star(:,j), b_star(:,j), q_star(:,j), &
    738                       del_m(:,j), del_h (:,j), del_q (:,j))
    739 enddo
    740 
    741 return
    742 end subroutine mo_profile_2d


ENTRY POINTS

  Name                                           
                                                 
 monin_obukhov_mod_mp_mo_profile_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  726      R(8)            8     2     1        ARG,IN           737                               
 DEL_H                      Dummy  727      R(8)            8     2     1        ARG,OUT          738                               
 DEL_M                      Dummy  727      R(8)            8     2     1        ARG,OUT          738                               
 DEL_Q                      Dummy  727      R(8)            8     2     1        ARG,OUT          738                               
 J                          Local  733      I(4)            4           scalar                    735,736,737,738                   
 MO_PROFILE_2D              Subr   726                                           PRIV             832                               
 Q_STAR                     Dummy  726      R(8)            8     2     1        ARG,IN           737                               
 SIZE                       Func   735                                  scalar                    735                               
 U_STAR                     Dummy  726      R(8)            8     2     1        ARG,IN           737                               
 Z                          Dummy  726      R(8)            8     2     1        ARG,IN           735,736                           
 Z0                         Dummy  726      R(8)            8     2     1        ARG,IN           736                               
 ZQ                         Dummy  726      R(8)            8     2     1        ARG,IN           737                               
 ZREF                       Dummy  726      R(8)            8           scalar   ARG,IN           736                               
 ZREF_T                     Dummy  726      R(8)            8           scalar   ARG,IN           736                               
 ZT                         Dummy  726      R(8)            8     2     1        ARG,IN           736                               

Page 31          Source Listing                  MO_PROFILE_2D
2021-06-01 08:55                                 monin_obukhov.F90

    743 
    744 !=======================================================================
    745 
    746 subroutine mo_profile_0d(zref, zref_t, z, z0, zt, zq, u_star, b_star, q_star, &
    747                          del_m, del_h, del_q)
    748 
    749 real, intent(in)  :: zref, zref_t
    750 real, intent(in)  :: z, z0, zt, zq, u_star, b_star, q_star
    751 real, intent(out) :: del_m, del_h, del_q
    752 
    753 real, dimension(1) :: z_1, z0_1, zt_1, zq_1, u_star_1, b_star_1, q_star_1, &
    754                       del_m_1, del_h_1, del_q_1
    755 
    756 z_1     (1) = z
    757 z0_1    (1) = z0
    758 zt_1    (1) = zt
    759 zq_1    (1) = zq
    760 u_star_1(1) = u_star
    761 b_star_1(1) = b_star
    762 q_star_1(1) = q_star
    763 
    764 call mo_profile_1d (zref, zref_t, z_1, z0_1, zt_1, zq_1, &
    765                     u_star_1, b_star_1, q_star_1,        &
    766                     del_m_1, del_h_1, del_q_1)
    767 
    768 del_m = del_m_1(1)
    769 del_h = del_h_1(1)
    770 del_q = del_q_1(1)
    771 
    772 
    773 return
    774 end subroutine mo_profile_0d

Page 32          Source Listing                  MO_PROFILE_0D
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                           
                                                 
 monin_obukhov_mod_mp_mo_profile_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  746      R(8)            8           scalar   ARG,IN           761                               
 B_STAR_1                   Local  753      R(8)            8     1     1        TGT              761,765                           
 DEL_H                      Dummy  747      R(8)            8           scalar   ARG,OUT          769                               
 DEL_H_1                    Local  754      R(8)            8     1     1        TGT              766,769                           
 DEL_M                      Dummy  747      R(8)            8           scalar   ARG,OUT          768                               
 DEL_M_1                    Local  754      R(8)            8     1     1        TGT              766,768                           
 DEL_Q                      Dummy  747      R(8)            8           scalar   ARG,OUT          770                               
 DEL_Q_1                    Local  754      R(8)            8     1     1        TGT              766,770                           
 MO_PROFILE_0D              Subr   746                                           PRIV             813                               
 Q_STAR                     Dummy  746      R(8)            8           scalar   ARG,IN           762                               
 Q_STAR_1                   Local  753      R(8)            8     1     1        TGT              762,765                           
 U_STAR                     Dummy  746      R(8)            8           scalar   ARG,IN           760                               
 U_STAR_1                   Local  753      R(8)            8     1     1        TGT              760,765                           
 Z                          Dummy  746      R(8)            8           scalar   ARG,IN           756                               
 Z0                         Dummy  746      R(8)            8           scalar   ARG,IN           757                               
 Z0_1                       Local  753      R(8)            8     1     1        TGT              757,764                           
 ZQ                         Dummy  746      R(8)            8           scalar   ARG,IN           759                               
 ZQ_1                       Local  753      R(8)            8     1     1        TGT              759,764                           
 ZREF                       Dummy  746      R(8)            8           scalar   ARG,IN           764                               
 ZREF_T                     Dummy  746      R(8)            8           scalar   ARG,IN           764                               
 ZT                         Dummy  746      R(8)            8           scalar   ARG,IN           758                               
 ZT_1                       Local  753      R(8)            8     1     1        TGT              758,764                           
 Z_1                        Local  753      R(8)            8     1     1        TGT              756,764                           

Page 33          Source Listing                  MO_PROFILE_0D
2021-06-01 08:55                                 monin_obukhov.F90

    775 
    776 !=======================================================================
    777 
    778 subroutine mo_profile_1d_n(zref, z, z0, zt, zq, u_star, b_star, q_star, &
    779                          del_m, del_t, del_q, avail)
    780 
    781 real,    intent(in),  dimension(:)   :: zref
    782 real,    intent(in) , dimension(:)   :: z, z0, zt, zq, u_star, b_star, q_star
    783 real,    intent(out), dimension(:,:) :: del_m, del_t, del_q
    784 logical, intent(in) , optional, dimension(:) :: avail
    785 
    786 integer :: k
    787 
    788 do k = 1, size(zref(:))
    789   if(present(avail)) then
    790     call mo_profile_1d (zref(k), zref(k), z, z0, zt, zq, &
    791        u_star, b_star, q_star, del_m(:,k), del_t(:,k), del_q(:,k), avail)
    792   else
    793       call mo_profile_1d (zref(k), zref(k), z, z0, zt, zq, &
    794        u_star, b_star, q_star, del_m(:,k), del_t(:,k), del_q(:,k))
    795   endif
    796 enddo
    797 
    798 return
    799 end subroutine mo_profile_1d_n


ENTRY POINTS

  Name                                             
                                                   
 monin_obukhov_mod_mp_mo_profile_1d_n_             

Page 34          Source Listing                  MO_PROFILE_1D_N
2021-06-01 08:55 Symbol Table                    monin_obukhov.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 AVAIL                      Dummy  779      L(4)            4     1     1        ARG,IN           789,791                           
 B_STAR                     Dummy  778      R(8)            8     1     1        ARG,IN           791,794                           
 DEL_M                      Dummy  779      R(8)            8     2     1        ARG,OUT          791,794                           
 DEL_Q                      Dummy  779      R(8)            8     2     1        ARG,OUT          791,794                           
 DEL_T                      Dummy  779      R(8)            8     2     1        ARG,OUT          791,794                           
 K                          Local  786      I(4)            4           scalar                    788,790,791,793,794               
 MO_PROFILE_1D_N            Subr   778                                           PRIV                                               
 PRESENT                    Func   789                                  scalar                    789                               
 Q_STAR                     Dummy  778      R(8)            8     1     1        ARG,IN           791,794                           
 SIZE                       Func   788                                  scalar                    788                               
 U_STAR                     Dummy  778      R(8)            8     1     1        ARG,IN           791,794                           
 Z                          Dummy  778      R(8)            8     1     1        ARG,IN           790,793                           
 Z0                         Dummy  778      R(8)            8     1     1        ARG,IN           790,793                           
 ZQ                         Dummy  778      R(8)            8     1     1        ARG,IN           790,793                           
 ZREF                       Dummy  778      R(8)            8     1     1        ARG,IN           788,790,793                       
 ZT                         Dummy  778      R(8)            8     1     1        ARG,IN           790,793                           

Page 35          Source Listing                  MO_PROFILE_1D_N
2021-06-01 08:55                                 monin_obukhov.F90

    800 
    801 !=======================================================================
    802 
    803 subroutine mo_profile_0d_n(zref, z, z0, zt, zq, u_star, b_star, q_star, &
    804                          del_m, del_t, del_q)
    805 
    806 real,    intent(in),  dimension(:) :: zref
    807 real,    intent(in)                :: z, z0, zt, zq, u_star, b_star, q_star
    808 real,    intent(out), dimension(:) :: del_m, del_t, del_q
    809 
    810 integer :: k
    811 
    812 do k = 1, size(zref(:))
    813   call mo_profile_0d (zref(k), zref(k), z, z0, zt, zq, &
    814        u_star, b_star, q_star, del_m(k), del_t(k), del_q(k))
    815 enddo
    816 
    817 return
    818 end subroutine mo_profile_0d_n


ENTRY POINTS

  Name                                             
                                                   
 monin_obukhov_mod_mp_mo_profile_0d_n_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  803      R(8)            8           scalar   ARG,IN           814                               
 DEL_M                      Dummy  804      R(8)            8     1     1        ARG,OUT          814                               
 DEL_Q                      Dummy  804      R(8)            8     1     1        ARG,OUT          814                               
 DEL_T                      Dummy  804      R(8)            8     1     1        ARG,OUT          814                               
 K                          Local  810      I(4)            4           scalar                    812,813,814                       
 MO_PROFILE_0D_N            Subr   803                                           PRIV                                               
 Q_STAR                     Dummy  803      R(8)            8           scalar   ARG,IN           814                               
 SIZE                       Func   812                                  scalar                    812                               
 U_STAR                     Dummy  803      R(8)            8           scalar   ARG,IN           814                               
 Z                          Dummy  803      R(8)            8           scalar   ARG,IN           813                               
 Z0                         Dummy  803      R(8)            8           scalar   ARG,IN           813                               
 ZQ                         Dummy  803      R(8)            8           scalar   ARG,IN           813                               
 ZREF                       Dummy  803      R(8)            8     1     1        ARG,IN           812,813                           
 ZT                         Dummy  803      R(8)            8           scalar   ARG,IN           813                               

Page 36          Source Listing                  MO_PROFILE_0D_N
2021-06-01 08:55                                 monin_obukhov.F90

    819 
    820 !=======================================================================
    821 
    822 subroutine mo_profile_2d_n(zref, z, z0, zt, zq, u_star, b_star, q_star, &
    823                          del_m, del_t, del_q)
    824 
    825 real,    intent(in),  dimension(:)     :: zref
    826 real,    intent(in),  dimension(:,:)   :: z, z0, zt, zq, u_star, b_star, q_star
    827 real,    intent(out), dimension(:,:,:) :: del_m, del_t, del_q
    828 
    829 integer :: k
    830 
    831 do k = 1, size(zref(:))
    832   call mo_profile_2d (zref(k), zref(k), z, z0, zt, zq, &
    833        u_star, b_star, q_star, del_m(:,:,k), del_t(:,:,k), del_q(:,:,k))
    834 enddo
    835 
    836 return
    837 end subroutine mo_profile_2d_n


ENTRY POINTS

  Name                                             
                                                   
 monin_obukhov_mod_mp_mo_profile_2d_n_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  822      R(8)            8     2     1        ARG,IN           833                               
 DEL_M                      Dummy  823      R(8)            8     3     1        ARG,OUT          833                               
 DEL_Q                      Dummy  823      R(8)            8     3     1        ARG,OUT          833                               
 DEL_T                      Dummy  823      R(8)            8     3     1        ARG,OUT          833                               
 K                          Local  829      I(4)            4           scalar                    831,832,833                       
 MO_PROFILE_2D_N            Subr   822                                           PRIV                                               
 Q_STAR                     Dummy  822      R(8)            8     2     1        ARG,IN           833                               
 SIZE                       Func   831                                  scalar                    831                               
 U_STAR                     Dummy  822      R(8)            8     2     1        ARG,IN           833                               
 Z                          Dummy  822      R(8)            8     2     1        ARG,IN           832                               
 Z0                         Dummy  822      R(8)            8     2     1        ARG,IN           832                               
 ZQ                         Dummy  822      R(8)            8     2     1        ARG,IN           832                               
 ZREF                       Dummy  822      R(8)            8     1     1        ARG,IN           831,832                           
 ZT                         Dummy  822      R(8)            8     2     1        ARG,IN           832                               

Page 37          Source Listing                  MO_PROFILE_2D_N
2021-06-01 08:55                                 monin_obukhov.F90

    838 
    839 !=======================================================================
    840 
    841 subroutine mo_diff_2d_1(z, u_star, b_star, k_m, k_h)
    842 
    843 real, intent(in),  dimension(:,:) :: z, u_star, b_star
    844 real, intent(out), dimension(:,:) :: k_m, k_h
    845 
    846 real   , dimension(size(z,1),size(z,2),1) :: z_n, k_m_n, k_h_n
    847 
    848 z_n(:,:,1) = z
    849 
    850 call mo_diff_2d_n(z_n, u_star, b_star, k_m_n, k_h_n)
    851 
    852 k_m = k_m_n(:,:,1)
    853 k_h = k_h_n(:,:,1)
    854 
    855 return
    856 end subroutine mo_diff_2d_1


ENTRY POINTS

  Name                                          
                                                
 monin_obukhov_mod_mp_mo_diff_2d_1_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  841      R(8)            8     2     1        ARG,IN           850                               
 K_H                        Dummy  841      R(8)            8     2     1        ARG,OUT          853                               
 K_H_N                      Local  846      R(8)            8     3     0        TGT              850,853                           
 K_M                        Dummy  841      R(8)            8     2     1        ARG,OUT          852                               
 K_M_N                      Local  846      R(8)            8     3     0        TGT              850,852                           
 MO_DIFF_2D_1               Subr   841                                           PRIV                                               
 U_STAR                     Dummy  841      R(8)            8     2     1        ARG,IN           850                               
 Z                          Dummy  841      R(8)            8     2     1        ARG,IN           848                               
 Z_N                        Local  846      R(8)            8     3     0        TGT              848,850                           

Page 38          Source Listing                  MO_DIFF_2D_1
2021-06-01 08:55                                 monin_obukhov.F90

    857 
    858 
    859 !=======================================================================
    860 
    861 subroutine mo_diff_1d_1(z, u_star, b_star, k_m, k_h)
    862 
    863 real, intent(in),  dimension(:) :: z, u_star, b_star
    864 real, intent(out), dimension(:) :: k_m, k_h
    865 
    866 real, dimension(size(z),1,1) :: z_n, k_m_n, k_h_n
    867 real, dimension(size(z),1)   :: u_star_n, b_star_n
    868 
    869 z_n   (:,1,1) = z
    870 u_star_n(:,1) = u_star
    871 b_star_n(:,1) = b_star
    872 
    873 call mo_diff_2d_n(z_n, u_star_n, b_star_n, k_m_n, k_h_n)
    874 
    875 k_m = k_m_n(:,1,1)
    876 k_h = k_h_n(:,1,1)
    877 
    878 return
    879 end subroutine mo_diff_1d_1


ENTRY POINTS

  Name                                          
                                                
 monin_obukhov_mod_mp_mo_diff_1d_1_             

Page 39          Source Listing                  MO_DIFF_1D_1
2021-06-01 08:55 Symbol Table                    monin_obukhov.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  861      R(8)            8     1     1        ARG,IN           871                               
 B_STAR_N                   Local  867      R(8)            8     2     0        TGT              871,873                           
 K_H                        Dummy  861      R(8)            8     1     1        ARG,OUT          876                               
 K_H_N                      Local  866      R(8)            8     3     0        TGT              873,876                           
 K_M                        Dummy  861      R(8)            8     1     1        ARG,OUT          875                               
 K_M_N                      Local  866      R(8)            8     3     0        TGT              873,875                           
 MO_DIFF_1D_1               Subr   861                                           PRIV                                               
 U_STAR                     Dummy  861      R(8)            8     1     1        ARG,IN           870                               
 U_STAR_N                   Local  867      R(8)            8     2     0        TGT              870,873                           
 Z                          Dummy  861      R(8)            8     1     1        ARG,IN           869                               
 Z_N                        Local  866      R(8)            8     3     0        TGT              869,873                           

Page 40          Source Listing                  MO_DIFF_1D_1
2021-06-01 08:55                                 monin_obukhov.F90

    880 
    881 !=======================================================================
    882 
    883 subroutine mo_diff_1d_n(z, u_star, b_star, k_m, k_h)
    884 
    885 real, intent(in),  dimension(:,:) :: z
    886 real, intent(in),  dimension(:)   :: u_star, b_star
    887 real, intent(out), dimension(:,:) :: k_m, k_h
    888 
    889 real, dimension(size(z,1),1)            :: u_star2, b_star2
    890 real, dimension(size(z,1),1, size(z,2)) :: z2, k_m2, k_h2
    891 
    892 integer :: n
    893 
    894 do n = 1, size(z,2)
    895   z2   (:,1,n) = z(:,n)
    896 enddo
    897 u_star2(:,1) = u_star
    898 b_star2(:,1) = b_star
    899 
    900 call mo_diff_2d_n(z2, u_star2, b_star2, k_m2, k_h2)
    901 
    902 do n = 1, size(z,2)
    903   k_m(:,n) = k_m2(:,1,n)
    904   k_h(:,n) = k_h2(:,1,n)
    905 enddo
    906 
    907 return
    908 end subroutine mo_diff_1d_n

Page 41          Source Listing                  MO_DIFF_1D_N
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                          
                                                
 monin_obukhov_mod_mp_mo_diff_1d_n_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  883      R(8)            8     1     1        ARG,IN           898                               
 B_STAR2                    Local  889      R(8)            8     2     0        TGT              898,900                           
 K_H                        Dummy  883      R(8)            8     2     1        ARG,OUT          904                               
 K_H2                       Local  890      R(8)            8     3     0        TGT              900,904                           
 K_M                        Dummy  883      R(8)            8     2     1        ARG,OUT          903                               
 K_M2                       Local  890      R(8)            8     3     0        TGT              900,903                           
 MO_DIFF_1D_N               Subr   883                                           PRIV                                               
 N                          Local  892      I(4)            4           scalar                    894,895,902,903,904               
 SIZE                       Func   894                                  scalar                    894,902                           
 U_STAR                     Dummy  883      R(8)            8     1     1        ARG,IN           897                               
 U_STAR2                    Local  889      R(8)            8     2     0        TGT              897,900                           
 Z                          Dummy  883      R(8)            8     2     1        ARG,IN           894,895,902                       
 Z2                         Local  890      R(8)            8     3     0        TGT              895,900                           

Page 42          Source Listing                  MO_DIFF_1D_N
2021-06-01 08:55                                 monin_obukhov.F90

    909 
    910 !=======================================================================
    911 
    912 subroutine mo_diff_0d_1(z, u_star, b_star, k_m, k_h)
    913 
    914 real, intent(in)  :: z, u_star, b_star
    915 real, intent(out) :: k_m, k_h
    916 
    917 integer            :: ni, nj, nk, ier
    918 real, parameter    :: ustar_min = 1.e-10
    919 real, dimension(1,1,1) :: z_a, k_m_a, k_h_a
    920 real, dimension(1,1) :: u_star_a, b_star_a
    921 
    922 if(.not.module_is_initialized) call error_mesg('mo_diff_0d_1 in monin_obukhov_mod', &
    923      'monin_obukhov_init has not been called', FATAL)
    924 
    925 ni = 1; nj = 1; nk = 1
    926 z_a(1,1,1) = z
    927 u_star_a(1,1) = u_star
    928 b_star_a(1,1) = b_star
    929 call monin_obukhov_diff(vonkarm,                           &
    930           & ustar_min,                                     &
    931           & neutral, stable_option, new_mo_option,rich_crit, zeta_trans, &!miz
    932           & ni, nj, nk, z_a, u_star_a, b_star_a, k_m_a, k_h_a, ier)
    933 k_m = k_m_a(1,1,1)
    934 k_h = k_h_a(1,1,1)
    935 end subroutine mo_diff_0d_1


ENTRY POINTS

  Name                                          
                                                
 monin_obukhov_mod_mp_mo_diff_0d_1_             

Page 43          Source Listing                  MO_DIFF_0D_1
2021-06-01 08:55 Symbol Table                    monin_obukhov.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  912      R(8)            8           scalar   ARG,IN           928                               
 B_STAR_A                   Local  920      R(8)            8     2     1                         928,932                           
 IER                        Local  917      I(4)            4           scalar                    932                               
 K_H                        Dummy  912      R(8)            8           scalar   ARG,OUT          934                               
 K_H_A                      Local  919      R(8)            8     3     1                         932,934                           
 K_M                        Dummy  912      R(8)            8           scalar   ARG,OUT          933                               
 K_M_A                      Local  919      R(8)            8     3     1                         932,933                           
 MO_DIFF_0D_1               Subr   912                                           PRIV                                               
 NI                         Local  917      I(4)            4           scalar                    925,932                           
 NJ                         Local  917      I(4)            4           scalar                    925,932                           
 NK                         Local  917      I(4)            4           scalar                    925,932                           
 USTAR_MIN                  Param  918      R(8)            8           scalar                    930                               
 U_STAR                     Dummy  912      R(8)            8           scalar   ARG,IN           927                               
 U_STAR_A                   Local  920      R(8)            8     2     1                         927,932                           
 Z                          Dummy  912      R(8)            8           scalar   ARG,IN           926                               
 Z_A                        Local  919      R(8)            8     3     1                         926,932                           

Page 44          Source Listing                  MO_DIFF_0D_1
2021-06-01 08:55                                 monin_obukhov.F90

    936 
    937 !=======================================================================
    938 
    939 subroutine mo_diff_0d_n(z, u_star, b_star, k_m, k_h)
    940 
    941 real, intent(in),  dimension(:) :: z
    942 real, intent(in)                :: u_star, b_star
    943 real, intent(out), dimension(:) :: k_m, k_h
    944 
    945 integer            :: ni, nj, nk, ier
    946 real, parameter    :: ustar_min = 1.e-10
    947 real, dimension(1,1,size(z)) :: z_a, k_m_a, k_h_a
    948 real, dimension(1,1) :: u_star_a, b_star_a
    949 
    950 if(.not.module_is_initialized) call error_mesg('mo_diff_0d_n in monin_obukhov_mod', &
    951      'monin_obukhov_init has not been called', FATAL)
    952 
    953 ni = 1; nj = 1; nk = size(z(:))
    954 z_a(1,1,:) = z(:)
    955 u_star_a(1,1) = u_star
    956 b_star_a(1,1) = b_star
    957 call monin_obukhov_diff(vonkarm,                           &
    958           & ustar_min,                                     &
    959           & neutral, stable_option,new_mo_option,rich_crit, zeta_trans, &!miz
    960           & ni, nj, nk, z_a, u_star_a, b_star_a, k_m_a, k_h_a, ier)
    961 k_m(:) = k_m_a(1,1,:)
    962 k_h(:) = k_h_a(1,1,:)
    963 end subroutine mo_diff_0d_n

Page 45          Source Listing                  MO_DIFF_0D_N
2021-06-01 08:55 Entry Points                    monin_obukhov.F90



ENTRY POINTS

  Name                                          
                                                
 monin_obukhov_mod_mp_mo_diff_0d_n_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 B_STAR                     Dummy  939      R(8)            8           scalar   ARG,IN           956                               
 B_STAR_A                   Local  948      R(8)            8     2     1                         956,960                           
 IER                        Local  945      I(4)            4           scalar                    960                               
 K_H                        Dummy  939      R(8)            8     1     1        ARG,OUT          962                               
 K_H_A                      Local  947      R(8)            8     3     0                         960,962                           
 K_M                        Dummy  939      R(8)            8     1     1        ARG,OUT          961                               
 K_M_A                      Local  947      R(8)            8     3     0                         960,961                           
 MO_DIFF_0D_N               Subr   939                                           PRIV                                               
 NI                         Local  945      I(4)            4           scalar                    953,960                           
 NJ                         Local  945      I(4)            4           scalar                    953,960                           
 NK                         Local  945      I(4)            4           scalar                    953,960                           
 SIZE                       Func   953                                  scalar                    953                               
 USTAR_MIN                  Param  946      R(8)            8           scalar                    958                               
 U_STAR                     Dummy  939      R(8)            8           scalar   ARG,IN           955                               
 U_STAR_A                   Local  948      R(8)            8     2     1                         955,960                           
 Z                          Dummy  939      R(8)            8     1     1        ARG,IN           953,954                           
 Z_A                        Local  947      R(8)            8     3     0                         954,960                           

Page 46          Source Listing                  MO_DIFF_0D_N
2021-06-01 08:55                                 monin_obukhov.F90

    964 
    965 !=======================================================================
    966 
    967 subroutine stable_mix_2d(rich, mix)
    968 
    969 real, intent(in) , dimension(:,:)  :: rich
    970 real, intent(out), dimension(:,:)  :: mix
    971 
    972 real, dimension(size(rich,1),size(rich,2),1) :: rich_3d, mix_3d
    973 
    974 rich_3d(:,:,1) = rich
    975 
    976 call stable_mix_3d(rich_3d, mix_3d)
    977 
    978 mix = mix_3d(:,:,1)
    979 
    980 return
    981 end subroutine stable_mix_2d


ENTRY POINTS

  Name                                           
                                                 
 monin_obukhov_mod_mp_stable_mix_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MIX                        Dummy  967      R(8)            8     2     1        ARG,OUT          978                               
 MIX_3D                     Local  972      R(8)            8     3     0        TGT              976,978                           
 RICH                       Dummy  967      R(8)            8     2     1        ARG,IN           974                               
 RICH_3D                    Local  972      R(8)            8     3     0        TGT              974,976                           
 STABLE_MIX_2D              Subr   967                                           PRIV                                               

Page 47          Source Listing                  STABLE_MIX_2D
2021-06-01 08:55                                 monin_obukhov.F90

    982 
    983 
    984 !=======================================================================
    985 
    986 subroutine stable_mix_1d(rich, mix)
    987 
    988 real, intent(in) , dimension(:)  :: rich
    989 real, intent(out), dimension(:)  :: mix
    990 
    991 real, dimension(size(rich),1,1) :: rich_3d, mix_3d
    992 
    993 rich_3d(:,1,1) = rich
    994 
    995 call stable_mix_3d(rich_3d, mix_3d)
    996 
    997 mix = mix_3d(:,1,1)
    998 
    999 return
   1000 end subroutine stable_mix_1d


ENTRY POINTS

  Name                                           
                                                 
 monin_obukhov_mod_mp_stable_mix_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MIX                        Dummy  986      R(8)            8     1     1        ARG,OUT          997                               
 MIX_3D                     Local  991      R(8)            8     3     0        TGT              995,997                           
 RICH                       Dummy  986      R(8)            8     1     1        ARG,IN           993                               
 RICH_3D                    Local  991      R(8)            8     3     0        TGT              993,995                           
 STABLE_MIX_1D              Subr   986                                           PRIV                                               

Page 48          Source Listing                  STABLE_MIX_1D
2021-06-01 08:55                                 monin_obukhov.F90

   1001 
   1002 !=======================================================================
   1003 
   1004 subroutine stable_mix_0d(rich, mix)
   1005 
   1006 real, intent(in) :: rich
   1007 real, intent(out) :: mix
   1008 
   1009 real, dimension(1,1,1) :: rich_3d, mix_3d
   1010 
   1011 rich_3d(1,1,1) = rich
   1012 
   1013 call stable_mix_3d(rich_3d, mix_3d)
   1014 
   1015 mix = mix_3d(1,1,1)
   1016 
   1017 return
   1018 end subroutine stable_mix_0d


ENTRY POINTS

  Name                                           
                                                 
 monin_obukhov_mod_mp_stable_mix_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MIX                        Dummy  1004     R(8)            8           scalar   ARG,OUT          1015                              
 MIX_3D                     Local  1009     R(8)            8     3     1        TGT              1013,1015                         
 RICH                       Dummy  1004     R(8)            8           scalar   ARG,IN           1011                              
 RICH_3D                    Local  1009     R(8)            8     3     1        TGT              1011,1013                         
 STABLE_MIX_0D              Subr   1004                                          PRIV                                               

Page 49          Source Listing                  STABLE_MIX_0D
2021-06-01 08:55                                 monin_obukhov.F90

   1019 !=======================================================================
   1020 
   1021 end module monin_obukhov_mod


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CONSTANTS_MOD              Module 37                                                             37                                
 FMS_MOD                    Module 39                                                             39                                
 MONIN_OBUKHOV_END          Subr   49                                                             49                                
 MONIN_OBUKHOV_INIT         Subr   48                                                             48                                
 MONIN_OBUKHOV_INTER        Module 42                                                             42                                
 MONIN_OBUKHOV_MOD          Module 21                                                                                               
 MO_DIFF                    Local  66                                   scalar                    52                                
 MO_DRAG                    Local  56                                   scalar                    50                                
 MO_PROFILE                 Local  61                                   scalar                    51                                
 MPP_MOD                    Module 38                                                             38                                
 SMALL                      Param  129      R(8)            8           scalar                                                      
 STABLE_MIX                 Local  72                                   scalar                    53                                

Page 50          Source Listing                  STABLE_MIX_0D
2021-06-01 08:55 Subprograms/Common Blocks       monin_obukhov.F90



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MONIN_OBUKHOV_END          Subr   205                                                                                              
 MONIN_OBUKHOV_INIT         Subr   139                                                                                              
 MONIN_OBUKHOV_MOD          Module 21                                                                                               
 MO_DERIVATIVE_M            Subr   448                                                            407,408                           
 MO_DERIVATIVE_T            Subr   489                                                            409,410                           
 MO_DIFF_0D_1               Subr   912                                           PRIV                                               
 MO_DIFF_0D_N               Subr   939                                           PRIV                                               
 MO_DIFF_1D_1               Subr   861                                           PRIV                                               
 MO_DIFF_1D_N               Subr   883                                           PRIV                                               
 MO_DIFF_2D_1               Subr   841                                           PRIV                                               
 MO_DIFF_2D_N               Subr   317                                           PRIV             850,873,900                       
 MO_DRAG_0D                 Subr   696                                           PRIV                                               
 MO_DRAG_1D                 Subr   213                                           PRIV             686,713                           
 MO_DRAG_2D                 Subr   676                                           PRIV                                               
 MO_INTEGRAL_M              Subr   602                                                            412                               
 MO_INTEGRAL_TQ             Subr   528                                                            413                               
 MO_PROFILE_0D              Subr   746                                           PRIV             813                               
 MO_PROFILE_0D_N            Subr   803                                           PRIV                                               
 MO_PROFILE_1D              Subr   259                                           PRIV             736,764,790,793                   
 MO_PROFILE_1D_N            Subr   778                                           PRIV                                               
 MO_PROFILE_2D              Subr   726                                           PRIV             832                               
 MO_PROFILE_2D_N            Subr   822                                           PRIV                                               
 SOLVE_ZETA                 Subr   341                                                                                              
 STABLE_MIX_0D              Subr   1004                                          PRIV                                               
 STABLE_MIX_1D              Subr   986                                           PRIV                                               
 STABLE_MIX_2D              Subr   967                                           PRIV                                               
 STABLE_MIX_3D              Subr   298                                           PRIV             976,995,1013                      

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume cc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign

Page 51          Source Listing                  STABLE_MIX_0D
2021-06-01 08:55                                 monin_obukhov.F90

       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file
       -convert native                       -cross_reference
       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=0
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20191121       -D _OPENMP=201611
       -D __INTEL_OFFLOAD                    -D __MMX__
       -D __SSE__                            -D __SSE_MATH__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __pentium4                         -D __pentium4__
       -D __tune_pentium4__                  -D PACKAGE_NAME='"GFDL FMS Library"'
       -D PACKAGE_TARNAME='"FMS"'            -D PACKAGE_VERSION='"2021.02.0"'
       -D PACKAGE_STRING='"GFDL FMS Library 2021.02.0"'       -D PACKAGE_BUGREPORT='"gfdl.climate.model.info@noaa.gov"'
       -D PACKAGE_URL='"https://www.gfdl.noaa.gov/fms"'       -D PACKAGE='"FMS"'
       -D VERSION='"2021.02.0"'              -D STDC_HEADERS=1
       -D HAVE_SYS_TYPES_H=1                 -D HAVE_SYS_STAT_H=1
       -D HAVE_STDLIB_H=1                    -D HAVE_STRING_H=1
       -D HAVE_MEMORY_H=1                    -D HAVE_STRINGS_H=1
       -D HAVE_INTTYPES_H=1                  -D HAVE_STDINT_H=1
       -D HAVE_UNISTD_H=1                    -D HAVE_DLFCN_H=1
       -D LT_OBJDIR='".libs/"'               -D HAVE_MPI_H=1
       -D HAVE_NETCDF_H=1                    -D HAVE_SCHED_GETAFFINITY=1
       -D HAVE_MOD_MPI=1                     -D HAVE_MOD_NETCDF=1
       -D HAVE_CRAY_POINTER=1                -D HAVE_QUAD_PRECISION=1
       -D HAVE_INTERNAL_NML=1                -D use_netCDF=1
       -D use_libMPI=1                       -D INTERNAL_FILE_NML
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
  no   -fpconstant                           -fpe3
       -fprm nearest                         -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended

Page 52          Source Listing                  STABLE_MIX_0D
2021-06-01 08:55                                 monin_obukhov.F90

       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -fp_modbits nofp_contract
       -fp_modbits nono_fp_contract          -fp_modbits nofenv_access
       -fp_modbits nono_fenv_access          -fp_modbits nocx_limited_range
       -fp_modbits nono_cx_limited_range       -fp_modbits noprec_div
       -fp_modbits nono_prec_div             -fp_modbits noprec_sqrt
       -fp_modbits nono_prec_sqrt            -fp_modbits ftz
       -fp_modbits nono_ftz                  -fp_modbits nointrin_limited_range
       -fp_modbits nono_intrin_limited_range       -fp_modbits notrunc_compares
       -fp_modbits nono_trunc_compares       -fp_modbits noieee_nan_compares
       -fp_modbits nono_ieee_nan_compares       -fp_modbits honor_f32_conversion
       -fp_modbits nono_honor_f32_conversion       -fp_modbits honor_f64_conversion
       -fp_modbits nono_honor_f64_conversion       -fp_modbits nono_x87_copy
       -fp_modbits nono_no_x87_copy          -fp_modbits noexception_semantics
       -fp_modbits nono_exception_semantics       -fp_modbits noprecise_libm_functions
       -fp_modbits nono_precise_libm_functions       -heap_arrays 0
  no   -threadprivate_compat                 -free
       -g2                                   -iface nomixed_str_len_arg
       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity
       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
       -module ../.mods                      -names lowercase
  no   -noinclude                       no   -o
       -offload-build=host                   -openmp
       -openmp-simd                          -openmp-offload
       -O0                              no   -pad_source
       -real_size 64                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w noalignments                       -w nodeclarations
       -w noexternals                        -w nogeneral
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w nouncalled
       -w nouninitialized                    -w nounused
       -w nousage                       no   -wrap-margins

       -includepath : /opt/netcdf/4.6.1/INTEL/include/,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/,.f90,./.f90,./.f90,../include/.f90,
           ./.f90,/opt/netcdf/4.6.1/INTEL/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/ipp/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mkl/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/tbb/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/daal/include/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/intel64/.f90,/opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/icc/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/.f90,/usr/local/include/.f90,
           /usr/lib/gcc/x86_64-redhat-linux/4.8.5/include/.f90,/usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : monin_obukhov.lst
  no   -o


Page 53          Source Listing                  STABLE_MIX_0D
2021-06-01 08:55                                 monin_obukhov.F90

COMPILER: Intel(R) Fortran 19.1-1555
