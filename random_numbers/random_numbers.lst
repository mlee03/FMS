Page 1           Source Listing                  INITIALIZERANDOMNUMBERSTREAM_S
2021-06-01 08:56                                 /tmp/ifortCTxMwz.i90

      1 # 1 "random_numbers.F90"
      2 !***********************************************************************
      3 !*                   GNU Lesser General Public License
      4 !*
      5 !* This file is part of the GFDL Flexible Modeling System (FMS).
      6 !*
      7 !* FMS is free software: you can redistribute it and/or modify it under
      8 !* the terms of the GNU Lesser General Public License as published by
      9 !* the Free Software Foundation, either version 3 of the License, or (at
     10 !* your option) any later version.
     11 !*
     12 !* FMS is distributed in the hope that it will be useful, but WITHOUT
     13 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
     14 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
     15 !* for more details.
     16 !*
     17 !* You should have received a copy of the GNU Lesser General Public
     18 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
     19 !***********************************************************************
     20 
     21 module random_numbers_mod
     22 ! Generic module to wrap random number generators.
     23 !   The module defines a type that identifies the particular stream of random
     24 !   numbers, and has procedures for initializing it and getting real numbers
     25 !   in the range 0 to 1.
     26 ! This version uses the Mersenne Twister to generate random numbers on [0, 1].
     27 !
     28   use MersenneTwister_mod, only: randomNumberSequence, & ! The random number engine.
     29                                  new_RandomNumberSequence, getRandomReal
     30   use time_manager_mod, only: time_type, get_date
     31   implicit none
     32   private
     33 
     34   type randomNumberStream
     35     type(randomNumberSequence) :: theNumbers
     36   end type randomNumberStream
     37 
     38   interface getRandomNumbers
     39     module procedure getRandomNumber_Scalar, getRandomNumber_1D, getRandomNumber_2D
     40   end interface getRandomNumbers
     41 
     42   interface initializeRandomNumberStream
     43     module procedure initializeRandomNumberStream_S, initializeRandomNumberStream_V
     44   end interface initializeRandomNumberStream
     45 
     46   public :: randomNumberStream,                             &
     47             initializeRandomNumberStream, getRandomNumbers, &
     48             constructSeed
     49 contains
     50 ! ---------------------------------------------------------
     51 ! Initialization
     52 ! ---------------------------------------------------------
     53   function initializeRandomNumberStream_S(seed) result(new)
     54     integer, intent( in)     :: seed
     55     type(randomNumberStream) :: new
     56 
     57     new%theNumbers = new_RandomNumberSequence(seed)

Page 2           Source Listing                  INITIALIZERANDOMNUMBERSTREAM_S
2021-06-01 08:56                                 random_numbers.F90

     58 
     59   end function initializeRandomNumberStream_S


ENTRY POINTS

  Name                                                             
                                                                   
 random_numbers_mod_mp_initializerandomnumberstream_s_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 INITIALIZERANDOMNUMBERSTRE                                                                                                         
 AM_S                       Func   53       RECORD          2500        scalar   PRIV                                               
 INITIALIZE_SCALAR          Func   57       RECORD          2500        scalar   PRIV             57                                
 NEW                        Local  55       RANDOMNUMBERSTREAM                                                                      
                                                            2500        scalar                    57                                
 NEW_RANDOMNUMBERSEQUENCE   Local  57                                   scalar   PRIV             29,57,65                          
 RANDOMNUMBERSTREAM         Type   55                       2500        scalar                    36,46,55,63,72,79,91              
 SEED                       Dummy  53       I(4)            4           scalar   ARG,IN           57                                


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 RANDOMNUMBERSTREAM.THENUMBERS                                                                                             ...
                            RANDOMNUMBERSEQUENCE                                                                              
                                            2500  0              scalar                    57,65,75,86                        

Page 3           Source Listing                  INITIALIZERANDOMNUMBERSTREAM_S
2021-06-01 08:56                                 random_numbers.F90

     60 ! ---------------------------------------------------------
     61   function initializeRandomNumberStream_V(seed) result(new)
     62     integer, dimension(:), intent( in) :: seed
     63     type(randomNumberStream)           :: new
     64 
     65     new%theNumbers = new_RandomNumberSequence(seed)
     66 
     67   end function initializeRandomNumberStream_V


ENTRY POINTS

  Name                                                             
                                                                   
 random_numbers_mod_mp_initializerandomnumberstream_v_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 INITIALIZERANDOMNUMBERSTRE                                                                                                         
 AM_V                       Func   61       RECORD          2500        scalar   PRIV                                               
 INITIALIZE_VECTOR          Func   65       RECORD          2500        scalar   PRIV             65                                
 NEW                        Local  63       RANDOMNUMBERSTREAM                                                                      
                                                            2500        scalar                    65                                
 SEED                       Dummy  61       I(4)            4     1     1        ARG,IN           65                                

Page 4           Source Listing                  INITIALIZERANDOMNUMBERSTREAM_V
2021-06-01 08:56                                 random_numbers.F90

     68 ! ---------------------------------------------------------
     69 ! Procedures for drawing random numbers
     70 ! ---------------------------------------------------------
     71   subroutine getRandomNumber_Scalar(stream, number)
     72     type(randomNumberStream), intent(inout) :: stream
     73     real,                     intent(  out) :: number
     74 
     75     number = getRandomReal(stream%theNumbers)
     76   end subroutine getRandomNumber_Scalar


ENTRY POINTS

  Name                                                     
                                                           
 random_numbers_mod_mp_getrandomnumber_scalar_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 GETRANDOMNUMBER_SCALAR     Subr   71                                            PRIV                                               
 GETRANDOMREAL              Func   75       R(8)            8           scalar   PRIV             29,75,86                          
 NUMBER                     Dummy  71       R(8)            8           scalar   ARG,OUT          75                                
 STREAM                     Dummy  71       RANDOMNUMBERSTREAM                                                                      
                                                            2500        scalar   ARG,INOUT        75                                

Page 5           Source Listing                  GETRANDOMNUMBER_SCALAR
2021-06-01 08:56                                 random_numbers.F90

     77 ! ---------------------------------------------------------
     78   subroutine getRandomNumber_1D(stream, numbers)
     79     type(randomNumberStream), intent(inout) :: stream
     80     real, dimension(:),       intent(  out) :: numbers
     81 
     82 ! Local variables
     83     integer :: i
     84 
     85     do i = 1, size(numbers)
     86       numbers(i) = getRandomReal(stream%theNumbers)
     87     end do
     88   end subroutine getRandomNumber_1D


ENTRY POINTS

  Name                                                 
                                                       
 random_numbers_mod_mp_getrandomnumber_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 GETRANDOMNUMBER_1D         Subr   78                                            PRIV             98                                
 I                          Local  83       I(4)            4           scalar                    85,86                             
 NUMBERS                    Dummy  78       R(8)            8     1     1        ARG,OUT          85,86                             
 SIZE                       Func   85                                   scalar                    85                                
 STREAM                     Dummy  78       RANDOMNUMBERSTREAM                                                                      
                                                            2500        scalar   ARG,INOUT        86                                

Page 6           Source Listing                  GETRANDOMNUMBER_1D
2021-06-01 08:56                                 random_numbers.F90

     89 ! ---------------------------------------------------------
     90   subroutine getRandomNumber_2D(stream, numbers)
     91     type(randomNumberStream), intent(inout) :: stream
     92     real, dimension(:, :),    intent(  out) :: numbers
     93 
     94 ! Local variables
     95     integer :: i
     96 
     97     do i = 1, size(numbers, 2)
     98       call getRandomNumber_1D(stream, numbers(:, i))
     99     end do
    100   end subroutine getRandomNumber_2D


ENTRY POINTS

  Name                                                 
                                                       
 random_numbers_mod_mp_getrandomnumber_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 GETRANDOMNUMBER_2D         Subr   90                                            PRIV                                               
 I                          Local  95       I(4)            4           scalar                    97,98                             
 NUMBERS                    Dummy  90       R(8)            8     2     1        ARG,OUT          97,98                             
 SIZE                       Func   97                                   scalar                    97                                
 STREAM                     Dummy  90       RANDOMNUMBERSTREAM                                                                      
                                                            2500        scalar   ARG,INOUT        98                                

Page 7           Source Listing                  GETRANDOMNUMBER_2D
2021-06-01 08:56                                 random_numbers.F90

    101 ! ---------------------------------------------------------
    102 ! Constructs a unique seed from grid cell index and model date/time
    103 !   The perm is supplied we generate a different seed by
    104 !   circularly shifting the bits of the seed - this is useful
    105 !   if we want to create more than one seed for a given
    106 !   column and model date/time.
    107 !   Note that abs(perm) must be <= the number of bits used
    108 !   to represent the default integer (likely 32)
    109 ! ---------------------------------------------------------
    110   function constructSeed(i, j, time, perm) result(seed)
    111     integer,           intent( in)  :: i, j
    112     type(time_type),   intent( in) :: time
    113     integer, optional, intent( in) :: perm
    114     integer, dimension(8) :: seed
    115 
    116 ! Local variables
    117     integer :: year, month, day, hour, minute, second
    118 
    119 
    120     call get_date(time, year, month, day, hour, minute, second)
    121     seed = (/ i, j, year, month, day, hour, minute, second /)
    122     if(present(perm)) seed = ishftc(seed, perm)
    123   end function constructSeed


ENTRY POINTS

  Name                                            
                                                  
 random_numbers_mod_mp_constructseed_             

Page 8           Source Listing                  CONSTRUCTSEED
2021-06-01 08:56 Symbol Table                    random_numbers.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CONSTRUCTSEED              Func   110      I(4)            4     1     8                                                           
 DAY                        Local  117      I(4)            4           scalar                    120,121                           
 GET_DATE                   Subr   120                                           PRIV             30,120                            
 HOUR                       Local  117      I(4)            4           scalar                    120,121                           
 I                          Dummy  110      I(4)            4           scalar   ARG,IN           121                               
 ISHFTC                     Func   122                                  scalar                    122                               
 J                          Dummy  110      I(4)            4           scalar   ARG,IN           121                               
 MINUTE                     Local  117      I(4)            4           scalar                    120,121                           
 MONTH                      Local  117      I(4)            4           scalar                    120,121                           
 PERM                       Dummy  110      I(4)            4           scalar   ARG,IN           122                               
 PRESENT                    Func   122                                  scalar                    122                               
 SECOND                     Local  117      I(4)            4           scalar                    120,121                           
 SEED                       Local  114      I(4)            4     1     8                         121,122                           
 TIME                       Dummy  110      TIME_TYPE       16          scalar   ARG,IN           120                               
 TIME_TYPE                  Type   112                                  scalar   PRIV             30,112                            
 YEAR                       Local  117      I(4)            4           scalar                    120,121                           

Page 9           Source Listing                  CONSTRUCTSEED
2021-06-01 08:56                                 random_numbers.F90

    124 end module random_numbers_mod


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 GETRANDOMNUMBERS           Local  38                                   scalar                    47                                
 INITIALIZERANDOMNUMBERSTRE                                                                                                         
 AM                         Local  42                                   scalar                    47                                
 MERSENNETWISTER_MOD        Module 28                                                             28                                
 RANDOMNUMBERSEQUENCE       Type   28                                   scalar                    28,35                             
 RANDOM_NUMBERS_MOD         Module 21                                                                                               
 TIME_MANAGER_MOD           Module 30                                                             30                                

Page 10          Source Listing                  CONSTRUCTSEED
2021-06-01 08:56 Subprograms/Common Blocks       random_numbers.F90



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CONSTRUCTSEED              Func   110      I(4)            4     1     8                                                           
 GETRANDOMNUMBER_1D         Subr   78                                            PRIV             98                                
 GETRANDOMNUMBER_2D         Subr   90                                            PRIV                                               
 GETRANDOMNUMBER_SCALAR     Subr   71                                            PRIV                                               
 INITIALIZERANDOMNUMBERSTRE                                                                                                         
 AM_S                       Func   53       RECORD          2500        scalar   PRIV                                               
 INITIALIZERANDOMNUMBERSTRE                                                                                                         
 AM_V                       Func   61       RECORD          2500        scalar   PRIV                                               
 RANDOM_NUMBERS_MOD         Module 21                                                                                               

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume cc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file
       -convert native                       -cross_reference

Page 11          Source Listing                  CONSTRUCTSEED
2021-06-01 08:56                                 random_numbers.F90

       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=0
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20191121       -D _OPENMP=201611
       -D __INTEL_OFFLOAD                    -D __MMX__
       -D __SSE__                            -D __SSE_MATH__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __pentium4                         -D __pentium4__
       -D __tune_pentium4__                  -D PACKAGE_NAME='"GFDL FMS Library"'
       -D PACKAGE_TARNAME='"FMS"'            -D PACKAGE_VERSION='"2021.02.0"'
       -D PACKAGE_STRING='"GFDL FMS Library 2021.02.0"'       -D PACKAGE_BUGREPORT='"gfdl.climate.model.info@noaa.gov"'
       -D PACKAGE_URL='"https://www.gfdl.noaa.gov/fms"'       -D PACKAGE='"FMS"'
       -D VERSION='"2021.02.0"'              -D STDC_HEADERS=1
       -D HAVE_SYS_TYPES_H=1                 -D HAVE_SYS_STAT_H=1
       -D HAVE_STDLIB_H=1                    -D HAVE_STRING_H=1
       -D HAVE_MEMORY_H=1                    -D HAVE_STRINGS_H=1
       -D HAVE_INTTYPES_H=1                  -D HAVE_STDINT_H=1
       -D HAVE_UNISTD_H=1                    -D HAVE_DLFCN_H=1
       -D LT_OBJDIR='".libs/"'               -D HAVE_MPI_H=1
       -D HAVE_NETCDF_H=1                    -D HAVE_SCHED_GETAFFINITY=1
       -D HAVE_MOD_MPI=1                     -D HAVE_MOD_NETCDF=1
       -D HAVE_CRAY_POINTER=1                -D HAVE_QUAD_PRECISION=1
       -D HAVE_INTERNAL_NML=1                -D use_netCDF=1
       -D use_libMPI=1                       -D INTERNAL_FILE_NML
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
  no   -fpconstant                           -fpe3
       -fprm nearest                         -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -fp_modbits nofp_contract
       -fp_modbits nono_fp_contract          -fp_modbits nofenv_access
       -fp_modbits nono_fenv_access          -fp_modbits nocx_limited_range
       -fp_modbits nono_cx_limited_range       -fp_modbits noprec_div
       -fp_modbits nono_prec_div             -fp_modbits noprec_sqrt
       -fp_modbits nono_prec_sqrt            -fp_modbits ftz
       -fp_modbits nono_ftz                  -fp_modbits nointrin_limited_range
       -fp_modbits nono_intrin_limited_range       -fp_modbits notrunc_compares
       -fp_modbits nono_trunc_compares       -fp_modbits noieee_nan_compares
       -fp_modbits nono_ieee_nan_compares       -fp_modbits honor_f32_conversion
       -fp_modbits nono_honor_f32_conversion       -fp_modbits honor_f64_conversion
       -fp_modbits nono_honor_f64_conversion       -fp_modbits nono_x87_copy
       -fp_modbits nono_no_x87_copy          -fp_modbits noexception_semantics
       -fp_modbits nono_exception_semantics       -fp_modbits noprecise_libm_functions
       -fp_modbits nono_precise_libm_functions       -heap_arrays 0
  no   -threadprivate_compat                 -free
       -g2                                   -iface nomixed_str_len_arg

Page 12          Source Listing                  CONSTRUCTSEED
2021-06-01 08:56                                 random_numbers.F90

       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity
       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
       -module ../.mods                      -names lowercase
  no   -noinclude                       no   -o
       -offload-build=host                   -openmp
       -openmp-simd                          -openmp-offload
       -O0                              no   -pad_source
       -real_size 64                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w noalignments                       -w nodeclarations
       -w noexternals                        -w nogeneral
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w nouncalled
       -w nouninitialized                    -w nounused
       -w nousage                       no   -wrap-margins

       -includepath : /opt/netcdf/4.6.1/INTEL/include/,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/,.f90,./.f90,./.f90,../include/.f90,
           ./.f90,/opt/netcdf/4.6.1/INTEL/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/ipp/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mkl/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/tbb/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/daal/include/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/intel64/.f90,/opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/icc/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/.f90,/usr/local/include/.f90,
           /usr/lib/gcc/x86_64-redhat-linux/4.8.5/include/.f90,/usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : random_numbers.lst
  no   -o

COMPILER: Intel(R) Fortran 19.1-1555
