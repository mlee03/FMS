Page 1           Source Listing                  GET_DOMAIN_DECOMPOSED_INDEX
2021-06-01 08:53                                 /tmp/ifortcZyU7O.i90

      1 # 1 "fms_netcdf_domain_io.F90"
      2 !***********************************************************************
      3 !*                   GNU Lesser General Public License
      4 !*
      5 !* This file is part of the GFDL Flexible Modeling System (FMS).
      6 !*
      7 !* FMS is free software: you can redistribute it and/or modify it under
      8 !* the terms of the GNU Lesser General Public License as published by
      9 !* the Free Software Foundation, either version 3 of the License, or (at
     10 !* your option) any later version.
     11 !*
     12 !* FMS is distributed in the hope that it will be useful, but WITHOUT
     13 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
     14 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
     15 !* for more details.
     16 !*
     17 !* You should have received a copy of the GNU Lesser General Public
     18 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
     19 !***********************************************************************
     20 
     21 !> @file
     22 
     23 !> @brief Domain-specific I/O wrappers.
     24 module fms_netcdf_domain_io_mod
     25 use, intrinsic :: iso_fortran_env
     26 use netcdf
     27 use mpp_mod
     28 use mpp_domains_mod
     29 use fms_io_utils_mod
     30 use netcdf_io_mod
     31 use platform_mod
     32 implicit none
     33 private
     34 
     35 
     36 !Module constants.
     37 integer, parameter :: no_domain_decomposed_dimension = 0
     38 integer, parameter, public :: max_num_domain_decomposed_dims = 10
     39 integer, parameter :: variable_not_found = 0
     40 integer, parameter :: default_domain_position = center
     41 character(len=16), parameter :: domain_pos_att = "domain_position"
     42 character(len=16), parameter :: domain_axis_att_name = "domain_axis"
     43 character(len=16), parameter :: x = "x"
     44 character(len=16), parameter :: y = "y"
     45 
     46 
     47 !> @brief Domain variable.
     48 type :: DomainDimension_t
     49   character(len=nf90_max_name) :: varname !< Variable name.
     50   integer :: pos !< Domain position.
     51 endtype DomainDimension_t
     52 
     53 
     54 !> @brief netcdf domain file type.
     55 type, extends(FmsNetcdfFile_t), public :: FmsNetcdfDomainFile_t
     56   type(domain2d) :: domain !< Two-dimensional domain.
     57   type(DomainDimension_t), dimension(:), allocatable :: xdims !< Dimensions associated

Page 2           Source Listing                  GET_DOMAIN_DECOMPOSED_INDEX
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

     58 !! with the "x" axis
     59 !! of a 2d domain.
     60   integer :: nx !< Number of "x" dimensions.
     61   type(DomainDimension_t), dimension(:), allocatable :: ydims !< Dimensions associated
     62 !! with the "y" axis
     63 !! of a 2d domain.
     64   integer :: ny !< Number of "y" dimensions.
     65   character(len=256) :: non_mangled_path !< Non-domain-mangled file path.
     66   logical :: adjust_indices !< Flag telling if indices need to be adjusted
     67 !! for domain-decomposed read.
     68 endtype FmsNetcdfDomainFile_t
     69 
     70 
     71 public :: open_domain_file
     72 public :: close_domain_file
     73 public :: register_domain_decomposed_dimension
     74 public :: register_domain_variable
     75 public :: register_domain_restart_variable_0d
     76 public :: register_domain_restart_variable_1d
     77 public :: register_domain_restart_variable_2d
     78 public :: register_domain_restart_variable_3d
     79 public :: register_domain_restart_variable_4d
     80 public :: register_domain_restart_variable_5d
     81 public :: domain_read_0d
     82 public :: domain_read_1d
     83 public :: domain_read_2d
     84 public :: domain_read_3d
     85 public :: domain_read_4d
     86 public :: domain_read_5d
     87 public :: domain_write_0d
     88 public :: domain_write_1d
     89 public :: domain_write_2d
     90 public :: domain_write_3d
     91 public :: domain_write_4d
     92 public :: domain_write_5d
     93 public :: save_domain_restart
     94 public :: restore_domain_state
     95 public :: get_compute_domain_dimension_indices
     96 public :: get_global_io_domain_indices
     97 public :: is_dimension_registered
     98 public :: get_mosaic_tile_grid
     99 
    100 interface compute_global_checksum
    101   module procedure compute_global_checksum_2d
    102   module procedure compute_global_checksum_3d
    103   module procedure compute_global_checksum_4d
    104 end interface compute_global_checksum
    105 
    106 
    107 contains
    108 
    109 
    110 !> @brief Get the index of a domain decomposed dimension.
    111 !! @return Index of domain decomposed dimension.
    112 function get_domain_decomposed_index(name_, array, size_) &
    113   result(index_)
    114 

Page 3           Source Listing                  GET_DOMAIN_DECOMPOSED_INDEX
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    115   character(len=*), intent(in) :: name_ !< Name.
    116   type(DomainDimension_t), dimension(:), intent(in) :: array !< Array to search through.
    117   integer, intent(in) :: size_ !< Number of spots to look in.
    118   integer :: index_
    119 
    120   integer :: i
    121 
    122   index_ = variable_not_found
    123   do i = 1, size_
    124     if (string_compare(array(i)%varname, name_)) then
    125       index_ = i
    126       return
    127     endif
    128   enddo
    129 end function get_domain_decomposed_index


ENTRY POINTS

  Name                                                                
                                                                      
 fms_netcdf_domain_io_mod_mp_get_domain_decomposed_index_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ARRAY                      Dummy  112      RECORD          260   1     1        ARG,IN           124                               
 DOMAINDIMENSION_T          Type   116                      260         scalar   PRIV             51,57,61,116,137,162,195          
 GET_DOMAIN_DECOMPOSED_INDE                                                                                                         
 X                          Func   112      I(4)            4           scalar                    166,215,309,313,507,515,697,702,80
                                                                                                  3,808                             
 I                          Local  120      I(4)            4           scalar                    123,124,125                       
 INDEX_                     Local  118      I(4)            4           scalar                    122,125                           
 NAME_                      Dummy  112      CHAR                        scalar   ARG,IN           124                               
 SIZE_                      Dummy  112      I(4)            4           scalar   ARG,IN           123                               
 STRING_COMPARE             Func   124      L(4)            4           scalar   PRIV             124,143,205,208,387,389,417,458,46
                                                                                                  4,646,659,672                     
 VARIABLE_NOT_FOUND         Param  122      I(4)            4           scalar                    122,167,215,310,314,508,516,698,70
                                                                                                  3,804,809                         


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 DOMAINDIMENSION_T.VARNAME  CHAR            256   0              scalar                    124,143,151                        

Page 4           Source Listing                  GET_DOMAIN_DECOMPOSED_INDEX
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    130 
    131 
    132 !> @brief Add a domain decomposed dimension to an array.
    133 subroutine append_domain_decomposed_dimension(name_, position_, array, size_)
    134 
    135   character(len=*), intent(in) :: name_ !< Variable name.
    136   integer, intent(in) :: position_ !< Domain position.
    137   type(DomainDimension_t), dimension(:), intent(inout) :: array !< Array to search through.
    138   integer, intent(inout) :: size_ !< Number of spots to look in.
    139 
    140   integer :: i
    141 
    142   do i = 1, size_
    143     if (string_compare(array(i)%varname, name_)) then
    144       call error("variable "//trim(name_)//" already registered.")
    145     endif
    146   enddo
    147   size_ = size_ + 1
    148   if (size_ .gt. size(array)) then
    149     call error("number of domain decomposed variables exceeds limit.")
    150   endif
    151   call string_copy(array(size_)%varname, name_)
    152   array(size_)%pos = position_
    153 end subroutine append_domain_decomposed_dimension


ENTRY POINTS

  Name                                                                       
                                                                             
 fms_netcdf_domain_io_mod_mp_append_domain_decomposed_dimension_             

Page 5           Source Listing                  APPEND_DOMAIN_DECOMPOSED_DIMENSION
2021-06-01 08:53 Symbol Table                    fms_netcdf_domain_io.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 APPEND_DOMAIN_DECOMPOSED_D                                                                                                         
 IMENSION                   Subr   133                                                            463,469                           
 ARRAY                      Dummy  133      RECORD          260   1     1        ARG,INOUT        143,148,151,152                   
 ERROR                      Subr   144                                           PRIV             144,149,212,369,393,460,466,471,47
                                                                                                  6,560,607,628,647,660,673,677,707,
                                                                                                  782,813,821,1227,1263,1445,1481,16
                                                                                                  63,1699,1883,1919,2122,2285,2416,2
                                                                                                  579,2710,2873,3004,3167,3299,3413,
                                                                                                  3528                              
 I                          Local  140      I(4)            4           scalar                    142,143                           
 NAME_                      Dummy  133      CHAR                        scalar   ARG,IN           143,144,151                       
 POSITION_                  Dummy  133      I(4)            4           scalar   ARG,IN           152                               
 SIZE                       Func   148                                  scalar                    148                               
 SIZE_                      Dummy  133      I(4)            4           scalar   ARG,INOUT        142,147,148,151,152               
 STRING_COPY                Subr   151                                           PRIV             151,363,375,409,415               
 TRIM                       Func   144                                  scalar                    144                               


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 DOMAINDIMENSION_T.POS      I(4)            4     256            scalar                    152,168,509,517,699,704,805,810    

Page 6           Source Listing                  APPEND_DOMAIN_DECOMPOSED_DIMENSION
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    154 
    155 
    156 !> @brief Given a domain decomposed dimension, get its domain position.
    157 !! @return Position of the domain decomposed variable.
    158 function get_domain_position(name_, array, size_) &
    159   result(dpos)
    160 
    161   character(len=*), intent(in) :: name_ !< Variable name.
    162   type(DomainDimension_t), dimension(:), intent(in) :: array !< Array to search through.
    163   integer, intent(in) :: size_
    164   integer :: dpos
    165 
    166   dpos = get_domain_decomposed_index(name_, array, size_)
    167   if (dpos .ne. variable_not_found) then
    168     dpos = array(dpos)%pos
    169   endif
    170 end function get_domain_position


ENTRY POINTS

  Name                                                        
                                                              
 fms_netcdf_domain_io_mod_mp_get_domain_position_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ARRAY                      Dummy  158      RECORD          260   1     1        ARG,IN           166,168                           
 DPOS                       Local  164      I(4)            4           scalar                    166,167,168                       
 GET_DOMAIN_POSITION        Func   158      I(4)            4           scalar                    275,278                           
 NAME_                      Dummy  158      CHAR                        scalar   ARG,IN           166                               
 SIZE_                      Dummy  158      I(4)            4           scalar   ARG,IN           166                               

Page 7           Source Listing                  GET_DOMAIN_POSITION
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    171 
    172 
    173 !> @brief Given a variable, get the index of the "x" or "y" domain decomposed
    174 !!        dimension.
    175 !! @return Index of the domain decomposed dimension or else
    176 !!         no_domain_decomposed_dimension.
    177 function get_domain_decomposed_dimension_index(fileobj, variable_name, &
    178                                                xory, broadcast) &
    179   result(index_)
    180 
    181   type(FmsNetcdfDomainFile_t), intent(in), target :: fileobj !< File object.
    182   character(len=*), intent(in) :: variable_name !< Variable name.
    183   character(len=*), intent(in) :: xory !< String telling which dimension to
    184 !! look for.  Valid values are "x"
    185 !! or "y".
    186   logical, intent(in), optional :: broadcast !< Flag controlling whether or
    187 !! not the index will be
    188 !! broadcast to non "I/O root"
    189 !! ranks.  The broadcast will
    190 !! be done by default.
    191   integer :: index_
    192 
    193   integer :: ndims
    194   character(len=nf90_max_name), dimension(:), allocatable :: dim_names
    195   type(DomainDimension_t), dimension(:), pointer :: p
    196   integer :: n
    197   integer :: i
    198 
    199   index_ = no_domain_decomposed_dimension
    200   if (fileobj%is_root) then
    201     ndims = get_variable_num_dimensions(fileobj, variable_name, broadcast=.false.)
    202     allocate(dim_names(ndims))
    203     dim_names(:) = ""
    204     call get_variable_dimension_names(fileobj, variable_name, dim_names, broadcast=.false.)
    205     if (string_compare(xory, x, .true.)) then
    206       p => fileobj%xdims
    207       n = fileobj%nx
    208     elseif (string_compare(xory, y, .true.)) then
    209       p => fileobj%ydims
    210       n = fileobj%ny
    211     else
    212       call error("unrecognized xory flag value.")
    213     endif
    214     do i = 1, size(dim_names)
    215       if (get_domain_decomposed_index(dim_names(i), p, n) .ne. variable_not_found) then
    216         index_ = i
    217         exit
    218       endif
    219     enddo
    220     deallocate(dim_names)
    221   endif
    222   if (present(broadcast)) then
    223     if (.not. broadcast) then
    224       return
    225     endif
    226   endif
    227   call mpp_broadcast(index_, fileobj%io_root, pelist=fileobj%pelist)

Page 8           Source Listing                  GET_DOMAIN_DECOMPOSED_DIMENSION_INDEX
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    228 end function get_domain_decomposed_dimension_index


ENTRY POINTS

  Name                                                                          
                                                                                
 fms_netcdf_domain_io_mod_mp_get_domain_decomposed_dimension_index_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BROADCAST                  Dummy  178      L(4)            4           scalar   ARG,IN           222,223                           
 DIM_NAMES                  Local  194      CHAR            256   1     1        ALC              202,203,204,214,215,220           
 FILEOBJ                    Dummy  177      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,TGT,IN       200,201,204,206,207,209,210,227   
 FMSNETCDFDOMAINFILE_T      Type   181                      2040        scalar                    68,181,237,297,325,352,427,440,490
                                                                                                  ,530,552,619,686,792,887,902,920,9
                                                                                                  35,950,965,1001,1028,1059,1277,149
                                                                                                  5,1713,1949,1974,2004,2298,2592,28
                                                                                                  86,3196,3311,3425                 
 GET_DOMAIN_DECOMPOSED_DIME                                                                                                         
 NSION_INDEX                Func   177      I(4)            4           scalar                    256,260                           
 GET_VARIABLE_DIMENSION_NAM                                                                                                         
 ES                         Subr   204                                           PRIV             204,273                           
 GET_VARIABLE_NUM_DIMENSION                                                                                                         
 S                          Func   201      I(4)            4           scalar   PRIV             201,270                           
 I                          Local  197      I(4)            4           scalar                    214,215,216                       
 INDEX_                     Local  191      I(4)            4           scalar                    199,216,227                       
 MPP_BROADCAST              Local  227                                  scalar   PRIV             227                               
 MPP_BROADCAST_INT4_SCALAR  Subr   227                                           PRIV             227                               
 N                          Local  196      I(4)            4           scalar                    207,210,215                       
 NDIMS                      Local  193      I(4)            4           scalar                    201,202                           
 NF90_MAX_NAME              Param  194      I(4)            4           scalar   PRIV             49,194,254,305                    
 NO_DOMAIN_DECOMPOSED_DIMEN                                                                                                         
 SION                       Param  199      I(4)            4           scalar                    199,264,265                       
 P                          Local  195      RECORD          260   1     1        PTR              206,209,215                       
 PRESENT                    Func   222                                  scalar                    222                               
 SIZE                       Func   214                                  scalar                    214                               
 VARIABLE_NAME              Dummy  177      CHAR                        scalar   ARG,IN           201,204                           
 X                          Param  205      CHAR            16          scalar                    205,256,458                       
 XORY                       Dummy  178      CHAR                        scalar   ARG,IN           205,208                           
 Y                          Param  208      CHAR            16          scalar                    208,260,464                       


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 FMSNETCDFDOMAINFILE_T.NX   I(4)            4     1696           scalar                    207,275,309,412,431,463,507,697,80 
                                                                                           3                                  
 FMSNETCDFDOMAINFILE_T.NY   I(4)            4     1776           scalar                    210,278,313,414,433,469,515,702,80 
                                                                                           8                                  
 FMSNETCDFDOMAINFILE_T.XDIMS                                                                                               ...
                            RECORD          260   1624     1     1        ALC              206,275,309,411,430,463,507,509,69 

Page 9           Source Listing                  GET_DOMAIN_DECOMPOSED_DIMENSION_INDEX
2021-06-01 08:53 Symbol Table                    fms_netcdf_domain_io.F90

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
                                                                                           7,699,803,805                      
 FMSNETCDFDOMAINFILE_T.YDIMS                                                                                               ...
                            RECORD          260   1704     1     1        ALC              209,278,313,413,432,469,515,517,70 
                                                                                           2,704,808,810                      
 FMSNETCDFFILE_T.IO_ROOT    I(4)            4     592            scalar                    227,1244,1249,1254,1259,1462,1467, 
                                                                                           1472,1477,1680,1685,1690,1695,1900 
                                                                                           ,1905,1910,1915,2263,2269,2275,228 
                                                                                           1,2557,2563,2569,2575,2851,2857,28 
                                                                                           63,2869,3145,3151,3157,3163        
 FMSNETCDFFILE_T.IS_ROOT    L(4)            4     596            scalar                    200,1115,1333,1551,1769,2073,2367, 
                                                                                           2661,2955                          
 FMSNETCDFFILE_T.PELIST     I(4)            4     520      1     1        ALC              227,1116,1117,1118,1119,1124,1153, 
                                                                                           1176,1199,1222,1334,1335,1336,1337 
                                                                                           ,1342,1371,1394,1417,1440,1552,155 
                                                                                           3,1554,1555,1560,1589,1612,1635,16 
                                                                                           58,1770,1771,1772,1773,1778,1809,1 
                                                                                           832,1855,1878,2074,2075,2076,2079, 
                                                                                           2080,2081,2125,2150,2173,2196,2219 
                                                                                           ,2368,2369,2370,2373,2374,2375,241 
                                                                                           9,2444,2467,2490,2513,2662,2663,26 
                                                                                           64,2667,2668,2669,2713,2738,2761,2 
                                                                                           784,2807,2956,2957,2958,2961,2962, 
                                                                                           2963,3007,3032,3055,3078,3101      

Page 10          Source Listing                  GET_DOMAIN_DECOMPOSED_DIMENSION_INDEX
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    229 
    230 
    231 !> @brief Determine if a variable is "domain decomposed."
    232 !! @return Flag telling if the variable is "domain decomposed."
    233 function is_variable_domain_decomposed(fileobj, variable_name, broadcast, &
    234                                        xindex, yindex, xpos, ypos) &
    235   result(is_decomposed)
    236 
    237   type(FmsNetcdfDomainFile_t), intent(in) :: fileobj !< File object.
    238   character(len=*), intent(in) :: variable_name !< Variable name.
    239   logical, intent(in), optional :: broadcast !< Flag controlling whether or
    240 !! not the index will be
    241 !! broadcast to non "I/O root"
    242 !! ranks.  The broadcast will
    243 !! be done by default.
    244   integer, intent(out), optional :: xindex !< The index of the domain
    245 !! x dimension.
    246   integer, intent(out), optional :: yindex !< The index of the domain
    247 !! y dimension.
    248   integer, intent(out), optional :: xpos !< Domain position of the x dimension.
    249   integer, intent(out), optional :: ypos !< Domain position of the y dimension.
    250   logical :: is_decomposed
    251 
    252   integer, dimension(2) :: indices
    253   integer :: ndims
    254   character(len=nf90_max_name), dimension(:), allocatable :: dim_names
    255 
    256   indices(1) = get_domain_decomposed_dimension_index(fileobj, variable_name, x, broadcast)
    257   if (present(xindex)) then
    258     xindex = indices(1)
    259   endif
    260   indices(2) = get_domain_decomposed_dimension_index(fileobj, variable_name, y, broadcast)
    261   if (present(yindex)) then
    262     yindex = indices(2)
    263   endif
    264   is_decomposed = (indices(1) .ne. no_domain_decomposed_dimension) .and. &
    265                   (indices(2) .ne. no_domain_decomposed_dimension)
    266   if (is_decomposed) then
    267     if (.not. present(xpos) .and. .not. present(ypos)) then
    268       return
    269     endif
    270     ndims = get_variable_num_dimensions(fileobj, variable_name, broadcast)
    271     allocate(dim_names(ndims))
    272     dim_names(:) = ""
    273     call get_variable_dimension_names(fileobj, variable_name, dim_names, broadcast)
    274     if (present(xpos)) then
    275       xpos = get_domain_position(dim_names(indices(1)), fileobj%xdims, fileobj%nx)
    276     endif
    277     if (present(ypos)) then
    278       ypos = get_domain_position(dim_names(indices(2)), fileobj%ydims, fileobj%ny)
    279     endif
    280     deallocate(dim_names)
    281   else
    282     if (present(xpos)) then
    283       xpos = -1
    284     endif
    285     if (present(ypos)) then

Page 11          Source Listing                  IS_VARIABLE_DOMAIN_DECOMPOSED
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    286       ypos = -1
    287     endif
    288   endif
    289 end function is_variable_domain_decomposed


ENTRY POINTS

  Name                                                                  
                                                                        
 fms_netcdf_domain_io_mod_mp_is_variable_domain_decomposed_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BROADCAST                  Dummy  233      L(4)            4           scalar   ARG,IN           256,260,270,273                   
 DIM_NAMES                  Local  254      CHAR            256   1     1        ALC              271,272,273,275,278,280           
 FILEOBJ                    Dummy  233      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           256,260,270,273,275,278           
 INDICES                    Local  252      I(4)            4     1     2                         256,258,260,262,264,265,275,278   
 IS_DECOMPOSED              Local  250      L(4)            4           scalar                    264,266                           
 IS_VARIABLE_DOMAIN_DECOMPO                                                                                                         
 SED                        Func   233      L(4)            4           scalar                    1101,1319,1537,1755,2058,2352,2646
                                                                                                  ,2940,3228,3343,3457              
 NDIMS                      Local  253      I(4)            4           scalar                    270,271                           
 PRESENT                    Func   257                                  scalar                    257,261,267,274,277,282,285       
 VARIABLE_NAME              Dummy  233      CHAR                        scalar   ARG,IN           256,260,270,273                   
 XINDEX                     Dummy  234      I(4)            4           scalar   ARG,OUT          257,258                           
 XPOS                       Dummy  234      I(4)            4           scalar   ARG,OUT          267,274,275,282,283               
 YINDEX                     Dummy  234      I(4)            4           scalar   ARG,OUT          261,262                           
 YPOS                       Dummy  234      I(4)            4           scalar   ARG,OUT          267,277,278,285,286               

Page 12          Source Listing                  IS_VARIABLE_DOMAIN_DECOMPOSED
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    290 
    291 
    292 !> @brief Determine whether a domain-decomposed dimension has been registered to the file object
    293 !! @return Flag telling if the dimension is registered to the file object
    294 function is_dimension_registered(fileobj, dimension_name) &
    295   result(is_registered)
    296 
    297   type(FmsNetcdfDomainFile_t), intent(in) :: fileobj !< File object.
    298   character(len=*), intent(in) :: dimension_name !< Dimension name.
    299 
    300 ! local
    301   logical :: is_registered
    302 
    303   integer :: dpos
    304   integer :: ndims
    305   character(len=nf90_max_name), dimension(:), allocatable :: dim_names
    306 
    307   dpos = 0
    308   is_registered = .false.
    309   dpos = get_domain_decomposed_index(dimension_name, fileobj%xdims, fileobj%nx)
    310   if (dpos .ne. variable_not_found) then
    311     is_registered = .true.
    312   else
    313     dpos = get_domain_decomposed_index(dimension_name, fileobj%ydims, fileobj%ny)
    314     if (dpos .ne. variable_not_found) is_registered = .true.
    315   endif
    316 
    317 end function is_dimension_registered

Page 13          Source Listing                  IS_DIMENSION_REGISTERED
2021-06-01 08:53 Entry Points                    fms_netcdf_domain_io.F90



ENTRY POINTS

  Name                                                            
                                                                  
 fms_netcdf_domain_io_mod_mp_is_dimension_registered_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DIMENSION_NAME             Dummy  294      CHAR                        scalar   ARG,IN           309,313                           
 DIM_NAMES                  Local  305      CHAR            256   1     1        ALC                                                
 DPOS                       Local  303      I(4)            4           scalar                    307,309,310,313,314               
 FILEOBJ                    Dummy  294      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           309,313                           
 IS_DIMENSION_REGISTERED    Func   294      L(4)            4           scalar                                                      
 IS_REGISTERED              Local  301      L(4)            4           scalar                    308,311,314                       
 NDIMS                      Local  304      I(4)            4           scalar                                                      

Page 14          Source Listing                  IS_DIMENSION_REGISTERED
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    318 
    319 
    320 !> @brief Open a domain netcdf file.
    321 !! @return Flag telling if the open completed successfully.
    322 function open_domain_file(fileobj, path, mode, domain, nc_format, is_restart, dont_add_res_to_filename) &
    323   result(success)
    324 
    325   type(FmsNetcdfDomainFile_t),intent(inout) :: fileobj !< File object.
    326   character(len=*), intent(in) :: path !< File path.
    327   character(len=*), intent(in) :: mode !< File mode.  Allowed values
    328 !! are "read", "append", "write", or
    329 !! "overwrite".
    330   type(domain2d), intent(in) :: domain !< Two-dimensional domain.
    331   character(len=*), intent(in), optional :: nc_format !< Netcdf format that
    332 !! new files are written
    333 !! as.  Allowed values
    334 !! are: "64bit", "classic",
    335 !! or "netcdf4". Defaults to
    336 !! "64bit".
    337   logical, intent(in), optional :: is_restart !< Flag telling if this file
    338 !! is a restart file.  Defaults
    339 !! to false.
    340   logical, intent(in), optional :: dont_add_res_to_filename !< Flag indicating not to add
    341 !! ".res" to the filename
    342   logical :: success
    343 
    344   integer, dimension(2) :: io_layout
    345   integer, dimension(1) :: tile_id
    346   character(len=256) :: combined_filepath
    347   type(domain2d), pointer :: io_domain
    348   character(len=256) :: distributed_filepath
    349   integer :: pelist_size
    350   integer, dimension(:), allocatable :: pelist
    351   logical :: success2
    352   type(FmsNetcdfDomainFile_t) :: fileobj2
    353 
    354 !Get the path of a "combined" file.
    355   io_layout = mpp_get_io_domain_layout(domain)
    356   tile_id = mpp_get_tile_id(domain)
    357 
    358 !< If the number of tiles is greater than 1 or if the current tile is greater
    359 !than 1 add .tileX. to the filename
    360   if (mpp_get_ntile_count(domain) .gt. 1 .or. tile_id(1) > 1) then
    361     call domain_tile_filepath_mangle(combined_filepath, path, tile_id(1))
    362   else
    363     call string_copy(combined_filepath, path)
    364   endif
    365 
    366 !Get the path of a "distributed" file.
    367   io_domain => mpp_get_io_domain(domain)
    368   if (.not. associated(io_domain)) then
    369     call error("input domain does not have an io_domain.")
    370   endif
    371   if (io_layout(1)*io_layout(2) .gt. 1) then
    372     tile_id = mpp_get_tile_id(io_domain)
    373     call io_domain_tile_filepath_mangle(distributed_filepath, combined_filepath, tile_id(1))
    374   else

Page 15          Source Listing                  OPEN_DOMAIN_FILE
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    375     call string_copy(distributed_filepath, combined_filepath)
    376   endif
    377 
    378 !Make sure the input domain has an I/O domain and get its pelist.
    379   pelist_size = mpp_get_domain_npes(io_domain)
    380   allocate(pelist(pelist_size))
    381   call mpp_get_pelist(io_domain, pelist)
    382   fileobj%adjust_indices = .true. !Set the default to true
    383 
    384 !Open the distibuted files.
    385   success = netcdf_file_open(fileobj, distributed_filepath, mode, nc_format, pelist, &
    386                              is_restart, dont_add_res_to_filename)
    387   if (string_compare(mode, "read", .true.) .or. string_compare(mode, "append", .true.)) then
    388     if (success) then
    389       if (.not. string_compare(distributed_filepath, combined_filepath)) then
    390         success2 = netcdf_file_open(fileobj2, combined_filepath, mode, nc_format, pelist, &
    391                                     is_restart, dont_add_res_to_filename)
    392         if (success2) then
    393           call error("you have both combined and distributed files.")
    394         endif
    395       endif
    396     else
    397       success = netcdf_file_open(fileobj, combined_filepath, mode, nc_format, pelist, &
    398                                  is_restart, dont_add_res_to_filename)
    399 !If the file is combined and the layout is not (1,1) set the adjust_indices flag to false
    400       if (success .and. (io_layout(1)*io_layout(2) .gt. 1)) fileobj%adjust_indices = .false.
    401     endif
    402   endif
    403   if (.not. success) then
    404     deallocate(pelist)
    405     return
    406   endif
    407 
    408 !Store/initialize necessary properties.
    409   call string_copy(fileobj%non_mangled_path, path)
    410   fileobj%domain = domain
    411   allocate(fileobj%xdims(max_num_domain_decomposed_dims))
    412   fileobj%nx = 0
    413   allocate(fileobj%ydims(max_num_domain_decomposed_dims))
    414   fileobj%ny = 0
    415   call string_copy(fileobj%non_mangled_path, path)
    416 
    417   if (string_compare(mode, "write", .true.) .or. string_compare(mode, "overwrite", .true.)) then
    418 !Add global attribute needed by mppnccombine.
    419     call register_global_attribute(fileobj, "NumFilesInSet", io_layout(1)*io_layout(2))
    420   endif
    421 end function open_domain_file

Page 16          Source Listing                  OPEN_DOMAIN_FILE
2021-06-01 08:53 Entry Points                    fms_netcdf_domain_io.F90



ENTRY POINTS

  Name                                                     
                                                           
 fms_netcdf_domain_io_mod_mp_open_domain_file_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ASSOCIATED                 Func   368                                  scalar                    368                               
 COMBINED_FILEPATH          Local  346      CHAR            256         scalar                    361,363,373,375,389,390,397       
 DISTRIBUTED_FILEPATH       Local  348      CHAR            256         scalar                    373,375,385,389                   
 DOMAIN                     Dummy  322      DOMAIN2D        752         scalar   ARG,IN           355,356,360,367,410               
 DOMAIN2D                   Type   330                                  scalar                    56,330,347,449,493,690,729,748,798
                                                                                                  ,839,1077,1295,1513,1731,2032,2326
                                                                                                  ,2620,2914,3204,3319,3433         
 DOMAIN_TILE_FILEPATH_MANGL                                                                                                         
 E                          Subr   361                                           PRIV             361                               
 DONT_ADD_RES_TO_FILENAME   Dummy  322      L(4)            4           scalar   ARG,IN           386,391,398                       
 FILEOBJ                    Dummy  322      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        382,385,397,400,409,410,411,412,41
                                                                                                  3,414,415,419                     
 FILEOBJ2                   Local  352      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar                    390                               
 IO_DOMAIN                  Local  347      DOMAIN2D        752         scalar   PTR              367,368,372,379,381               
 IO_DOMAIN_TILE_FILEPATH_MA                                                                                                         
 NGLE                       Subr   373                                           PRIV             373                               
 IO_LAYOUT                  Local  344      I(4)            4     1     2                         355,371,400,419                   
 IS_RESTART                 Dummy  322      L(4)            4           scalar   ARG,IN           386,391,398                       
 MAX_NUM_DOMAIN_DECOMPOSED_                                                                                                         
 DIMS                       Param  411      I(4)            4           scalar                    38,411,413                        
 MODE                       Dummy  322      CHAR                        scalar   ARG,IN           385,387,390,397,417               
 MPP_GET_DOMAIN_NPES        Func   379      I(4)            4           scalar   PRIV             379                               
 MPP_GET_IO_DOMAIN          Func   367      RECORD          752         scalar   PTR,PRIV         367,457,506,696,750,802,1108,1326,
                                                                                                  1544,1762,2065,2359,2653,2947,3235
                                                                                                  ,3350,3464                        
 MPP_GET_IO_DOMAIN_LAYOUT   Func   355      I(4)            4     1     2        PRIV             355,503                           
 MPP_GET_NTILE_COUNT        Func   360      I(4)            4           scalar   PRIV             360                               
 MPP_GET_PELIST             Local  381                                  scalar   PRIV             381                               
 MPP_GET_PELIST2D           Subr   381                                           PRIV             381                               
 MPP_GET_TILE_ID            Func   356      I(4)            4     1     0        PRIV             356,372,853                       
 NC_FORMAT                  Dummy  322      CHAR                        scalar   ARG,IN           385,390,397                       
 NETCDF_FILE_OPEN           Func   385      L(4)            4           scalar   PRIV             385,390,397,855                   
 OPEN_DOMAIN_FILE           Func   322      L(4)            4           scalar                                                      
 PATH                       Dummy  322      CHAR                        scalar   ARG,IN           361,363,409,415                   
 PELIST                     Local  350      I(4)            4     1     1        ALC              380,381,385,390,397,404           
 PELIST_SIZE                Local  349      I(4)            4           scalar                    379,380                           
 REGISTER_GLOBAL_ATTRIBUTE  Local  419                                  scalar   PRIV             419                               
 REGISTER_GLOBAL_ATTRIBUTE_                                                                                                         
 0D                         Subr   419                                           PRIV             419                               
 SUCCESS                    Local  342      L(4)            4           scalar                    385,388,397,400,403               
 SUCCESS2                   Local  351      L(4)            4           scalar                    390,392                           
 TILE_ID                    Local  345      I(4)            4     1     1                         356,360,361,372,373               

Page 17          Source Listing                  OPEN_DOMAIN_FILE
2021-06-01 08:53 Symbol Table                    fms_netcdf_domain_io.F90



TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 FMSNETCDFDOMAINFILE_T.ADJUST_INDICES                                                                                      ...
                            L(4)            4     2036           scalar                    382,400,1127,1345,1563,1782        
 FMSNETCDFDOMAINFILE_T.DOMAIN                                                                                              ...
                            DOMAIN2D        752   872            scalar                    410,454,457,503,506,510,518,696,80 
                                                                                           2,1108,1109,1326,1327,1544,1545,17 
                                                                                           62,1763,2065,2066,2359,2360,2653,2 
                                                                                           654,2947,2948,3235,3236,3350,3351, 
                                                                                           3464,3465                          
 FMSNETCDFDOMAINFILE_T.NON_MANGLED_PATH                                                                                    ...
                            CHAR            256   1780           scalar                    409,415                            

Page 18          Source Listing                  OPEN_DOMAIN_FILE
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    422 
    423 
    424 !> @brief Close a domain netcdf file.
    425 subroutine close_domain_file(fileobj)
    426 
    427   type(FmsNetcdfDomainFile_t), intent(inout) :: fileobj !< File object.
    428 
    429   call netcdf_file_close(fileobj)
    430   deallocate(fileobj%xdims)
    431   fileobj%nx = 0
    432   deallocate(fileobj%ydims)
    433   fileobj%ny = 0
    434 end subroutine close_domain_file


ENTRY POINTS

  Name                                                      
                                                            
 fms_netcdf_domain_io_mod_mp_close_domain_file_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CLOSE_DOMAIN_FILE          Subr   425                                                                                              
 FILEOBJ                    Dummy  425      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        429,430,431,432,433               
 NETCDF_FILE_CLOSE          Subr   429                                           PRIV             429,858                           

Page 19          Source Listing                  CLOSE_DOMAIN_FILE
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    435 
    436 
    437 !> @brief Add a dimension to a file associated with a two-dimensional domain.
    438 subroutine register_domain_decomposed_dimension(fileobj, dim_name, xory, domain_position)
    439 
    440   type(FmsNetcdfDomainFile_t), intent(inout) :: fileobj !< File object.
    441   character(len=*), intent(in) :: dim_name !< Dimension name.
    442   character(len=*), intent(in) :: xory !< Flag telling if the dimension
    443 !! is associated with the "x" or "y"
    444 !! axis of the 2d domain.  Allowed
    445 !! values are "x" or "y".
    446   integer, intent(in), optional :: domain_position !< Domain position.
    447 
    448   integer :: dpos
    449   type(domain2d), pointer :: io_domain
    450   integer :: domain_size
    451   integer :: dim_size
    452 
    453   dpos = default_domain_position
    454   if (mpp_domain_is_symmetry(fileobj%domain) .and. present(domain_position)) then
    455     dpos = domain_position
    456   endif
    457   io_domain => mpp_get_io_domain(fileobj%domain)
    458   if (string_compare(xory, x, .true.)) then
    459     if (dpos .ne. center .and. dpos .ne. east) then
    460       call error("only center or east supported for x dimensions.")
    461     endif
    462     call mpp_get_global_domain(io_domain, xsize=domain_size, position=dpos)
    463     call append_domain_decomposed_dimension(dim_name, dpos, fileobj%xdims, fileobj%nx)
    464   elseif (string_compare(xory, y, .true.)) then
    465     if (dpos .ne. center .and. dpos .ne. north) then
    466       call error("only center or north supported for y dimensions.")
    467     endif
    468     call mpp_get_global_domain(io_domain, ysize=domain_size, position=dpos)
    469     call append_domain_decomposed_dimension(dim_name, dpos, fileobj%ydims, fileobj%ny)
    470   else
    471     call error("unrecognized xory flag value.")
    472   endif
    473   if (fileobj%is_readonly .or. (fileobj%mode_is_append .and. dimension_exists(fileobj, dim_name))) then
    474     call get_dimension_size(fileobj, dim_name, dim_size, broadcast=.true.)
    475     if (dim_size .lt. domain_size) then
    476       call error("dimension "//trim(dim_name)//" is smaller than the size of" &
    477                  //" the associated domain "//trim(xory)//" axis.")
    478     endif
    479   else
    480     call netcdf_add_dimension(fileobj, dim_name, domain_size, is_compressed=.false.)
    481   endif
    482 end subroutine register_domain_decomposed_dimension

Page 20          Source Listing                  REGISTER_DOMAIN_DECOMPOSED_DIMENSION
2021-06-01 08:53 Entry Points                    fms_netcdf_domain_io.F90



ENTRY POINTS

  Name                                                                         
                                                                               
 fms_netcdf_domain_io_mod_mp_register_domain_decomposed_dimension_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CENTER                     Param  459      I(4)            4           scalar   PRIV             40,459,465                        
 DEFAULT_DOMAIN_POSITION    Param  453      I(4)            4           scalar                    453                               
 DIMENSION_EXISTS           Func   473      L(4)            4           scalar   PRIV             473                               
 DIM_NAME                   Dummy  438      CHAR                        scalar   ARG,IN           463,469,473,474,476,480           
 DIM_SIZE                   Local  451      I(4)            4           scalar                    474,475                           
 DOMAIN_POSITION            Dummy  438      I(4)            4           scalar   ARG,IN           454,455                           
 DOMAIN_SIZE                Local  450      I(4)            4           scalar                    462,468,475,480                   
 DPOS                       Local  448      I(4)            4           scalar                    453,455,459,462,463,465,468,469   
 EAST                       Param  459      I(4)            4           scalar   PRIV             459,761                           
 FILEOBJ                    Dummy  438      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        454,457,463,469,473,474,480       
 GET_DIMENSION_SIZE         Subr   474                                           PRIV             474                               
 IO_DOMAIN                  Local  449      DOMAIN2D        752         scalar   PTR              457,462,468                       
 MPP_DOMAIN_IS_SYMMETRY     Func   454      L(4)            4           scalar   PRIV             454                               
 MPP_GET_GLOBAL_DOMAIN      Local  462                                  scalar   PRIV             462,468,510,511,518,519,752,753,80
                                                                                                  6,811,1122,1123,1340,1341,1558,155
                                                                                                  9,1776,1777,2086,2087,2380,2381,26
                                                                                                  74,2675,2968,2969                 
 MPP_GET_GLOBAL_DOMAIN2D    Subr   462                                           PRIV             462,468,510,511,518,519,752,753,80
                                                                                                  6,811,1122,1123,1340,1341,1558,155
                                                                                                  9,1776,1777,2086,2087,2380,2381,26
                                                                                                  74,2675,2968,2969                 
 NETCDF_ADD_DIMENSION       Subr   480                                           PRIV             480                               
 NORTH                      Param  465      I(4)            4           scalar   PRIV             465,772                           
 PRESENT                    Func   454                                  scalar                    454                               
 REGISTER_DOMAIN_DECOMPOSED                                                                                                         
 _DIMENSION                 Subr   438                                                                                              
 TRIM                       Func   476                                  scalar                    476,477                           
 XORY                       Dummy  438      CHAR                        scalar   ARG,IN           458,464,477                       


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 FMSNETCDFFILE_T.IS_READONLY                                                                                               ...
                            L(4)            4     256            scalar                    473,537,910                        
 FMSNETCDFFILE_T.MODE_IS_APPEND                                                                                            ...
                            L(4)            4     604            scalar                    473                                

Page 21          Source Listing                  REGISTER_DOMAIN_DECOMPOSED_DIMENSION
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    483 
    484 
    485 !> @brief Add a "domain_decomposed" attribute to the axis variables because it is
    486 !!        required by mppnccombine.
    487 !! @internal
    488 subroutine add_domain_attribute(fileobj, variable_name)
    489 
    490   type(FmsNetcdfDomainFile_t), intent(inout) :: fileobj !< File object.
    491   character(len=*), intent(in) :: variable_name !< Variable name.
    492 
    493   type(domain2d), pointer :: io_domain
    494   integer :: dpos
    495   integer :: sg
    496   integer :: eg
    497   integer :: s
    498   integer :: e
    499   integer, dimension(2) :: io_layout !< Io_layout in the fileobj's domain
    500 
    501 !< Don't add the "domain_decomposition" variable attribute if the io_layout is
    502 !! 1,1, to avoid frecheck "failures"
    503   io_layout = mpp_get_io_domain_layout(fileobj%domain)
    504   if (io_layout(1)  .eq. 1 .and. io_layout(2) .eq. 1) return
    505 
    506   io_domain => mpp_get_io_domain(fileobj%domain)
    507   dpos = get_domain_decomposed_index(variable_name, fileobj%xdims, fileobj%nx)
    508   if (dpos .ne. variable_not_found) then
    509     dpos = fileobj%xdims(dpos)%pos
    510     call mpp_get_global_domain(fileobj%domain, xbegin=sg, xend=eg, position=dpos)
    511     call mpp_get_global_domain(io_domain, xbegin=s, xend=e, position=dpos)
    512     call register_variable_attribute(fileobj, variable_name, "domain_decomposition", &
    513                                      (/sg, eg, s, e/))
    514   else
    515     dpos = get_domain_decomposed_index(variable_name, fileobj%ydims, fileobj%ny)
    516     if (dpos .ne. variable_not_found) then
    517       dpos = fileobj%ydims(dpos)%pos
    518       call mpp_get_global_domain(fileobj%domain, ybegin=sg, yend=eg, position=dpos)
    519       call mpp_get_global_domain(io_domain, ybegin=s, yend=e, position=dpos)
    520       call register_variable_attribute(fileobj, variable_name, "domain_decomposition", &
    521                                        (/sg, eg, s, e/))
    522     endif
    523   endif
    524 end subroutine add_domain_attribute

Page 22          Source Listing                  ADD_DOMAIN_ATTRIBUTE
2021-06-01 08:53 Entry Points                    fms_netcdf_domain_io.F90



ENTRY POINTS

  Name                                                         
                                                               
 fms_netcdf_domain_io_mod_mp_add_domain_attribute_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ADD_DOMAIN_ATTRIBUTE       Subr   488                                                            541,911                           
 DPOS                       Local  494      I(4)            4           scalar                    507,508,509,510,511,515,516,517,51
                                                                                                  8,519                             
 E                          Local  498      I(4)            4           scalar                    511,513,519,521                   
 EG                         Local  496      I(4)            4           scalar                    510,513,518,521                   
 FILEOBJ                    Dummy  488      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        503,506,507,509,510,512,515,517,51
                                                                                                  8,520                             
 IO_DOMAIN                  Local  493      DOMAIN2D        752         scalar   PTR              506,511,519                       
 IO_LAYOUT                  Local  499      I(4)            4     1     2                         503,504                           
 REGISTER_VARIABLE_ATTRIBUT                                                                                                         
 E                          Local  512                                  scalar   PRIV             512,520,569,576,583               
 REGISTER_VARIABLE_ATTRIBUT                                                                                                         
 E_1D                       Subr   512                                           PRIV             512,520                           
 S                          Local  497      I(4)            4           scalar                    511,513,519,521                   
 SG                         Local  495      I(4)            4           scalar                    510,513,518,521                   
 VARIABLE_NAME              Dummy  488      CHAR                        scalar   ARG,IN           507,512,515,520                   

Page 23          Source Listing                  ADD_DOMAIN_ATTRIBUTE
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    525 
    526 
    527 !> @brief Add a domain decomposed variable.
    528 subroutine register_domain_variable(fileobj, variable_name, variable_type, dimensions)
    529 
    530   type(FmsNetcdfDomainFile_t), intent(inout) :: fileobj !< File object.
    531   character(len=*), intent(in) :: variable_name !< Variable name.
    532   character(len=*), intent(in) :: variable_type !< Variable type.  Allowed
    533 !! values are: "int", "int64",
    534 !! "float", or "double".
    535   character(len=*), dimension(:), intent(in), optional :: dimensions !< Dimension names.
    536 
    537   if (.not. fileobj%is_readonly) then
    538     call netcdf_add_variable(fileobj, variable_name, variable_type, dimensions)
    539     if (present(dimensions)) then
    540       if (size(dimensions) .eq. 1) then
    541         call add_domain_attribute(fileobj, variable_name)
    542       endif
    543     endif
    544   endif
    545 end subroutine register_domain_variable


ENTRY POINTS

  Name                                                             
                                                                   
 fms_netcdf_domain_io_mod_mp_register_domain_variable_             

Page 24          Source Listing                  REGISTER_DOMAIN_VARIABLE
2021-06-01 08:53 Symbol Table                    fms_netcdf_domain_io.F90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DIMENSIONS                 Dummy  528      CHAR                  1     1        ARG,IN           538,539,540                       
 FILEOBJ                    Dummy  528      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        537,538,541                       
 NETCDF_ADD_VARIABLE        Subr   538                                           PRIV             538                               
 PRESENT                    Func   539                                  scalar                    539                               
 REGISTER_DOMAIN_VARIABLE   Subr   528                                                                                              
 SIZE                       Func   540                                  scalar                    540                               
 VARIABLE_NAME              Dummy  528      CHAR                        scalar   ARG,IN           538,541                           
 VARIABLE_TYPE              Dummy  528      CHAR                        scalar   ARG,IN           538                               

Page 25          Source Listing                  REGISTER_DOMAIN_VARIABLE
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    546 
    547 
    548 !> @brief Loop through registered restart variables and write them to
    549 !!        a netcdf file.
    550 subroutine save_domain_restart(fileobj, unlim_dim_level)
    551 
    552   type(FmsNetcdfDomainFile_t), intent(in) :: fileobj !< File object.
    553   integer, intent(in), optional :: unlim_dim_level !< Unlimited dimension level.
    554 
    555   integer :: i
    556   character(len=32) :: chksum
    557   logical :: is_decomposed
    558 
    559   if (.not. fileobj%is_restart) then
    560     call error("file "//trim(fileobj%path)//" is not a restart file.")
    561   endif
    562 
    563 ! Calculate the variable's checksum and write it to the netcdf file
    564   do i = 1, fileobj%num_restart_vars
    565     if (associated(fileobj%restart_vars(i)%data2d)) then
    566       chksum = compute_global_checksum(fileobj, fileobj%restart_vars(i)%varname, &
    567                                        fileobj%restart_vars(i)%data2d, is_decomposed)
    568       if (is_decomposed) then
    569         call register_variable_attribute(fileobj, fileobj%restart_vars(i)%varname, &
    570                                          "checksum", chksum(1:len(chksum)), str_len=len(chksum))
    571       endif
    572     elseif (associated(fileobj%restart_vars(i)%data3d)) then
    573       chksum = compute_global_checksum(fileobj, fileobj%restart_vars(i)%varname, &
    574                                        fileobj%restart_vars(i)%data3d, is_decomposed)
    575       if (is_decomposed) then
    576         call register_variable_attribute(fileobj, fileobj%restart_vars(i)%varname, &
    577                                          "checksum", chksum(1:len(chksum)), str_len=len(chksum))
    578       endif
    579     elseif (associated(fileobj%restart_vars(i)%data4d)) then
    580       chksum = compute_global_checksum(fileobj, fileobj%restart_vars(i)%varname, &
    581                                        fileobj%restart_vars(i)%data4d, is_decomposed)
    582       if (is_decomposed) then
    583         call register_variable_attribute(fileobj, fileobj%restart_vars(i)%varname, &
    584                                          "checksum", chksum(1:len(chksum)), str_len=len(chksum))
    585       endif
    586     endif
    587   enddo
    588 
    589 ! Write the variable's data to the netcdf file
    590   do i = 1, fileobj%num_restart_vars
    591     if (associated(fileobj%restart_vars(i)%data0d)) then
    592       call domain_write_0d(fileobj, fileobj%restart_vars(i)%varname, &
    593                            fileobj%restart_vars(i)%data0d, unlim_dim_level=unlim_dim_level)
    594     elseif (associated(fileobj%restart_vars(i)%data1d)) then
    595       call domain_write_1d(fileobj, fileobj%restart_vars(i)%varname, &
    596                            fileobj%restart_vars(i)%data1d, unlim_dim_level=unlim_dim_level)
    597     elseif (associated(fileobj%restart_vars(i)%data2d)) then
    598       call domain_write_2d(fileobj, fileobj%restart_vars(i)%varname, &
    599                            fileobj%restart_vars(i)%data2d, unlim_dim_level=unlim_dim_level)
    600     elseif (associated(fileobj%restart_vars(i)%data3d)) then
    601       call domain_write_3d(fileobj, fileobj%restart_vars(i)%varname, &
    602                            fileobj%restart_vars(i)%data3d, unlim_dim_level=unlim_dim_level)

Page 26          Source Listing                  SAVE_DOMAIN_RESTART
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    603     elseif (associated(fileobj%restart_vars(i)%data4d)) then
    604       call domain_write_4d(fileobj, fileobj%restart_vars(i)%varname, &
    605                            fileobj%restart_vars(i)%data4d, unlim_dim_level=unlim_dim_level)
    606     else
    607       call error("This routine only accepts data that is scalar, 1d 2d 3d or 4d."//&
    608                  " The data sent in has an unsupported dimensionality")
    609     endif
    610   enddo
    611 
    612 end subroutine save_domain_restart


ENTRY POINTS

  Name                                                        
                                                              
 fms_netcdf_domain_io_mod_mp_save_domain_restart_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ASSOCIATED                 Func   565                                  scalar                    565,572,579,591,594,597,600,603   
 CHKSUM                     Local  556      CHAR            32          scalar                    566,570,573,577,580,584           
 COMPUTE_GLOBAL_CHECKSUM    Local  566                                  scalar                    566,573,580,640,653,666           
 DOMAIN_WRITE_0D            Subr   592                                                            87,592                            
 DOMAIN_WRITE_1D            Subr   595                                                            88,595                            
 DOMAIN_WRITE_2D            Subr   598                                                            89,598                            
 DOMAIN_WRITE_3D            Subr   601                                                            90,601                            
 DOMAIN_WRITE_4D            Subr   604                                                            91,604                            
 FILEOBJ                    Dummy  550      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           559,560,564,565,566,567,569,572,57
                                                                                                  3,574,576,579,580,581,583,590,591,
                                                                                                  592,593,594,595,596,597,598,599,60
                                                                                                  0,601,602,603,604,605             
 I                          Local  555      I(4)            4           scalar                    564,565,566,567,569,572,573,574,57
                                                                                                  6,579,580,581,583,590,591,592,593,
                                                                                                  594,595,596,597,598,599,600,601,60
                                                                                                  2,603,604,605                     
 IS_DECOMPOSED              Local  557      L(4)            4           scalar                    567,568,574,575,581,582           
 LEN                        Func   570                                  scalar                    570,577,584                       
 REGISTER_VARIABLE_ATTRIBUT                                                                                                         
 E_0D                       Subr   569                                           PRIV             569,576,583                       
 SAVE_DOMAIN_RESTART        Subr   550                                                                                              
 TRIM                       Func   560                                  scalar                    560                               
 UNLIM_DIM_LEVEL            Dummy  550      I(4)            4           scalar   ARG,IN           593,596,599,602,605               



Page 27          Source Listing                  SAVE_DOMAIN_RESTART
2021-06-01 08:53 Symbol Table                    fms_netcdf_domain_io.F90

TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 FMSNETCDFFILE_T.IS_RESTART L(4)            4     600            scalar                    559,627                            
 FMSNETCDFFILE_T.NUM_RESTART_VARS                                                                                          ...
                            I(4)            4     688            scalar                    564,590,630                        
 FMSNETCDFFILE_T.PATH       CHAR            256   0              scalar                    560,628,1227,1263,1445,1481,1663,1 
                                                                                           699,1883,1919                      
 FMSNETCDFFILE_T.RESTART_VARS                                                                                              ...
                            RECORD          2104  616      1     1        ALC              565,566,567,569,572,573,574,576,57 
                                                                                           9,580,581,583,591,592,593,594,595, 
                                                                                           596,597,598,599,600,601,602,603,60 
                                                                                           4,605,631,632,633,634,635,636,637, 
                                                                                           638,639,640,641,642,644,650,651,65 
                                                                                           2,653,654,655,657,663,664,665,666, 
                                                                                           667,668,670                        
 RESTARTVARIABLE_T.DATA0D   RECORD                256            scalar   PTR              591,593,631,633                    
 RESTARTVARIABLE_T.DATA1D   RECORD                384      1     1        PTR              594,596,634,636                    
 RESTARTVARIABLE_T.DATA2D   RECORD                536      2     1        PTR              565,567,597,599,637,639,641        
 RESTARTVARIABLE_T.DATA3D   RECORD                712      3     1        PTR              572,574,600,602,650,652,654        
 RESTARTVARIABLE_T.DATA4D   RECORD                912      4     1        PTR              579,581,603,605,663,665,667        
 RESTARTVARIABLE_T.VARNAME  CHAR            256   0              scalar                    566,569,573,576,580,583,592,595,59 
                                                                                           8,601,604,632,635,638,640,642,644, 
                                                                                           651,653,655,657,664,666,668,670    

Page 28          Source Listing                  SAVE_DOMAIN_RESTART
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    613 
    614 
    615 !> @brief Loop through registered restart variables and read them from
    616 !!        a netcdf file.
    617 subroutine restore_domain_state(fileobj, unlim_dim_level)
    618 
    619   type(FmsNetcdfDomainFile_t), intent(inout) :: fileobj !< File object.
    620   integer, intent(in), optional :: unlim_dim_level !< Unlimited dimension level.
    621 
    622   integer :: i
    623   character(len=32) :: chksum_in_file
    624   character(len=32) :: chksum
    625   logical :: is_decomposed
    626 
    627   if (.not. fileobj%is_restart) then
    628     call error("file "//trim(fileobj%path)//" is not a restart file.")
    629   endif
    630   do i = 1, fileobj%num_restart_vars
    631     if (associated(fileobj%restart_vars(i)%data0d)) then
    632       call domain_read_0d(fileobj, fileobj%restart_vars(i)%varname, &
    633                           fileobj%restart_vars(i)%data0d, unlim_dim_level=unlim_dim_level)
    634     elseif (associated(fileobj%restart_vars(i)%data1d)) then
    635       call domain_read_1d(fileobj, fileobj%restart_vars(i)%varname, &
    636                           fileobj%restart_vars(i)%data1d, unlim_dim_level=unlim_dim_level)
    637     elseif (associated(fileobj%restart_vars(i)%data2d)) then
    638       call domain_read_2d(fileobj, fileobj%restart_vars(i)%varname, &
    639                           fileobj%restart_vars(i)%data2d, unlim_dim_level=unlim_dim_level)
    640       chksum = compute_global_checksum(fileobj, fileobj%restart_vars(i)%varname, &
    641                                        fileobj%restart_vars(i)%data2d, is_decomposed)
    642       if (variable_att_exists(fileobj, fileobj%restart_vars(i)%varname, "checksum") .and. &
    643           is_decomposed) then
    644         call get_variable_attribute(fileobj, fileobj%restart_vars(i)%varname, &
    645                                     "checksum", chksum_in_file)
    646         if (.not. string_compare(trim(adjustl(chksum_in_file)), trim(adjustl(chksum)))) then
    647           call error("checksum attribute does not match data in file.")
    648         endif
    649       endif
    650     elseif (associated(fileobj%restart_vars(i)%data3d)) then
    651       call domain_read_3d(fileobj, fileobj%restart_vars(i)%varname, &
    652                           fileobj%restart_vars(i)%data3d, unlim_dim_level=unlim_dim_level)
    653       chksum = compute_global_checksum(fileobj, fileobj%restart_vars(i)%varname, &
    654                                        fileobj%restart_vars(i)%data3d, is_decomposed)
    655       if (variable_att_exists(fileobj, fileobj%restart_vars(i)%varname, "checksum") .and. &
    656           is_decomposed) then
    657         call get_variable_attribute(fileobj, fileobj%restart_vars(i)%varname, &
    658                                     "checksum", chksum_in_file(1:len(chksum_in_file)))
    659         if (.not. string_compare(trim(adjustl(chksum_in_file)), trim(adjustl(chksum)))) then
    660           call error("checksum attribute does not match data in file.")
    661         endif
    662       endif
    663     elseif (associated(fileobj%restart_vars(i)%data4d)) then
    664       call domain_read_4d(fileobj, fileobj%restart_vars(i)%varname, &
    665                           fileobj%restart_vars(i)%data4d, unlim_dim_level=unlim_dim_level)
    666       chksum = compute_global_checksum(fileobj, fileobj%restart_vars(i)%varname, &
    667                                        fileobj%restart_vars(i)%data4d, is_decomposed)
    668       if (variable_att_exists(fileobj, fileobj%restart_vars(i)%varname, "checksum") .and. &
    669           is_decomposed) then

Page 29          Source Listing                  RESTORE_DOMAIN_STATE
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    670         call get_variable_attribute(fileobj, fileobj%restart_vars(i)%varname, &
    671                                     "checksum", chksum_in_file)
    672         if (.not. string_compare(trim(adjustl(chksum_in_file)), trim(adjustl(chksum)))) then
    673           call error("checksum attribute does not match data in file.")
    674         endif
    675       endif
    676     else
    677       call error("this branch should not be reached.")
    678     endif
    679   enddo
    680 end subroutine restore_domain_state


ENTRY POINTS

  Name                                                         
                                                               
 fms_netcdf_domain_io_mod_mp_restore_domain_state_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ADJUSTL                    Func   646                                  scalar                    646,659,672                       
 ASSOCIATED                 Func   631                                  scalar                    631,634,637,650,663               
 CHKSUM                     Local  624      CHAR            32          scalar                    640,646,653,659,666,672           
 CHKSUM_IN_FILE             Local  623      CHAR            32          scalar                    645,646,658,659,671,672           
 DOMAIN_READ_0D             Subr   632                                                            81,632                            
 DOMAIN_READ_1D             Subr   635                                                            82,635                            
 DOMAIN_READ_2D             Subr   638                                                            83,638                            
 DOMAIN_READ_3D             Subr   651                                                            84,651                            
 DOMAIN_READ_4D             Subr   664                                                            85,664                            
 FILEOBJ                    Dummy  617      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        627,628,630,631,632,633,634,635,63
                                                                                                  6,637,638,639,640,641,642,644,650,
                                                                                                  651,652,653,654,655,657,663,664,66
                                                                                                  5,666,667,668,670                 
 GET_VARIABLE_ATTRIBUTE     Local  644                                  scalar   PRIV             644,657,670                       
 GET_VARIABLE_ATTRIBUTE_0D  Subr   644                                           PRIV             644,657,670                       
 I                          Local  622      I(4)            4           scalar                    630,631,632,633,634,635,636,637,63
                                                                                                  8,639,640,641,642,644,650,651,652,
                                                                                                  653,654,655,657,663,664,665,666,66
                                                                                                  7,668,670                         
 IS_DECOMPOSED              Local  625      L(4)            4           scalar                    641,643,654,656,667,669           
 LEN                        Func   658                                  scalar                    658                               
 RESTORE_DOMAIN_STATE       Subr   617                                                                                              
 TRIM                       Func   628                                  scalar                    628,646,659,672                   
 UNLIM_DIM_LEVEL            Dummy  617      I(4)            4           scalar   ARG,IN           633,636,639,652,665               
 VARIABLE_ATT_EXISTS        Func   642      L(4)            4           scalar   PRIV             642,655,668                       

Page 30          Source Listing                  RESTORE_DOMAIN_STATE
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    681 
    682 
    683 !> @brief Return an array of compute domain indices.
    684 subroutine get_compute_domain_dimension_indices(fileobj, dimname, indices)
    685 
    686   type(FmsNetcdfDomainFile_t), intent(in) :: fileobj !< File object.
    687   character(len=*), intent(in) :: dimname !< Name of dimension variable.
    688   integer, dimension(:), allocatable, intent(inout) :: indices !< Compute domain indices.
    689 
    690   type(domain2d), pointer :: io_domain
    691   integer :: dpos
    692   integer :: s
    693   integer :: e
    694   integer :: i
    695 
    696   io_domain => mpp_get_io_domain(fileobj%domain)
    697   dpos = get_domain_decomposed_index(dimname, fileobj%xdims, fileobj%nx)
    698   if (dpos .ne. variable_not_found) then
    699     dpos = fileobj%xdims(dpos)%pos
    700     call mpp_get_compute_domain(io_domain, xbegin=s, xend=e, position=dpos)
    701   else
    702     dpos = get_domain_decomposed_index(dimname, fileobj%ydims, fileobj%ny)
    703     if (dpos .ne. variable_not_found) then
    704       dpos = fileobj%ydims(dpos)%pos
    705       call mpp_get_compute_domain(io_domain, ybegin=s, yend=e, position=dpos)
    706     else
    707       call error("input dimension is not associated with the domain.")
    708     endif
    709   endif
    710   if (allocated(indices)) then
    711     deallocate(indices)
    712   endif
    713   allocate(indices(e-s+1))
    714   do i = s, e
    715     indices(i-s+1) = i
    716   enddo
    717 end subroutine get_compute_domain_dimension_indices

Page 31          Source Listing                  GET_COMPUTE_DOMAIN_DIMENSION_INDICES
2021-06-01 08:53 Entry Points                    fms_netcdf_domain_io.F90



ENTRY POINTS

  Name                                                                         
                                                                               
 fms_netcdf_domain_io_mod_mp_get_compute_domain_dimension_indices_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALLOCATED                  Func   710                                  scalar                    710                               
 DIMNAME                    Dummy  684      CHAR                        scalar   ARG,IN           697,702                           
 DPOS                       Local  691      I(4)            4           scalar                    697,698,699,700,702,703,704,705   
 E                          Local  693      I(4)            4           scalar                    700,705,713,714                   
 FILEOBJ                    Dummy  684      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           696,697,699,702,704               
 GET_COMPUTE_DOMAIN_DIMENSI                                                                                                         
 ON_INDICES                 Subr   684                                                                                              
 I                          Local  694      I(4)            4           scalar                    714,715                           
 INDICES                    Dummy  684      I(4)            4     1     1        ARG,ALC,INOUT    710,711,713,715                   
 IO_DOMAIN                  Local  690      DOMAIN2D        752         scalar   PTR              696,700,705                       
 MPP_GET_COMPUTE_DOMAIN     Local  700                                  scalar   PRIV             700,705,757,768                   
 MPP_GET_COMPUTE_DOMAIN2D   Subr   700                                           PRIV             700,705,757,768                   
 S                          Local  692      I(4)            4           scalar                    700,705,713,714,715               

Page 32          Source Listing                  GET_COMPUTE_DOMAIN_DIMENSION_INDICES
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    718 
    719 
    720 !> @brief Utility routine that retrieves domain indices.
    721 !! @internal
    722 subroutine domain_offsets(data_xsize, data_ysize, domain, xpos, ypos, &
    723                           isd, isc, xc_size, jsd, jsc, yc_size, &
    724                           buffer_includes_halos, extra_x_point, &
    725                           extra_y_point)
    726 
    727   integer, intent(in) :: data_xsize !< Size of buffer's domain "x" dimension.
    728   integer, intent(in) :: data_ysize !< Size of buffer's domain "y" dimension.
    729   type(domain2d), intent(in) :: domain !< Parent domain.
    730   integer, intent(in) :: xpos !< Variable's domain x dimension position.
    731   integer, intent(in) :: ypos !< Variable's domain y dimension position.
    732   integer, intent(out) :: isd !< Starting index for x dimension of data domain.
    733   integer, intent(out) :: isc !< Starting index for x dimension of compute domain.
    734   integer, intent(out) :: xc_size !< Size of x dimension of compute domain.
    735   integer, intent(out) :: jsd !< Starting index for y dimension of data domain.
    736   integer, intent(out) :: jsc !< Starting index for y dimension of compute domain.
    737   integer, intent(out) :: yc_size !< Size of y dimension of compute domain.
    738   logical, intent(out) :: buffer_includes_halos !< Flag telling if input buffer includes space for halos.
    739   logical, intent(out), optional :: extra_x_point !<
    740   logical, intent(out), optional :: extra_y_point !<
    741 
    742   integer :: xd_size
    743   integer :: yd_size
    744   integer :: iec
    745   integer :: xmax
    746   integer :: jec
    747   integer :: ymax
    748   type(domain2d), pointer :: io_domain !< I/O domain variable is decomposed over.
    749 
    750   io_domain => mpp_get_io_domain(domain)
    751 
    752   call mpp_get_global_domain(domain, xend=xmax, position=xpos)
    753   call mpp_get_global_domain(domain, yend=ymax, position=ypos)
    754   call mpp_get_data_domain(io_domain, xbegin=isd, xsize=xd_size, position=xpos)
    755   call mpp_get_data_domain(io_domain, ybegin=jsd, ysize=yd_size, position=ypos)
    756 
    757   call mpp_get_compute_domain(io_domain, xbegin=isc, xend=iec, xsize=xc_size, &
    758                               position=xpos)
    759 ! If the xpos is east and the ending x index is NOT equal to max allowed, set extra_x_point to true
    760   if (present(extra_x_point)) then
    761     if ((xpos .eq. east) .and. (iec .ne. xmax)) then
    762       extra_x_point = .true.
    763     else
    764       extra_x_point = .false.
    765     endif
    766   endif
    767 
    768   call mpp_get_compute_domain(io_domain, ybegin=jsc, yend=jec, ysize=yc_size, &
    769                               position=ypos)
    770 ! If the ypost is north and the ending y index is NOT equal to max allowed, set extra_y_point to true
    771   if (present(extra_y_point)) then
    772     if ((ypos .eq. north) .and. (jec .ne. ymax)) then
    773       extra_y_point = .true.
    774     else

Page 33          Source Listing                  DOMAIN_OFFSETS
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    775       extra_y_point = .false.
    776     endif
    777   endif
    778 
    779   buffer_includes_halos = (data_xsize .eq. xd_size) .and. (data_ysize .eq. yd_size)
    780   if (.not. buffer_includes_halos .and. data_xsize .ne. xc_size .and. data_ysize &
    781       .ne. yc_size) then
    782     call error("size of x dimension of input buffer does not match size" &
    783                //" of x dimension of data or compute domain.")
    784   endif
    785 end subroutine domain_offsets


ENTRY POINTS

  Name                                                   
                                                         
 fms_netcdf_domain_io_mod_mp_domain_offsets_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFFER_INCLUDES_HALOS      Dummy  724      L(4)            4           scalar   ARG,OUT          779,780                           
 DATA_XSIZE                 Dummy  722      I(4)            4           scalar   ARG,IN           779,780                           
 DATA_YSIZE                 Dummy  722      I(4)            4           scalar   ARG,IN           779,780                           
 DOMAIN                     Dummy  722      DOMAIN2D        752         scalar   ARG,IN           750,752,753                       
 DOMAIN_OFFSETS             Subr   722                                                            1109,1327,1545,1763,2066,2360,2654
                                                                                                  ,2948,3236,3351,3465              
 EXTRA_X_POINT              Dummy  724      L(4)            4           scalar   ARG,OUT          760,762,764                       
 EXTRA_Y_POINT              Dummy  725      L(4)            4           scalar   ARG,OUT          771,773,775                       
 IEC                        Local  744      I(4)            4           scalar                    757,761                           
 IO_DOMAIN                  Local  748      DOMAIN2D        752         scalar   PTR              750,754,755,757,768               
 ISC                        Dummy  723      I(4)            4           scalar   ARG,OUT          757                               
 ISD                        Dummy  723      I(4)            4           scalar   ARG,OUT          754                               
 JEC                        Local  746      I(4)            4           scalar                    768,772                           
 JSC                        Dummy  723      I(4)            4           scalar   ARG,OUT          768                               
 JSD                        Dummy  723      I(4)            4           scalar   ARG,OUT          755                               
 MPP_GET_DATA_DOMAIN        Local  754                                  scalar   PRIV             754,755                           
 MPP_GET_DATA_DOMAIN2D      Subr   754                                           PRIV             754,755                           
 PRESENT                    Func   760                                  scalar                    760,771                           
 XC_SIZE                    Dummy  723      I(4)            4           scalar   ARG,OUT          757,780                           
 XD_SIZE                    Local  742      I(4)            4           scalar                    754,779                           
 XMAX                       Local  745      I(4)            4           scalar                    752,761                           
 XPOS                       Dummy  722      I(4)            4           scalar   ARG,IN           752,754,758,761                   
 YC_SIZE                    Dummy  723      I(4)            4           scalar   ARG,OUT          768,781                           
 YD_SIZE                    Local  743      I(4)            4           scalar                    755,779                           
 YMAX                       Local  747      I(4)            4           scalar                    753,772                           
 YPOS                       Dummy  722      I(4)            4           scalar   ARG,IN           753,755,769,772                   

Page 34          Source Listing                  DOMAIN_OFFSETS
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    786 
    787 
    788 !> @brief Get starting/ending global indices of the I/O domain for a domain decomposed
    789 !!        file.
    790 subroutine get_global_io_domain_indices(fileobj, dimname, is, ie, indices)
    791 
    792   type(FmsNetcdfDomainFile_t), intent(in) :: fileobj !< File object.
    793   character(len=*), intent(in) :: dimname !< Name of dimension variable.
    794   integer, intent(out) :: is !< Staring index of I/O global domain.
    795   integer, intent(out) :: ie !< Ending index of I/O global domain.
    796   integer, dimension(:), allocatable, intent(out), optional :: indices !< Global domain indices
    797 
    798   type(domain2d), pointer :: io_domain
    799   integer :: dpos
    800   integer :: i
    801 
    802   io_domain => mpp_get_io_domain(fileobj%domain)
    803   dpos = get_domain_decomposed_index(dimname, fileobj%xdims, fileobj%nx)
    804   if (dpos .ne. variable_not_found) then
    805     dpos = fileobj%xdims(dpos)%pos
    806     call mpp_get_global_domain(io_domain, xbegin=is, xend=ie, position=dpos)
    807   else
    808     dpos = get_domain_decomposed_index(dimname, fileobj%ydims, fileobj%ny)
    809     if (dpos .ne. variable_not_found) then
    810       dpos = fileobj%ydims(dpos)%pos
    811       call mpp_get_global_domain(io_domain, ybegin=is, yend=ie, position=dpos)
    812     else
    813       call error("input dimension is not associated with the domain.")
    814     endif
    815   endif
    816 
    817 ! Allocate indices to the difference between the ending and starting indices and
    818 ! fill indices with the data
    819   if (present(indices)) then
    820     if(allocated(indices)) then
    821       call error("get_global_io_domain_indices: the variable indices should not be allocated.")
    822     endif
    823     allocate(indices(ie-is+1))
    824     do i = is, ie
    825       indices(i-is+1) = i
    826     enddo
    827   endif
    828 
    829 
    830 end subroutine get_global_io_domain_indices

Page 35          Source Listing                  GET_GLOBAL_IO_DOMAIN_INDICES
2021-06-01 08:53 Entry Points                    fms_netcdf_domain_io.F90



ENTRY POINTS

  Name                                                                 
                                                                       
 fms_netcdf_domain_io_mod_mp_get_global_io_domain_indices_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALLOCATED                  Func   820                                  scalar                    820                               
 DIMNAME                    Dummy  790      CHAR                        scalar   ARG,IN           803,808                           
 DPOS                       Local  799      I(4)            4           scalar                    803,804,805,806,808,809,810,811   
 FILEOBJ                    Dummy  790      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           802,803,805,808,810               
 GET_GLOBAL_IO_DOMAIN_INDIC                                                                                                         
 ES                         Subr   790                                                                                              
 I                          Local  800      I(4)            4           scalar                    824,825                           
 IE                         Dummy  790      I(4)            4           scalar   ARG,OUT          806,811,823,824                   
 INDICES                    Dummy  790      I(4)            4     1     1        ARG,ALC,OUT      819,820,823,825                   
 IO_DOMAIN                  Local  798      DOMAIN2D        752         scalar   PTR              802,806,811                       
 IS                         Dummy  790      I(4)            4           scalar   ARG,OUT          806,811,823,824,825               
 PRESENT                    Func   819                                  scalar                    819                               

Page 36          Source Listing                  GET_GLOBAL_IO_DOMAIN_INDICES
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    831 
    832 !> @brief Read a mosaic_file and get the grid filename for the current tile or
    833 !!        for the tile specified
    834 subroutine get_mosaic_tile_grid(grid_file,mosaic_file, domain, tile_count)
    835   character(len=*), intent(out)          :: grid_file !< Filename of the grid file for the
    836 !! current domain tile or for tile
    837 !! specified in tile_count
    838   character(len=*), intent(in)           :: mosaic_file !< Filename that will be read
    839   type(domain2D),   intent(in)           :: domain !< Input domain
    840   integer,          intent(in), optional :: tile_count !< Optional argument indicating
    841 !! the tile you want grid file name for
    842 !! this is for when a pe is in more than
    843 !! tile.
    844   integer                                :: tile !< Current domian tile or tile_count
    845   integer                                :: ntileMe !< Total number of tiles in the domain
    846   integer, dimension(:), allocatable     :: tile_id !< List of tiles in the domain
    847   type(FmsNetcdfFile_t)                  :: fileobj !< Fms2io file object
    848 
    849   tile = 1
    850   if(present(tile_count)) tile = tile_count
    851   ntileMe = mpp_get_current_ntile(domain)
    852   allocate(tile_id(ntileMe))
    853   tile_id = mpp_get_tile_id(domain)
    854 
    855   if (netcdf_file_open(fileobj, mosaic_file, "read")) then
    856       call netcdf_read_data(fileobj, "gridfiles", grid_file, corner=tile_id(tile))
    857       grid_file = 'INPUT/'//trim(grid_file)
    858       call netcdf_file_close(fileobj)
    859   endif
    860 
    861 end subroutine get_mosaic_tile_grid

Page 37          Source Listing                  GET_MOSAIC_TILE_GRID
2021-06-01 08:53 Entry Points                    fms_netcdf_domain_io.F90



ENTRY POINTS

  Name                                                         
                                                               
 fms_netcdf_domain_io_mod_mp_get_mosaic_tile_grid_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DOMAIN                     Dummy  834      DOMAIN2D        752         scalar   ARG,IN           851,853                           
 FILEOBJ                    Local  847      FMSNETCDFFILE_T 872         scalar                    855,856,858                       
 FMSNETCDFFILE_T            Type   847                                  scalar                    55,847                            
 GET_MOSAIC_TILE_GRID       Subr   834                                                                                              
 GRID_FILE                  Dummy  834      CHAR                        scalar   ARG,OUT          856,857                           
 MOSAIC_FILE                Dummy  834      CHAR                        scalar   ARG,IN           855                               
 MPP_GET_CURRENT_NTILE      Func   851      I(4)            4           scalar   PRIV             851                               
 NETCDF_READ_DATA           Local  856                                  scalar   PRIV             856,1013,1044,1103,1137,1160,1183,
                                                                                                  1206,1321,1355,1378,1401,1424,1539
                                                                                                  ,1573,1596,1619,1642,1757,1792,181
                                                                                                  6,1839,1862                       
 NETCDF_READ_DATA_0D        Subr   856                                           PRIV             856,1013                          
 NTILEME                    Local  845      I(4)            4           scalar                    851,852                           
 PRESENT                    Func   850                                  scalar                    850                               
 TILE                       Local  844      I(4)            4           scalar                    849,850,856                       
 TILE_COUNT                 Dummy  834      I(4)            4           scalar   ARG,IN           850                               
 TILE_ID                    Local  846      I(4)            4     1     1        ALC              852,853,856                       
 TRIM                       Func   857                                  scalar                    857                               

Page 38          Source Listing                  GET_MOSAIC_TILE_GRID
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    862 
    863 include "register_domain_restart_variable.inc"


ENTRY POINTS

  Name                                                                        
                                                                              
 fms_netcdf_domain_io_mod_mp_register_domain_restart_variable_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DIMENSIONS                 Dummy  885      CHAR                  1     1        ARG,IN           894                               
 FILEOBJ                    Dummy  884      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        894                               
 IS_OPTIONAL                Dummy  885      L(4)            4           scalar   ARG,IN           894                               
 NETCDF_ADD_RESTART_VARIABL                                                                                                         
 E                          Local  894                                  scalar   PRIV             894,909,927,942,957,972           
 NETCDF_ADD_RESTART_VARIABL                                                                                                         
 E_0D                       Subr   894                                           PRIV             894                               
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_0D                  Subr   884                                                                                              
 VARIABLE_NAME              Dummy  884      CHAR                        scalar   ARG,IN           894                               
 VDATA                      Dummy  884      RECORD                      scalar   ARG,TGT,IN       894                               

Page 39          Source Listing                  REGISTER_DOMAIN_RESTART_VARIABLE_1D
2021-06-01 08:53 Entry Points                    ...nclude/register_domain_restart_variable.inc



ENTRY POINTS

  Name                                                                        
                                                                              
 fms_netcdf_domain_io_mod_mp_register_domain_restart_variable_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DIMENSIONS                 Dummy  900      CHAR                  1     1        ARG,IN           909                               
 FILEOBJ                    Dummy  899      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        909,910,911                       
 IS_OPTIONAL                Dummy  900      L(4)            4           scalar   ARG,IN           909                               
 NETCDF_ADD_RESTART_VARIABL                                                                                                         
 E_1D                       Subr   909                                           PRIV             909                               
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_1D                  Subr   899                                                                                              
 VARIABLE_NAME              Dummy  899      CHAR                        scalar   ARG,IN           909,911                           
 VDATA                      Dummy  899      RECORD                1     1        ARG,TGT,IN       909                               

Page 40          Source Listing                  REGISTER_DOMAIN_RESTART_VARIABLE_2D
2021-06-01 08:53 Entry Points                    ...nclude/register_domain_restart_variable.inc



ENTRY POINTS

  Name                                                                        
                                                                              
 fms_netcdf_domain_io_mod_mp_register_domain_restart_variable_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DIMENSIONS                 Dummy  918      CHAR                  1     1        ARG,IN           927                               
 FILEOBJ                    Dummy  917      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        927                               
 IS_OPTIONAL                Dummy  918      L(4)            4           scalar   ARG,IN           927                               
 NETCDF_ADD_RESTART_VARIABL                                                                                                         
 E_2D                       Subr   927                                           PRIV             927                               
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_2D                  Subr   917                                                                                              
 VARIABLE_NAME              Dummy  917      CHAR                        scalar   ARG,IN           927                               
 VDATA                      Dummy  917      RECORD                2     1        ARG,TGT,IN       927                               

Page 41          Source Listing                  REGISTER_DOMAIN_RESTART_VARIABLE_3D
2021-06-01 08:53 Entry Points                    ...nclude/register_domain_restart_variable.inc



ENTRY POINTS

  Name                                                                        
                                                                              
 fms_netcdf_domain_io_mod_mp_register_domain_restart_variable_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DIMENSIONS                 Dummy  933      CHAR                  1     1        ARG,IN           942                               
 FILEOBJ                    Dummy  932      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        942                               
 IS_OPTIONAL                Dummy  933      L(4)            4           scalar   ARG,IN           942                               
 NETCDF_ADD_RESTART_VARIABL                                                                                                         
 E_3D                       Subr   942                                           PRIV             942                               
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_3D                  Subr   932                                                                                              
 VARIABLE_NAME              Dummy  932      CHAR                        scalar   ARG,IN           942                               
 VDATA                      Dummy  932      RECORD                3     1        ARG,TGT,IN       942                               

Page 42          Source Listing                  REGISTER_DOMAIN_RESTART_VARIABLE_4D
2021-06-01 08:53 Entry Points                    ...nclude/register_domain_restart_variable.inc



ENTRY POINTS

  Name                                                                        
                                                                              
 fms_netcdf_domain_io_mod_mp_register_domain_restart_variable_4d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DIMENSIONS                 Dummy  948      CHAR                  1     1        ARG,IN           957                               
 FILEOBJ                    Dummy  947      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        957                               
 IS_OPTIONAL                Dummy  948      L(4)            4           scalar   ARG,IN           957                               
 NETCDF_ADD_RESTART_VARIABL                                                                                                         
 E_4D                       Subr   957                                           PRIV             957                               
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_4D                  Subr   947                                                                                              
 VARIABLE_NAME              Dummy  947      CHAR                        scalar   ARG,IN           957                               
 VDATA                      Dummy  947      RECORD                4     1        ARG,TGT,IN       957                               

Page 43          Source Listing                  REGISTER_DOMAIN_RESTART_VARIABLE_5D
2021-06-01 08:53 Entry Points                    ...nclude/register_domain_restart_variable.inc



ENTRY POINTS

  Name                                                                        
                                                                              
 fms_netcdf_domain_io_mod_mp_register_domain_restart_variable_5d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DIMENSIONS                 Dummy  963      CHAR                  1     1        ARG,IN           972                               
 FILEOBJ                    Dummy  962      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,INOUT        972                               
 IS_OPTIONAL                Dummy  963      L(4)            4           scalar   ARG,IN           972                               
 NETCDF_ADD_RESTART_VARIABL                                                                                                         
 E_5D                       Subr   972                                           PRIV             972                               
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_5D                  Subr   962                                                                                              
 VARIABLE_NAME              Dummy  962      CHAR                        scalar   ARG,IN           972                               
 VDATA                      Dummy  962      RECORD                5     1        ARG,TGT,IN       972                               

Page 44          Source Listing                  REGISTER_DOMAIN_RESTART_VARIABLE_5D
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

    974 include "domain_read.inc"


ENTRY POINTS

  Name                                                   
                                                         
 fms_netcdf_domain_io_mod_mp_domain_read_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CORNER                     Dummy  999      I(4)            4           scalar   ARG,IN           1014                              
 DOMAIN_READ_0D             Subr   999                                                                                              
 FILEOBJ                    Dummy  999      FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           1013                              
 UNLIM_DIM_LEVEL            Dummy  999      I(4)            4           scalar   ARG,IN           1014                              
 VARIABLE_NAME              Dummy  999      CHAR                        scalar   ARG,IN           1013                              
 VDATA                      Dummy  999      RECORD                      scalar   ARG,INOUT        1013                              

Page 45          Source Listing                  DOMAIN_READ_1D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_read.inc



ENTRY POINTS

  Name                                                   
                                                         
 fms_netcdf_domain_io_mod_mp_domain_read_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CORNER                     Dummy  1026     I(4)            4     1     1        ARG,TGT,IN       1045                              
 DOMAIN_READ_1D             Subr   1025                                                                                             
 EDGE_LENGTHS               Dummy  1026     I(4)            4     1     1        ARG,TGT,IN       1046                              
 FILEOBJ                    Dummy  1025     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           1044                              
 NETCDF_READ_DATA_1D        Subr   1044                                          PRIV             1044                              
 UNLIM_DIM_LEVEL            Dummy  1025     I(4)            4           scalar   ARG,IN           1045                              
 VARIABLE_NAME              Dummy  1025     CHAR                        scalar   ARG,IN           1044                              
 VDATA                      Dummy  1025     RECORD                1     1        ARG,INOUT        1044                              

Page 46          Source Listing                  DOMAIN_READ_2D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_read.inc



ENTRY POINTS

  Name                                                   
                                                         
 fms_netcdf_domain_io_mod_mp_domain_read_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALLOCATE_ARRAY             Local  1136                                 scalar   PRIV             1136,1159,1182,1205,1243,1248,1253
                                                                                                  ,1258,1354,1377,1400,1423,1461,146
                                                                                                  6,1471,1476,1572,1595,1618,1641,16
                                                                                                  79,1684,1689,1694,1791,1815,1838,1
                                                                                                  861,1899,1904,1909,1914,2098,2104,
                                                                                                  2110,2116,2133,2156,2179,2202,2261
                                                                                                  ,2267,2273,2279,2392,2398,2404,241
                                                                                                  0,2427,2450,2473,2496,2555,2561,25
                                                                                                  67,2573,2686,2692,2698,2704,2721,2
                                                                                                  744,2767,2790,2849,2855,2861,2867,
                                                                                                  2980,2986,2992,2998,3015,3038,3061
                                                                                                  ,3084,3143,3149,3155,3161,3263,327
                                                                                                  2,3281,3290,3377,3386,3395,3404,34
                                                                                                  92,3501,3510,3519                 
 ALLOCATE_ARRAY_I4_KIND_2D  Subr   1136                                          PRIV             1136,1243,2098,2133,2261,3263     
 ALLOCATE_ARRAY_I8_KIND_2D  Subr   1159                                          PRIV             1159,1248,2104,2156,2267,3272     
 ALLOCATE_ARRAY_R4_KIND_2D  Subr   1182                                          PRIV             1182,1253,2110,2179,2273,3281     
 ALLOCATE_ARRAY_R8_KIND_2D  Subr   1205                                          PRIV             1205,1258,2116,2202,2279,3290     
 BUFFER_INCLUDES_HALOS      Local  1097     L(4)            4           scalar                    1110,1142,1165,1188,1211,1235     
 BUF_I4_KIND                Local  1093     I(4)            4     2     1        ALC              1136,1137,1150,1153,1156,1243,1244
                                                                                                  ,1245,1246                        
 BUF_I8_KIND                Local  1094     I(8)            8     2     1        ALC              1159,1160,1173,1176,1179,1248,1249
                                                                                                  ,1250,1251                        
 BUF_R4_KIND                Local  1095     R(4)            4     2     1        ALC              1182,1183,1196,1199,1202,1253,1254
                                                                                                  ,1255,1256                        
 BUF_R8_KIND                Local  1096     R(8)            8     2     1        ALC              1205,1206,1219,1222,1225,1258,1259
                                                                                                  ,1260,1261                        
 C                          Local  1091     I(4)            4     1     2        TGT              1111,1125,1126,1128,1129,1139,1144
                                                                                                  ,1145,1147,1148,1150,1162,1167,116
                                                                                                  8,1170,1171,1173,1185,1190,1191,11
                                                                                                  93,1194,1196,1208,1213,1214,1216,1
                                                                                                  217,1219,1236,1237,1245,1250,1255,
                                                                                                  1260                              
 CORNER                     Dummy  1057     I(4)            4     1     2        ARG,TGT,IN       1104                              
 DOMAIN_READ_2D             Subr   1056                                                                                             
 E                          Local  1092     I(4)            4     1     2        TGT              1112,1131,1132,1136,1139,1150,1159
                                                                                                  ,1162,1173,1182,1185,1196,1205,120
                                                                                                  8,1219,1239,1240,1243,1245,1248,12
                                                                                                  50,1253,1255,1258,1260            
 EDGE_LENGTHS               Dummy  1057     I(4)            4     1     2        ARG,TGT,IN       1105                              
 EVENT_SEND                 Param  1154     I(4)            4           scalar   PRIV             1154,1177,1200,1223,1372,1395,1418
                                                                                                  ,1441,1590,1613,1636,1659,1810,183
                                                                                                  3,1856,1879,2264,2270,2276,2282,25
                                                                                                  58,2564,2570,2576,2852,2858,2864,2

Page 47          Source Listing                  DOMAIN_READ_2D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_read.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  870,3146,3152,3158,3164           
 FILEOBJ                    Dummy  1056     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           1101,1103,1108,1109,1115,1116,1117
                                                                                                  ,1118,1119,1124,1127,1137,1153,116
                                                                                                  0,1176,1183,1199,1206,1222,1227,12
                                                                                                  44,1249,1254,1259,1263            
 I                          Local  1080     I(4)            4           scalar                    1124,1125,1126,1131,1132,1140,1153
                                                                                                  ,1163,1176,1186,1199,1209,1222    
 I4_KIND                    Param  1093     I(4)            4           scalar   PRIV             1093,1134,1242,1311,1352,1460,1529
                                                                                                  ,1570,1678,1747,1789,1898,2020,202
                                                                                                  7,2049,2097,2132,2235,2260,2314,23
                                                                                                  21,2343,2391,2426,2529,2554,2608,2
                                                                                                  615,2637,2685,2720,2823,2848,2902,
                                                                                                  2909,2931,2979,3014,3117,3142,3218
                                                                                                  ,3222,3262,3333,3337,3376,3447,345
                                                                                                  1,3491                            
 I8_KIND                    Param  1094     I(4)            4           scalar   PRIV             1094,1157,1247,1312,1375,1465,1530
                                                                                                  ,1593,1683,1748,1813,1903,2021,202
                                                                                                  8,2050,2103,2155,2239,2266,2315,23
                                                                                                  22,2344,2397,2449,2533,2560,2609,2
                                                                                                  616,2638,2691,2743,2827,2854,2903,
                                                                                                  2910,2932,2985,3037,3121,3148,3219
                                                                                                  ,3223,3226,3271,3334,3338,3341,338
                                                                                                  5,3448,3452,3455,3500             
 IO_DOMAIN                  Local  1077     DOMAIN2D        752         scalar   PTR              1108,1120,1121,1122,1123          
 ISC                        Local  1082     I(4)            4           scalar                    1110,1144,1167,1190,1213,1236     
 ISD                        Local  1081     I(4)            4           scalar                    1110,1144,1167,1190,1213,1236     
 JSC                        Local  1085     I(4)            4           scalar                    1110,1145,1168,1191,1214,1237     
 JSD                        Local  1084     I(4)            4           scalar                    1110,1145,1168,1191,1214,1237     
 MPP_GET_COMPUTE_DOMAINS    Local  1120                                 scalar   PRIV             1120,1121,1338,1339,1556,1557,1774
                                                                                                  ,1775,2077,2082,2371,2376,2665,267
                                                                                                  0,2959,2964                       
 MPP_GET_COMPUTE_DOMAINS2D  Subr   1120                                          PRIV             1120,1121,1338,1339,1556,1557,1774
                                                                                                  ,1775,2077,2082,2371,2376,2665,267
                                                                                                  0,2959,2964                       
 MPP_RECV                   Local  1244                                 scalar   PRIV             1244,1249,1254,1259,1462,1467,1472
                                                                                                  ,1477,1680,1685,1690,1695,1900,190
                                                                                                  5,1910,1915,2150,2173,2196,2219,24
                                                                                                  44,2467,2490,2513,2738,2761,2784,2
                                                                                                  807,3032,3055,3078,3101           
 MPP_RECV_INT4_2D           Subr   1244                                          PRIV             1244,2150                         
 MPP_RECV_INT8_2D           Subr   1249                                          PRIV             1249,2173                         
 MPP_RECV_REAL4_2D          Subr   1254                                          PRIV             1254,2196                         
 MPP_RECV_REAL8_2D          Subr   1259                                          PRIV             1259,2219                         
 MPP_SEND                   Local  1153                                 scalar   PRIV             1153,1176,1199,1222,1371,1394,1417
                                                                                                  ,1440,1589,1612,1635,1658,1809,183
                                                                                                  2,1855,1878,2263,2269,2275,2281,25
                                                                                                  57,2563,2569,2575,2851,2857,2863,2
                                                                                                  869,3145,3151,3157,3163           
 MPP_SEND_INT4_2D           Subr   1153                                          PRIV             1153,2263                         
 MPP_SEND_INT8_2D           Subr   1176                                          PRIV             1176,2269                         
 MPP_SEND_REAL4_2D          Subr   1199                                          PRIV             1199,2275                         
 MPP_SEND_REAL8_2D          Subr   1222                                          PRIV             1222,2281                         
 MPP_SYNC_SELF              Subr   1154                                          PRIV             1154,1177,1200,1223,1372,1395,1418
                                                                                                  ,1441,1590,1613,1636,1659,1810,183

Page 48          Source Listing                  DOMAIN_READ_2D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_read.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  3,1856,1879,2264,2270,2276,2282,25
                                                                                                  58,2564,2570,2576,2852,2858,2864,2
                                                                                                  870,3146,3152,3158,3164           
 NETCDF_READ_DATA_2D        Subr   1103                                          PRIV             1103,1137,1160,1183,1206          
 PE_ICSIZE                  Local  1088     I(4)            4     1     1        ALC              1117,1120,1131,1231               
 PE_ISC                     Local  1087     I(4)            4     1     1        ALC              1116,1120,1125,1230               
 PE_JCSIZE                  Local  1090     I(4)            4     1     1        ALC              1119,1121,1132,1233               
 PE_JSC                     Local  1089     I(4)            4     1     1        ALC              1118,1121,1126,1232               
 PUT_ARRAY_SECTION          Local  1150                                 scalar   PRIV             1150,1173,1196,1219,1245,1250,1255
                                                                                                  ,1260,1368,1391,1414,1437,1463,146
                                                                                                  8,1473,1478,1586,1609,1632,1655,16
                                                                                                  81,1686,1691,1696,1806,1829,1852,1
                                                                                                  875,1901,1906,1911,1916,2153,2176,
                                                                                                  2199,2222,2447,2470,2493,2516,2741
                                                                                                  ,2764,2787,2810,3035,3058,3081,310
                                                                                                  4                                 
 PUT_ARRAY_SECTION_I4_KIND_                                                                                                         
 2D                         Subr   1150                                          PRIV             1150,1245,2153                    
 PUT_ARRAY_SECTION_I8_KIND_                                                                                                         
 2D                         Subr   1173                                          PRIV             1173,1250,2176                    
 PUT_ARRAY_SECTION_R4_KIND_                                                                                                         
 2D                         Subr   1196                                          PRIV             1196,1255,2199                    
 PUT_ARRAY_SECTION_R8_KIND_                                                                                                         
 2D                         Subr   1219                                          PRIV             1219,1260,2222                    
 R4_KIND                    Param  1095     I(4)            4           scalar   PRIV             1095,1180,1252,1313,1398,1470,1531
                                                                                                  ,1616,1688,1749,1836,1908,2022,202
                                                                                                  9,2051,2109,2178,2243,2272,2316,23
                                                                                                  23,2345,2403,2472,2537,2566,2610,2
                                                                                                  617,2639,2697,2766,2831,2860,2904,
                                                                                                  2911,2933,2991,3060,3125,3154,3220
                                                                                                  ,3224,3280,3335,3339,3394,3449,345
                                                                                                  3,3509                            
 R8_KIND                    Param  1096     I(4)            4           scalar   PRIV             1096,1203,1257,1314,1421,1475,1532
                                                                                                  ,1639,1693,1750,1859,1913,2023,203
                                                                                                  0,2052,2115,2201,2247,2278,2317,23
                                                                                                  24,2346,2409,2495,2541,2572,2611,2
                                                                                                  618,2640,2703,2789,2835,2866,2905,
                                                                                                  2912,2934,2997,3083,3129,3160,3221
                                                                                                  ,3225,3289,3336,3340,3403,3450,345
                                                                                                  4,3518                            
 SHAPE                      Func   1112                                 scalar                    1112                              
 SIZE                       Func   1109                                 scalar                    1109,1116,1117,1118,1119,1124,1153
                                                                                                  ,1176,1199,1222,1244,1249,1254,125
                                                                                                  9                                 
 TRIM                       Func   1227                                 scalar                    1227,1263                         
 UNLIM_DIM_LEVEL            Dummy  1056     I(4)            4           scalar   ARG,IN           1104,1138,1161,1184,1207          
 VARIABLE_NAME              Dummy  1056     CHAR                        scalar   ARG,IN           1101,1103,1137,1160,1183,1206,1227
                                                                                                  ,1263                             
 VDATA                      Dummy  1056     RECORD                2     1        ARG,INOUT        1103,1109,1112,1133,1241          
 VDATA                      Local  1133     I(4)            4     2     1                         1150                              
 VDATA                      Local  1133     I(8)            8     2     1                         1173                              
 VDATA                      Local  1133     R(4)            4     2     1                         1196                              
 VDATA                      Local  1133     R(8)            8     2     1                         1219                              
 VDATA                      Local  1133     RECORD                2     1                                                           
 VDATA                      Local  1241     I(4)            4     2     1                         1245                              

Page 49          Source Listing                  DOMAIN_READ_2D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_read.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VDATA                      Local  1241     I(8)            8     2     1                         1250                              
 VDATA                      Local  1241     R(4)            4     2     1                         1255                              
 VDATA                      Local  1241     R(8)            8     2     1                         1260                              
 VDATA                      Local  1241     RECORD                2     1                                                           
 XC_SIZE                    Local  1083     I(4)            4           scalar                    1110,1239                         
 XDIM_INDEX                 Local  1075     I(4)            4           scalar                    1102,1109,1125,1128,1131,1144,1147
                                                                                                  ,1167,1170,1190,1193,1213,1216,123
                                                                                                  6,1239                            
 XGMIN                      Local  1098     I(4)            4           scalar                    1122,1128                         
 XPOS                       Local  1078     I(4)            4           scalar                    1102,1110,1120,1122               
 YC_SIZE                    Local  1086     I(4)            4           scalar                    1110,1240                         
 YDIM_INDEX                 Local  1076     I(4)            4           scalar                    1102,1109,1126,1129,1132,1145,1148
                                                                                                  ,1168,1171,1191,1194,1214,1217,123
                                                                                                  7,1240                            
 YGMIN                      Local  1099     I(4)            4           scalar                    1123,1129                         
 YPOS                       Local  1079     I(4)            4           scalar                    1102,1110,1121,1123               

Page 50          Source Listing                  DOMAIN_READ_3D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_read.inc



ENTRY POINTS

  Name                                                   
                                                         
 fms_netcdf_domain_io_mod_mp_domain_read_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALLOCATE_ARRAY_I4_KIND_3D  Subr   1354                                          PRIV             1354,1461,2392,2427,2555,3377     
 ALLOCATE_ARRAY_I8_KIND_3D  Subr   1377                                          PRIV             1377,1466,2398,2450,2561,3386     
 ALLOCATE_ARRAY_R4_KIND_3D  Subr   1400                                          PRIV             1400,1471,2404,2473,2567,3395     
 ALLOCATE_ARRAY_R8_KIND_3D  Subr   1423                                          PRIV             1423,1476,2410,2496,2573,3404     
 BUFFER_INCLUDES_HALOS      Local  1315     L(4)            4           scalar                    1328,1360,1383,1406,1429,1453     
 BUF_I4_KIND                Local  1311     I(4)            4     3     1        ALC              1354,1355,1368,1371,1374,1461,1462
                                                                                                  ,1463,1464                        
 BUF_I8_KIND                Local  1312     I(8)            8     3     1        ALC              1377,1378,1391,1394,1397,1466,1467
                                                                                                  ,1468,1469                        
 BUF_R4_KIND                Local  1313     R(4)            4     3     1        ALC              1400,1401,1414,1417,1420,1471,1472
                                                                                                  ,1473,1474                        
 BUF_R8_KIND                Local  1314     R(8)            8     3     1        ALC              1423,1424,1437,1440,1443,1476,1477
                                                                                                  ,1478,1479                        
 C                          Local  1309     I(4)            4     1     3        TGT              1329,1343,1344,1346,1347,1357,1362
                                                                                                  ,1363,1365,1366,1368,1380,1385,138
                                                                                                  6,1388,1389,1391,1403,1408,1409,14
                                                                                                  11,1412,1414,1426,1431,1432,1434,1
                                                                                                  435,1437,1454,1455,1463,1468,1473,
                                                                                                  1478                              
 CORNER                     Dummy  1275     I(4)            4     1     3        ARG,TGT,IN       1322                              
 DOMAIN_READ_3D             Subr   1274                                                                                             
 E                          Local  1310     I(4)            4     1     3        TGT              1330,1349,1350,1354,1357,1368,1377
                                                                                                  ,1380,1391,1400,1403,1414,1423,142
                                                                                                  6,1437,1457,1458,1461,1463,1466,14
                                                                                                  68,1471,1473,1476,1478            
 EDGE_LENGTHS               Dummy  1275     I(4)            4     1     3        ARG,TGT,IN       1323                              
 FILEOBJ                    Dummy  1274     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           1319,1321,1326,1327,1333,1334,1335
                                                                                                  ,1336,1337,1342,1345,1355,1371,137
                                                                                                  8,1394,1401,1417,1424,1440,1445,14
                                                                                                  62,1467,1472,1477,1481            
 I                          Local  1298     I(4)            4           scalar                    1342,1343,1344,1349,1350,1358,1371
                                                                                                  ,1381,1394,1404,1417,1427,1440    
 IO_DOMAIN                  Local  1295     DOMAIN2D        752         scalar   PTR              1326,1338,1339,1340,1341          
 ISC                        Local  1300     I(4)            4           scalar                    1328,1362,1385,1408,1431,1454     
 ISD                        Local  1299     I(4)            4           scalar                    1328,1362,1385,1408,1431,1454     
 JSC                        Local  1303     I(4)            4           scalar                    1328,1363,1386,1409,1432,1455     
 JSD                        Local  1302     I(4)            4           scalar                    1328,1363,1386,1409,1432,1455     
 MPP_RECV_INT4_3D           Subr   1462                                          PRIV             1462,2444                         
 MPP_RECV_INT8_3D           Subr   1467                                          PRIV             1467,2467                         
 MPP_RECV_REAL4_3D          Subr   1472                                          PRIV             1472,2490                         
 MPP_RECV_REAL8_3D          Subr   1477                                          PRIV             1477,2513                         
 MPP_SEND_INT4_3D           Subr   1371                                          PRIV             1371,2557                         
 MPP_SEND_INT8_3D           Subr   1394                                          PRIV             1394,2563                         

Page 51          Source Listing                  DOMAIN_READ_3D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_read.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPP_SEND_REAL4_3D          Subr   1417                                          PRIV             1417,2569                         
 MPP_SEND_REAL8_3D          Subr   1440                                          PRIV             1440,2575                         
 NETCDF_READ_DATA_3D        Subr   1321                                          PRIV             1321,1355,1378,1401,1424          
 PE_ICSIZE                  Local  1306     I(4)            4     1     1        ALC              1335,1338,1349,1449               
 PE_ISC                     Local  1305     I(4)            4     1     1        ALC              1334,1338,1343,1448               
 PE_JCSIZE                  Local  1308     I(4)            4     1     1        ALC              1337,1339,1350,1451               
 PE_JSC                     Local  1307     I(4)            4     1     1        ALC              1336,1339,1344,1450               
 PUT_ARRAY_SECTION_I4_KIND_                                                                                                         
 3D                         Subr   1368                                          PRIV             1368,1463,2447                    
 PUT_ARRAY_SECTION_I8_KIND_                                                                                                         
 3D                         Subr   1391                                          PRIV             1391,1468,2470                    
 PUT_ARRAY_SECTION_R4_KIND_                                                                                                         
 3D                         Subr   1414                                          PRIV             1414,1473,2493                    
 PUT_ARRAY_SECTION_R8_KIND_                                                                                                         
 3D                         Subr   1437                                          PRIV             1437,1478,2516                    
 SHAPE                      Func   1330                                 scalar                    1330                              
 SIZE                       Func   1327                                 scalar                    1327,1334,1335,1336,1337,1342,1371
                                                                                                  ,1394,1417,1440,1462,1467,1472,147
                                                                                                  7                                 
 TRIM                       Func   1445                                 scalar                    1445,1481                         
 UNLIM_DIM_LEVEL            Dummy  1274     I(4)            4           scalar   ARG,IN           1322,1356,1379,1402,1425          
 VARIABLE_NAME              Dummy  1274     CHAR                        scalar   ARG,IN           1319,1321,1355,1378,1401,1424,1445
                                                                                                  ,1481                             
 VDATA                      Dummy  1274     RECORD                3     1        ARG,INOUT        1321,1327,1330,1351,1459          
 VDATA                      Local  1351     I(4)            4     3     1                         1368                              
 VDATA                      Local  1351     I(8)            8     3     1                         1391                              
 VDATA                      Local  1351     R(4)            4     3     1                         1414                              
 VDATA                      Local  1351     R(8)            8     3     1                         1437                              
 VDATA                      Local  1351     RECORD                3     1                                                           
 VDATA                      Local  1459     I(4)            4     3     1                         1463                              
 VDATA                      Local  1459     I(8)            8     3     1                         1468                              
 VDATA                      Local  1459     R(4)            4     3     1                         1473                              
 VDATA                      Local  1459     R(8)            8     3     1                         1478                              
 VDATA                      Local  1459     RECORD                3     1                                                           
 XC_SIZE                    Local  1301     I(4)            4           scalar                    1328,1457                         
 XDIM_INDEX                 Local  1293     I(4)            4           scalar                    1320,1327,1343,1346,1349,1362,1365
                                                                                                  ,1385,1388,1408,1411,1431,1434,145
                                                                                                  4,1457                            
 XGMIN                      Local  1316     I(4)            4           scalar                    1340,1346                         
 XPOS                       Local  1296     I(4)            4           scalar                    1320,1328,1338,1340               
 YC_SIZE                    Local  1304     I(4)            4           scalar                    1328,1458                         
 YDIM_INDEX                 Local  1294     I(4)            4           scalar                    1320,1327,1344,1347,1350,1363,1366
                                                                                                  ,1386,1389,1409,1412,1432,1435,145
                                                                                                  5,1458                            
 YGMIN                      Local  1317     I(4)            4           scalar                    1341,1347                         
 YPOS                       Local  1297     I(4)            4           scalar                    1320,1328,1339,1341               

Page 52          Source Listing                  DOMAIN_READ_4D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_read.inc



ENTRY POINTS

  Name                                                   
                                                         
 fms_netcdf_domain_io_mod_mp_domain_read_4d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALLOCATE_ARRAY_I4_KIND_4D  Subr   1572                                          PRIV             1572,1679,2686,2721,2849,3492     
 ALLOCATE_ARRAY_I8_KIND_4D  Subr   1595                                          PRIV             1595,1684,2692,2744,2855,3501     
 ALLOCATE_ARRAY_R4_KIND_4D  Subr   1618                                          PRIV             1618,1689,2698,2767,2861,3510     
 ALLOCATE_ARRAY_R8_KIND_4D  Subr   1641                                          PRIV             1641,1694,2704,2790,2867,3519     
 BUFFER_INCLUDES_HALOS      Local  1533     L(4)            4           scalar                    1546,1578,1601,1624,1647,1671     
 BUF_I4_KIND                Local  1529     I(4)            4     4     1        ALC              1572,1573,1586,1589,1592,1679,1680
                                                                                                  ,1681,1682                        
 BUF_I8_KIND                Local  1530     I(8)            8     4     1        ALC              1595,1596,1609,1612,1615,1684,1685
                                                                                                  ,1686,1687                        
 BUF_R4_KIND                Local  1531     R(4)            4     4     1        ALC              1618,1619,1632,1635,1638,1689,1690
                                                                                                  ,1691,1692                        
 BUF_R8_KIND                Local  1532     R(8)            8     4     1        ALC              1641,1642,1655,1658,1661,1694,1695
                                                                                                  ,1696,1697                        
 C                          Local  1527     I(4)            4     1     4        TGT              1547,1561,1562,1564,1565,1575,1580
                                                                                                  ,1581,1583,1584,1586,1598,1603,160
                                                                                                  4,1606,1607,1609,1621,1626,1627,16
                                                                                                  29,1630,1632,1644,1649,1650,1652,1
                                                                                                  653,1655,1672,1673,1681,1686,1691,
                                                                                                  1696                              
 CORNER                     Dummy  1493     I(4)            4     1     4        ARG,TGT,IN       1540                              
 DOMAIN_READ_4D             Subr   1492                                                                                             
 E                          Local  1528     I(4)            4     1     4        TGT              1548,1567,1568,1572,1575,1586,1595
                                                                                                  ,1598,1609,1618,1621,1632,1641,164
                                                                                                  4,1655,1675,1676,1679,1681,1684,16
                                                                                                  86,1689,1691,1694,1696            
 EDGE_LENGTHS               Dummy  1493     I(4)            4     1     4        ARG,TGT,IN       1541                              
 FILEOBJ                    Dummy  1492     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           1537,1539,1544,1545,1551,1552,1553
                                                                                                  ,1554,1555,1560,1563,1573,1589,159
                                                                                                  6,1612,1619,1635,1642,1658,1663,16
                                                                                                  80,1685,1690,1695,1699            
 I                          Local  1516     I(4)            4           scalar                    1560,1561,1562,1567,1568,1576,1589
                                                                                                  ,1599,1612,1622,1635,1645,1658    
 IO_DOMAIN                  Local  1513     DOMAIN2D        752         scalar   PTR              1544,1556,1557,1558,1559          
 ISC                        Local  1518     I(4)            4           scalar                    1546,1580,1603,1626,1649,1672     
 ISD                        Local  1517     I(4)            4           scalar                    1546,1580,1603,1626,1649,1672     
 JSC                        Local  1521     I(4)            4           scalar                    1546,1581,1604,1627,1650,1673     
 JSD                        Local  1520     I(4)            4           scalar                    1546,1581,1604,1627,1650,1673     
 MPP_RECV_INT4_4D           Subr   1680                                          PRIV             1680,2738                         
 MPP_RECV_INT8_4D           Subr   1685                                          PRIV             1685,2761                         
 MPP_RECV_REAL4_4D          Subr   1690                                          PRIV             1690,2784                         
 MPP_RECV_REAL8_4D          Subr   1695                                          PRIV             1695,2807                         
 MPP_SEND_INT4_4D           Subr   1589                                          PRIV             1589,2851                         
 MPP_SEND_INT8_4D           Subr   1612                                          PRIV             1612,2857                         

Page 53          Source Listing                  DOMAIN_READ_4D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_read.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPP_SEND_REAL4_4D          Subr   1635                                          PRIV             1635,2863                         
 MPP_SEND_REAL8_4D          Subr   1658                                          PRIV             1658,2869                         
 NETCDF_READ_DATA_4D        Subr   1539                                          PRIV             1539,1573,1596,1619,1642          
 PE_ICSIZE                  Local  1524     I(4)            4     1     1        ALC              1553,1556,1567,1667               
 PE_ISC                     Local  1523     I(4)            4     1     1        ALC              1552,1556,1561,1666               
 PE_JCSIZE                  Local  1526     I(4)            4     1     1        ALC              1555,1557,1568,1669               
 PE_JSC                     Local  1525     I(4)            4     1     1        ALC              1554,1557,1562,1668               
 PUT_ARRAY_SECTION_I4_KIND_                                                                                                         
 4D                         Subr   1586                                          PRIV             1586,1681,2741                    
 PUT_ARRAY_SECTION_I8_KIND_                                                                                                         
 4D                         Subr   1609                                          PRIV             1609,1686,2764                    
 PUT_ARRAY_SECTION_R4_KIND_                                                                                                         
 4D                         Subr   1632                                          PRIV             1632,1691,2787                    
 PUT_ARRAY_SECTION_R8_KIND_                                                                                                         
 4D                         Subr   1655                                          PRIV             1655,1696,2810                    
 SHAPE                      Func   1548                                 scalar                    1548                              
 SIZE                       Func   1545                                 scalar                    1545,1552,1553,1554,1555,1560,1589
                                                                                                  ,1612,1635,1658,1680,1685,1690,169
                                                                                                  5                                 
 TRIM                       Func   1663                                 scalar                    1663,1699                         
 UNLIM_DIM_LEVEL            Dummy  1492     I(4)            4           scalar   ARG,IN           1540,1574,1597,1620,1643          
 VARIABLE_NAME              Dummy  1492     CHAR                        scalar   ARG,IN           1537,1539,1573,1596,1619,1642,1663
                                                                                                  ,1699                             
 VDATA                      Dummy  1492     RECORD                4     1        ARG,INOUT        1539,1545,1548,1569,1677          
 VDATA                      Local  1569     I(4)            4     4     1                         1586                              
 VDATA                      Local  1569     I(8)            8     4     1                         1609                              
 VDATA                      Local  1569     R(4)            4     4     1                         1632                              
 VDATA                      Local  1569     R(8)            8     4     1                         1655                              
 VDATA                      Local  1569     RECORD                4     1                                                           
 VDATA                      Local  1677     I(4)            4     4     1                         1681                              
 VDATA                      Local  1677     I(8)            8     4     1                         1686                              
 VDATA                      Local  1677     R(4)            4     4     1                         1691                              
 VDATA                      Local  1677     R(8)            8     4     1                         1696                              
 VDATA                      Local  1677     RECORD                4     1                                                           
 XC_SIZE                    Local  1519     I(4)            4           scalar                    1546,1675                         
 XDIM_INDEX                 Local  1511     I(4)            4           scalar                    1538,1545,1561,1564,1567,1580,1583
                                                                                                  ,1603,1606,1626,1629,1649,1652,167
                                                                                                  2,1675                            
 XGMIN                      Local  1534     I(4)            4           scalar                    1558,1564                         
 XPOS                       Local  1514     I(4)            4           scalar                    1538,1546,1556,1558               
 YC_SIZE                    Local  1522     I(4)            4           scalar                    1546,1676                         
 YDIM_INDEX                 Local  1512     I(4)            4           scalar                    1538,1545,1562,1565,1568,1581,1584
                                                                                                  ,1604,1607,1627,1630,1650,1653,167
                                                                                                  3,1676                            
 YGMIN                      Local  1535     I(4)            4           scalar                    1559,1565                         
 YPOS                       Local  1515     I(4)            4           scalar                    1538,1546,1557,1559               

Page 54          Source Listing                  DOMAIN_READ_5D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_read.inc



ENTRY POINTS

  Name                                                   
                                                         
 fms_netcdf_domain_io_mod_mp_domain_read_5d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ALLOCATE_ARRAY_I4_KIND_5D  Subr   1791                                          PRIV             1791,1899,2980,3015,3143          
 ALLOCATE_ARRAY_I8_KIND_5D  Subr   1815                                          PRIV             1815,1904,2986,3038,3149          
 ALLOCATE_ARRAY_R4_KIND_5D  Subr   1838                                          PRIV             1838,1909,2992,3061,3155          
 ALLOCATE_ARRAY_R8_KIND_5D  Subr   1861                                          PRIV             1861,1914,2998,3084,3161          
 BUFFER_INCLUDES_HALOS      Local  1751     L(4)            4           scalar                    1764,1798,1821,1844,1867,1891     
 BUF_I4_KIND                Local  1747     I(4)            4     5     1        ALC              1791,1792,1806,1809,1812,1899,1900
                                                                                                  ,1901,1902                        
 BUF_I8_KIND                Local  1748     I(8)            8     5     1        ALC              1815,1816,1829,1832,1835,1904,1905
                                                                                                  ,1906,1907                        
 BUF_R4_KIND                Local  1749     R(4)            4     5     1        ALC              1838,1839,1852,1855,1858,1909,1910
                                                                                                  ,1911,1912                        
 BUF_R8_KIND                Local  1750     R(8)            8     5     1        ALC              1861,1862,1875,1878,1881,1914,1915
                                                                                                  ,1916,1917                        
 C                          Local  1745     I(4)            4     1     5        TGT              1765,1780,1781,1783,1784,1794,1800
                                                                                                  ,1801,1803,1804,1806,1818,1823,182
                                                                                                  4,1826,1827,1829,1841,1846,1847,18
                                                                                                  49,1850,1852,1864,1869,1870,1872,1
                                                                                                  873,1875,1892,1893,1901,1906,1911,
                                                                                                  1916                              
 CORNER                     Dummy  1711     I(4)            4     1     5        ARG,TGT,IN       1758                              
 DOMAIN_READ_5D             Subr   1710                                                                                             
 E                          Local  1746     I(4)            4     1     5        TGT              1766,1786,1787,1791,1794,1806,1815
                                                                                                  ,1818,1829,1838,1841,1852,1861,186
                                                                                                  4,1875,1895,1896,1899,1901,1904,19
                                                                                                  06,1909,1911,1914,1916            
 EDGE_LENGTHS               Dummy  1711     I(4)            4     1     5        ARG,TGT,IN       1759                              
 FILEOBJ                    Dummy  1710     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           1755,1757,1762,1763,1769,1770,1771
                                                                                                  ,1772,1773,1778,1782,1792,1809,181
                                                                                                  6,1832,1839,1855,1862,1878,1883,19
                                                                                                  00,1905,1910,1915,1919            
 I                          Local  1734     I(4)            4           scalar                    1778,1780,1781,1786,1787,1795,1809
                                                                                                  ,1819,1832,1842,1855,1865,1878    
 IO_DOMAIN                  Local  1731     DOMAIN2D        752         scalar   PTR              1762,1774,1775,1776,1777          
 ISC                        Local  1736     I(4)            4           scalar                    1764,1800,1823,1846,1869,1892     
 ISD                        Local  1735     I(4)            4           scalar                    1764,1800,1823,1846,1869,1892     
 JSC                        Local  1739     I(4)            4           scalar                    1764,1801,1824,1847,1870,1893     
 JSD                        Local  1738     I(4)            4           scalar                    1764,1801,1824,1847,1870,1893     
 MPP_RECV_INT4_5D           Subr   1900                                          PRIV             1900,3032                         
 MPP_RECV_INT8_5D           Subr   1905                                          PRIV             1905,3055                         
 MPP_RECV_REAL4_5D          Subr   1910                                          PRIV             1910,3078                         
 MPP_RECV_REAL8_5D          Subr   1915                                          PRIV             1915,3101                         
 MPP_SEND_INT4_5D           Subr   1809                                          PRIV             1809,3145                         
 MPP_SEND_INT8_5D           Subr   1832                                          PRIV             1832,3151                         

Page 55          Source Listing                  DOMAIN_READ_5D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_read.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPP_SEND_REAL4_5D          Subr   1855                                          PRIV             1855,3157                         
 MPP_SEND_REAL8_5D          Subr   1878                                          PRIV             1878,3163                         
 NETCDF_READ_DATA_5D        Subr   1757                                          PRIV             1757,1792,1816,1839,1862          
 PE_ICSIZE                  Local  1742     I(4)            4     1     1        ALC              1771,1774,1786,1887               
 PE_ISC                     Local  1741     I(4)            4     1     1        ALC              1770,1774,1780,1886               
 PE_JCSIZE                  Local  1744     I(4)            4     1     1        ALC              1773,1775,1787,1889               
 PE_JSC                     Local  1743     I(4)            4     1     1        ALC              1772,1775,1781,1888               
 PUT_ARRAY_SECTION_I4_KIND_                                                                                                         
 5D                         Subr   1806                                          PRIV             1806,1901,3035                    
 PUT_ARRAY_SECTION_I8_KIND_                                                                                                         
 5D                         Subr   1829                                          PRIV             1829,1906,3058                    
 PUT_ARRAY_SECTION_R4_KIND_                                                                                                         
 5D                         Subr   1852                                          PRIV             1852,1911,3081                    
 PUT_ARRAY_SECTION_R8_KIND_                                                                                                         
 5D                         Subr   1875                                          PRIV             1875,1916,3104                    
 SHAPE                      Func   1766                                 scalar                    1766                              
 SIZE                       Func   1763                                 scalar                    1763,1770,1771,1772,1773,1778,1809
                                                                                                  ,1832,1855,1878,1900,1905,1910,191
                                                                                                  5                                 
 TRIM                       Func   1883                                 scalar                    1883,1919                         
 UNLIM_DIM_LEVEL            Dummy  1710     I(4)            4           scalar   ARG,IN           1758,1793,1817,1840,1863          
 VARIABLE_NAME              Dummy  1710     CHAR                        scalar   ARG,IN           1755,1757,1792,1816,1839,1862,1883
                                                                                                  ,1919                             
 VDATA                      Dummy  1710     RECORD                5     1        ARG,INOUT        1757,1763,1766,1788,1897          
 VDATA                      Local  1788     I(4)            4     5     1                         1806                              
 VDATA                      Local  1788     I(8)            8     5     1                         1829                              
 VDATA                      Local  1788     R(4)            4     5     1                         1852                              
 VDATA                      Local  1788     R(8)            8     5     1                         1875                              
 VDATA                      Local  1788     RECORD                5     1                                                           
 VDATA                      Local  1897     I(4)            4     5     1                         1901                              
 VDATA                      Local  1897     I(8)            8     5     1                         1906                              
 VDATA                      Local  1897     R(4)            4     5     1                         1911                              
 VDATA                      Local  1897     R(8)            8     5     1                         1916                              
 VDATA                      Local  1897     RECORD                5     1                                                           
 XC_SIZE                    Local  1737     I(4)            4           scalar                    1764,1895                         
 XDIM_INDEX                 Local  1729     I(4)            4           scalar                    1756,1763,1780,1783,1786,1800,1803
                                                                                                  ,1823,1826,1846,1849,1869,1872,189
                                                                                                  2,1895                            
 XGMIN                      Local  1752     I(4)            4           scalar                    1776,1783                         
 XPOS                       Local  1732     I(4)            4           scalar                    1756,1764,1774,1776               
 YC_SIZE                    Local  1740     I(4)            4           scalar                    1764,1896                         
 YDIM_INDEX                 Local  1730     I(4)            4           scalar                    1756,1763,1781,1784,1787,1801,1804
                                                                                                  ,1824,1827,1847,1850,1870,1873,189
                                                                                                  3,1896                            
 YGMIN                      Local  1753     I(4)            4           scalar                    1777,1784                         
 YPOS                       Local  1733     I(4)            4           scalar                    1756,1764,1775,1777               

Page 56          Source Listing                  DOMAIN_READ_5D
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

   1923 include "domain_write.inc"


ENTRY POINTS

  Name                                                    
                                                          
 fms_netcdf_domain_io_mod_mp_domain_write_0d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPRESSED_WRITE           Local  1961                                 scalar   PRIV             1961,1990,2060,2354,2648,2942     
 COMPRESSED_WRITE_0D        Subr   1961                                          PRIV             1961                              
 CORNER                     Dummy  1947     I(4)            4           scalar   ARG,IN           1962                              
 DOMAIN_WRITE_0D            Subr   1947                                                                                             
 FILEOBJ                    Dummy  1947     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           1961                              
 UNLIM_DIM_LEVEL            Dummy  1947     I(4)            4           scalar   ARG,IN           1962                              
 VARIABLE_NAME              Dummy  1947     CHAR                        scalar   ARG,IN           1961                              
 VDATA                      Dummy  1947     RECORD                      scalar   ARG,IN           1961                              

Page 57          Source Listing                  DOMAIN_WRITE_1D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_write.inc



ENTRY POINTS

  Name                                                    
                                                          
 fms_netcdf_domain_io_mod_mp_domain_write_1d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 COMPRESSED_WRITE_1D        Subr   1990                                          PRIV             1990                              
 CORNER                     Dummy  1972     I(4)            4     1     1        ARG,IN           1991                              
 DOMAIN_WRITE_1D            Subr   1971                                                                                             
 EDGE_LENGTHS               Dummy  1972     I(4)            4     1     1        ARG,IN           1992                              
 FILEOBJ                    Dummy  1971     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           1990                              
 UNLIM_DIM_LEVEL            Dummy  1971     I(4)            4           scalar   ARG,IN           1991                              
 VARIABLE_NAME              Dummy  1971     CHAR                        scalar   ARG,IN           1990                              
 VDATA                      Dummy  1971     RECORD                1     1        ARG,IN           1990                              

Page 58          Source Listing                  DOMAIN_WRITE_2D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_write.inc



ENTRY POINTS

  Name                                                    
                                                          
 fms_netcdf_domain_io_mod_mp_domain_write_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFFER_INCLUDES_HALOS      Local  2024     L(4)            4           scalar                    2068,2137,2160,2183,2206,2253     
 BUF_I4_KIND                Local  2020     I(4)            4     2     1        ALC              2133,2145,2150,2153,2154,2261,2262
                                                                                                  ,2263,2265                        
 BUF_I8_KIND                Local  2021     I(8)            8     2     1        ALC              2156,2168,2173,2176,2177,2267,2268
                                                                                                  ,2269,2271                        
 BUF_R4_KIND                Local  2022     R(4)            4     2     1        ALC              2179,2191,2196,2199,2200,2273,2274
                                                                                                  ,2275,2277                        
 BUF_R8_KIND                Local  2023     R(8)            8     2     1        ALC              2202,2214,2219,2222,2223,2279,2280
                                                                                                  ,2281,2283                        
 C                          Local  2025     I(4)            4     1     2                         2069,2127,2128,2139,2140,2142,2143
                                                                                                  ,2145,2146,2147,2153,2162,2163,216
                                                                                                  5,2166,2168,2169,2170,2176,2185,21
                                                                                                  86,2188,2189,2191,2192,2193,2199,2
                                                                                                  208,2209,2211,2212,2214,2215,2216,
                                                                                                  2222,2254,2255,2262,2268,2274,2280
 COMPRESSED_WRITE_2D        Subr   2060                                          PRIV             2060                              
 CORNER                     Dummy  2002     I(4)            4     1     2        ARG,IN           2061                              
 DOMAIN_WRITE_2D            Subr   2001                                                                                             
 E                          Local  2026     I(4)            4     1     2                         2070,2091,2092,2098,2104,2110,2116
                                                                                                  ,2129,2130,2133,2145,2153,2156,216
                                                                                                  8,2176,2179,2191,2199,2202,2214,22
                                                                                                  22,2257,2258,2261,2262,2267,2268,2
                                                                                                  273,2274,2279,2280                
 EDGE_LENGTHS               Dummy  2002     I(4)            4     1     2        ARG,IN           2062                              
 FILEOBJ                    Dummy  2001     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           2058,2060,2065,2066,2073,2074,2075
                                                                                                  ,2076,2079,2080,2081,2100,2106,211
                                                                                                  2,2118,2125,2150,2173,2196,2219,22
                                                                                                  36,2240,2244,2248,2263,2269,2275,2
                                                                                                  281                               
 FILL_I4_KIND               Local  2049     R(4)            4           scalar                    2100,2101                         
 FILL_I8_KIND               Local  2050     R(8)            8           scalar                    2106,2107                         
 FILL_R4_KIND               Local  2051     R(4)            4           scalar                    2112,2113                         
 FILL_R8_KIND               Local  2052     R(8)            8           scalar                    2118,2119                         
 GET_ARRAY_SECTION          Local  2145                                 scalar   PRIV             2145,2168,2191,2214,2262,2268,2274
                                                                                                  ,2280,2439,2462,2485,2508,2556,256
                                                                                                  2,2568,2574,2733,2756,2779,2802,28
                                                                                                  50,2856,2862,2868,3027,3050,3073,3
                                                                                                  096,3144,3150,3156,3162,3264,3273,
                                                                                                  3282,3291,3378,3387,3396,3405,3493
                                                                                                  ,3502,3511,3520                   
 GET_ARRAY_SECTION_I4_KIND_                                                                                                         
 2D                         Subr   2145                                          PRIV             2145,2262,3264                    
 GET_ARRAY_SECTION_I8_KIND_                                                                                                         

Page 59          Source Listing                  DOMAIN_WRITE_2D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_write.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 2D                         Subr   2168                                          PRIV             2168,2268,3273                    
 GET_ARRAY_SECTION_R4_KIND_                                                                                                         
 2D                         Subr   2191                                          PRIV             2191,2274,3282                    
 GET_ARRAY_SECTION_R8_KIND_                                                                                                         
 2D                         Subr   2214                                          PRIV             2214,2280,3291                    
 GET_FILL_VALUE             Func   2100     L(4)            4           scalar   PRIV             2100,2106,2112,2118,2394,2400,2406
                                                                                                  ,2412,2688,2694,2700,2706,2982,298
                                                                                                  8,2994,3000,3265,3274,3283,3292,33
                                                                                                  79,3388,3397,3406,3494,3503,3512,3
                                                                                                  521                               
 GLOBAL_BUF_I4_KIND         Local  2027     I(4)            4     2     1        ALC              2098,2099,2101,2153,2236,2238     
 GLOBAL_BUF_I8_KIND         Local  2028     I(8)            8     2     1        ALC              2104,2105,2107,2176,2240,2242     
 GLOBAL_BUF_R4_KIND         Local  2029     R(4)            4     2     1        ALC              2110,2111,2113,2199,2244,2246     
 GLOBAL_BUF_R8_KIND         Local  2030     R(8)            8     2     1        ALC              2116,2117,2119,2222,2248,2250     
 I                          Local  2031     I(4)            4           scalar                    2125,2127,2128,2129,2130,2135,2146
                                                                                                  ,2147,2150,2158,2169,2170,2173,218
                                                                                                  1,2192,2193,2196,2204,2215,2216,22
                                                                                                  19                                
 IO_DOMAIN                  Local  2032     DOMAIN2D        752         scalar   PTR              2065,2077,2082,2086,2087          
 ISC                        Local  2033     I(4)            4           scalar                    2067,2139,2162,2185,2208,2254     
 ISD                        Local  2034     I(4)            4           scalar                    2067,2139,2162,2185,2208,2254     
 JSC                        Local  2035     I(4)            4           scalar                    2067,2140,2163,2186,2209,2255     
 JSD                        Local  2036     I(4)            4           scalar                    2067,2140,2163,2186,2209,2255     
 NETCDF_WRITE_DATA          Local  2236                                 scalar   PRIV             2236,2240,2244,2248,2530,2534,2538
                                                                                                  ,2542,2824,2828,2832,2836,3118,312
                                                                                                  2,3126,3130                       
 NETCDF_WRITE_DATA_2D       Subr   2236                                          PRIV             2236,2240,2244,2248               
 PE_ICSIZE                  Local  2037     I(4)            4     1     1        ALC              2076,2077,2129,2228               
 PE_IEC                     Local  2038     I(4)            4     1     1        ALC              2075,2077,2227                    
 PE_ISC                     Local  2039     I(4)            4     1     1        ALC              2074,2077,2127,2146,2169,2192,2215
                                                                                                  ,2226                             
 PE_JCSIZE                  Local  2040     I(4)            4     1     1        ALC              2081,2082,2130,2231               
 PE_JEC                     Local  2041     I(4)            4     1     1        ALC              2080,2082,2230                    
 PE_JSC                     Local  2042     I(4)            4     1     1        ALC              2079,2082,2128,2147,2170,2193,2216
                                                                                                  ,2229                             
 SHAPE                      Func   2070                                 scalar                    2070                              
 SIZE                       Func   2066                                 scalar                    2066,2074,2075,2076,2079,2080,2081
                                                                                                  ,2125,2150,2173,2196,2219,2263,226
                                                                                                  9,2275,2281                       
 UNLIM_DIM_LEVEL            Dummy  2001     I(4)            4           scalar   ARG,IN           2061,2237,2241,2245,2249          
 VARIABLE_NAME              Dummy  2001     CHAR                        scalar   ARG,IN           2058,2060,2100,2106,2112,2118,2236
                                                                                                  ,2240,2244,2248                   
 VDATA                      Dummy  2001     RECORD                2     1        ARG,IN           2060,2066,2070,2096,2131,2234,2259
 VDATA                      Local  2096     I(4)            4     2     1                                                           
 VDATA                      Local  2096     I(8)            8     2     1                                                           
 VDATA                      Local  2096     R(4)            4     2     1                                                           
 VDATA                      Local  2096     R(8)            8     2     1                                                           
 VDATA                      Local  2096     RECORD                2     1                                                           
 VDATA                      Local  2131     I(4)            4     2     1                         2145                              
 VDATA                      Local  2131     I(8)            8     2     1                         2168                              
 VDATA                      Local  2131     R(4)            4     2     1                         2191                              
 VDATA                      Local  2131     R(8)            8     2     1                         2214                              
 VDATA                      Local  2234     I(4)            4     2     1                                                           
 VDATA                      Local  2234     I(8)            8     2     1                                                           
 VDATA                      Local  2234     R(4)            4     2     1                                                           

Page 60          Source Listing                  DOMAIN_WRITE_2D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_write.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 VDATA                      Local  2234     R(8)            8     2     1                                                           
 VDATA                      Local  2259     I(4)            4     2     1                         2262                              
 VDATA                      Local  2259     I(8)            8     2     1                         2268                              
 VDATA                      Local  2259     R(4)            4     2     1                         2274                              
 VDATA                      Local  2259     R(8)            8     2     1                         2280                              
 VDATA                      Local  2259     RECORD                2     1                                                           
 XC_SIZE                    Local  2043     I(4)            4           scalar                    2067,2257                         
 XDIM_INDEX                 Local  2044     I(4)            4           scalar                    2059,2066,2091,2127,2129,2139,2142
                                                                                                  ,2146,2162,2165,2169,2185,2188,219
                                                                                                  2,2208,2211,2215,2254,2257        
 XGMAX                      Local  2053     I(4)            4           scalar                    2087,2091                         
 XGMIN                      Local  2054     I(4)            4           scalar                    2087,2091,2127,2146,2169,2192,2215
 XPOS                       Local  2045     I(4)            4           scalar                    2059,2067,2078,2087               
 YC_SIZE                    Local  2048     I(4)            4           scalar                    2067,2258                         
 YDIM_INDEX                 Local  2046     I(4)            4           scalar                    2059,2066,2092,2128,2130,2140,2143
                                                                                                  ,2147,2163,2166,2170,2186,2189,219
                                                                                                  3,2209,2212,2216,2255,2258        
 YGMAX                      Local  2055     I(4)            4           scalar                    2086,2092                         
 YGMIN                      Local  2056     I(4)            4           scalar                    2086,2092,2128,2147,2170,2193,2216
 YPOS                       Local  2047     I(4)            4           scalar                    2059,2067,2083,2086               

Page 61          Source Listing                  DOMAIN_WRITE_3D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_write.inc



ENTRY POINTS

  Name                                                    
                                                          
 fms_netcdf_domain_io_mod_mp_domain_write_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFFER_INCLUDES_HALOS      Local  2318     L(4)            4           scalar                    2362,2431,2454,2477,2500,2547     
 BUF_I4_KIND                Local  2314     I(4)            4     3     1        ALC              2427,2439,2444,2447,2448,2555,2556
                                                                                                  ,2557,2559                        
 BUF_I8_KIND                Local  2315     I(8)            8     3     1        ALC              2450,2462,2467,2470,2471,2561,2562
                                                                                                  ,2563,2565                        
 BUF_R4_KIND                Local  2316     R(4)            4     3     1        ALC              2473,2485,2490,2493,2494,2567,2568
                                                                                                  ,2569,2571                        
 BUF_R8_KIND                Local  2317     R(8)            8     3     1        ALC              2496,2508,2513,2516,2517,2573,2574
                                                                                                  ,2575,2577                        
 C                          Local  2319     I(4)            4     1     3                         2363,2421,2422,2433,2434,2436,2437
                                                                                                  ,2439,2440,2441,2447,2456,2457,245
                                                                                                  9,2460,2462,2463,2464,2470,2479,24
                                                                                                  80,2482,2483,2485,2486,2487,2493,2
                                                                                                  502,2503,2505,2506,2508,2509,2510,
                                                                                                  2516,2548,2549,2556,2562,2568,2574
 COMPRESSED_WRITE_3D        Subr   2354                                          PRIV             2354                              
 CORNER                     Dummy  2296     I(4)            4     1     3        ARG,IN           2355                              
 DOMAIN_WRITE_3D            Subr   2295                                                                                             
 E                          Local  2320     I(4)            4     1     3                         2364,2385,2386,2392,2398,2404,2410
                                                                                                  ,2423,2424,2427,2439,2447,2450,246
                                                                                                  2,2470,2473,2485,2493,2496,2508,25
                                                                                                  16,2551,2552,2555,2556,2561,2562,2
                                                                                                  567,2568,2573,2574                
 EDGE_LENGTHS               Dummy  2296     I(4)            4     1     3        ARG,IN           2356                              
 FILEOBJ                    Dummy  2295     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           2352,2354,2359,2360,2367,2368,2369
                                                                                                  ,2370,2373,2374,2375,2394,2400,240
                                                                                                  6,2412,2419,2444,2467,2490,2513,25
                                                                                                  30,2534,2538,2542,2557,2563,2569,2
                                                                                                  575                               
 FILL_I4_KIND               Local  2343     R(4)            4           scalar                    2394,2395                         
 FILL_I8_KIND               Local  2344     R(8)            8           scalar                    2400,2401                         
 FILL_R4_KIND               Local  2345     R(4)            4           scalar                    2406,2407                         
 FILL_R8_KIND               Local  2346     R(8)            8           scalar                    2412,2413                         
 GET_ARRAY_SECTION_I4_KIND_                                                                                                         
 3D                         Subr   2439                                          PRIV             2439,2556,3378                    
 GET_ARRAY_SECTION_I8_KIND_                                                                                                         
 3D                         Subr   2462                                          PRIV             2462,2562,3387                    
 GET_ARRAY_SECTION_R4_KIND_                                                                                                         
 3D                         Subr   2485                                          PRIV             2485,2568,3396                    
 GET_ARRAY_SECTION_R8_KIND_                                                                                                         
 3D                         Subr   2508                                          PRIV             2508,2574,3405                    
 GLOBAL_BUF_I4_KIND         Local  2321     I(4)            4     3     1        ALC              2392,2393,2395,2447,2530,2532     
 GLOBAL_BUF_I8_KIND         Local  2322     I(8)            8     3     1        ALC              2398,2399,2401,2470,2534,2536     

Page 62          Source Listing                  DOMAIN_WRITE_3D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_write.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 GLOBAL_BUF_R4_KIND         Local  2323     R(4)            4     3     1        ALC              2404,2405,2407,2493,2538,2540     
 GLOBAL_BUF_R8_KIND         Local  2324     R(8)            8     3     1        ALC              2410,2411,2413,2516,2542,2544     
 I                          Local  2325     I(4)            4           scalar                    2419,2421,2422,2423,2424,2429,2440
                                                                                                  ,2441,2444,2452,2463,2464,2467,247
                                                                                                  5,2486,2487,2490,2498,2509,2510,25
                                                                                                  13                                
 IO_DOMAIN                  Local  2326     DOMAIN2D        752         scalar   PTR              2359,2371,2376,2380,2381          
 ISC                        Local  2327     I(4)            4           scalar                    2361,2433,2456,2479,2502,2548     
 ISD                        Local  2328     I(4)            4           scalar                    2361,2433,2456,2479,2502,2548     
 JSC                        Local  2329     I(4)            4           scalar                    2361,2434,2457,2480,2503,2549     
 JSD                        Local  2330     I(4)            4           scalar                    2361,2434,2457,2480,2503,2549     
 NETCDF_WRITE_DATA_3D       Subr   2530                                          PRIV             2530,2534,2538,2542               
 PE_ICSIZE                  Local  2331     I(4)            4     1     1        ALC              2370,2371,2423,2522               
 PE_IEC                     Local  2332     I(4)            4     1     1        ALC              2369,2371,2521                    
 PE_ISC                     Local  2333     I(4)            4     1     1        ALC              2368,2371,2421,2440,2463,2486,2509
                                                                                                  ,2520                             
 PE_JCSIZE                  Local  2334     I(4)            4     1     1        ALC              2375,2376,2424,2525               
 PE_JEC                     Local  2335     I(4)            4     1     1        ALC              2374,2376,2524                    
 PE_JSC                     Local  2336     I(4)            4     1     1        ALC              2373,2376,2422,2441,2464,2487,2510
                                                                                                  ,2523                             
 SHAPE                      Func   2364                                 scalar                    2364                              
 SIZE                       Func   2360                                 scalar                    2360,2368,2369,2370,2373,2374,2375
                                                                                                  ,2419,2444,2467,2490,2513,2557,256
                                                                                                  3,2569,2575                       
 UNLIM_DIM_LEVEL            Dummy  2295     I(4)            4           scalar   ARG,IN           2355,2531,2535,2539,2543          
 VARIABLE_NAME              Dummy  2295     CHAR                        scalar   ARG,IN           2352,2354,2394,2400,2406,2412,2530
                                                                                                  ,2534,2538,2542                   
 VDATA                      Dummy  2295     RECORD                3     1        ARG,IN           2354,2360,2364,2390,2425,2528,2553
 VDATA                      Local  2390     I(4)            4     3     1                                                           
 VDATA                      Local  2390     I(8)            8     3     1                                                           
 VDATA                      Local  2390     R(4)            4     3     1                                                           
 VDATA                      Local  2390     R(8)            8     3     1                                                           
 VDATA                      Local  2390     RECORD                3     1                                                           
 VDATA                      Local  2425     I(4)            4     3     1                         2439                              
 VDATA                      Local  2425     I(8)            8     3     1                         2462                              
 VDATA                      Local  2425     R(4)            4     3     1                         2485                              
 VDATA                      Local  2425     R(8)            8     3     1                         2508                              
 VDATA                      Local  2528     I(4)            4     3     1                                                           
 VDATA                      Local  2528     I(8)            8     3     1                                                           
 VDATA                      Local  2528     R(4)            4     3     1                                                           
 VDATA                      Local  2528     R(8)            8     3     1                                                           
 VDATA                      Local  2553     I(4)            4     3     1                         2556                              
 VDATA                      Local  2553     I(8)            8     3     1                         2562                              
 VDATA                      Local  2553     R(4)            4     3     1                         2568                              
 VDATA                      Local  2553     R(8)            8     3     1                         2574                              
 VDATA                      Local  2553     RECORD                3     1                                                           
 XC_SIZE                    Local  2337     I(4)            4           scalar                    2361,2551                         
 XDIM_INDEX                 Local  2338     I(4)            4           scalar                    2353,2360,2385,2421,2423,2433,2436
                                                                                                  ,2440,2456,2459,2463,2479,2482,248
                                                                                                  6,2502,2505,2509,2548,2551        
 XGMAX                      Local  2347     I(4)            4           scalar                    2381,2385                         
 XGMIN                      Local  2348     I(4)            4           scalar                    2381,2385,2421,2440,2463,2486,2509
 XPOS                       Local  2339     I(4)            4           scalar                    2353,2361,2372,2381               
 YC_SIZE                    Local  2342     I(4)            4           scalar                    2361,2552                         
 YDIM_INDEX                 Local  2340     I(4)            4           scalar                    2353,2360,2386,2422,2424,2434,2437

Page 63          Source Listing                  DOMAIN_WRITE_3D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_write.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,2441,2457,2460,2464,2480,2483,248
                                                                                                  7,2503,2506,2510,2549,2552        
 YGMAX                      Local  2349     I(4)            4           scalar                    2380,2386                         
 YGMIN                      Local  2350     I(4)            4           scalar                    2380,2386,2422,2441,2464,2487,2510
 YPOS                       Local  2341     I(4)            4           scalar                    2353,2361,2377,2380               

Page 64          Source Listing                  DOMAIN_WRITE_4D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_write.inc



ENTRY POINTS

  Name                                                    
                                                          
 fms_netcdf_domain_io_mod_mp_domain_write_4d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFFER_INCLUDES_HALOS      Local  2612     L(4)            4           scalar                    2656,2725,2748,2771,2794,2841     
 BUF_I4_KIND                Local  2608     I(4)            4     4     1        ALC              2721,2733,2738,2741,2742,2849,2850
                                                                                                  ,2851,2853                        
 BUF_I8_KIND                Local  2609     I(8)            8     4     1        ALC              2744,2756,2761,2764,2765,2855,2856
                                                                                                  ,2857,2859                        
 BUF_R4_KIND                Local  2610     R(4)            4     4     1        ALC              2767,2779,2784,2787,2788,2861,2862
                                                                                                  ,2863,2865                        
 BUF_R8_KIND                Local  2611     R(8)            8     4     1        ALC              2790,2802,2807,2810,2811,2867,2868
                                                                                                  ,2869,2871                        
 C                          Local  2613     I(4)            4     1     4                         2657,2715,2716,2727,2728,2730,2731
                                                                                                  ,2733,2734,2735,2741,2750,2751,275
                                                                                                  3,2754,2756,2757,2758,2764,2773,27
                                                                                                  74,2776,2777,2779,2780,2781,2787,2
                                                                                                  796,2797,2799,2800,2802,2803,2804,
                                                                                                  2810,2842,2843,2850,2856,2862,2868
 COMPRESSED_WRITE_4D        Subr   2648                                          PRIV             2648                              
 CORNER                     Dummy  2590     I(4)            4     1     4        ARG,IN           2649                              
 DOMAIN_WRITE_4D            Subr   2589                                                                                             
 E                          Local  2614     I(4)            4     1     4                         2658,2679,2680,2686,2692,2698,2704
                                                                                                  ,2717,2718,2721,2733,2741,2744,275
                                                                                                  6,2764,2767,2779,2787,2790,2802,28
                                                                                                  10,2845,2846,2849,2850,2855,2856,2
                                                                                                  861,2862,2867,2868                
 EDGE_LENGTHS               Dummy  2590     I(4)            4     1     4        ARG,IN           2650                              
 FILEOBJ                    Dummy  2589     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           2646,2648,2653,2654,2661,2662,2663
                                                                                                  ,2664,2667,2668,2669,2688,2694,270
                                                                                                  0,2706,2713,2738,2761,2784,2807,28
                                                                                                  24,2828,2832,2836,2851,2857,2863,2
                                                                                                  869                               
 FILL_I4_KIND               Local  2637     R(4)            4           scalar                    2688,2689                         
 FILL_I8_KIND               Local  2638     R(8)            8           scalar                    2694,2695                         
 FILL_R4_KIND               Local  2639     R(4)            4           scalar                    2700,2701                         
 FILL_R8_KIND               Local  2640     R(8)            8           scalar                    2706,2707                         
 GET_ARRAY_SECTION_I4_KIND_                                                                                                         
 4D                         Subr   2733                                          PRIV             2733,2850,3493                    
 GET_ARRAY_SECTION_I8_KIND_                                                                                                         
 4D                         Subr   2756                                          PRIV             2756,2856,3502                    
 GET_ARRAY_SECTION_R4_KIND_                                                                                                         
 4D                         Subr   2779                                          PRIV             2779,2862,3511                    
 GET_ARRAY_SECTION_R8_KIND_                                                                                                         
 4D                         Subr   2802                                          PRIV             2802,2868,3520                    
 GLOBAL_BUF_I4_KIND         Local  2615     I(4)            4     4     1        ALC              2686,2687,2689,2741,2824,2826     
 GLOBAL_BUF_I8_KIND         Local  2616     I(8)            8     4     1        ALC              2692,2693,2695,2764,2828,2830     

Page 65          Source Listing                  DOMAIN_WRITE_4D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_write.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 GLOBAL_BUF_R4_KIND         Local  2617     R(4)            4     4     1        ALC              2698,2699,2701,2787,2832,2834     
 GLOBAL_BUF_R8_KIND         Local  2618     R(8)            8     4     1        ALC              2704,2705,2707,2810,2836,2838     
 I                          Local  2619     I(4)            4           scalar                    2713,2715,2716,2717,2718,2723,2734
                                                                                                  ,2735,2738,2746,2757,2758,2761,276
                                                                                                  9,2780,2781,2784,2792,2803,2804,28
                                                                                                  07                                
 IO_DOMAIN                  Local  2620     DOMAIN2D        752         scalar   PTR              2653,2665,2670,2674,2675          
 ISC                        Local  2621     I(4)            4           scalar                    2655,2727,2750,2773,2796,2842     
 ISD                        Local  2622     I(4)            4           scalar                    2655,2727,2750,2773,2796,2842     
 JSC                        Local  2623     I(4)            4           scalar                    2655,2728,2751,2774,2797,2843     
 JSD                        Local  2624     I(4)            4           scalar                    2655,2728,2751,2774,2797,2843     
 NETCDF_WRITE_DATA_4D       Subr   2824                                          PRIV             2824,2828,2832,2836               
 PE_ICSIZE                  Local  2625     I(4)            4     1     1        ALC              2664,2665,2717,2816               
 PE_IEC                     Local  2626     I(4)            4     1     1        ALC              2663,2665,2815                    
 PE_ISC                     Local  2627     I(4)            4     1     1        ALC              2662,2665,2715,2734,2757,2780,2803
                                                                                                  ,2814                             
 PE_JCSIZE                  Local  2628     I(4)            4     1     1        ALC              2669,2670,2718,2819               
 PE_JEC                     Local  2629     I(4)            4     1     1        ALC              2668,2670,2818                    
 PE_JSC                     Local  2630     I(4)            4     1     1        ALC              2667,2670,2716,2735,2758,2781,2804
                                                                                                  ,2817                             
 SHAPE                      Func   2658                                 scalar                    2658                              
 SIZE                       Func   2654                                 scalar                    2654,2662,2663,2664,2667,2668,2669
                                                                                                  ,2713,2738,2761,2784,2807,2851,285
                                                                                                  7,2863,2869                       
 UNLIM_DIM_LEVEL            Dummy  2589     I(4)            4           scalar   ARG,IN           2649,2825,2829,2833,2837          
 VARIABLE_NAME              Dummy  2589     CHAR                        scalar   ARG,IN           2646,2648,2688,2694,2700,2706,2824
                                                                                                  ,2828,2832,2836                   
 VDATA                      Dummy  2589     RECORD                4     1        ARG,IN           2648,2654,2658,2684,2719,2822,2847
 VDATA                      Local  2684     I(4)            4     4     1                                                           
 VDATA                      Local  2684     I(8)            8     4     1                                                           
 VDATA                      Local  2684     R(4)            4     4     1                                                           
 VDATA                      Local  2684     R(8)            8     4     1                                                           
 VDATA                      Local  2684     RECORD                4     1                                                           
 VDATA                      Local  2719     I(4)            4     4     1                         2733                              
 VDATA                      Local  2719     I(8)            8     4     1                         2756                              
 VDATA                      Local  2719     R(4)            4     4     1                         2779                              
 VDATA                      Local  2719     R(8)            8     4     1                         2802                              
 VDATA                      Local  2822     I(4)            4     4     1                                                           
 VDATA                      Local  2822     I(8)            8     4     1                                                           
 VDATA                      Local  2822     R(4)            4     4     1                                                           
 VDATA                      Local  2822     R(8)            8     4     1                                                           
 VDATA                      Local  2847     I(4)            4     4     1                         2850                              
 VDATA                      Local  2847     I(8)            8     4     1                         2856                              
 VDATA                      Local  2847     R(4)            4     4     1                         2862                              
 VDATA                      Local  2847     R(8)            8     4     1                         2868                              
 VDATA                      Local  2847     RECORD                4     1                                                           
 XC_SIZE                    Local  2631     I(4)            4           scalar                    2655,2845                         
 XDIM_INDEX                 Local  2632     I(4)            4           scalar                    2647,2654,2679,2715,2717,2727,2730
                                                                                                  ,2734,2750,2753,2757,2773,2776,278
                                                                                                  0,2796,2799,2803,2842,2845        
 XGMAX                      Local  2641     I(4)            4           scalar                    2675,2679                         
 XGMIN                      Local  2642     I(4)            4           scalar                    2675,2679,2715,2734,2757,2780,2803
 XPOS                       Local  2633     I(4)            4           scalar                    2647,2655,2666,2675               
 YC_SIZE                    Local  2636     I(4)            4           scalar                    2655,2846                         
 YDIM_INDEX                 Local  2634     I(4)            4           scalar                    2647,2654,2680,2716,2718,2728,2731

Page 66          Source Listing                  DOMAIN_WRITE_4D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_write.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,2735,2751,2754,2758,2774,2777,278
                                                                                                  1,2797,2800,2804,2843,2846        
 YGMAX                      Local  2643     I(4)            4           scalar                    2674,2680                         
 YGMIN                      Local  2644     I(4)            4           scalar                    2674,2680,2716,2735,2758,2781,2804
 YPOS                       Local  2635     I(4)            4           scalar                    2647,2655,2671,2674               

Page 67          Source Listing                  DOMAIN_WRITE_5D
2021-06-01 08:53 Entry Points                    ../fms2_io/include/domain_write.inc



ENTRY POINTS

  Name                                                    
                                                          
 fms_netcdf_domain_io_mod_mp_domain_write_5d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFFER_INCLUDES_HALOS      Local  2906     L(4)            4           scalar                    2950,3019,3042,3065,3088,3135     
 BUF_I4_KIND                Local  2902     I(4)            4     5     1        ALC              3015,3027,3032,3035,3036,3143,3144
                                                                                                  ,3145,3147                        
 BUF_I8_KIND                Local  2903     I(8)            8     5     1        ALC              3038,3050,3055,3058,3059,3149,3150
                                                                                                  ,3151,3153                        
 BUF_R4_KIND                Local  2904     R(4)            4     5     1        ALC              3061,3073,3078,3081,3082,3155,3156
                                                                                                  ,3157,3159                        
 BUF_R8_KIND                Local  2905     R(8)            8     5     1        ALC              3084,3096,3101,3104,3105,3161,3162
                                                                                                  ,3163,3165                        
 C                          Local  2907     I(4)            4     1     5                         2951,3009,3010,3021,3022,3024,3025
                                                                                                  ,3027,3028,3029,3035,3044,3045,304
                                                                                                  7,3048,3050,3051,3052,3058,3067,30
                                                                                                  68,3070,3071,3073,3074,3075,3081,3
                                                                                                  090,3091,3093,3094,3096,3097,3098,
                                                                                                  3104,3136,3137,3144,3150,3156,3162
 COMPRESSED_WRITE_5D        Subr   2942                                          PRIV             2942                              
 CORNER                     Dummy  2884     I(4)            4     1     5        ARG,IN           2943                              
 DOMAIN_WRITE_5D            Subr   2883                                                                                             
 E                          Local  2908     I(4)            4     1     5                         2952,2973,2974,2980,2986,2992,2998
                                                                                                  ,3011,3012,3015,3027,3035,3038,305
                                                                                                  0,3058,3061,3073,3081,3084,3096,31
                                                                                                  04,3139,3140,3143,3144,3149,3150,3
                                                                                                  155,3156,3161,3162                
 EDGE_LENGTHS               Dummy  2884     I(4)            4     1     5        ARG,IN           2944                              
 FILEOBJ                    Dummy  2883     FMSNETCDFDOMAINFILE_T                                                                   
                                                            2040        scalar   ARG,IN           2940,2942,2947,2948,2955,2956,2957
                                                                                                  ,2958,2961,2962,2963,2982,2988,299
                                                                                                  4,3000,3007,3032,3055,3078,3101,31
                                                                                                  18,3122,3126,3130,3145,3151,3157,3
                                                                                                  163                               
 FILL_I4_KIND               Local  2931     R(4)            4           scalar                    2982,2983                         
 FILL_I8_KIND               Local  2932     R(8)            8           scalar                    2988,2989                         
 FILL_R4_KIND               Local  2933     R(4)            4           scalar                    2994,2995                         
 FILL_R8_KIND               Local  2934     R(8)            8           scalar                    3000,3001                         
 GET_ARRAY_SECTION_I4_KIND_                                                                                                         
 5D                         Subr   3027                                          PRIV             3027,3144                         
 GET_ARRAY_SECTION_I8_KIND_                                                                                                         
 5D                         Subr   3050                                          PRIV             3050,3150                         
 GET_ARRAY_SECTION_R4_KIND_                                                                                                         
 5D                         Subr   3073                                          PRIV             3073,3156                         
 GET_ARRAY_SECTION_R8_KIND_                                                                                                         
 5D                         Subr   3096                                          PRIV             3096,3162                         
 GLOBAL_BUF_I4_KIND         Local  2909     I(4)            4     5     1        ALC              2980,2981,2983,3035,3118,3120     
 GLOBAL_BUF_I8_KIND         Local  2910     I(8)            8     5     1        ALC              2986,2987,2989,3058,3122,3124     

Page 68          Source Listing                  DOMAIN_WRITE_5D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_write.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 GLOBAL_BUF_R4_KIND         Local  2911     R(4)            4     5     1        ALC              2992,2993,2995,3081,3126,3128     
 GLOBAL_BUF_R8_KIND         Local  2912     R(8)            8     5     1        ALC              2998,2999,3001,3104,3130,3132     
 I                          Local  2913     I(4)            4           scalar                    3007,3009,3010,3011,3012,3017,3028
                                                                                                  ,3029,3032,3040,3051,3052,3055,306
                                                                                                  3,3074,3075,3078,3086,3097,3098,31
                                                                                                  01                                
 IO_DOMAIN                  Local  2914     DOMAIN2D        752         scalar   PTR              2947,2959,2964,2968,2969          
 ISC                        Local  2915     I(4)            4           scalar                    2949,3021,3044,3067,3090,3136     
 ISD                        Local  2916     I(4)            4           scalar                    2949,3021,3044,3067,3090,3136     
 JSC                        Local  2917     I(4)            4           scalar                    2949,3022,3045,3068,3091,3137     
 JSD                        Local  2918     I(4)            4           scalar                    2949,3022,3045,3068,3091,3137     
 NETCDF_WRITE_DATA_5D       Subr   3118                                          PRIV             3118,3122,3126,3130               
 PE_ICSIZE                  Local  2919     I(4)            4     1     1        ALC              2958,2959,3011,3110               
 PE_IEC                     Local  2920     I(4)            4     1     1        ALC              2957,2959,3109                    
 PE_ISC                     Local  2921     I(4)            4     1     1        ALC              2956,2959,3009,3028,3051,3074,3097
                                                                                                  ,3108                             
 PE_JCSIZE                  Local  2922     I(4)            4     1     1        ALC              2963,2964,3012,3113               
 PE_JEC                     Local  2923     I(4)            4     1     1        ALC              2962,2964,3112                    
 PE_JSC                     Local  2924     I(4)            4     1     1        ALC              2961,2964,3010,3029,3052,3075,3098
                                                                                                  ,3111                             
 SHAPE                      Func   2952                                 scalar                    2952                              
 SIZE                       Func   2948                                 scalar                    2948,2956,2957,2958,2961,2962,2963
                                                                                                  ,3007,3032,3055,3078,3101,3145,315
                                                                                                  1,3157,3163                       
 UNLIM_DIM_LEVEL            Dummy  2883     I(4)            4           scalar   ARG,IN           2943,3119,3123,3127,3131          
 VARIABLE_NAME              Dummy  2883     CHAR                        scalar   ARG,IN           2940,2942,2982,2988,2994,3000,3118
                                                                                                  ,3122,3126,3130                   
 VDATA                      Dummy  2883     RECORD                5     1        ARG,IN           2942,2948,2952,2978,3013,3116,3141
 VDATA                      Local  2978     I(4)            4     5     1                                                           
 VDATA                      Local  2978     I(8)            8     5     1                                                           
 VDATA                      Local  2978     R(4)            4     5     1                                                           
 VDATA                      Local  2978     R(8)            8     5     1                                                           
 VDATA                      Local  2978     RECORD                5     1                                                           
 VDATA                      Local  3013     I(4)            4     5     1                         3027                              
 VDATA                      Local  3013     I(8)            8     5     1                         3050                              
 VDATA                      Local  3013     R(4)            4     5     1                         3073                              
 VDATA                      Local  3013     R(8)            8     5     1                         3096                              
 VDATA                      Local  3116     I(4)            4     5     1                                                           
 VDATA                      Local  3116     I(8)            8     5     1                                                           
 VDATA                      Local  3116     R(4)            4     5     1                                                           
 VDATA                      Local  3116     R(8)            8     5     1                                                           
 VDATA                      Local  3141     I(4)            4     5     1                         3144                              
 VDATA                      Local  3141     I(8)            8     5     1                         3150                              
 VDATA                      Local  3141     R(4)            4     5     1                         3156                              
 VDATA                      Local  3141     R(8)            8     5     1                         3162                              
 VDATA                      Local  3141     RECORD                5     1                                                           
 XC_SIZE                    Local  2925     I(4)            4           scalar                    2949,3139                         
 XDIM_INDEX                 Local  2926     I(4)            4           scalar                    2941,2948,2973,3009,3011,3021,3024
                                                                                                  ,3028,3044,3047,3051,3067,3070,307
                                                                                                  4,3090,3093,3097,3136,3139        
 XGMAX                      Local  2935     I(4)            4           scalar                    2969,2973                         
 XGMIN                      Local  2936     I(4)            4           scalar                    2969,2973,3009,3028,3051,3074,3097
 XPOS                       Local  2927     I(4)            4           scalar                    2941,2949,2960,2969               
 YC_SIZE                    Local  2930     I(4)            4           scalar                    2949,3140                         
 YDIM_INDEX                 Local  2928     I(4)            4           scalar                    2941,2948,2974,3010,3012,3022,3025

Page 69          Source Listing                  DOMAIN_WRITE_5D
2021-06-01 08:53 Symbol Table                    ../fms2_io/include/domain_write.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  ,3029,3045,3048,3052,3068,3071,307
                                                                                                  5,3091,3094,3098,3137,3140        
 YGMAX                      Local  2937     I(4)            4           scalar                    2968,2974                         
 YGMIN                      Local  2938     I(4)            4           scalar                    2968,2974,3010,3029,3052,3075,3098
 YPOS                       Local  2929     I(4)            4           scalar                    2941,2949,2965,2968               

Page 70          Source Listing                  DOMAIN_WRITE_5D
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

   3171 # 1 "../fms2_io/include/compute_global_checksum.inc" 1 
   3172 !***********************************************************************
   3173 !*                   GNU Lesser General Public License
   3174 !*
   3175 !* This file is part of the GFDL Flexible Modeling System (FMS).
   3176 !*
   3177 !* FMS is free software: you can redistribute it and/or modify it under
   3178 !* the terms of the GNU Lesser General Public License as published by
   3179 !* the Free Software Foundation, either version 3 of the License, or (at
   3180 !* your option) any later version.
   3181 !*
   3182 !* FMS is distributed in the hope that it will be useful, but WITHOUT
   3183 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
   3184 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
   3185 !* for more details.
   3186 !*
   3187 !* You should have received a copy of the GNU Lesser General Public
   3188 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
   3189 !***********************************************************************
   3190 
   3191 !> @briefs Calculates a variable's checksum across all ranks in the current pelist.
   3192 !! @return A hex string containing the checksum.
   3193 function compute_global_checksum_2d(fileobj, variable_name, variable_data, is_decomposed) &
   3194   result(chksum)
   3195 
   3196   class(FmsNetcdfDomainFile_t), intent(in) :: fileobj !< File object.
   3197   character(len=*), intent(in) :: variable_name !< Variable name.
   3198   class(*), dimension(:,:), intent(in) :: variable_data !< Data to be checksummed.
   3199   logical, intent(out) :: is_decomposed !< Flag telling if the variable is decomposed.
   3200   character(len=32) :: chksum
   3201 
   3202   integer :: xdim
   3203   integer :: ydim
   3204   type(domain2d), pointer :: io_domain
   3205   integer :: xpos
   3206   integer :: ypos
   3207   integer :: isd
   3208   integer :: isc
   3209   integer :: xc_size
   3210   integer :: jsd
   3211   integer :: jsc
   3212   integer :: yc_size
   3213   logical :: buffer_includes_halos
   3214   logical :: extra_x
   3215   logical :: extra_y
   3216   integer, dimension(2) :: c
   3217   integer, dimension(2) :: e
   3218   integer(kind=i4_kind), dimension(:,:), allocatable :: buf_i4_kind
   3219   integer(kind=i8_kind), dimension(:,:), allocatable :: buf_i8_kind
   3220   real(kind=r4_kind), dimension(:,:), allocatable :: buf_r4_kind
   3221   real(kind=r8_kind), dimension(:,:), allocatable :: buf_r8_kind
   3222   integer(kind=i4_kind) :: fill_i4_kind
   3223   integer(kind=i8_kind) :: fill_i8_kind
   3224   real(kind=r4_kind) :: fill_r4_kind
   3225   real(kind=r8_kind) :: fill_r8_kind
   3226   integer(kind=i8_kind) :: chksum_val
   3227 

Page 71          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_2D
2021-06-01 08:53                                 ...fms2_io/include/compute_global_checksum.inc

   3228   is_decomposed = is_variable_domain_decomposed(fileobj, variable_name, &
   3229                                                 xindex=xdim, yindex=ydim, &
   3230                                                 xpos=xpos, ypos=ypos)
   3231   if (.not. is_decomposed) then
   3232     chksum = ""
   3233     return
   3234   endif
   3235   io_domain => mpp_get_io_domain(fileobj%domain)
   3236   call domain_offsets(size(variable_data, xdim), size(variable_data, ydim), fileobj%domain, &
   3237                       xpos, ypos, isd, isc, xc_size, jsd, jsc, &
   3238                       yc_size, buffer_includes_halos, extra_x, extra_y)
   3239   c(:) = 1
   3240   if (buffer_includes_halos) then
   3241 !Adjust if the input buffer has room for halos.
   3242     c(xdim) = isc - isd + 1
   3243     c(ydim) = jsc - jsd + 1
   3244   endif
   3245   e(:) = shape(variable_data)
   3246   e(xdim) = xc_size
   3247   e(ydim) = yc_size
   3248 
   3249   if (extra_x) then
   3250 !Adjust sizes since compute domains overlap whe there are non-centered
   3251 !domain position.
   3252     e(xdim) = e(xdim) - 1
   3253   endif
   3254 
   3255   if (extra_y) then
   3256 !Adjust sizes since compute domains overlap whe there are non-centered
   3257 !domain position.
   3258     e(ydim) = e(ydim) - 1
   3259   endif
   3260 
   3261   select type (variable_data)
   3262     type is (integer(kind=i4_kind))
   3263       call allocate_array(buf_i4_kind, e)
   3264       call get_array_section(buf_i4_kind, variable_data, c, e)
   3265       if (get_fill_value(fileobj, variable_name, fill_i4_kind)) then
   3266         chksum_val = mpp_chksum(buf_i4_kind, mask_val=fill_i4_kind)
   3267       else
   3268         chksum_val = mpp_chksum(buf_i4_kind)
   3269       endif
   3270       deallocate(buf_i4_kind)
   3271     type is (integer(kind=i8_kind))
   3272       call allocate_array(buf_i8_kind, e)
   3273       call get_array_section(buf_i8_kind, variable_data, c, e)
   3274       if (get_fill_value(fileobj, variable_name, fill_i8_kind)) then
   3275         chksum_val = mpp_chksum(buf_i8_kind, mask_val=fill_i8_kind)
   3276       else
   3277         chksum_val = mpp_chksum(buf_i8_kind)
   3278       endif
   3279       deallocate(buf_i8_kind)
   3280    type is (real(kind=r4_kind))
   3281      call allocate_array(buf_r4_kind, e)
   3282      call get_array_section(buf_r4_kind, variable_data, c, e)
   3283      if (get_fill_value(fileobj, variable_name, fill_r4_kind)) then
   3284        chksum_val = mpp_chksum(buf_r4_kind, mask_val=fill_r4_kind)

Page 72          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_2D
2021-06-01 08:53                                 ...fms2_io/include/compute_global_checksum.inc

   3285      else
   3286        chksum_val = mpp_chksum(buf_r4_kind)
   3287      endif
   3288      deallocate(buf_r4_kind)
   3289    type is (real(kind=r8_kind))
   3290       call allocate_array(buf_r8_kind, e)
   3291       call get_array_section(buf_r8_kind, variable_data, c, e)
   3292       if (get_fill_value(fileobj, variable_name, fill_r8_kind)) then
   3293         chksum_val = mpp_chksum(buf_r8_kind, mask_val=fill_r8_kind)
   3294       else
   3295         chksum_val = mpp_chksum(buf_r8_kind)
   3296       endif
   3297       deallocate(buf_r8_kind)
   3298     class default
   3299       call error("Compute_global_checksum: unsupported type.")
   3300   end select
   3301   chksum = ""
   3302   write(chksum, "(Z16)") chksum_val
   3303 end function compute_global_checksum_2d


ENTRY POINTS

  Name                                                               
                                                                     
 fms_netcdf_domain_io_mod_mp_compute_global_checksum_2d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFFER_INCLUDES_HALOS      Local  3213     L(4)            4           scalar                    3238,3240                         
 BUF_I4_KIND                Local  3218     I(4)            4     2     1        ALC              3263,3264,3266,3268,3270          
 BUF_I8_KIND                Local  3219     I(8)            8     2     1        ALC              3272,3273,3275,3277,3279          
 BUF_R4_KIND                Local  3220     R(4)            4     2     1        ALC              3281,3282,3284,3286,3288          
 BUF_R8_KIND                Local  3221     R(8)            8     2     1        ALC              3290,3291,3293,3295,3297          
 C                          Local  3216     I(4)            4     1     2                         3239,3242,3243,3264,3273,3282,3291
 CHKSUM                     Local  3200     CHAR            32          scalar                    3232,3301,3302                    
 CHKSUM_VAL                 Local  3226     I(8)            8           scalar                    3266,3268,3275,3277,3284,3286,3293
                                                                                                  ,3295,3302                        
 COMPUTE_GLOBAL_CHECKSUM_2D Func   3193     CHAR            32          scalar                    566,640                           
 E                          Local  3217     I(4)            4     1     2                         3245,3246,3247,3252,3258,3263,3264
                                                                                                  ,3272,3273,3281,3282,3290,3291    
 EXTRA_X                    Local  3214     L(4)            4           scalar                    3238,3249                         
 EXTRA_Y                    Local  3215     L(4)            4           scalar                    3238,3255                         
 FILEOBJ                    Dummy  3193     RECORD          2040        scalar   ARG,IN           3228,3235,3236,3265,3274,3283,3292
 FILL_I4_KIND               Local  3222     I(4)            4           scalar                    3265,3266                         
 FILL_I8_KIND               Local  3223     I(8)            8           scalar                    3274,3275                         
 FILL_R4_KIND               Local  3224     R(4)            4           scalar                    3283,3284                         
 FILL_R8_KIND               Local  3225     R(8)            8           scalar                    3292,3293                         
 IO_DOMAIN                  Local  3204     DOMAIN2D        752         scalar   PTR              3235                              
 ISC                        Local  3208     I(4)            4           scalar                    3237,3242                         
 ISD                        Local  3207     I(4)            4           scalar                    3237,3242                         
 IS_DECOMPOSED              Dummy  3193     L(4)            4           scalar   ARG,OUT          3228,3231                         
 JSC                        Local  3211     I(4)            4           scalar                    3237,3243                         
 JSD                        Local  3210     I(4)            4           scalar                    3237,3243                         

Page 73          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_2D
2021-06-01 08:53 Symbol Table                    ...fms2_io/include/compute_global_checksum.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MPP_CHKSUM                 Local  3266                                 scalar   PRIV             3266,3268,3275,3277,3284,3286,3293
                                                                                                  ,3295,3380,3382,3389,3391,3398,340
                                                                                                  0,3407,3409,3495,3497,3504,3506,35
                                                                                                  13,3515,3522,3524                 
 MPP_CHKSUM_I4_2D           Func   3266     I(8)            8           scalar   PRIV             3266,3268                         
 MPP_CHKSUM_I8_2D           Func   3275     I(8)            8           scalar   PRIV             3275,3277                         
 MPP_CHKSUM_R4_2D           Func   3284     I(8)            8           scalar   PRIV             3284,3286                         
 MPP_CHKSUM_R8_2D           Func   3293     I(8)            8           scalar   PRIV             3293,3295                         
 SHAPE                      Func   3245                                 scalar                    3245                              
 SIZE                       Func   3236                                 scalar                    3236                              
 VARIABLE_DATA              Dummy  3193     RECORD                2     1        ARG,IN           3236,3245,3261                    
 VARIABLE_DATA              Local  3261     I(4)            4     2     1                         3264                              
 VARIABLE_DATA              Local  3261     I(8)            8     2     1                         3273                              
 VARIABLE_DATA              Local  3261     R(4)            4     2     1                         3282                              
 VARIABLE_DATA              Local  3261     R(8)            8     2     1                         3291                              
 VARIABLE_DATA              Local  3261     RECORD                2     1                                                           
 VARIABLE_NAME              Dummy  3193     CHAR                        scalar   ARG,IN           3228,3265,3274,3283,3292          
 XC_SIZE                    Local  3209     I(4)            4           scalar                    3237,3246                         
 XDIM                       Local  3202     I(4)            4           scalar                    3229,3236,3242,3246,3252          
 XPOS                       Local  3205     I(4)            4           scalar                    3230,3237                         
 YC_SIZE                    Local  3212     I(4)            4           scalar                    3238,3247                         
 YDIM                       Local  3203     I(4)            4           scalar                    3229,3236,3243,3247,3258          
 YPOS                       Local  3206     I(4)            4           scalar                    3230,3237                         

Page 74          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_2D
2021-06-01 08:53                                 ...fms2_io/include/compute_global_checksum.inc

   3304 
   3305 
   3306 !> @briefs Calculates a variable's checksum across all ranks in the current pelist.
   3307 !! @return A hex string containing the checksum.
   3308 function compute_global_checksum_3d(fileobj, variable_name, variable_data, is_decomposed) &
   3309   result(chksum)
   3310 
   3311   class(FmsNetcdfDomainFile_t), intent(in) :: fileobj !< File object.
   3312   character(len=*), intent(in) :: variable_name !< Variable name.
   3313   class(*), dimension(:,:,:), intent(in) :: variable_data !< Data to be checksummed.
   3314   logical, intent(out) :: is_decomposed !< Flag telling if the variable is decomposed.
   3315   character(len=32) :: chksum
   3316 
   3317   integer :: xdim
   3318   integer :: ydim
   3319   type(domain2d), pointer :: io_domain
   3320   integer :: xpos
   3321   integer :: ypos
   3322   integer :: isd
   3323   integer :: isc
   3324   integer :: xc_size
   3325   integer :: jsd
   3326   integer :: jsc
   3327   integer :: yc_size
   3328   logical :: buffer_includes_halos
   3329   logical :: extra_x
   3330   logical :: extra_y
   3331   integer, dimension(3) :: c
   3332   integer, dimension(3) :: e
   3333   integer(kind=i4_kind), dimension(:,:,:), allocatable :: buf_i4_kind
   3334   integer(kind=i8_kind), dimension(:,:,:), allocatable :: buf_i8_kind
   3335   real(kind=r4_kind), dimension(:,:,:), allocatable :: buf_r4_kind
   3336   real(kind=r8_kind), dimension(:,:,:), allocatable :: buf_r8_kind
   3337   integer(kind=i4_kind) :: fill_i4_kind
   3338   integer(kind=i8_kind) :: fill_i8_kind
   3339   real(kind=r4_kind) :: fill_r4_kind
   3340   real(kind=r8_kind) :: fill_r8_kind
   3341   integer(kind=i8_kind) :: chksum_val
   3342 
   3343   is_decomposed = is_variable_domain_decomposed(fileobj, variable_name, &
   3344                                                 xindex=xdim, yindex=ydim, &
   3345                                                 xpos=xpos, ypos=ypos)
   3346   if (.not. is_decomposed) then
   3347     chksum = ""
   3348     return
   3349   endif
   3350   io_domain => mpp_get_io_domain(fileobj%domain)
   3351   call domain_offsets(size(variable_data, xdim), size(variable_data, ydim), fileobj%domain, &
   3352                       xpos, ypos, isd, isc, xc_size, jsd, jsc, &
   3353                       yc_size, buffer_includes_halos, extra_x, extra_y)
   3354   c(:) = 1
   3355   if (buffer_includes_halos) then
   3356 !Adjust if the input buffer has room for halos.
   3357     c(xdim) = isc - isd + 1
   3358     c(ydim) = jsc - jsd + 1
   3359   endif
   3360   e(:) = shape(variable_data)

Page 75          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_3D
2021-06-01 08:53                                 ...fms2_io/include/compute_global_checksum.inc

   3361   e(xdim) = xc_size
   3362   e(ydim) = yc_size
   3363 
   3364   if (extra_x) then
   3365 !Adjust sizes since compute domains overlap whe there are non-centered
   3366 !domain position.
   3367     e(xdim) = e(xdim) - 1
   3368   endif
   3369 
   3370   if (extra_y) then
   3371 !Adjust sizes since compute domains overlap whe there are non-centered
   3372 !domain position.
   3373     e(ydim) = e(ydim) - 1
   3374   endif
   3375   select type (variable_data)
   3376     type is (integer(kind=i4_kind))
   3377       call allocate_array(buf_i4_kind, e)
   3378       call get_array_section(buf_i4_kind, variable_data, c, e)
   3379       if (get_fill_value(fileobj, variable_name, fill_i4_kind)) then
   3380         chksum_val = mpp_chksum(buf_i4_kind, mask_val=fill_i4_kind)
   3381       else
   3382         chksum_val = mpp_chksum(buf_i4_kind)
   3383       endif
   3384       deallocate(buf_i4_kind)
   3385     type is (integer(kind=i8_kind))
   3386       call allocate_array(buf_i8_kind, e)
   3387       call get_array_section(buf_i8_kind, variable_data, c, e)
   3388       if (get_fill_value(fileobj, variable_name, fill_i8_kind)) then
   3389         chksum_val = mpp_chksum(buf_i8_kind, mask_val=fill_i8_kind)
   3390       else
   3391         chksum_val = mpp_chksum(buf_i8_kind)
   3392       endif
   3393       deallocate(buf_i8_kind)
   3394    type is (real(kind=r4_kind))
   3395      call allocate_array(buf_r4_kind, e)
   3396      call get_array_section(buf_r4_kind, variable_data, c, e)
   3397      if (get_fill_value(fileobj, variable_name, fill_r4_kind)) then
   3398        chksum_val = mpp_chksum(buf_r4_kind, mask_val=fill_r4_kind)
   3399      else
   3400        chksum_val = mpp_chksum(buf_r4_kind)
   3401      endif
   3402      deallocate(buf_r4_kind)
   3403    type is (real(kind=r8_kind))
   3404       call allocate_array(buf_r8_kind, e)
   3405       call get_array_section(buf_r8_kind, variable_data, c, e)
   3406       if (get_fill_value(fileobj, variable_name, fill_r8_kind)) then
   3407         chksum_val = mpp_chksum(buf_r8_kind, mask_val=fill_r8_kind)
   3408       else
   3409         chksum_val = mpp_chksum(buf_r8_kind)
   3410       endif
   3411       deallocate(buf_r8_kind)
   3412     class default
   3413       call error("Compute_global_checksum: unsupported type.")
   3414   end select
   3415   chksum = ""
   3416   write(chksum, "(Z16)") chksum_val
   3417 end function compute_global_checksum_3d

Page 76          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_3D
2021-06-01 08:53 Entry Points                    ...fms2_io/include/compute_global_checksum.inc



ENTRY POINTS

  Name                                                               
                                                                     
 fms_netcdf_domain_io_mod_mp_compute_global_checksum_3d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFFER_INCLUDES_HALOS      Local  3328     L(4)            4           scalar                    3353,3355                         
 BUF_I4_KIND                Local  3333     I(4)            4     3     1        ALC              3377,3378,3380,3382,3384          
 BUF_I8_KIND                Local  3334     I(8)            8     3     1        ALC              3386,3387,3389,3391,3393          
 BUF_R4_KIND                Local  3335     R(4)            4     3     1        ALC              3395,3396,3398,3400,3402          
 BUF_R8_KIND                Local  3336     R(8)            8     3     1        ALC              3404,3405,3407,3409,3411          
 C                          Local  3331     I(4)            4     1     3                         3354,3357,3358,3378,3387,3396,3405
 CHKSUM                     Local  3315     CHAR            32          scalar                    3347,3415,3416                    
 CHKSUM_VAL                 Local  3341     I(8)            8           scalar                    3380,3382,3389,3391,3398,3400,3407
                                                                                                  ,3409,3416                        
 COMPUTE_GLOBAL_CHECKSUM_3D Func   3308     CHAR            32          scalar                    573,653                           
 E                          Local  3332     I(4)            4     1     3                         3360,3361,3362,3367,3373,3377,3378
                                                                                                  ,3386,3387,3395,3396,3404,3405    
 EXTRA_X                    Local  3329     L(4)            4           scalar                    3353,3364                         
 EXTRA_Y                    Local  3330     L(4)            4           scalar                    3353,3370                         
 FILEOBJ                    Dummy  3308     RECORD          2040        scalar   ARG,IN           3343,3350,3351,3379,3388,3397,3406
 FILL_I4_KIND               Local  3337     I(4)            4           scalar                    3379,3380                         
 FILL_I8_KIND               Local  3338     I(8)            8           scalar                    3388,3389                         
 FILL_R4_KIND               Local  3339     R(4)            4           scalar                    3397,3398                         
 FILL_R8_KIND               Local  3340     R(8)            8           scalar                    3406,3407                         
 IO_DOMAIN                  Local  3319     DOMAIN2D        752         scalar   PTR              3350                              
 ISC                        Local  3323     I(4)            4           scalar                    3352,3357                         
 ISD                        Local  3322     I(4)            4           scalar                    3352,3357                         
 IS_DECOMPOSED              Dummy  3308     L(4)            4           scalar   ARG,OUT          3343,3346                         
 JSC                        Local  3326     I(4)            4           scalar                    3352,3358                         
 JSD                        Local  3325     I(4)            4           scalar                    3352,3358                         
 MPP_CHKSUM_I4_3D           Func   3380     I(8)            8           scalar   PRIV             3380,3382                         
 MPP_CHKSUM_I8_3D           Func   3389     I(8)            8           scalar   PRIV             3389,3391                         
 MPP_CHKSUM_R4_3D           Func   3398     I(8)            8           scalar   PRIV             3398,3400                         
 MPP_CHKSUM_R8_3D           Func   3407     I(8)            8           scalar   PRIV             3407,3409                         
 SHAPE                      Func   3360                                 scalar                    3360                              
 SIZE                       Func   3351                                 scalar                    3351                              
 VARIABLE_DATA              Dummy  3308     RECORD                3     1        ARG,IN           3351,3360,3375                    
 VARIABLE_DATA              Local  3375     I(4)            4     3     1                         3378                              
 VARIABLE_DATA              Local  3375     I(8)            8     3     1                         3387                              
 VARIABLE_DATA              Local  3375     R(4)            4     3     1                         3396                              
 VARIABLE_DATA              Local  3375     R(8)            8     3     1                         3405                              
 VARIABLE_DATA              Local  3375     RECORD                3     1                                                           
 VARIABLE_NAME              Dummy  3308     CHAR                        scalar   ARG,IN           3343,3379,3388,3397,3406          
 XC_SIZE                    Local  3324     I(4)            4           scalar                    3352,3361                         
 XDIM                       Local  3317     I(4)            4           scalar                    3344,3351,3357,3361,3367          
 XPOS                       Local  3320     I(4)            4           scalar                    3345,3352                         
 YC_SIZE                    Local  3327     I(4)            4           scalar                    3353,3362                         
 YDIM                       Local  3318     I(4)            4           scalar                    3344,3351,3358,3362,3373          
 YPOS                       Local  3321     I(4)            4           scalar                    3345,3352                         

Page 77          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_3D
2021-06-01 08:53                                 ...fms2_io/include/compute_global_checksum.inc

   3418 
   3419 
   3420 !> @briefs Calculates a variable's checksum across all ranks in the current pelist.
   3421 !! @return A hex string containing the checksum.
   3422 function compute_global_checksum_4d(fileobj, variable_name, variable_data, is_decomposed) &
   3423   result(chksum)
   3424 
   3425   class(FmsNetcdfDomainFile_t), intent(in) :: fileobj !< File object.
   3426   character(len=*), intent(in) :: variable_name !< Variable name.
   3427   class(*), dimension(:,:,:,:), intent(in) :: variable_data !< Data to be checksummed.
   3428   logical, intent(out) :: is_decomposed !< Flag telling if the variable is decomposed.
   3429   character(len=32) :: chksum
   3430 
   3431   integer :: xdim
   3432   integer :: ydim
   3433   type(domain2d), pointer :: io_domain
   3434   integer :: xpos
   3435   integer :: ypos
   3436   integer :: isd
   3437   integer :: isc
   3438   integer :: xc_size
   3439   integer :: jsd
   3440   integer :: jsc
   3441   integer :: yc_size
   3442   logical :: buffer_includes_halos
   3443   logical :: extra_x
   3444   logical :: extra_y
   3445   integer, dimension(4) :: c
   3446   integer, dimension(4) :: e
   3447   integer(kind=i4_kind), dimension(:,:,:,:), allocatable :: buf_i4_kind
   3448   integer(kind=i8_kind), dimension(:,:,:,:), allocatable :: buf_i8_kind
   3449   real(kind=r4_kind), dimension(:,:,:,:), allocatable :: buf_r4_kind
   3450   real(kind=r8_kind), dimension(:,:,:,:), allocatable :: buf_r8_kind
   3451   integer(kind=i4_kind) :: fill_i4_kind
   3452   integer(kind=i8_kind) :: fill_i8_kind
   3453   real(kind=r4_kind) :: fill_r4_kind
   3454   real(kind=r8_kind) :: fill_r8_kind
   3455   integer(kind=i8_kind) :: chksum_val
   3456 
   3457   is_decomposed = is_variable_domain_decomposed(fileobj, variable_name, &
   3458                                                 xindex=xdim, yindex=ydim, &
   3459                                                 xpos=xpos, ypos=ypos)
   3460   if (.not. is_decomposed) then
   3461     chksum = ""
   3462     return
   3463   endif
   3464   io_domain => mpp_get_io_domain(fileobj%domain)
   3465   call domain_offsets(size(variable_data, xdim), size(variable_data, ydim), fileobj%domain, &
   3466                       xpos, ypos, isd, isc, xc_size, jsd, jsc, &
   3467                       yc_size, buffer_includes_halos, extra_x, extra_y)
   3468   c(:) = 1
   3469   if (buffer_includes_halos) then
   3470 !Adjust if the input buffer has room for halos.
   3471     c(xdim) = isc - isd + 1
   3472     c(ydim) = jsc - jsd + 1
   3473   endif
   3474   e(:) = shape(variable_data)

Page 78          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_4D
2021-06-01 08:53                                 ...fms2_io/include/compute_global_checksum.inc

   3475   e(xdim) = xc_size
   3476   e(ydim) = yc_size
   3477 
   3478   if (extra_x) then
   3479 !Adjust sizes since compute domains overlap whe there are non-centered
   3480 !domain position.
   3481     e(xdim) = e(xdim) - 1
   3482   endif
   3483 
   3484   if (extra_y) then
   3485 !Adjust sizes since compute domains overlap whe there are non-centered
   3486 !domain position.
   3487     e(ydim) = e(ydim) - 1
   3488   endif
   3489 
   3490   select type (variable_data)
   3491     type is (integer(kind=i4_kind))
   3492       call allocate_array(buf_i4_kind, e)
   3493       call get_array_section(buf_i4_kind, variable_data, c, e)
   3494       if (get_fill_value(fileobj, variable_name, fill_i4_kind)) then
   3495         chksum_val = mpp_chksum(buf_i4_kind, mask_val=fill_i4_kind)
   3496       else
   3497         chksum_val = mpp_chksum(buf_i4_kind)
   3498       endif
   3499       deallocate(buf_i4_kind)
   3500     type is (integer(kind=i8_kind))
   3501       call allocate_array(buf_i8_kind, e)
   3502       call get_array_section(buf_i8_kind, variable_data, c, e)
   3503       if (get_fill_value(fileobj, variable_name, fill_i8_kind)) then
   3504         chksum_val = mpp_chksum(buf_i8_kind, mask_val=fill_i8_kind)
   3505       else
   3506         chksum_val = mpp_chksum(buf_i8_kind)
   3507       endif
   3508       deallocate(buf_i8_kind)
   3509    type is (real(kind=r4_kind))
   3510      call allocate_array(buf_r4_kind, e)
   3511      call get_array_section(buf_r4_kind, variable_data, c, e)
   3512      if (get_fill_value(fileobj, variable_name, fill_r4_kind)) then
   3513        chksum_val = mpp_chksum(buf_r4_kind, mask_val=fill_r4_kind)
   3514      else
   3515        chksum_val = mpp_chksum(buf_r4_kind)
   3516      endif
   3517      deallocate(buf_r4_kind)
   3518    type is (real(kind=r8_kind))
   3519       call allocate_array(buf_r8_kind, e)
   3520       call get_array_section(buf_r8_kind, variable_data, c, e)
   3521       if (get_fill_value(fileobj, variable_name, fill_r8_kind)) then
   3522         chksum_val = mpp_chksum(buf_r8_kind, mask_val=fill_r8_kind)
   3523       else
   3524         chksum_val = mpp_chksum(buf_r8_kind)
   3525       endif
   3526       deallocate(buf_r8_kind)
   3527     class default
   3528       call error("Compute_global_checksum: unsupported type.")
   3529   end select
   3530   chksum = ""
   3531   write(chksum, "(Z16)") chksum_val

Page 79          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_4D
2021-06-01 08:53                                 ...fms2_io/include/compute_global_checksum.inc

   3532 end function compute_global_checksum_4d


ENTRY POINTS

  Name                                                               
                                                                     
 fms_netcdf_domain_io_mod_mp_compute_global_checksum_4d_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 BUFFER_INCLUDES_HALOS      Local  3442     L(4)            4           scalar                    3467,3469                         
 BUF_I4_KIND                Local  3447     I(4)            4     4     1        ALC              3492,3493,3495,3497,3499          
 BUF_I8_KIND                Local  3448     I(8)            8     4     1        ALC              3501,3502,3504,3506,3508          
 BUF_R4_KIND                Local  3449     R(4)            4     4     1        ALC              3510,3511,3513,3515,3517          
 BUF_R8_KIND                Local  3450     R(8)            8     4     1        ALC              3519,3520,3522,3524,3526          
 C                          Local  3445     I(4)            4     1     4                         3468,3471,3472,3493,3502,3511,3520
 CHKSUM                     Local  3429     CHAR            32          scalar                    3461,3530,3531                    
 CHKSUM_VAL                 Local  3455     I(8)            8           scalar                    3495,3497,3504,3506,3513,3515,3522
                                                                                                  ,3524,3531                        
 COMPUTE_GLOBAL_CHECKSUM_4D Func   3422     CHAR            32          scalar                    580,666                           
 E                          Local  3446     I(4)            4     1     4                         3474,3475,3476,3481,3487,3492,3493
                                                                                                  ,3501,3502,3510,3511,3519,3520    
 EXTRA_X                    Local  3443     L(4)            4           scalar                    3467,3478                         
 EXTRA_Y                    Local  3444     L(4)            4           scalar                    3467,3484                         
 FILEOBJ                    Dummy  3422     RECORD          2040        scalar   ARG,IN           3457,3464,3465,3494,3503,3512,3521
 FILL_I4_KIND               Local  3451     I(4)            4           scalar                    3494,3495                         
 FILL_I8_KIND               Local  3452     I(8)            8           scalar                    3503,3504                         
 FILL_R4_KIND               Local  3453     R(4)            4           scalar                    3512,3513                         
 FILL_R8_KIND               Local  3454     R(8)            8           scalar                    3521,3522                         
 IO_DOMAIN                  Local  3433     DOMAIN2D        752         scalar   PTR              3464                              
 ISC                        Local  3437     I(4)            4           scalar                    3466,3471                         
 ISD                        Local  3436     I(4)            4           scalar                    3466,3471                         
 IS_DECOMPOSED              Dummy  3422     L(4)            4           scalar   ARG,OUT          3457,3460                         
 JSC                        Local  3440     I(4)            4           scalar                    3466,3472                         
 JSD                        Local  3439     I(4)            4           scalar                    3466,3472                         
 MPP_CHKSUM_I4_4D           Func   3495     I(8)            8           scalar   PRIV             3495,3497                         
 MPP_CHKSUM_I8_4D           Func   3504     I(8)            8           scalar   PRIV             3504,3506                         
 MPP_CHKSUM_R4_4D           Func   3513     I(8)            8           scalar   PRIV             3513,3515                         
 MPP_CHKSUM_R8_4D           Func   3522     I(8)            8           scalar   PRIV             3522,3524                         
 SHAPE                      Func   3474                                 scalar                    3474                              
 SIZE                       Func   3465                                 scalar                    3465                              
 VARIABLE_DATA              Dummy  3422     RECORD                4     1        ARG,IN           3465,3474,3490                    
 VARIABLE_DATA              Local  3490     I(4)            4     4     1                         3493                              
 VARIABLE_DATA              Local  3490     I(8)            8     4     1                         3502                              
 VARIABLE_DATA              Local  3490     R(4)            4     4     1                         3511                              
 VARIABLE_DATA              Local  3490     R(8)            8     4     1                         3520                              
 VARIABLE_DATA              Local  3490     RECORD                4     1                                                           
 VARIABLE_NAME              Dummy  3422     CHAR                        scalar   ARG,IN           3457,3494,3503,3512,3521          
 XC_SIZE                    Local  3438     I(4)            4           scalar                    3466,3475                         
 XDIM                       Local  3431     I(4)            4           scalar                    3458,3465,3471,3475,3481          
 XPOS                       Local  3434     I(4)            4           scalar                    3459,3466                         
 YC_SIZE                    Local  3441     I(4)            4           scalar                    3467,3476                         
 YDIM                       Local  3432     I(4)            4           scalar                    3458,3465,3472,3476,3487          

Page 80          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_4D
2021-06-01 08:53 Symbol Table                    ...fms2_io/include/compute_global_checksum.inc

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 YPOS                       Local  3435     I(4)            4           scalar                    3459,3466                         

Page 81          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_4D
2021-06-01 08:53                                 ...fms2_io/include/compute_global_checksum.inc

   3533 # 866 "fms_netcdf_domain_io.F90" 2 
   3534 
   3535 
   3536 end module fms_netcdf_domain_io_mod


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CLOSE_DOMAIN_FILE          Subr   72                                                             72                                
 DOMAIN_AXIS_ATT_NAME       Param  42       CHAR            16          scalar                                                      
 DOMAIN_POS_ATT             Param  41       CHAR            16          scalar                                                      
 DOMAIN_READ_5D             Subr   86                                                             86                                
 DOMAIN_WRITE_5D            Subr   92                                                             92                                
 FMS_IO_UTILS_MOD           Module 29                                                             29                                
 FMS_NETCDF_DOMAIN_IO_MOD   Module 24                                                                                               
 GET_COMPUTE_DOMAIN_DIMENSI                                                                                                         
 ON_INDICES                 Subr   95                                                             95                                
 GET_GLOBAL_IO_DOMAIN_INDIC                                                                                                         
 ES                         Subr   96                                                             96                                
 GET_MOSAIC_TILE_GRID       Subr   98                                                             98                                
 ISO_FORTRAN_ENV            Module 25                                                             25                                
 MPP_DOMAINS_MOD            Module 28                                                             28                                
 MPP_MOD                    Module 27                                                             27                                
 NETCDF                     Module 26                                                             26                                
 NETCDF_IO_MOD              Module 30                                                             30                                
 PLATFORM_MOD               Module 31                                                             31                                
 REGISTER_DOMAIN_DECOMPOSED                                                                                                         
 _DIMENSION                 Subr   73                                                             73                                
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_0D                  Subr   75                                                             75                                
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_1D                  Subr   76                                                             76                                
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_2D                  Subr   77                                                             77                                
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_3D                  Subr   78                                                             78                                
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_4D                  Subr   79                                                             79                                
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_5D                  Subr   80                                                             80                                
 REGISTER_DOMAIN_VARIABLE   Subr   74                                                             74                                
 RESTORE_DOMAIN_STATE       Subr   94                                                             94                                
 SAVE_DOMAIN_RESTART        Subr   93                                                             93                                


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 FMSNETCDFDOMAINFILE_T.FMSNETCDFFILE_T                                                                                     ...
                            FMSNETCDFFILE_T 872   0              scalar                                                       

Page 82          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_4D
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

   3537 

Page 83          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_4D
2021-06-01 08:53 Subprograms/Common Blocks       fms_netcdf_domain_io.F90



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ADD_DOMAIN_ATTRIBUTE       Subr   488                                                            541,911                           
 APPEND_DOMAIN_DECOMPOSED_D                                                                                                         
 IMENSION                   Subr   133                                                            463,469                           
 CLOSE_DOMAIN_FILE          Subr   425                                                                                              
 COMPUTE_GLOBAL_CHECKSUM_2D Func   3193     CHAR            32          scalar                    566,640                           
 COMPUTE_GLOBAL_CHECKSUM_3D Func   3308     CHAR            32          scalar                    573,653                           
 COMPUTE_GLOBAL_CHECKSUM_4D Func   3422     CHAR            32          scalar                    580,666                           
 DOMAIN_OFFSETS             Subr   722                                                            1109,1327,1545,1763,2066,2360,2654
                                                                                                  ,2948,3236,3351,3465              
 DOMAIN_READ_0D             Subr   999                                                                                              
 DOMAIN_READ_1D             Subr   1025                                                                                             
 DOMAIN_READ_2D             Subr   1056                                                                                             
 DOMAIN_READ_3D             Subr   1274                                                                                             
 DOMAIN_READ_4D             Subr   1492                                                                                             
 DOMAIN_READ_5D             Subr   1710                                                                                             
 DOMAIN_WRITE_0D            Subr   1947                                                                                             
 DOMAIN_WRITE_1D            Subr   1971                                                                                             
 DOMAIN_WRITE_2D            Subr   2001                                                                                             
 DOMAIN_WRITE_3D            Subr   2295                                                                                             
 DOMAIN_WRITE_4D            Subr   2589                                                                                             
 DOMAIN_WRITE_5D            Subr   2883                                                                                             
 FMS_NETCDF_DOMAIN_IO_MOD   Module 24                                                                                               
 GET_COMPUTE_DOMAIN_DIMENSI                                                                                                         
 ON_INDICES                 Subr   684                                                                                              
 GET_DOMAIN_DECOMPOSED_DIME                                                                                                         
 NSION_INDEX                Func   177      I(4)            4           scalar                    256,260                           
 GET_DOMAIN_DECOMPOSED_INDE                                                                                                         
 X                          Func   112      I(4)            4           scalar                    166,215,309,313,507,515,697,702,80
                                                                                                  3,808                             
 GET_DOMAIN_POSITION        Func   158      I(4)            4           scalar                    275,278                           
 GET_GLOBAL_IO_DOMAIN_INDIC                                                                                                         
 ES                         Subr   790                                                                                              
 GET_MOSAIC_TILE_GRID       Subr   834                                                                                              
 IS_DIMENSION_REGISTERED    Func   294      L(4)            4           scalar                                                      
 IS_VARIABLE_DOMAIN_DECOMPO                                                                                                         
 SED                        Func   233      L(4)            4           scalar                    1101,1319,1537,1755,2058,2352,2646
                                                                                                  ,2940,3228,3343,3457              
 OPEN_DOMAIN_FILE           Func   322      L(4)            4           scalar                                                      
 REGISTER_DOMAIN_DECOMPOSED                                                                                                         
 _DIMENSION                 Subr   438                                                                                              
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_0D                  Subr   884                                                                                              
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_1D                  Subr   899                                                                                              
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_2D                  Subr   917                                                                                              
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_3D                  Subr   932                                                                                              
 REGISTER_DOMAIN_RESTART_VA                                                                                                         
 RIABLE_4D                  Subr   947                                                                                              
 REGISTER_DOMAIN_RESTART_VA                                                                                                         

Page 84          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_4D
2021-06-01 08:53 Subprograms/Common Blocks       fms_netcdf_domain_io.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 RIABLE_5D                  Subr   962                                                                                              
 REGISTER_DOMAIN_VARIABLE   Subr   528                                                                                              
 RESTORE_DOMAIN_STATE       Subr   617                                                                                              
 SAVE_DOMAIN_RESTART        Subr   550                                                                                              

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume cc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file
       -convert native                       -cross_reference
       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=0
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20191121       -D _OPENMP=201611
       -D __INTEL_OFFLOAD                    -D __MMX__

Page 85          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_4D
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

       -D __SSE__                            -D __SSE_MATH__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __pentium4                         -D __pentium4__
       -D __tune_pentium4__                  -D PACKAGE_NAME='"GFDL FMS Library"'
       -D PACKAGE_TARNAME='"FMS"'            -D PACKAGE_VERSION='"2021.02.0"'
       -D PACKAGE_STRING='"GFDL FMS Library 2021.02.0"'       -D PACKAGE_BUGREPORT='"gfdl.climate.model.info@noaa.gov"'
       -D PACKAGE_URL='"https://www.gfdl.noaa.gov/fms"'       -D PACKAGE='"FMS"'
       -D VERSION='"2021.02.0"'              -D STDC_HEADERS=1
       -D HAVE_SYS_TYPES_H=1                 -D HAVE_SYS_STAT_H=1
       -D HAVE_STDLIB_H=1                    -D HAVE_STRING_H=1
       -D HAVE_MEMORY_H=1                    -D HAVE_STRINGS_H=1
       -D HAVE_INTTYPES_H=1                  -D HAVE_STDINT_H=1
       -D HAVE_UNISTD_H=1                    -D HAVE_DLFCN_H=1
       -D LT_OBJDIR='".libs/"'               -D HAVE_MPI_H=1
       -D HAVE_NETCDF_H=1                    -D HAVE_SCHED_GETAFFINITY=1
       -D HAVE_MOD_MPI=1                     -D HAVE_MOD_NETCDF=1
       -D HAVE_CRAY_POINTER=1                -D HAVE_QUAD_PRECISION=1
       -D HAVE_INTERNAL_NML=1                -D use_netCDF=1
       -D use_libMPI=1                       -D INTERNAL_FILE_NML
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
  no   -fpconstant                           -fpe3
       -fprm nearest                         -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -fp_modbits nofp_contract
       -fp_modbits nono_fp_contract          -fp_modbits nofenv_access
       -fp_modbits nono_fenv_access          -fp_modbits nocx_limited_range
       -fp_modbits nono_cx_limited_range       -fp_modbits noprec_div
       -fp_modbits nono_prec_div             -fp_modbits noprec_sqrt
       -fp_modbits nono_prec_sqrt            -fp_modbits ftz
       -fp_modbits nono_ftz                  -fp_modbits nointrin_limited_range
       -fp_modbits nono_intrin_limited_range       -fp_modbits notrunc_compares
       -fp_modbits nono_trunc_compares       -fp_modbits noieee_nan_compares
       -fp_modbits nono_ieee_nan_compares       -fp_modbits honor_f32_conversion
       -fp_modbits nono_honor_f32_conversion       -fp_modbits honor_f64_conversion
       -fp_modbits nono_honor_f64_conversion       -fp_modbits nono_x87_copy
       -fp_modbits nono_no_x87_copy          -fp_modbits noexception_semantics
       -fp_modbits nono_exception_semantics       -fp_modbits noprecise_libm_functions
       -fp_modbits nono_precise_libm_functions       -heap_arrays 0
  no   -threadprivate_compat                 -free
       -g2                                   -iface nomixed_str_len_arg
       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity
       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
       -module ../.mods                      -names lowercase
  no   -noinclude                       no   -o

Page 86          Source Listing                  COMPUTE_GLOBAL_CHECKSUM_4D
2021-06-01 08:53                                 fms_netcdf_domain_io.F90

       -offload-build=host                   -openmp
       -openmp-simd                          -openmp-offload
       -O0                              no   -pad_source
       -real_size 64                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w noalignments                       -w nodeclarations
       -w noexternals                        -w nogeneral
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w nouncalled
       -w nouninitialized                    -w nounused
       -w nousage                       no   -wrap-margins

       -includepath : ./,/opt/intel/2020/compilers_and_libraries/linux/mkl/include/,/opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/icc/,
           /usr/include/,./,./,../fms2_io/include/,../include/,./,/opt/netcdf/4.6.1/INTEL/include/,/opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/,
           /opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/,/opt/intel/2020/compilers_and_libraries/linux/ipp/include/,
           /opt/intel/2020/compilers_and_libraries/linux/mkl/include/,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/,
           /opt/intel/2020/compilers_and_libraries/linux/tbb/include/,/opt/intel/2020/compilers_and_libraries/linux/daal/include/,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/intel64/,/opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/icc/,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/,/usr/local/include/,/usr/lib/gcc/x86_64-redhat-linux/4.8.5/include/,
           /usr/include/,/usr/include/,/usr/include/
       -list filename : fms_netcdf_domain_io.lst
  no   -o

COMPILER: Intel(R) Fortran 19.1-1555
