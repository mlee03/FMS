Page 1           Source Listing                  CHECK_GRID_SIZES
2021-06-01 08:55                                 /tmp/ifortBzBReQ.i90

      1 # 1 "get_grid_version_mpp.F90"
      2 !***********************************************************************
      3 !*                   GNU Lesser General Public License
      4 !*
      5 !* This file is part of the GFDL Flexible Modeling System (FMS).
      6 !*
      7 !* FMS is free software: you can redistribute it and/or modify it under
      8 !* the terms of the GNU Lesser General Public License as published by
      9 !* the Free Software Foundation, either version 3 of the License, or (at
     10 !* your option) any later version.
     11 !*
     12 !* FMS is distributed in the hope that it will be useful, but WITHOUT
     13 !* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
     14 !* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
     15 !* for more details.
     16 !*
     17 !* You should have received a copy of the GNU Lesser General Public
     18 !* License along with FMS.  If not, see <http://www.gnu.org/licenses/>.
     19 !***********************************************************************
     20 !> @file
     21 !! @brief mpp_io implementations of grid routines
     22 module get_grid_version_mpp_mod
     23 use constants_mod, only: PI
     24 use mpp_mod, only : mpp_error,FATAL,WARNING,NOTE, mpp_min, mpp_max
     25 use fms_io_mod, only: field_size, read_data, get_mosaic_tile_grid
     26 use fms_mod, only: field_exist
     27 use mpp_domains_mod, only : domain2d, mpp_get_compute_domain, operator(.NE.),operator(.EQ.)
     28 use mpp_domains_mod, only : mpp_copy_domain, mpp_get_global_domain
     29 use mpp_domains_mod, only : mpp_get_data_domain, mpp_set_compute_domain, mpp_set_data_domain
     30 use mpp_domains_mod, only : mpp_set_global_domain, mpp_deallocate_domain
     31 
     32 implicit none
     33 
     34 real, parameter    :: deg_to_radian=PI/180.
     35 contains
     36 ! Get lon and lat of three model (target) grids from grid_spec.nc
     37 
     38 subroutine check_grid_sizes(domain_name, Domain, nlon, nlat)
     39 character(len=12), intent(in) :: domain_name
     40 type (domain2d),   intent(in) :: Domain
     41 integer,           intent(in) :: nlon, nlat
     42 
     43 character(len=184) :: error_message
     44 integer            :: xsize, ysize
     45 
     46 call mpp_get_global_domain(Domain, xsize=xsize, ysize=ysize)
     47 if(nlon .NE. xsize .OR. nlat .NE. ysize) then
     48   error_message = 'Error in data_override_init. Size of grid as specified by '// &
     49                   '             does not conform to that specified by grid_spec.nc.'// &
     50                   '  From             :     by      From grid_spec.nc:     by    '
     51   error_message( 59: 70) = domain_name
     52   error_message(130:141) = domain_name
     53   write(error_message(143:146),'(i4)') xsize
     54   write(error_message(150:153),'(i4)') ysize
     55   write(error_message(174:177),'(i4)') nlon
     56   write(error_message(181:184),'(i4)') nlat
     57   call mpp_error(FATAL,error_message)

Page 2           Source Listing                  CHECK_GRID_SIZES
2021-06-01 08:55                                 get_grid_version_mpp.F90

     58 endif
     59 end subroutine check_grid_sizes


ENTRY POINTS

  Name                                                     
                                                           
 get_grid_version_mpp_mod_mp_check_grid_sizes_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHECK_GRID_SIZES           Subr   38                                                             98,111,155,226                    
 DOMAIN                     Dummy  38       DOMAIN2D        752         scalar   ARG,IN           46                                
 DOMAIN2D                   Type   40                                   scalar                    27,40,64,78,187,200               
 DOMAIN_NAME                Dummy  38       CHAR            12          scalar   ARG,IN           51,52                             
 ERROR_MESSAGE              Local  43       CHAR            184         scalar                    48,51,52,53,54,55,56,57           
 FATAL                      Param  57       I(4)            4           scalar                    24,57,92,168,203,220,222,236      
 MPP_ERROR                  Local  57                                   scalar                    24,57,92,107,168,203,220,222,236  
 MPP_ERROR_BASIC            Subr   57                                            PRIV             57,92,107,168,203,220,222,236     
 MPP_GET_GLOBAL_DOMAIN      Local  46                                   scalar                    28,46,82,207                      
 MPP_GET_GLOBAL_DOMAIN2D    Subr   46                                            PRIV             46,82,207                         
 NLAT                       Dummy  38       I(4)            4           scalar   ARG,IN           47,56                             
 NLON                       Dummy  38       I(4)            4           scalar   ARG,IN           47,55                             
 XSIZE                      Local  44       I(4)            4           scalar                    46,47,53                          
 YSIZE                      Local  44       I(4)            4           scalar                    46,47,54                          

Page 3           Source Listing                  CHECK_GRID_SIZES
2021-06-01 08:55                                 get_grid_version_mpp.F90

     60 
     61 subroutine get_grid_version_classic_1(grid_file, mod_name, domain, isc, iec, jsc, jec, lon, lat, min_lon, max_lon, grid_cent
     61 er_bug)
     62   character(len=*),            intent(in) :: grid_file
     63   character(len=*),            intent(in) :: mod_name
     64   type(domain2d),              intent(in) :: domain
     65   integer,                     intent(in) :: isc, iec, jsc, jec
     66   real, dimension(isc:,jsc:), intent(out) :: lon, lat
     67   real,                       intent(out) :: min_lon, max_lon
     68   logical,           intent(in), optional :: grid_center_bug
     69 
     70   integer                                      :: i, j, siz(4)
     71   integer                                      :: nlon, nlat         ! size of global lon and lat
     72   real,          dimension(:,:,:), allocatable :: lon_vert, lat_vert !of OCN grid vertices
     73   real,          dimension(:),     allocatable :: glon, glat         ! lon and lat of 1-D grid of atm/lnd
     74   logical                                      :: is_new_grid
     75   integer                                      :: is, ie, js, je
     76   integer                                      :: isd, ied, jsd, jed
     77   integer                                      :: isg, ieg, jsg, jeg
     78   type(domain2d)                               :: domain2
     79   character(len=3)                             :: xname, yname
     80 
     81   call mpp_get_data_domain(domain, isd, ied, jsd, jed)
     82   call mpp_get_global_domain(domain, isg, ieg, jsg, jeg)
     83 
     84   select case(mod_name)
     85   case('ocn', 'ice')
     86     is_new_grid = .FALSE.
     87     if(field_exist(grid_file, 'x_T')) then
     88        is_new_grid = .true.
     89     else if(field_exist(grid_file, 'geolon_t')) then
     90        is_new_grid = .FALSE.
     91     else
     92        call mpp_error(FATAL,'data_override: both x_T and geolon_t is not in the grid file '//trim(grid_file) )
     93     endif
     94 
     95     if(is_new_grid) then
     96       call field_size(grid_file, 'x_T', siz)
     97       nlon = siz(1); nlat = siz(2)
     98       call check_grid_sizes(trim(mod_name)//'_domain  ', domain, nlon, nlat)
     99       allocate(lon_vert(isc:iec,jsc:jec,4), lat_vert(isc:iec,jsc:jec,4) )
    100       call read_data(trim(grid_file), 'x_vert_T', lon_vert, domain)
    101       call read_data(trim(grid_file), 'y_vert_T', lat_vert, domain)
    102 
    103 !2 Global lon and lat of ocean grid cell centers are determined from adjacent vertices
    104       lon(:,:) = (lon_vert(:,:,1) + lon_vert(:,:,2) + lon_vert(:,:,3) + lon_vert(:,:,4))*0.25
    105       lat(:,:) = (lat_vert(:,:,1) + lat_vert(:,:,2) + lat_vert(:,:,3) + lat_vert(:,:,4))*0.25
    106     else
    107       if(grid_center_bug) call mpp_error(NOTE, &
    108            'data_override: grid_center_bug is set to true, the grid center location may be incorrect')
    109       call field_size(grid_file, 'geolon_vert_t', siz)
    110       nlon = siz(1) - 1; nlat = siz(2) - 1;
    111       call check_grid_sizes(trim(mod_name)//'_domain  ', domain, nlon, nlat)
    112       call mpp_copy_domain(domain, domain2)
    113       call mpp_set_compute_domain(domain2, isc, iec+1, jsc, jec+1, iec-isc+2, jec-jsc+2 )
    114       call mpp_set_data_domain   (domain2, isd, ied+1, jsd, jed+1, ied-isd+2, jed-jsd+2 )
    115       call mpp_set_global_domain (domain2, isg, ieg+1, jsg, jeg+1, ieg-isg+2, jeg-jsg+2 )

Page 4           Source Listing                  GET_GRID_VERSION_CLASSIC_1
2021-06-01 08:55                                 get_grid_version_mpp.F90

    116       allocate(lon_vert(isc:iec+1,jsc:jec+1,1))
    117       allocate(lat_vert(isc:iec+1,jsc:jec+1,1))
    118       call read_data(trim(grid_file), 'geolon_vert_t', lon_vert, domain2)
    119       call read_data(trim(grid_file), 'geolat_vert_t', lat_vert, domain2)
    120 
    121       if(grid_center_bug) then
    122          do j = jsc, jec
    123             do i = isc, iec
    124                lon(i,j) = (lon_vert(i,j,1) + lon_vert(i+1,j,1))/2.
    125                lat(i,j) = (lat_vert(i,j,1) + lat_vert(i,j+1,1))/2.
    126             enddo
    127          enddo
    128       else
    129          do j = jsc, jec
    130             do i = isc, iec
    131                lon(i,j) = (lon_vert(i,j,1) + lon_vert(i+1,j,1) + &
    132                     lon_vert(i+1,j+1,1) + lon_vert(i,j+1,1))*0.25
    133                lat(i,j) = (lat_vert(i,j,1) + lat_vert(i+1,j,1) + &
    134                     lat_vert(i+1,j+1,1) + lat_vert(i,j+1,1))*0.25
    135             enddo
    136          enddo
    137       end if
    138       call mpp_deallocate_domain(domain2)
    139     endif
    140     deallocate(lon_vert)
    141     deallocate(lat_vert)
    142   case('atm', 'lnd')
    143      if(trim(mod_name) == 'atm') then
    144         xname = 'xta'; yname = 'yta'
    145      else
    146         xname = 'xtl'; yname = 'ytl'
    147      endif
    148      call field_size(grid_file, xname, siz)
    149      nlon = siz(1); allocate(glon(nlon))
    150      call read_data(grid_file, xname, glon, no_domain = .true.)
    151 
    152      call field_size(grid_file, yname, siz)
    153      nlat = siz(1); allocate(glat(nlat))
    154      call read_data(grid_file, yname, glat, no_domain = .true.)
    155      call check_grid_sizes(trim(mod_name)//'_domain  ', domain, nlon, nlat)
    156 
    157      is = isc - isg + 1; ie = iec - isg + 1
    158      js = jsc - jsg + 1; je = jec - jsg + 1
    159      do j = js, jec
    160         do i = is, ie
    161            lon(i,j) = glon(i)
    162            lat(i,j) = glat(j)
    163         enddo
    164      enddo
    165      deallocate(glon)
    166      deallocate(glat)
    167   case default
    168      call mpp_error(FATAL, "data_override_mod: mod_name should be 'atm', 'ocn', 'ice' or 'lnd' ")
    169   end select
    170 
    171 ! convert from degree to radian
    172   lon = lon * deg_to_radian

Page 5           Source Listing                  GET_GRID_VERSION_CLASSIC_1
2021-06-01 08:55                                 get_grid_version_mpp.F90

    173   lat = lat * deg_to_radian
    174   min_lon = minval(lon)
    175   max_lon = maxval(lon)
    176   call mpp_min(min_lon)
    177   call mpp_max(max_lon)
    178 
    179 
    180 end subroutine get_grid_version_classic_1


ENTRY POINTS

  Name                                                               
                                                                     
 get_grid_version_mpp_mod_mp_get_grid_version_classic_1_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DEG_TO_RADIAN              Param  172      R(8)            8           scalar                    172,173,260,261                   
 DOMAIN                     Dummy  61       DOMAIN2D        752         scalar   ARG,IN           81,82,98,100,101,111,112,155      
 DOMAIN2                    Local  78       DOMAIN2D        752         scalar                    112,113,114,115,118,119,138       
 FIELD_EXIST                Func   87       L(4)            4           scalar                    26,87,89,210                      
 FIELD_SIZE                 Subr   96                                                             25,96,109,148,152,218             
 GET_GRID_VERSION_CLASSIC_1 Subr   61                                                                                               
 GLAT                       Local  73       R(8)            8     1     1        ALC              153,154,162,166                   
 GLON                       Local  73       R(8)            8     1     1        ALC              149,150,161,165                   
 GRID_CENTER_BUG            Dummy  61       L(4)            4           scalar   ARG,IN           107,121                           
 GRID_FILE                  Dummy  61       CHAR                        scalar   ARG,IN           87,89,92,96,100,101,109,118,119,14
                                                                                                  8,150,152,154                     
 I                          Local  70       I(4)            4           scalar                    123,124,125,130,131,132,133,134,16
                                                                                                  0,161,162                         
 IE                         Local  75       I(4)            4           scalar                    157,160                           
 IEC                        Dummy  61       I(4)            4           scalar   ARG,IN           99,113,116,117,123,130,157        
 IED                        Local  76       I(4)            4           scalar                    81,114                            
 IEG                        Local  77       I(4)            4           scalar                    82,115                            
 IS                         Local  75       I(4)            4           scalar                    157,160                           
 ISC                        Dummy  61       I(4)            4           scalar   ARG,IN           66,99,113,116,117,123,130,157     
 ISD                        Local  76       I(4)            4           scalar                    81,114                            
 ISG                        Local  77       I(4)            4           scalar                    82,115,157                        
 IS_NEW_GRID                Local  74       L(4)            4           scalar                    86,88,90,95                       
 J                          Local  70       I(4)            4           scalar                    122,124,125,129,131,132,133,134,15
                                                                                                  9,161,162                         
 JE                         Local  75       I(4)            4           scalar                    158                               
 JEC                        Dummy  61       I(4)            4           scalar   ARG,IN           99,113,116,117,122,129,158,159    
 JED                        Local  76       I(4)            4           scalar                    81,114                            
 JEG                        Local  77       I(4)            4           scalar                    82,115                            
 JS                         Local  75       I(4)            4           scalar                    158,159                           
 JSC                        Dummy  61       I(4)            4           scalar   ARG,IN           66,99,113,116,117,122,129,158     
 JSD                        Local  76       I(4)            4           scalar                    81,114                            
 JSG                        Local  77       I(4)            4           scalar                    82,115,158                        
 LAT                        Dummy  61       R(8)            8     2     1        ARG,OUT          105,125,133,162,173               
 LAT_VERT                   Local  72       R(8)            8     3     1        ALC              99,101,105,117,119,125,133,134,141
 LON                        Dummy  61       R(8)            8     2     1        ARG,OUT          104,124,131,161,172,174,175       
 LON_VERT                   Local  72       R(8)            8     3     1        ALC              99,100,104,116,118,124,131,132,140

Page 6           Source Listing                  GET_GRID_VERSION_CLASSIC_1
2021-06-01 08:55 Symbol Table                    get_grid_version_mpp.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 MAXVAL                     Func   175                                  scalar                    175                               
 MAX_LON                    Dummy  61       R(8)            8           scalar   ARG,OUT          175,177                           
 MINVAL                     Func   174                                  scalar                    174                               
 MIN_LON                    Dummy  61       R(8)            8           scalar   ARG,OUT          174,176                           
 MOD_NAME                   Dummy  61       CHAR                        scalar   ARG,IN           84,98,111,143,155                 
 MPP_COPY_DOMAIN            Local  112                                  scalar                    28,112,229                        
 MPP_COPY_DOMAIN2D          Subr   112                                           PRIV             112,229                           
 MPP_DEALLOCATE_DOMAIN      Local  138                                  scalar                    30,138,269                        
 MPP_DEALLOCATE_DOMAIN2D    Subr   138                                           PRIV             138,269                           
 MPP_GET_DATA_DOMAIN        Local  81                                   scalar                    29,81,206                         
 MPP_GET_DATA_DOMAIN2D      Subr   81                                            PRIV             81,206                            
 MPP_MAX                    Local  177                                  scalar                    24,177,267                        
 MPP_MAX_REAL8_0D           Subr   177                                           PRIV             177,267                           
 MPP_MIN                    Local  176                                  scalar                    24,176,266                        
 MPP_MIN_REAL8_0D           Subr   176                                           PRIV             176,266                           
 MPP_SET_COMPUTE_DOMAIN     Local  113                                  scalar                    29,113,230                        
 MPP_SET_COMPUTE_DOMAIN2D   Subr   113                                           PRIV             113,230                           
 MPP_SET_DATA_DOMAIN        Local  114                                  scalar                    29,114,231                        
 MPP_SET_DATA_DOMAIN2D      Subr   114                                           PRIV             114,231                           
 MPP_SET_GLOBAL_DOMAIN      Local  115                                  scalar                    30,115,232                        
 MPP_SET_GLOBAL_DOMAIN2D    Subr   115                                           PRIV             115,232                           
 NLAT                       Local  71       I(4)            4           scalar                    97,98,110,111,153,155             
 NLON                       Local  71       I(4)            4           scalar                    97,98,110,111,149,155             
 NOTE                       Param  107      I(4)            4           scalar                    24,107                            
 READ_DATA                  Local  100                                  scalar                    25,100,101,118,119,150,154,211,240
                                                                                                  ,241                              
 READ_DATA_1D_NEW           Subr   150                                           PRIV             150,154                           
 READ_DATA_3D_NEW           Subr   100                                           PRIV             100,101,118,119                   
 SIZ                        Local  70       I(4)            4     1     4        TGT              96,97,109,110,148,149,152,153     
 TRIM                       Func   92                                   scalar                    92,98,100,101,111,118,119,143,155 
 XNAME                      Local  79       CHAR            3           scalar                    144,146,148,150                   
 YNAME                      Local  79       CHAR            3           scalar                    144,146,152,154                   

Page 7           Source Listing                  GET_GRID_VERSION_CLASSIC_1
2021-06-01 08:55                                 get_grid_version_mpp.F90

    181 
    182 ! Get global lon and lat of three model (target) grids from mosaic.nc
    183 ! z1l: currently we assume the refinement ratio is 2 and there is one tile on each pe.
    184 subroutine get_grid_version_classic_2(mosaic_file, mod_name, domain, isc, iec, jsc, jec, lon, lat, min_lon, max_lon)
    185   character(len=*),            intent(in) :: mosaic_file
    186   character(len=*),            intent(in) :: mod_name
    187   type(domain2d),              intent(in) :: domain
    188   integer,                     intent(in) :: isc, iec, jsc, jec
    189   real, dimension(isc:,jsc:), intent(out) :: lon, lat
    190   real,                       intent(out) :: min_lon, max_lon
    191 
    192   integer            :: i, j, siz(4)
    193   integer            :: nlon, nlat             ! size of global grid
    194   integer            :: nlon_super, nlat_super ! size of global supergrid.
    195   integer            :: isd, ied, jsd, jed
    196   integer            :: isg, ieg, jsg, jeg
    197   integer            :: isc2, iec2, jsc2, jec2
    198   character(len=256) :: solo_mosaic_file, grid_file
    199   real, allocatable  :: tmpx(:,:), tmpy(:,:)
    200   type(domain2d)     :: domain2
    201 
    202   if(trim(mod_name) .NE. 'atm' .AND. trim(mod_name) .NE. 'ocn' .AND. &
    203      trim(mod_name) .NE. 'ice' .AND. trim(mod_name) .NE. 'lnd' ) call mpp_error(FATAL, &
    204         "data_override_mod: mod_name should be 'atm', 'ocn', 'ice' or 'lnd' ")
    205 
    206   call mpp_get_data_domain(domain, isd, ied, jsd, jed)
    207   call mpp_get_global_domain(domain, isg, ieg, jsg, jeg)
    208 
    209 ! get the grid file to read
    210   if(field_exist(mosaic_file, trim(mod_name)//'_mosaic_file' )) then
    211      call read_data(mosaic_file, trim(mod_name)//'_mosaic_file', solo_mosaic_file)
    212      solo_mosaic_file = 'INPUT/'//trim(solo_mosaic_file)
    213   else
    214      solo_mosaic_file = mosaic_file
    215   end if
    216   call get_mosaic_tile_grid(grid_file, solo_mosaic_file, domain)
    217 
    218   call field_size(grid_file, 'area', siz)
    219   nlon_super = siz(1); nlat_super = siz(2)
    220   if( mod(nlon_super,2) .NE. 0) call mpp_error(FATAL,  &
    221        'data_override_mod: '//trim(mod_name)//' supergrid longitude size can not be divided by 2')
    222   if( mod(nlat_super,2) .NE. 0) call mpp_error(FATAL,  &
    223        'data_override_mod: '//trim(mod_name)//' supergrid latitude size can not be divided by 2')
    224   nlon = nlon_super/2;
    225   nlat = nlat_super/2;
    226   call check_grid_sizes(trim(mod_name)//'_domain  ', domain, nlon, nlat)
    227 
    228 !--- setup the domain for super grid.
    229   call mpp_copy_domain(domain, domain2)
    230   call mpp_set_compute_domain(domain2, 2*isc-1, 2*iec+1, 2*jsc-1, 2*jec+1, 2*iec-2*isc+3, 2*jec-2*jsc+3 )
    231   call mpp_set_data_domain   (domain2, 2*isd-1, 2*ied+1, 2*jsd-1, 2*jed+1, 2*ied-2*isd+3, 2*jed-2*jsd+3 )
    232   call mpp_set_global_domain (domain2, 2*isg-1, 2*ieg+1, 2*jsg-1, 2*jeg+1, 2*ieg-2*isg+3, 2*jeg-2*jsg+3 )
    233 
    234   call mpp_get_compute_domain(domain2, isc2, iec2, jsc2, jec2)
    235   if(isc2 .NE. 2*isc-1 .OR. iec2 .NE. 2*iec+1 .OR. jsc2 .NE. 2*jsc-1 .OR. jec2 .NE. 2*jec+1) then
    236      call mpp_error(FATAL, 'data_override_mod: '//trim(mod_name)//' supergrid domain is not set properly')
    237   endif

Page 8           Source Listing                  GET_GRID_VERSION_CLASSIC_2
2021-06-01 08:55                                 get_grid_version_mpp.F90

    238 
    239   allocate(tmpx(isc2:iec2, jsc2:jec2), tmpy(isc2:iec2, jsc2:jec2) )
    240   call read_data( grid_file, 'x', tmpx, domain2)
    241   call read_data( grid_file, 'y', tmpy, domain2)
    242 ! copy data onto model grid
    243   if(trim(mod_name) == 'ocn' .OR. trim(mod_name) == 'ice') then
    244      do j = jsc, jec
    245         do i = isc, iec
    246            lon(i,j) = (tmpx(i*2-1,j*2-1)+tmpx(i*2+1,j*2-1)+tmpx(i*2+1,j*2+1)+tmpx(i*2-1,j*2+1))*0.25
    247            lat(i,j) = (tmpy(i*2-1,j*2-1)+tmpy(i*2+1,j*2-1)+tmpy(i*2+1,j*2+1)+tmpy(i*2-1,j*2+1))*0.25
    248         end do
    249      end do
    250   else
    251      do j = jsc, jec
    252         do i = isc, iec
    253            lon(i,j) = tmpx(i*2,j*2)
    254            lat(i,j) = tmpy(i*2,j*2)
    255         end do
    256      end do
    257   endif
    258 
    259 ! convert to radian
    260   lon = lon * deg_to_radian
    261   lat = lat * deg_to_radian
    262 
    263   deallocate(tmpx, tmpy)
    264   min_lon = minval(lon)
    265   max_lon = maxval(lon)
    266   call mpp_min(min_lon)
    267   call mpp_max(max_lon)
    268 
    269   call mpp_deallocate_domain(domain2)
    270 
    271 end subroutine get_grid_version_classic_2

Page 9           Source Listing                  GET_GRID_VERSION_CLASSIC_2
2021-06-01 08:55 Entry Points                    get_grid_version_mpp.F90



ENTRY POINTS

  Name                                                               
                                                                     
 get_grid_version_mpp_mod_mp_get_grid_version_classic_2_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DOMAIN                     Dummy  184      DOMAIN2D        752         scalar   ARG,IN           206,207,216,226,229               
 DOMAIN2                    Local  200      DOMAIN2D        752         scalar                    229,230,231,232,234,240,241,269   
 GET_GRID_VERSION_CLASSIC_2 Subr   184                                                                                              
 GET_MOSAIC_TILE_GRID       Subr   216                                                            25,216                            
 GRID_FILE                  Local  198      CHAR            256         scalar                    216,218,240,241                   
 I                          Local  192      I(4)            4           scalar                    245,246,247,252,253,254           
 IEC                        Dummy  184      I(4)            4           scalar   ARG,IN           230,235,245,252                   
 IEC2                       Local  197      I(4)            4           scalar                    234,235,239                       
 IED                        Local  195      I(4)            4           scalar                    206,231                           
 IEG                        Local  196      I(4)            4           scalar                    207,232                           
 ISC                        Dummy  184      I(4)            4           scalar   ARG,IN           189,230,235,245,252               
 ISC2                       Local  197      I(4)            4           scalar                    234,235,239                       
 ISD                        Local  195      I(4)            4           scalar                    206,231                           
 ISG                        Local  196      I(4)            4           scalar                    207,232                           
 J                          Local  192      I(4)            4           scalar                    244,246,247,251,253,254           
 JEC                        Dummy  184      I(4)            4           scalar   ARG,IN           230,235,244,251                   
 JEC2                       Local  197      I(4)            4           scalar                    234,235,239                       
 JED                        Local  195      I(4)            4           scalar                    206,231                           
 JEG                        Local  196      I(4)            4           scalar                    207,232                           
 JSC                        Dummy  184      I(4)            4           scalar   ARG,IN           189,230,235,244,251               
 JSC2                       Local  197      I(4)            4           scalar                    234,235,239                       
 JSD                        Local  195      I(4)            4           scalar                    206,231                           
 JSG                        Local  196      I(4)            4           scalar                    207,232                           
 LAT                        Dummy  184      R(8)            8     2     1        ARG,OUT          247,254,261                       
 LON                        Dummy  184      R(8)            8     2     1        ARG,OUT          246,253,260,264,265               
 MAXVAL                     Func   265                                  scalar                    265                               
 MAX_LON                    Dummy  184      R(8)            8           scalar   ARG,OUT          265,267                           
 MINVAL                     Func   264                                  scalar                    264                               
 MIN_LON                    Dummy  184      R(8)            8           scalar   ARG,OUT          264,266                           
 MOD                        Func   220                                  scalar                    220,222                           
 MOD_NAME                   Dummy  184      CHAR                        scalar   ARG,IN           202,203,210,211,221,223,226,236,24
                                                                                                  3                                 
 MOSAIC_FILE                Dummy  184      CHAR                        scalar   ARG,IN           210,211,214                       
 MPP_GET_COMPUTE_DOMAIN     Local  234                                  scalar                    27,234                            
 MPP_GET_COMPUTE_DOMAIN2D   Subr   234                                           PRIV             234                               
 NLAT                       Local  193      I(4)            4           scalar                    225,226                           
 NLAT_SUPER                 Local  194      I(4)            4           scalar                    219,222,225                       
 NLON                       Local  193      I(4)            4           scalar                    224,226                           
 NLON_SUPER                 Local  194      I(4)            4           scalar                    219,220,224                       
 READ_DATA_2D_NEW           Subr   240                                           PRIV             240,241                           
 READ_DATA_TEXT             Subr   211                                           PRIV             211                               
 SIZ                        Local  192      I(4)            4     1     4        TGT              218,219                           
 SOLO_MOSAIC_FILE           Local  198      CHAR            256         scalar                    211,212,214,216                   
 TMPX                       Local  199      R(8)            8     2     1        ALC              239,240,246,253,263               

Page 10          Source Listing                  GET_GRID_VERSION_CLASSIC_2
2021-06-01 08:55 Symbol Table                    get_grid_version_mpp.F90

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TMPY                       Local  199      R(8)            8     2     1        ALC              239,241,247,254,263               
 TRIM                       Func   202                                  scalar                    202,203,210,211,212,221,223,226,23
                                                                                                  6,243                             

Page 11          Source Listing                  GET_GRID_VERSION_CLASSIC_2
2021-06-01 08:55                                 get_grid_version_mpp.F90

    272 
    273 end module get_grid_version_mpp_mod


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CONSTANTS_MOD              Module 23                                                             23                                
 FMS_IO_MOD                 Module 25                                                             25                                
 FMS_MOD                    Module 26                                                             26                                
 GET_GRID_VERSION_MPP_MOD   Module 22                                                                                               
 MPP_DOMAINS_MOD            Module 27                                                             27,28,29,30                       
 MPP_MOD                    Module 24                                                             24                                
 Operator (/=)                     27                                                                                               
 PI                         Param  23       R(8)            8           scalar                    23,34                             
 WARNING                    Param  24       I(4)            4           scalar                    24                                

Page 12          Source Listing                  GET_GRID_VERSION_CLASSIC_2
2021-06-01 08:55                                 get_grid_version_mpp.F90

    274 

Page 13          Source Listing                  GET_GRID_VERSION_CLASSIC_2
2021-06-01 08:55 Subprograms/Common Blocks       get_grid_version_mpp.F90



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CHECK_GRID_SIZES           Subr   38                                                             98,111,155,226                    
 GET_GRID_VERSION_CLASSIC_1 Subr   61                                                                                               
 GET_GRID_VERSION_CLASSIC_2 Subr   184                                                                                              
 GET_GRID_VERSION_MPP_MOD   Module 22                                                                                               

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume cc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
       -auto                            no   -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file
       -convert native                       -cross_reference
       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=0
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__

Page 14          Source Listing                  GET_GRID_VERSION_CLASSIC_2
2021-06-01 08:55                                 get_grid_version_mpp.F90

       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20191121       -D _OPENMP=201611
       -D __INTEL_OFFLOAD                    -D __MMX__
       -D __SSE__                            -D __SSE_MATH__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __pentium4                         -D __pentium4__
       -D __tune_pentium4__                  -D PACKAGE_NAME='"GFDL FMS Library"'
       -D PACKAGE_TARNAME='"FMS"'            -D PACKAGE_VERSION='"2021.02.0"'
       -D PACKAGE_STRING='"GFDL FMS Library 2021.02.0"'       -D PACKAGE_BUGREPORT='"gfdl.climate.model.info@noaa.gov"'
       -D PACKAGE_URL='"https://www.gfdl.noaa.gov/fms"'       -D PACKAGE='"FMS"'
       -D VERSION='"2021.02.0"'              -D STDC_HEADERS=1
       -D HAVE_SYS_TYPES_H=1                 -D HAVE_SYS_STAT_H=1
       -D HAVE_STDLIB_H=1                    -D HAVE_STRING_H=1
       -D HAVE_MEMORY_H=1                    -D HAVE_STRINGS_H=1
       -D HAVE_INTTYPES_H=1                  -D HAVE_STDINT_H=1
       -D HAVE_UNISTD_H=1                    -D HAVE_DLFCN_H=1
       -D LT_OBJDIR='".libs/"'               -D HAVE_MPI_H=1
       -D HAVE_NETCDF_H=1                    -D HAVE_SCHED_GETAFFINITY=1
       -D HAVE_MOD_MPI=1                     -D HAVE_MOD_NETCDF=1
       -D HAVE_CRAY_POINTER=1                -D HAVE_QUAD_PRECISION=1
       -D HAVE_INTERNAL_NML=1                -D use_netCDF=1
       -D use_libMPI=1                       -D INTERNAL_FILE_NML
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
  no   -fpconstant                           -fpe3
       -fprm nearest                         -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -fp_modbits nofp_contract
       -fp_modbits nono_fp_contract          -fp_modbits nofenv_access
       -fp_modbits nono_fenv_access          -fp_modbits nocx_limited_range
       -fp_modbits nono_cx_limited_range       -fp_modbits noprec_div
       -fp_modbits nono_prec_div             -fp_modbits noprec_sqrt
       -fp_modbits nono_prec_sqrt            -fp_modbits ftz
       -fp_modbits nono_ftz                  -fp_modbits nointrin_limited_range
       -fp_modbits nono_intrin_limited_range       -fp_modbits notrunc_compares
       -fp_modbits nono_trunc_compares       -fp_modbits noieee_nan_compares
       -fp_modbits nono_ieee_nan_compares       -fp_modbits honor_f32_conversion
       -fp_modbits nono_honor_f32_conversion       -fp_modbits honor_f64_conversion
       -fp_modbits nono_honor_f64_conversion       -fp_modbits nono_x87_copy
       -fp_modbits nono_no_x87_copy          -fp_modbits noexception_semantics
       -fp_modbits nono_exception_semantics       -fp_modbits noprecise_libm_functions
       -fp_modbits nono_precise_libm_functions       -heap_arrays 0
  no   -threadprivate_compat                 -free
       -g2                                   -iface nomixed_str_len_arg
       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity
       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny

Page 15          Source Listing                  GET_GRID_VERSION_CLASSIC_2
2021-06-01 08:55                                 get_grid_version_mpp.F90

       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
       -module ../.mods                      -names lowercase
  no   -noinclude                       no   -o
       -offload-build=host                   -openmp
       -openmp-simd                          -openmp-offload
       -O0                              no   -pad_source
       -real_size 64                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w noalignments                       -w nodeclarations
       -w noexternals                        -w nogeneral
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w nouncalled
       -w nouninitialized                    -w nounused
       -w nousage                       no   -wrap-margins

       -includepath : /opt/netcdf/4.6.1/INTEL/include/,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/,.f90,./.f90,./.f90,../include/.f90,
           ./.f90,/opt/netcdf/4.6.1/INTEL/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mpi/intel64/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/ipp/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/mkl/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/pstl/include/.f90,
           /opt/intel/2020/compilers_and_libraries/linux/tbb/include/.f90,/opt/intel/2020/compilers_and_libraries/linux/daal/include/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/intel64/.f90,/opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/icc/.f90,
           /opt/intel/2020/compilers_and_libraries_2020.0.166/linux/compiler/include/.f90,/usr/local/include/.f90,
           /usr/lib/gcc/x86_64-redhat-linux/4.8.5/include/.f90,/usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : get_grid_version_mpp.lst
  no   -o

COMPILER: Intel(R) Fortran 19.1-1555
